<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>è¡¨ç™½å¢™å®Œå–„ï¼ˆæ•°æ®åº“ï¼Œå‰ç«¯ï¼Œåç«¯Servletï¼‰ï¼Œå†è°ˆCookieå’ŒSessionã€‚ä»¥åŠä¸€ä¸ªå…³äºCookieçš„ç»ƒä¹ å°ç¨‹åº - ç¼–ç¨‹å­¦ä¹ è€…</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcxuexizhe.github.io/posts/da7d4050a5f64e356f40aa19568d702b/">
  <meta property="og:site_name" content="ç¼–ç¨‹å­¦ä¹ è€…">
  <meta property="og:title" content="è¡¨ç™½å¢™å®Œå–„ï¼ˆæ•°æ®åº“ï¼Œå‰ç«¯ï¼Œåç«¯Servletï¼‰ï¼Œå†è°ˆCookieå’ŒSessionã€‚ä»¥åŠä¸€ä¸ªå…³äºCookieçš„ç»ƒä¹ å°ç¨‹åº">
  <meta property="og:description" content="ç›®å½•
è¡¨ç™½å¢™å¼•å…¥æ•°æ®åº“Â å†è°ˆCookieå’Œsession
å¾—åˆ°Cookie
â€‹ç¼–è¾‘
è®¾ç½®Cooie
ä½¿ç”¨Cookieç¼–å†™ä¸€ä¸ªç™»å…¥çš„å°ç•Œé¢
è¡¨ç™½å¢™å¼•å…¥æ•°æ®åº“Â 1.å…ˆå¼•å…¥æ•°æ®åº“çš„ä¾èµ–ï¼ˆé©±åŠ¨åŒ…ï¼‰ï¼Œ5.1.49
pom.xmlä¸­ï¼Œåœ¨ä¹‹å‰çš„ä¸¤ä¸ªä¹‹å‰ï¼Œå†å»æ·»åŠ ä¸€ä¸ª
&lt;!-- https://mvnrepository.com/artifact/mysql/mysql-connector-java --&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;5.1.49&lt;/version&gt; &lt;/dependency&gt; 2.åˆ›å»ºæœ¬åœ°çš„æ•°æ®åº“
create table messageWall(`from` varchar(20),`to` varchar(20),message varchar(1024)); 3.ä¹‹å‰çš„ä»£ç ä¸­æœ‰ä¸€æ®µå¯ä»¥åˆ æ‰äº†
//æ­¤å¤„æŠŠæ¶ˆæ¯ä¿å­˜åˆ°å†…å­˜ä¸­ï¼ˆä¸€æ—¦é‡å¯æœåŠ¡å™¨ï¼Œå†…å­˜æ•°æ®å°±ä¼šæ¶ˆå¤±äº†ã€‚æ›´ç§‘å­¦çš„åšæ³•ï¼Œåº”è¯¥æ˜¯ä¿å­˜åˆ°æ•°æ®åº“é‡Œé¢ï¼‰ private List&lt;Message&gt; messageList=new ArrayList&lt;&gt;(); è¿™ä¸ªä»£ç éœ€è¦åˆ é™¤ï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»å†³å®šä½¿ç”¨æ•°æ®åº“å»å­˜å‚¨äº†ï¼Œå°±ä¸éœ€è¦æœ¬åœ°å»å­˜äº†ã€‚
å®Œæ•´ä»£ç 
import com.fasterxml.jackson.databind.ObjectMapper; import com.mysql.jdbc.jdbc2.optional.MysqlDataSource; import javax.servlet.ServletException; import javax.servlet.annotation.WebServlet; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import javax.sql.DataSource; import java.io.IOException; import java.sql.Connection; import java.sql.PreparedStatement; import java.sql.ResultSet; import java.sql.SQLException; import java.util.ArrayList; import java.util.List; class Message{ public String from; public String to; public String message; @Override public String toString() { return &#34;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-10-22T21:19:02+08:00">
    <meta property="article:modified_time" content="2023-10-22T21:19:02+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å­¦ä¹ è€…" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å­¦ä¹ è€…</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">è¡¨ç™½å¢™å®Œå–„ï¼ˆæ•°æ®åº“ï¼Œå‰ç«¯ï¼Œåç«¯Servletï¼‰ï¼Œå†è°ˆCookieå’ŒSessionã€‚ä»¥åŠä¸€ä¸ªå…³äºCookieçš„ç»ƒä¹ å°ç¨‹åº</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>ç›®å½•</strong></p> 
<p id="-toc" style="margin-left:0px;"></p> 
<p id="%E8%A1%A8%E7%99%BD%E5%A2%99%E5%BC%95%E5%85%A5%E6%95%B0%E6%8D%AE%E5%BA%93%C2%A0-toc" style="margin-left:0px;"><a href="#%E8%A1%A8%E7%99%BD%E5%A2%99%E5%BC%95%E5%85%A5%E6%95%B0%E6%8D%AE%E5%BA%93%C2%A0" rel="nofollow">è¡¨ç™½å¢™å¼•å…¥æ•°æ®åº“Â </a></p> 
<p id="%E5%86%8D%E8%B0%88Cookie%E5%92%8Csession-toc" style="margin-left:0px;"><a href="#%E5%86%8D%E8%B0%88Cookie%E5%92%8Csession" rel="nofollow">å†è°ˆCookieå’Œsession</a></p> 
<p id="%E5%BE%97%E5%88%B0Cookie-toc" style="margin-left:40px;"><a href="#%E5%BE%97%E5%88%B0Cookie" rel="nofollow">å¾—åˆ°Cookie</a></p> 
<p id="%E2%80%8B%E7%BC%96%E8%BE%91-toc" style="margin-left:40px;"><a href="#%E2%80%8B%E7%BC%96%E8%BE%91" rel="nofollow">â€‹ç¼–è¾‘</a></p> 
<p id="-toc" style="margin-left:40px;"></p> 
<p id="%E8%AE%BE%E7%BD%AECooie-toc" style="margin-left:40px;"><a href="#%E8%AE%BE%E7%BD%AECooie" rel="nofollow">è®¾ç½®Cooie</a></p> 
<p id="%E4%BD%BF%E7%94%A8Cookie%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AA%E7%99%BB%E5%85%A5%E7%9A%84%E5%B0%8F%E7%95%8C%E9%9D%A2-toc" style="margin-left:0px;"><a href="#%E4%BD%BF%E7%94%A8Cookie%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AA%E7%99%BB%E5%85%A5%E7%9A%84%E5%B0%8F%E7%95%8C%E9%9D%A2" rel="nofollow">ä½¿ç”¨Cookieç¼–å†™ä¸€ä¸ªç™»å…¥çš„å°ç•Œé¢</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="%E8%A1%A8%E7%99%BD%E5%A2%99%E5%BC%95%E5%85%A5%E6%95%B0%E6%8D%AE%E5%BA%93%C2%A0">è¡¨ç™½å¢™å¼•å…¥æ•°æ®åº“Â </h2> 
<blockquote> 
 <p>1.å…ˆå¼•å…¥æ•°æ®åº“çš„ä¾èµ–ï¼ˆé©±åŠ¨åŒ…ï¼‰ï¼Œ5.1.49</p> 
 <p>pom.xmlä¸­ï¼Œåœ¨ä¹‹å‰çš„ä¸¤ä¸ªä¹‹å‰ï¼Œå†å»æ·»åŠ ä¸€ä¸ª</p> 
 <pre><code>&lt;!-- https://mvnrepository.com/artifact/mysql/mysql-connector-java --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;mysql&lt;/groupId&gt;
    &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
    &lt;version&gt;5.1.49&lt;/version&gt;
&lt;/dependency&gt;
</code></pre> 
 <p>2.åˆ›å»ºæœ¬åœ°çš„æ•°æ®åº“</p> 
 <pre><code>create table messageWall(`from` varchar(20),`to` varchar(20),message varchar(1024));

</code></pre> 
 <p>3.ä¹‹å‰çš„ä»£ç ä¸­æœ‰ä¸€æ®µå¯ä»¥åˆ æ‰äº†</p> 
 <pre><code> //æ­¤å¤„æŠŠæ¶ˆæ¯ä¿å­˜åˆ°å†…å­˜ä¸­ï¼ˆä¸€æ—¦é‡å¯æœåŠ¡å™¨ï¼Œå†…å­˜æ•°æ®å°±ä¼šæ¶ˆå¤±äº†ã€‚æ›´ç§‘å­¦çš„åšæ³•ï¼Œåº”è¯¥æ˜¯ä¿å­˜åˆ°æ•°æ®åº“é‡Œé¢ï¼‰
    private List&lt;Message&gt; messageList=new ArrayList&lt;&gt;();
</code></pre> 
 <p>è¿™ä¸ªä»£ç éœ€è¦åˆ é™¤ï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»å†³å®šä½¿ç”¨æ•°æ®åº“å»å­˜å‚¨äº†ï¼Œå°±ä¸éœ€è¦æœ¬åœ°å»å­˜äº†ã€‚</p> 
 <p></p> 
</blockquote> 
<p>Â å®Œæ•´ä»£ç </p> 
<pre><code>import com.fasterxml.jackson.databind.ObjectMapper;
import com.mysql.jdbc.jdbc2.optional.MysqlDataSource;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.sql.DataSource;
import java.io.IOException;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

class  Message{
    public String from;
    public String to;
    public String message;

    @Override
    public String toString() {
        return "Message{" +
                "from='" + from + '\'' +
                ", to='" + to + '\'' +
                ", message='" + message + '\'' +
                '}';
    }
}

@WebServlet("/message")
public class MessageServlet extends HttpServlet {
    //é¦–å…ˆè¦æŠŠä¸€ä¸ªjsonè½¬åŒ–ä¸ºjavaå¯¹è±¡
    private ObjectMapper objectMapper=new ObjectMapper();
    //æ­¤å¤„æŠŠæ¶ˆæ¯ä¿å­˜åˆ°å†…å­˜ä¸­ï¼ˆä¸€æ—¦é‡å¯æœåŠ¡å™¨ï¼Œå†…å­˜æ•°æ®å°±ä¼šæ¶ˆå¤±äº†ã€‚æ›´ç§‘å­¦çš„åšæ³•ï¼Œåº”è¯¥æ˜¯ä¿å­˜åˆ°æ•°æ®åº“é‡Œé¢ï¼‰
    private List&lt;Message&gt; messageList=new ArrayList&lt;&gt;();

    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
       //1.éœ€è¦èƒ½å¤Ÿè¯»å–è¯·æ±‚body,è½¬æ¢æˆjavaå¯¹è±¡
        Message message=objectMapper.readValue(req.getInputStream(),Message.class);
        //2.å¾—åˆ°messageä¹‹åï¼Œéœ€è¦æŠŠmessageä¿å­˜åˆ°æœåŠ¡å™¨ä¸­
        try {
            save(message);
        } catch (SQLException e) {
            e.printStackTrace();
        }
        System.out.println("æœåŠ¡å™¨æ”¶åˆ°message:"+message.toString());
        //3.è¿”å›å“åº”ï¼Œï¼ˆå…¶å®æ²¡å•¥å¤§å¿…è¦ï¼Œä¸»è¦æ˜¯è¿”å›ä¸€ä¸ª200okå°±è¡Œï¼Œbodyå¯ä»¥æ²¡æœ‰ï¼‰
        resp.setStatus(200);                          //è®¾ç½®æˆåŠŸçŠ¶æ€ç ï¼Œä¼šæ›´åŠ æ¸…æ™°
        resp.getWriter().write("ok");
    }

    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        List&lt;Message&gt;messageList= null;
        try {
            messageList = load();
        } catch (SQLException e) {
            e.printStackTrace();
        }

        //1.æŠŠå†…å­˜ä¸­çš„è¿™äº›Messageï¼Œç»„ç»‡æˆjsonæ ¼å¼ï¼Œè¿”å›åˆ°å“åº”ä¸­
       String respJson=objectMapper.writeValueAsString(messageList);
       //è¿™ä¸ªä»£ç ååˆ†å…³é”®ï¼Œå‘Šè¯‰æµè§ˆå™¨ï¼Œè¿”å›çš„å“åº”çš„bodyæ˜¯jsonæ ¼å¼ï¼ˆutf8ç¼–ç ï¼‰
       resp.setContentType("application/json; charset=utf8");
       resp.getWriter().write(respJson);
        // 2.é’ˆå¯¹List/æ•°ç»„è¿™ç§ï¼Œjackonä¼šè‡ªåŠ¨æŠŠæ•°æ®æ•´ç†æˆjsonæ•°ç»„ï¼Œé‡Œé¢æ¯ä¸ªå¯¹è±¡ï¼Œåˆä¼šè¢«jsckonè½¬æ¢æˆ{}jsonå¯¹è±¡(jsonå¯¹è±¡å±æ€§åå­—ï¼Œä¹Ÿæ˜¯å’ŒMessageç±»çš„æˆå‘˜åå­—å¯¹åº”çš„ï¼‰

    }
    private void save(Message message) throws SQLException {
        //é€šè¿‡jdbcä»æ•°æ®åº“ä¸­å­˜å‚¨æ•°æ®ã€‚
        DataSource dataSource=new MysqlDataSource();
        //useSSL=false æ­¤å¤„çš„SSLå°±æ˜¯HTTPSä¸­çš„åŠ å¯†æ–¹æ¡ˆ
        ((MysqlDataSource) dataSource).setUrl("jdbc:mysql://127.0.0.1:3306/message?characterEncoding=utf8&amp;&amp;useSSL=false");
        ((MysqlDataSource)dataSource).setUser("root");
        ((MysqlDataSource)dataSource).setPassword("lcl15604007179");
        //2.å»ºç«‹é“¾æ¥
        Connection connection=dataSource.getConnection();
        //3.æ„é€ SQL
        String sql="insert into messageWall values(?,?,?)";
        PreparedStatement statement=connection.prepareStatement(sql);
        statement.setString(1, message.from);
        statement.setString(2, message.from);
        statement.setString(3, message.from);
        //4.æ‰§è¡ŒSQL
        statement.executeUpdate();
        //5.é‡Šæ”¾èµ„æºï¼Œå…³é—­è¿æ¥
        statement.close();
        connection.close();
    }
    private List&lt;Message&gt; load() throws SQLException {
        //é€šè¿‡jdbc,ä»æ•°æ®åº“è¯»å–æ•°æ®
        //1ã€‚åˆ›å»ºæ•°æ®æº
        DataSource dataSource=new MysqlDataSource();
        ((MysqlDataSource) dataSource).setUrl("jdbc:mysql://127.0.0.1:3306/message?characterEncoding=utf8&amp;&amp;useSSL=false");
        ((MysqlDataSource) dataSource).setUser("root");
        ((MysqlDataSource)dataSource).setPassword("lcl15604007179");
        //2.å»ºç«‹è¿æ¥
        Connection connection= dataSource.getConnection();
        //3.æ„é€ SQL
        String sql="select *from messageWall";
        PreparedStatement statement=connection.prepareStatement(sql);
        //4.æ‰§è¡ŒSQL
        ResultSet resultSet= statement.executeQuery();
        //5.éå†ç»“æœé›†åˆ
     List &lt;Message&gt; messageList=new ArrayList&lt;&gt;();
     while (resultSet.next()){
         Message message=new Message();
         message.from=resultSet.getString("from");
         message.to=resultSet.getString("to");
         message.message=resultSet.getString("message");
         messageList.add(message);
     }
     //å…³é—­è¿æ¥ï¼Œé‡Šæ”¾èµ„æº
        resultSet.close();
        statement.close();
        connection.close();
        return messageList;



    }





}
</code></pre> 
<p>æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œè¡¨ç™½å¢™ä¸Šçš„ä¸œè¥¿ï¼Œå³ä½¿ä½ å…³é—­æœåŠ¡å™¨ï¼Œæˆ‘ä»¬çš„æ•°æ®ä¹Ÿæ˜¯ä¿å­˜çš„ï¼Œè¿™ä¹Ÿæ˜¯æ¸¸æˆåœæœäº†ä½†æ˜¯ä½ çš„æ•°æ®ä¸ä¸¢å¤±çš„åŸå› ã€‚<img alt="" height="1200" src="https://images2.imgbox.com/f2/4d/DSgyhx8G_o.png" width="1200"></p> 
<h2 id="%E5%86%8D%E8%B0%88Cookie%E5%92%8Csession">å†è°ˆCookieå’Œsession</h2> 
<blockquote> 
 <p>Cookieæ˜¯æµè§ˆå™¨åœ¨æœ¬åœ°æŒä¹…åŒ–å­˜å‚¨æ•°æ®çš„ä¸€ç§æœºåˆ¶</p> 
 <p>1.Cookieçš„æ•°æ®ä»å“ªé‡Œæ¥ï¼Ÿ</p> 
 <p>æœåŠ¡å™¨è¿”å›ç»™æµè§ˆå™¨çš„</p> 
 <p>2.Cookieçš„æ•°æ®é•¿ä»€ä¹ˆæ ·å­ï¼Ÿ</p> 
 <p>Cookieä¸­æ˜¯é”®å€¼å¯¹ç»“æ„çš„æ•°æ®ï¼Œå¹¶ä¸”è¿™é‡Œçš„é”®å€¼å¯¹éƒ½æ˜¯ç¨‹åºå‘˜è‡ªå®šä¹‰çš„ã€‚</p> 
 <p>3.Cookieæœ‰ä»€ä¹ˆç”¨</p> 
 <p>Cookieå¯ä»¥åœ¨æµè§ˆå™¨è¿™è¾¹å­˜å‚¨ä¸€äº›ä¸´æ—¶æ€§æ•°æ®</p> 
 <p>å…¶ä¸­æœ€å…¸å‹çš„ä¸€ç§ä½¿ç”¨æ–¹å¼ï¼Œå°±æ˜¯ç”¨æ¥å­˜å‚¨â€œèº«ä»½æ ‡è¯†â€</p> 
 <p>sessionId-&gt;Cookieå’ŒSessionä¹‹é—´çš„è”åŠ¨äº†<img alt="" height="1094" src="https://images2.imgbox.com/73/35/xaazchml_o.png" width="1200"></p> 
 <p>4.Cookieåˆ°å“ªé‡Œå»</p> 
 <p>Cookieçš„å†…å®¹ä¼šåœ¨ä¸‹æ¬¡è®¿é—®è¯¥ç½‘ç«™çš„æ—¶å€™ï¼Œè‡ªåŠ¨è¢«å¸¦åˆ°HTTPè¯·æ±‚ä¸­</p> 
 <p>5.Cookieæ€ä¹ˆå­˜å‚¨çš„</p> 
 <p>æµè§ˆå™¨æŒ‰ç…§ä¸åŒçš„åŸŸååˆ†åˆ«å­˜å‚¨CookieåŸŸåå’ŒåŸŸåä¹‹é—´ä¸èƒ½æ‰“æ‰°ã€‚</p> 
 <p>Cookieå­˜å‚¨åœ¨ç¡¬ç›˜ä¸Šçš„</p> 
 <p>Cookieå­˜å‚¨å¾€å¾€ä¼šæœ‰ä¸€ä¸ªè¶…æ—¶æ—¶é—´ï¼ˆçœ‹æµè§ˆå™¨ä¸åŒè€Œå®šï¼Œæ”¯ä»˜å®å¾ˆçŸ­ï¼Œå®‰å…¨ï¼‰</p> 
</blockquote> 
<p></p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/65/b6/5KgR4v5J_o.png" width="1200"></p> 
<p></p> 
<h3 id="%E5%BE%97%E5%88%B0Cookie">å¾—åˆ°Cookie</h3> 
<pre><code>import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.Cookie;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

@WebServlet("/getcookie")
public class GetCookieServlet extends HttpServlet {
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        Cookie[] cookies = req.getCookies();
        if (cookies != null) {
            for (Cookie cookie : cookies) {
                System.out.println(cookie.getName() + ":" + cookie.getValue());
            }
        } else {
            resp.getWriter().write("å½“å‰è¯·æ±‚ä¸­æ²¡æœ‰cookie");
        }
        resp.getWriter().write("ok");
    }
}
</code></pre> 
<h3 id="%E2%80%8B%E7%BC%96%E8%BE%91"><img alt="" height="1200" src="https://images2.imgbox.com/7a/20/YOhVLRui_o.png" width="1200"></h3> 
<h3></h3> 
<h3 id="%E8%AE%BE%E7%BD%AECooie">è®¾ç½®Cooie</h3> 
<pre><code>import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.Cookie;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

@WebServlet("/setcookie")
public class SetCookieServlet extends HttpServlet {
    //æœŸæœ›é€šè¿‡doGetæ–¹æ³•ï¼ŒæŠŠä¸€ä¸ªè‡ªå®šä¹‰çš„cookieæ•°æ®è¿”å›åˆ°æµè§ˆå™¨è¿™è¾¹ã€‚
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        Cookie cookie=new Cookie("date","2023-09-23");
        resp.addCookie(cookie);
        Cookie cookie1=new Cookie("time","19:55");
        resp.addCookie(cookie1);
        resp.getWriter().write("setCookie ok");
    }
}
</code></pre> 
<p></p> 
<p><img alt="" height="786" src="https://images2.imgbox.com/fc/33/TwDNtE5J_o.png" width="1200"></p> 
<p></p> 
<blockquote> 
 <p>æˆ‘ä»¬éœ€è¦æ˜¯å…ˆè®¾ç½®Cookieä¹‹åï¼Œå°±å¯ä»¥æ­¤æ—¶æ‹¿åˆ°Cookieçš„å†…å®¹ï¼Œå½“ç„¶Cookieé‡Œé¢çš„æ•°æ®ï¼Œåªæ˜¯åœ¨æµè§ˆå™¨ä¼‘æ¯ä¼‘æ¯ï¼ŒçœŸæ­£å‘æŒ¥ä½œç”¨ï¼Œè¿˜æ˜¯å¾—åœ¨æœåŠ¡å™¨è¿™è¾¹çš„é€»è¾‘ç”Ÿæ•ˆçš„ã€‚</p> 
 <p>Cookieç»“åˆSessionå®ç°ç™»å…¥æ•ˆæœï¼Œæ­¤æ—¶å°±èƒ½æ›´æ¸…æ¥šçš„çœ‹å‡ºæ¥</p> 
</blockquote> 
<p><img alt="" height="1148" src="https://images2.imgbox.com/09/9b/N6FexrTZ_o.png" width="1200"></p> 
<p></p> 
<blockquote> 
 <p>sessionIdæ˜¯ä¸€ä¸ªå¹¿ä¹‰çš„æ¦‚å¿µï¼Œä¸åŒçš„åº“ä¸­å…·ä½“å®ç°è¿‡ç¨‹ä¼šæœ‰ä¸€äº›ç»†èŠ‚çš„å·®å¼‚ï¼Œåœ¨Servleté‡Œï¼ŒæŠŠè¿™ä¸ªå±æ€§å…·ä½“å«åšJSESSIONID</p> 
 <p>getSessionèƒŒååšçš„äº‹æƒ…ï¼ˆä¼šè¯ï¼Œå°±ç›¸å½“äºè´¦æˆ·ï¼Œç”¨æˆ·å’ŒæœåŠ¡å™¨çš„äº¤æµï¼Œä¹‹å‰æœ‰æ²¡æœ‰è¿™ä¸ªè´¦æˆ·ï¼‰</p> 
 <p>1.è¯»å–è¯·æ±‚ä¸­çš„Cookie,çœ‹Cookieé‡Œé¢æ˜¯å¦æœ‰JESSIONIDå±æ€§ï¼Œä»¥åŠå€¼æ˜¯ä»€ä¹ˆï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±è®¤ä¸ºéœ€è¦åˆ›å»ºæ–°çš„ä¼šè¯ï¼Œå¦‚æœæœ‰ï¼Œå°±æ‹¿ç€è¿™ä¸ªIDå»æŸ¥è¯¢å½“å‰çš„sessionæ˜¯å¦å­˜åœ¨</p> 
 <p>è¦æ˜¯sessionå­˜åœ¨ï¼Œå°±ç›´æ¥è¿”å›è¯¥session</p> 
 <p>è¦æ˜¯sessionä¸å­˜åœ¨ï¼Œå°±å‡†å¤‡åˆ›å»ºæ–°çš„ä¼šè¯ã€‚</p> 
 <p>2.å¦‚æœå½“å‰ç¡®å®éœ€è¦åˆ›å»ºä¼šè¯ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªSessionå¯¹è±¡ï¼ŒåŒæ—¶ç”Ÿæˆå”¯ä¸€çš„ä¸€ä¸ªJESSIONIDï¼Œä»¥JSESSIONIDä¸ºkeyï¼ŒSESSIONå¯¹è±¡ä¸ºvalueï¼ŒæŠŠè¿™ä¸ªé”®å€¼å¯¹æ’å…¥åˆ°æœåŠ¡å™¨ä¸Šè¿°çš„å“ˆå¸Œè¡¨ä¸­</p> 
 <p>3.åˆšæ‰ç”Ÿæˆçš„JESSIONIDåˆä¼šé€šè¿‡addCookieæ–¹æ³•ï¼ŒåŠ å…¥åˆ°å“åº”ä¸­ï¼Œæ­¤æ—¶å“åº”é‡Œå°±ä¼šå¸¦æœ‰Set-Cookieå­—æ®µï¼Œè¿™é‡Œçš„å€¼å°±æ˜¯JSEEION=xxxxxxxé€šè¿‡å“åº”ï¼Œå°±æŠŠJSESSIOIDè¿”å›åˆ°æµè§ˆå™¨è¿™è¾¹äº†ã€‚</p> 
 <p><span style="color:#511b78;"><strong>è¿™ä¸€è¡Œå°å°çš„ï¼Œèƒ½é‡å¤§å¤§çš„</strong></span>ğŸ™‰ğŸ™‰ğŸ™‰</p> 
 <pre><code> HttpSession session=req.getSession(true);</code></pre> 
 <p>é—®é¢˜1:ä»€ä¹ˆæƒ…å†µä¼šæœ‰sessionIdä½†æ˜¯æ²¡æœ‰sessionå‘¢</p> 
 <p>æœåŠ¡å™¨è¿™è¾¹å­˜çš„sessionå¯¹è±¡ä¹Ÿæ˜¯åœ¨å†…å­˜ä¸­è¿›è¡Œçš„</p> 
 <p>æ¯”å¦‚æŠŠsessionIdè¿”å›ç»™æµè§ˆå™¨äº†ï¼ŒsessionIdå’Œsessionå¯¹è±¡æ˜¯ä¿å­˜åœ¨æœåŠ¡å™¨å†…å­˜çš„ï¼Œæ­¤æ—¶å¦‚æœæœåŠ¡å™¨é‡å¯äº†ï¼Œå†…å­˜ä¸­è¿™äº›ä¼šè¯æ•°æ®å°±æ²¡äº†ï¼Œä½†æ˜¯æµè§ˆå™¨ä¸­çš„Cookieè¿˜æ˜¯å­˜åœ¨çš„</p> 
 <p>sessionå­˜åœ¨å†…å­˜ä¸­ä¸å¤ªåˆç†ï¼Œå®è·µä¸­å¾€å¾€ä¼šæŠŠè¿™ç§ä¼šè¯ä¿å­˜åˆ°å…¶ä»–ä»‹è´¨ä¸Šï¼Œæ¥è¾¾åˆ°æŒä¹…åŒ–å­˜å‚¨ç›®çš„ï¼ˆmysql,redis)</p> 
</blockquote> 
<h2 id="%E4%BD%BF%E7%94%A8Cookie%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AA%E7%99%BB%E5%85%A5%E7%9A%84%E5%B0%8F%E7%95%8C%E9%9D%A2">ä½¿ç”¨Cookieç¼–å†™ä¸€ä¸ªç™»å…¥çš„å°ç•Œé¢</h2> 
<p>ç®€å•çš„ä¸€ä¸ªå°çš„å‰ç«¯ä»£ç </p> 
<pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;Document&lt;/title&gt;
&lt;/head&gt;
&lt;form action="login" method="post"&gt;
    &lt;input type="text" name="username"&gt;
    &lt;input type="password" name="password"&gt;
    &lt;input type="submit"  value="ç™»å…¥"&gt;
&lt;!--  å½“å‰é¡µé¢æ˜¯ä¸€ä¸ªformè¡¨å•--&gt;
  &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre> 
<p>åç«¯çš„ç™»å…¥ä»£ç ç¼–å†™</p> 
<pre><code class="hljs">import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;
import java.io.IOException;

@WebServlet("/index")
public class indexServlet extends HttpServlet {
    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        //å…ˆéªŒè¯ç”¨æˆ·çš„ç™»å…¥çŠ¶æ€ï¼Œå¦‚æœæœªç™»å…¥ï¼Œå°±è¦æ±‚ç”¨æˆ·è¦å…ˆç™»å…¥ä¸€ä¸‹
        HttpSession session=req.getSession(false);
        if(session==null){
            //ç”¨æˆ·å°šæœªç™»å…¥
            resp.setContentType("text/html;charset=utf8");
            resp.getWriter().write("è¯·å…ˆç™»å…¥ï¼Œå†è®¿é—®ä¸»é¡µ");
            return;
        }
        //å·²ç»ç™»å…¥æˆåŠŸäº†
        //å°±å¯ä»¥å–å‡ºä¹‹å‰çš„attribute
        String username=(String) session.getAttribute("username");
        Long time=(Long) session.getAttribute("time");
        System.out.println("username="+username+",time"+time);
        //æ ¹æ®è¿™æ ·çš„å†…å®¹æ„é€ é¡µé¢
        resp.setContentType("text/html;charset=utf8");
        resp.getWriter().write("æ¬¢è¿æ‚¨,"+username+"!ä¸Šæ¬¡ç™»å…¥æ—¶é—´"+time);
    }
}
</code></pre> 
<p>é‡å®šå‘çš„å†…å®¹ç¼–å†™Â </p> 
<pre><code>import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;
import java.io.IOException;
@WebServlet("/login")
public class LoginServlet extends HttpServlet {
    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        //1.è·å–åˆ°ç”¨æˆ·åå’Œå¯†ç 
        String username = req.getParameter("username");
        String password = req.getParameter("password");
        if (username == null || password == null || username.equals("") || password.equals("")) {
            resp.setContentType("text/html;charset=utf8");
            resp.getWriter().write("è¯·æ±‚çš„å‚æ•°ä¸å®Œæ•´");
            return;
        }
        //2.éªŒè¯ç”¨æˆ·å¯†ç æ˜¯å¦æ­£ç¡®
        //æ­£å¸¸çš„éªŒè¯ï¼Œæ˜¯ä»æ•°æ®åº“è¯»å–æ•°æ®
        //æ³¨å†Œè´¦å·å°±ä¼šç»™æ•°æ®åº“æ’å…¥ç”¨æˆ·åå’Œå¯†ç ï¼Œç™»å…¥çš„æ—¶å€™å°±æ˜¯éªŒè¯å½“å‰ç”¨æˆ·åæ˜¯å¦å­˜åœ¨ï¼Œä»¥åŠå¯†ç æ˜¯å¦åŒ¹é…
        //å½“å‰ä¸ºäº†ç®€å•ï¼Œå…ˆä¸å¼•å…¥æ•°æ®åº“ï¼Œç›´æ¥é€šè¿‡ç¡¬ç¼–ç çš„æ–¹å¼æ¥åˆ¤å®šç”¨æˆ·åå’Œå¯†ç 
        //æ­¤å¤„çº¦å®šï¼Œåˆæ³•çš„ç”¨æˆ·åæ˜¯:zhangsanï¼Œå¯†ç :123
        if (!username.equals("zhangsan")) {
            resp.setContentType("text/html;charset=utf8");
            resp.getWriter().write("ç”¨æˆ·åé”™è¯¯ï¼");
            return;
        }
        if (!password.equals("123")) {
            resp.setContentType("text/html;charset=utf8");
            resp.getWriter().write("å¯†ç é”™è¯¯");
            return;
        }
        //3.ç™»å…¥æˆåŠŸäº†ï¼Œæ­¤æ—¶å¯ä»¥ç»™è¿™ä¸ªç”¨æˆ·åˆ›å»ºä¼šè¯ï¼ˆå°±æ˜¯è¿™ä¸ªäººåœ¨ä¸åœ¨è´¦æˆ·ä¸Šï¼‰
        HttpSession session = req.getSession(true);
        //ä¼šè¯æ€»ï¼Œå¯ä»¥é¡ºä¾¿ä¿å­˜ç‚¹è‡ªå®šä¹‰çš„æ•°æ®ï¼Œæ¯”å¦‚ä¿å­˜ä¸€ä¸ªç™»å…¥çš„æ—¶é—´æˆ³
        //setAttributeåé¢çš„valueæ˜¯ä¸ªObject,æƒ³è¦å­˜ä»€ä¹ˆéƒ½å¯ä»¥ï¼ï¼
        session.setAttribute("username", username);
        session.setAttribute("time", System.currentTimeMillis());
        //4.è®©é¡µé¢è‡ªåŠ¨è·³è½¬åˆ°ç½‘ç«™ä¸»é¡µ
        //æ­¤å¤„çº¦å®šçš„è·¯å¾„æ˜¯index(ä½¿ç”¨Servletç”Ÿæˆä¸€ä¸ªåŠ¨æ€é¡µé¢ï¼‰
        resp.sendRedirect("index");
    }
}</code></pre> 
<p>å½“å‰ç¨‹åºè®¾è®¡ä¸‰ä¸ªéƒ¨åˆ†è¿›è¡Œè”åŠ¨â€”â€”ä»¥ä¸‹æ˜¯ç™»å…¥æˆåŠŸçš„æ•ˆæœ</p> 
<blockquote> 
 <p>1.ç™»å…¥ç•Œé¢ï¼ˆé™æ€çš„html,ä½¿ç”¨formæ„é€ httpè¯·æ±‚ï¼‰</p> 
 <p>2.LoginServlet(doPostå¤„ç†ç™»å…¥çš„é€»è¾‘æµç¨‹ 1234ï¼‰</p> 
 <p>3.IndexServlet(doGetå¤„ç†ä¸»é¡µçš„ç”Ÿæˆï¼‰<img alt="" height="490" src="https://images2.imgbox.com/84/ed/QopgezR7_o.png" width="1200"><img alt="" height="484" src="https://images2.imgbox.com/37/37/X0Ao32n4_o.png" width="1148"></p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/bd091c43c396af3bb0075bbe13f824ad/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">ä¸‹è½½å®‰è£…Microsoft ODBC Driver for SQL Serverå’Œé…ç½®SQL Server ODBCæ•°æ®æº</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/53551ff875464eed3c062245e0843997/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">MinGW-w64çš„å®‰è£…è¯¦ç»†æ­¥éª¤(c/c&#43;&#43;çš„ç¼–è¯‘å™¨gccã€g&#43;&#43;çš„windowsç‰ˆï¼Œwin10ã€win11çœŸå®å¯ç”¨ï¼‰</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å­¦ä¹ è€….
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【微信小程序开发】小程序前后端交互--发送网络请求实战解析 - 编程学习者</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcxuexizhe.github.io/posts/229dc76b90237e3b56d25c4ed7bd69e8/">
  <meta property="og:site_name" content="编程学习者">
  <meta property="og:title" content="【微信小程序开发】小程序前后端交互--发送网络请求实战解析">
  <meta property="og:description" content="✨✨ 欢迎大家来到景天科技苑✨✨
🎈🎈 养成好习惯，先赞后看哦~🎈🎈
🏆 作者简介：景天科技苑
🏆《头衔》：大厂架构师，华为云开发者社区专家博主，阿里云开发者社区专家博主，CSDN全栈领域优质创作者，掘金优秀博主，51CTO博客专家等。
🏆《博客》：Python全栈，前后端开发，小程序开发，人工智能，js逆向，App逆向，网络系统安全，数据分析，Django，fastapi，flask等框架，linux，shell脚本等实操经验，网站搭建，数据库等分享。
所属的专栏：微信小程序开发零基础教学，难点与应用实战总结
景天的主页：景天科技苑
文章目录 发送网络请求1.微信发送网络请求2.后端接口3.发送请求4.loading提示框5.结合爬虫实战案例 发送网络请求 在之前的小程序开发章节中，全是在微信小程序端操作，没有加入后端内容。
本文将详细讲讲如何从后端获取数据，需要在微信小程序端，发送网络请求，获取数据，显示在小程序上
1.微信发送网络请求 注意：发送网络请求的域名，必须在微信公众平台配置
本地环境去除，只适用于开发版和体验版 配置域名：
登录小程序后台–开发管理
必须配置在工信部备案的域名
未备案的域名不能填写
我们本地开发，不需要域名，只需要在开发者工具中，详情配置里面，勾选不校验合法域名即可
这样，开发和体验的微信号就不用域名也可以访问
2.后端接口 使用django后端：写个接口，返回用户信息微信小程序端：发送请求，获取数据，显示在微信小程序端 视图层：
from django.shortcuts import render from django.http import JsonResponse import time import json import requests # Create your views here. #写个接口，返回数据 def index(request): # time.sleep(3) return JsonResponse({&#34;name&#34;:&#34;彭于晏&#34;,&#34;age&#34;:39,&#34;hobby&#34;:&#34;抽烟&#34;}) url路由
from django.contrib import admin from django.urls import path from app import views urlpatterns = [ path(&#39;admin/&#39;, admin.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-22T07:15:00+08:00">
    <meta property="article:modified_time" content="2024-05-22T07:15:00+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程学习者" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程学习者</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【微信小程序开发】小程序前后端交互--发送网络请求实战解析</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><img src="https://images2.imgbox.com/e3/f9/XfG6wdHf_o.jpg" alt="在这里插入图片描述"></p> 
<p><strong>✨✨ 欢迎大家来到景天科技苑✨✨</strong></p> 
<p><strong>🎈🎈 养成好习惯，先赞后看哦~🎈🎈</strong></p> 
<blockquote> 
 <p>🏆 作者简介：景天科技苑<br> 🏆《头衔》：大厂架构师，华为云开发者社区专家博主，阿里云开发者社区专家博主，CSDN全栈领域优质创作者，掘金优秀博主，51CTO博客专家等。<br> 🏆《博客》：Python全栈，前后端开发，小程序开发，人工智能，js逆向，App逆向，网络系统安全，数据分析，Django，fastapi，flask等框架，linux，shell脚本等实操经验，网站搭建，数据库等分享。</p> 
 <p><strong>所属的专栏：</strong><a href="https://blog.csdn.net/littlefun591/category_12650706.html?spm=1001.2014.3001.5482">微信小程序开发零基础教学，难点与应用实战总结</a><br> <strong>景天的主页：</strong><a href="https://jingtian.blog.csdn.net/" rel="nofollow">景天科技苑</a></p> 
</blockquote> 
<p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_20" rel="nofollow">发送网络请求</a></li><li><ul><li><a href="#1_26" rel="nofollow">1.微信发送网络请求</a></li><li><a href="#2_48" rel="nofollow">2.后端接口</a></li><li><a href="#3_98" rel="nofollow">3.发送请求</a></li><li><a href="#4loading_163" rel="nofollow">4.loading提示框</a></li><li><a href="#5_199" rel="nofollow">5.结合爬虫实战案例</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_20"></a>发送网络请求</h2> 
<p>在之前的小程序开发章节中，全是在微信小程序端操作，没有加入后端内容。</p> 
<p>本文将详细讲讲如何从后端获取数据，需要在微信小程序端，发送网络请求，获取数据，显示在小程序上</p> 
<h3><a id="1_26"></a>1.微信发送网络请求</h3> 
<p><strong>注意：发送网络请求的域名，必须在微信公众平台配置</strong></p> 
<ul><li>本地环境去除，只适用于开发版和体验版</li></ul> 
<p><strong>配置域名：</strong><br> 登录小程序后台–开发管理<br> 必须配置在工信部备案的域名<br> <img src="https://images2.imgbox.com/d6/ff/HqLfNfvW_o.png" alt="在这里插入图片描述"></p> 
<p>未备案的域名不能填写<br> <img src="https://images2.imgbox.com/3b/a4/J4ONyp8o_o.png" alt="在这里插入图片描述"></p> 
<p>我们本地开发，不需要域名，只需要在开发者工具中，详情配置里面，勾选不校验合法域名即可<br> 这样，开发和体验的微信号就不用域名也可以访问<br> <img src="https://images2.imgbox.com/78/73/HWSRiqtf_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2_48"></a>2.后端接口</h3> 
<ul><li>使用django后端：写个接口，返回用户信息</li><li>微信小程序端：发送请求，获取数据，显示在微信小程序端</li></ul> 
<p>视图层：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> render

<span class="token keyword">from</span> django<span class="token punctuation">.</span>http <span class="token keyword">import</span> JsonResponse

<span class="token keyword">import</span> time

<span class="token keyword">import</span> json
<span class="token keyword">import</span> requests


<span class="token comment"># Create your views here.</span>


<span class="token comment">#写个接口，返回数据</span>

<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># time.sleep(3)</span>
    <span class="token keyword">return</span> JsonResponse<span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token string">"name"</span><span class="token punctuation">:</span><span class="token string">"彭于晏"</span><span class="token punctuation">,</span><span class="token string">"age"</span><span class="token punctuation">:</span><span class="token number">39</span><span class="token punctuation">,</span><span class="token string">"hobby"</span><span class="token punctuation">:</span><span class="token string">"抽烟"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/2b/09/vnA7pn5e_o.png" alt="在这里插入图片描述"></p> 
<p>url路由</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib <span class="token keyword">import</span> admin
<span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path

<span class="token keyword">from</span> app <span class="token keyword">import</span> views

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">'admin/'</span><span class="token punctuation">,</span> admin<span class="token punctuation">.</span>site<span class="token punctuation">.</span>urls<span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">'index/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>index<span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/5e/72/IyYO8NaO_o.png" alt="在这里插入图片描述"></p> 
<p>浏览器访问，得到响应数据<br> <img src="https://images2.imgbox.com/8d/59/hWGdOChw_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="3_98"></a>3.发送请求</h3> 
<p>###js###<br> <img src="https://images2.imgbox.com/14/37/UgubqaY6_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-javascript">  <span class="token literal-property property">user</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>

  <span class="token function">handleLoadUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 发送请求之前 loading效果</span>
    wx<span class="token punctuation">.</span><span class="token function">showLoading</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'加载中~~'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">mask</span><span class="token operator">:</span><span class="token boolean">true</span>  <span class="token comment">// 显示透明蒙层，设置后，框后的按钮都不能点击了</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'http://127.0.0.1:8000/index/'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">method</span><span class="token operator">:</span><span class="token string">'GET'</span><span class="token punctuation">,</span>
      <span class="token comment">//如果是get请求，data就是请求参数，如果是post请求，data就是请求体数据</span>
      <span class="token literal-property property">data</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">header</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
          <span class="token comment">//请求成功</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"请求成功，结果为："</span><span class="token punctuation">,</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
          <span class="token comment">//将请求结果更新到页面对象user中</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">user</span><span class="token operator">:</span>res<span class="token punctuation">.</span>data
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">fail</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">complete</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 关闭加载，无论成功与否都会执行</span>
        wx<span class="token punctuation">.</span><span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>

    <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/ef/3f/MTv2xDDS_o.png" alt="在这里插入图片描述"></p> 
<p>##wxml###</p> 
<pre><code class="prism language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>---发送网络请求-----<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>用户名：{<!-- -->{user.name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>爱好：{<!-- -->{user.hobby}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>年龄：{<!-- -->{user.age}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>primary<span class="token punctuation">"</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>handleLoadUser<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>加载用户信息<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p><img src="https://images2.imgbox.com/03/2a/CxVL9Pq6_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4loading_163"></a>4.loading提示框</h3> 
<pre><code class="prism language-javascript"> wx<span class="token punctuation">.</span><span class="token function">showLoading</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'加载中，稍后'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">mask</span><span class="token operator">:</span><span class="token boolean">true</span>  <span class="token comment">// 显示透明蒙层</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/63/27/hSGTjpzR_o.png" alt="在这里插入图片描述"></p> 
<p>#关闭–必须手动关闭，在complete中写的，如论请求成功与否，都会执行</p> 
<pre><code class="prism language-javascript"> wx<span class="token punctuation">.</span><span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/b3/2d/XB5YQXoa_o.png" alt="在这里插入图片描述"></p> 
<p>模拟网络请求延迟，在后台延迟3秒再响应<br> <img src="https://images2.imgbox.com/20/b7/Lz7yw8tO_o.png" alt="在这里插入图片描述"></p> 
<p>点击加载，出现加载中模态框<br> <img src="https://images2.imgbox.com/a4/0d/kZY3jBoD_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="5_199"></a>5.结合爬虫实战案例</h3> 
<p>卖座电影网数据展示<br> https://m.maizuo.com/v5/#/films/nowPlaying<br> <img src="https://images2.imgbox.com/e2/69/DcZAdfsC_o.png" alt="在这里插入图片描述"></p> 
<p>通过代码调试，得知返回的响应是在这个接口<br> https://m.maizuo.com/gateway?cityId=440300&amp;pageNum=1&amp;pageSize=10&amp;type=1&amp;k=7329328<br> <img src="https://images2.imgbox.com/10/49/m9L0WVpb_o.png" alt="在这里插入图片描述"></p> 
<p>我们使用爬虫得到数据，拿到小程序上展示</p> 
<p>将该页面展示到小程序上<br> django接口代码</p> 
<pre><code class="prism language-python"><span class="token comment">#返回电影接口</span>

<span class="token keyword">def</span> <span class="token function">films</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>

    cookies <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'aliyungf_tc'</span><span class="token punctuation">:</span> <span class="token string">'3b04bdddc2fcc08a2e07b5c05804eeb7f3559c2c0c84bea844e7c501a2c93bf6'</span><span class="token punctuation">,</span>
        <span class="token string">'acw_tc'</span><span class="token punctuation">:</span> <span class="token string">'ac11000117162716286612753e74b1e14e614cc55223c8721d0381c2eba53e'</span><span class="token punctuation">,</span>
        <span class="token string">'co'</span><span class="token punctuation">:</span> <span class="token string">'mzmovie'</span><span class="token punctuation">,</span>
        <span class="token string">'DEVICE_ID'</span><span class="token punctuation">:</span> <span class="token string">'17162716284574994868731905'</span><span class="token punctuation">,</span>
        <span class="token string">'gr_user_id'</span><span class="token punctuation">:</span> <span class="token string">'f9c0d6d0-e26b-44f9-be62-d939767554ff'</span><span class="token punctuation">,</span>
        <span class="token string">'ac641e22637cd956_gr_session_id'</span><span class="token punctuation">:</span> <span class="token string">'c6136a17-7e24-4344-bd43-ba4216e3a7f8'</span><span class="token punctuation">,</span>
        <span class="token string">'ac641e22637cd956_gr_session_id_sent_vst'</span><span class="token punctuation">:</span> <span class="token string">'c6136a17-7e24-4344-bd43-ba4216e3a7f8'</span><span class="token punctuation">,</span>
        <span class="token string">'ac641e22637cd956_gr_last_sent_sid_with_cs1'</span><span class="token punctuation">:</span> <span class="token string">'c6136a17-7e24-4344-bd43-ba4216e3a7f8'</span><span class="token punctuation">,</span>
        <span class="token string">'ac641e22637cd956_gr_last_sent_cs1'</span><span class="token punctuation">:</span> <span class="token string">'undefined'</span><span class="token punctuation">,</span>
        <span class="token string">'_bl_uid'</span><span class="token punctuation">:</span> <span class="token string">'g8ldjw2hfeLz4ktFwed4oL96OgzU'</span><span class="token punctuation">,</span>
        <span class="token string">'COOKIE_CITY_ID'</span><span class="token punctuation">:</span> <span class="token string">'440300'</span><span class="token punctuation">,</span>
        <span class="token string">'COOKIE_CITY_NAME'</span><span class="token punctuation">:</span> <span class="token string">'%E6%B7%B1%E5%9C%B3'</span><span class="token punctuation">,</span>
        <span class="token string">'COOKIE_BUSINESS_CITY'</span><span class="token punctuation">:</span> <span class="token string">'440300'</span><span class="token punctuation">,</span>
        <span class="token string">'COOKIE_SERVICE_TIME'</span><span class="token punctuation">:</span> <span class="token string">'1716271699'</span><span class="token punctuation">,</span>
        <span class="token string">'ac641e22637cd956_gr_cs1'</span><span class="token punctuation">:</span> <span class="token string">'undefined'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>

    headers <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'Accept'</span><span class="token punctuation">:</span> <span class="token string">'application/json, text/plain, */*'</span><span class="token punctuation">,</span>
        <span class="token string">'Accept-Language'</span><span class="token punctuation">:</span> <span class="token string">'zh-CN,zh;q=0.9,en;q=0.8'</span><span class="token punctuation">,</span>
        <span class="token string">'Cache-Control'</span><span class="token punctuation">:</span> <span class="token string">'no-cache'</span><span class="token punctuation">,</span>
        <span class="token string">'Connection'</span><span class="token punctuation">:</span> <span class="token string">'keep-alive'</span><span class="token punctuation">,</span>
        <span class="token comment"># 'Cookie': 'aliyungf_tc=3b04bdddc2fcc08a2e07b5c05804eeb7f3559c2c0c84bea844e7c501a2c93bf6; acw_tc=ac11000117162716286612753e74b1e14e614cc55223c8721d0381c2eba53e; co=mzmovie; DEVICE_ID=17162716284574994868731905; gr_user_id=f9c0d6d0-e26b-44f9-be62-d939767554ff; ac641e22637cd956_gr_session_id=c6136a17-7e24-4344-bd43-ba4216e3a7f8; ac641e22637cd956_gr_session_id_sent_vst=c6136a17-7e24-4344-bd43-ba4216e3a7f8; ac641e22637cd956_gr_last_sent_sid_with_cs1=c6136a17-7e24-4344-bd43-ba4216e3a7f8; ac641e22637cd956_gr_last_sent_cs1=undefined; _bl_uid=g8ldjw2hfeLz4ktFwed4oL96OgzU; COOKIE_CITY_ID=440300; COOKIE_CITY_NAME=%E6%B7%B1%E5%9C%B3; COOKIE_BUSINESS_CITY=440300; COOKIE_SERVICE_TIME=1716271699; ac641e22637cd956_gr_cs1=undefined',</span>
        <span class="token string">'EagleEye-SessionID'</span><span class="token punctuation">:</span> <span class="token string">'undefined'</span><span class="token punctuation">,</span>
        <span class="token string">'EagleEye-TraceID'</span><span class="token punctuation">:</span> <span class="token string">'69708c621716271709032100044555'</span><span class="token punctuation">,</span>
        <span class="token string">'Pragma'</span><span class="token punctuation">:</span> <span class="token string">'no-cache'</span><span class="token punctuation">,</span>
        <span class="token string">'Referer'</span><span class="token punctuation">:</span> <span class="token string">'https://m.maizuo.com/v5/'</span><span class="token punctuation">,</span>
        <span class="token string">'Sec-Fetch-Dest'</span><span class="token punctuation">:</span> <span class="token string">'empty'</span><span class="token punctuation">,</span>
        <span class="token string">'Sec-Fetch-Mode'</span><span class="token punctuation">:</span> <span class="token string">'cors'</span><span class="token punctuation">,</span>
        <span class="token string">'Sec-Fetch-Site'</span><span class="token punctuation">:</span> <span class="token string">'same-origin'</span><span class="token punctuation">,</span>
        <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36'</span><span class="token punctuation">,</span>
        <span class="token string">'X-Client-Info'</span><span class="token punctuation">:</span> <span class="token string">'{"a":"3000","ch":"1002","v":"5.2.1","e":"17162716284574994868731905","bc":"440300"}'</span><span class="token punctuation">,</span>
        <span class="token string">'X-Host'</span><span class="token punctuation">:</span> <span class="token string">'mall.film-ticket.film.list'</span><span class="token punctuation">,</span>
        <span class="token string">'X-Requested-With'</span><span class="token punctuation">:</span> <span class="token string">'XMLHttpRequest'</span><span class="token punctuation">,</span>
        <span class="token string">'X-Token'</span><span class="token punctuation">:</span> <span class="token string">'undefined'</span><span class="token punctuation">,</span>
        <span class="token string">'sec-ch-ua'</span><span class="token punctuation">:</span> <span class="token string">'"Not_A Brand";v="8", "Chromium";v="120", "Google Chrome";v="120"'</span><span class="token punctuation">,</span>
        <span class="token string">'sec-ch-ua-mobile'</span><span class="token punctuation">:</span> <span class="token string">'?0'</span><span class="token punctuation">,</span>
        <span class="token string">'sec-ch-ua-platform'</span><span class="token punctuation">:</span> <span class="token string">'"Windows"'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>

    params <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token string">'cityId'</span><span class="token punctuation">:</span> <span class="token string">'440300'</span><span class="token punctuation">,</span>
        <span class="token string">'pageNum'</span><span class="token punctuation">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>
        <span class="token string">'pageSize'</span><span class="token punctuation">:</span> <span class="token string">'10'</span><span class="token punctuation">,</span>
        <span class="token string">'type'</span><span class="token punctuation">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span>
        <span class="token string">'k'</span><span class="token punctuation">:</span> <span class="token string">'7329328'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>

    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'https://m.maizuo.com/gateway'</span><span class="token punctuation">,</span> params<span class="token operator">=</span>params<span class="token punctuation">,</span> cookies<span class="token operator">=</span>cookies<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>

    data <span class="token operator">=</span> response<span class="token punctuation">.</span>text
    data <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    films_data <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'films'</span><span class="token punctuation">]</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>films_data<span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>films_data<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> JsonResponse<span class="token punctuation">(</span>films_data<span class="token punctuation">,</span>safe<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</code></pre> 
<p>小程序 wxml</p> 
<pre><code class="prism language-html"><span class="token comment">&lt;!--pages/now/now.wxml--&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{<!-- -->{filmsList}}<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>index<span class="token punctuation">"</span></span>  <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">flex</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span> <span class="token property">margin-right</span><span class="token punctuation">:</span> 20rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{<!-- -->{item.poster}}<span class="token punctuation">"</span></span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>aspectFit<span class="token punctuation">"</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">width</span><span class="token punctuation">:</span> 130px<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">/&gt;</span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">flex</span><span class="token punctuation">:</span> 2<span class="token punctuation">;</span> <span class="token property">margin-top</span><span class="token punctuation">:</span> 100rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">font-weight</span><span class="token punctuation">:</span> 900<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span> {<!-- -->{item.name}} <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span> color: white; font-weight: 400; background-color: rgb(168, 159, 159)<span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span> {<!-- -->{item.filmType.name}}   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>观众评分 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">color</span><span class="token punctuation">:</span> orange</span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span>{<!-- -->{item.grade}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span> 
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>主演: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{<!-- -->{item.actors}}<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>index<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span> {<!-- -->{item.name}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">font-size</span><span class="token punctuation">:</span> 35rpx<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">&gt;</span></span>{<!-- -->{item.nation}}| {<!-- -->{item.runtime}}分钟<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p>小程序wxjs</p> 
<pre><code class="prism language-javascript"><span class="token comment">// pages/now/now.js</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>

    <span class="token comment">/**
     * 页面的初始数据
     */</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">filmsList</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">/**
     * 生命周期函数--监听页面加载
     */</span>
    <span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
         <span class="token comment">// 发送请求之前 loading效果</span>
    wx<span class="token punctuation">.</span><span class="token function">showLoading</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'加载中~~'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">mask</span><span class="token operator">:</span><span class="token boolean">true</span>  <span class="token comment">// 显示透明蒙层，设置后，框后的按钮都不能点击了</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'http://127.0.0.1:8000/films/'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">method</span><span class="token operator">:</span><span class="token string">'GET'</span><span class="token punctuation">,</span>
        <span class="token comment">//如果是get请求，data就是请求参数，如果是post请求，data就是请求体数据</span>
        <span class="token literal-property property">data</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">header</span><span class="token operator">:</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
            <span class="token comment">//请求成功</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"请求成功，结果为："</span><span class="token punctuation">,</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
            <span class="token comment">//将请求结果更新到页面对象user中</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">filmsList</span><span class="token operator">:</span>res<span class="token punctuation">.</span>data
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">fail</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">complete</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{<!-- --></span>
          <span class="token comment">// 关闭加载，无论成功与否都会执行</span>
          wx<span class="token punctuation">.</span><span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
  
      <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">/**
     * 生命周期函数--监听页面初次渲染完成
     */</span>
    <span class="token function">onReady</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">/**
     * 生命周期函数--监听页面显示
     */</span>
    <span class="token function">onShow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">/**
     * 生命周期函数--监听页面隐藏
     */</span>
    <span class="token function">onHide</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">/**
     * 生命周期函数--监听页面卸载
     */</span>
    <span class="token function">onUnload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">/**
     * 页面相关事件处理函数--监听用户下拉动作
     */</span>
    <span class="token function">onPullDownRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">/**
     * 页面上拉触底事件的处理函数
     */</span>
    <span class="token function">onReachBottom</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">/**
     * 用户点击右上角分享
     */</span>
    <span class="token function">onShareAppMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> 
<p>小程序展示效果，大功告成，成功将数据展示到小程序上<br> <img src="https://images2.imgbox.com/21/d7/ac4LDtw2_o.png" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9453df5d4439d741a80500d322087f85/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【C语言】C语言零基础纯干货教学（下）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/74cb3a83987a34c2f3e79148e0a8b1c3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【postgresql初级使用】基于表达式或者函数的索引，字符串拼接可以使用索引了，带来不一样的优化效果</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程学习者.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
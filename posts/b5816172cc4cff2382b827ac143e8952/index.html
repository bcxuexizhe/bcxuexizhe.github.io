<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>在Ubuntu22.04上部署Stable Diffusion - 编程学习者</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcxuexizhe.github.io/posts/b5816172cc4cff2382b827ac143e8952/">
  <meta property="og:site_name" content="编程学习者">
  <meta property="og:title" content="在Ubuntu22.04上部署Stable Diffusion">
  <meta property="og:description" content="在AI绘画软件领域Stable-Diffusion（简称SD）在开源领域绝对是不二之选，他的插件方式可以让此软件具有更多的功能，开发者社群为此提供了大量免费高质量的外接预训练模型（fine-tune）和插件，并持续维护更新。在第三方插件和模型的加持下，SD拥有更加丰富的个性化功能，使用者可以生成更贴近需求的图片，甚至在 AI 视频特效、AI音乐生成等领域。
Stable-Diffusion学习有一定的难度，上手比较困难，但他在对绘画的精细控制方面非常灵活，对于专业AI绘画方面，他对画质的控制更高。接下来我用Ubuntu22.04和Nvidia P40搭建一套Stable-Diffusion服务器。
有关Ubuntu22.04和Nvidia P40的安装，请参照前面几章的介绍。这里就省劣了这些配置我们直接进入SD配置和部署。
一：准备安装环境
1、安装Anaconda，并创建虚拟环境。
conda create -n sd python=3.10 conda activate sd 2、安装pytorch
#先要进入虚拟环境 conda activate sd #安装pytorch pip3 install torch torchvision torchaudio 二：安装Stable Diffusion
1、克隆仓库
git clone https://github.com/AUTOMATIC1111/stable-diffusion-webui.git cd stable-diffusion-webui 2、安装相关依赖
#安装tb-nightly python -m pip install tb-nightly -i https://mirrors.aliyun.com/pypi/simple #安装相关依赖 pip install -r requirements_versions.txt pip install -r requirements.txt 3、修改web的绑定IP
vim webui.py #找到下面这几行 #app, local_url, share_url = shared.demo.launch( #share=cmd_opts.share, #server_name=initialize_util.gradio_server_name(), #修改为： #将shared.demo.launch()第一行改为 share=True， server_name=&#34;192.168.29.198&#34;,#注意IP上的双引号，IP灵活根据自己服务器的IP设置 4、下载模型并拷贝">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-01-04T23:11:09+08:00">
    <meta property="article:modified_time" content="2024-01-04T23:11:09+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程学习者" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程学习者</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">在Ubuntu22.04上部署Stable Diffusion</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p>在AI绘画软件领域Stable-Diffusion（简称SD）在开源领域绝对是不二之选，他的插件方式可以让此软件具有更多的功能，开发者社群为此提供了大量免费高质量的外接预训练模型（fine-tune）和插件，并持续维护更新。在第三方插件和模型的加持下，SD拥有更加丰富的个性化功能，使用者可以生成更贴近需求的图片，甚至在 AI 视频特效、AI音乐生成等领域。</p> 
<p>Stable-Diffusion学习有一定的难度，上手比较困难，但他在对绘画的精细控制方面非常灵活，对于专业AI绘画方面，他对画质的控制更高。接下来我用Ubuntu22.04和Nvidia P40搭建一套Stable-Diffusion服务器。</p> 
<p>有关Ubuntu22.04和Nvidia P40的安装，请参照前面几章的介绍。这里就省劣了这些配置我们直接进入SD配置和部署。</p> 
<p><strong>一：准备安装环境</strong></p> 
<p>1、安装Anaconda，并创建虚拟环境。</p> 
<pre><code class="language-bash">conda create -n sd python=3.10
conda activate sd</code></pre> 
<p>2、安装pytorch</p> 
<pre><code class="language-bash">#先要进入虚拟环境
conda activate sd
#安装pytorch
pip3 install torch torchvision torchaudio</code></pre> 
<p><strong>二：安装Stable Diffusion</strong></p> 
<p>1、克隆仓库</p> 
<pre><code class="language-bash">git clone https://github.com/AUTOMATIC1111/stable-diffusion-webui.git
cd stable-diffusion-webui</code></pre> 
<p>2、安装相关依赖</p> 
<pre><code class="language-bash">#安装tb-nightly
python -m pip install tb-nightly -i https://mirrors.aliyun.com/pypi/simple

#安装相关依赖
pip install -r requirements_versions.txt
pip install -r requirements.txt 
</code></pre> 
<p>3、修改web的绑定IP</p> 
<pre><code class="language-python">vim webui.py

#找到下面这几行
#app, local_url, share_url = shared.demo.launch(
#share=cmd_opts.share,
#server_name=initialize_util.gradio_server_name(),
#修改为：

#将shared.demo.launch()第一行改为
share=True，
server_name="192.168.29.198",#注意IP上的双引号，IP灵活根据自己服务器的IP设置</code></pre> 
<p>4、下载模型并拷贝</p> 
<p>模型考贝地址：</p> 
<p>/stable-diffusion-webui/models/Stable-diffusion<br> /stable-diffusion-webui/openai</p> 
<p>当然不考贝运行时也会自动下载，但时间太久，所以可以先下载，然后直接考过去。这样节省时间。</p> 
<p>可以访问国内镜像地址下载相关模型：</p> 
<p><a href="https://aifasthub.com/models" rel="nofollow" title="https://aifasthub.com/models">https://aifasthub.com/models</a></p> 
<p>5、为运行目录及模型付执行权限</p> 
<pre><code class="language-python">chmod +x stable-diffusion-webui/
chmod +x models/*
chmod +x openai/*</code></pre> 
<p>6、运行</p> 
<pre><code class="language-python">python launch.py
#或
python webui.py
#两种访求均可</code></pre> 
<p>7、打开浏览器</p> 
<p>http://192.168.29.198:7860</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/37/27/XqPp03LX_o.png" width="1200"></p> 
<p>注意IP要根据你服务器配置的具体IP地址，本例中的IP为演示服务器地址。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/87af2e709b497a8cab7327f36fabf231/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Java国密加密SM2代码</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/802371013c0cd8ee33f2a72150e5be52/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">通过NextChat(ChatGPT-Next-Web)低成本给自己或客户部署GPT程序</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程学习者.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
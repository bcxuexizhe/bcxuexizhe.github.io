<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Flink WordCount实践 - 编程学习者</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcxuexizhe.github.io/posts/ef60a44eef4a5f66b1f87e63d32e4150/">
  <meta property="og:site_name" content="编程学习者">
  <meta property="og:title" content="Flink WordCount实践">
  <meta property="og:description" content="目录
前提条件
基本准备
批处理API实现WordCount
流处理API实现WordCount
数据源是文件
数据源是socket文本流
打包
提交到集群运行
命令行提交作业
Web UI提交作业
上传代码到gitee
前提条件 Windows安装好jdk8、Maven3、IDEA
Linux安装好Flink集群，可参考：CentOS7安装flink1.17完全分布式
基本准备 创建项目 使用IDEA创建一个新的Maven项目，项目名称，例如：flinkdemo
添加依赖 在项目的pom.xml文件中添加Flink的依赖。
&lt;properties&gt; &lt;flink.version&gt;1.17.1&lt;/flink.version&gt; &lt;/properties&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.flink&lt;/groupId&gt; &lt;artifactId&gt;flink-streaming-java&lt;/artifactId&gt; &lt;version&gt;${flink.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.flink&lt;/groupId&gt; &lt;artifactId&gt;flink-clients&lt;/artifactId&gt; &lt;version&gt;${flink.version}&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; 刷新依赖
刷新依赖后，能看到相关依赖如下
刷新依赖过程需要等待一些时间来下载相关依赖。
如果依赖下载慢，可以设置阿里云仓库镜像：
1.设置maven的settings.xml
在&lt;/mirrors&gt;上面一行添加阿里云仓库镜像
&lt;mirror&gt; &lt;id&gt;alimaven&lt;/id&gt; &lt;name&gt;aliyun maven&lt;/name&gt; &lt;url&gt;http://maven.aliyun.com/nexus/content/groups/public/&lt;/url&gt; &lt;mirrorOf&gt;central&lt;/mirrorOf&gt; &lt;/mirror&gt; 2.IDEA设置maven
数据准备 在工程的根目录下，新建一个data文件夹
并在data文件夹下创建文本文件words.txt
内容如下
hello world hello java hello flink 新建包 右键src/main下的java，新建Package
填写包名org.example，包名与groupId的内容一致。
批处理API实现WordCount 在org.exmaple下新建wc包及BatchWordCount类
填写wc.BatchWordCount
效果如下
BatchWordCount.java代码如下：
package org.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-09T16:32:39+08:00">
    <meta property="article:modified_time" content="2024-04-09T16:32:39+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程学习者" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程学习者</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Flink WordCount实践</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"><strong>目录</strong></p> 
<p id="%E5%89%8D%E6%8F%90%E6%9D%A1%E4%BB%B6-toc" style="margin-left:40px;"><a href="#%E5%89%8D%E6%8F%90%E6%9D%A1%E4%BB%B6" rel="nofollow">前提条件</a></p> 
<p id="%E5%9F%BA%E6%9C%AC%E5%87%86%E5%A4%87-toc" style="margin-left:40px;"><a href="#%E5%9F%BA%E6%9C%AC%E5%87%86%E5%A4%87" rel="nofollow">基本准备</a></p> 
<p id="%E6%89%B9%E5%A4%84%E7%90%86API%E5%AE%9E%E7%8E%B0WordCount-toc" style="margin-left:40px;"><a href="#%E6%89%B9%E5%A4%84%E7%90%86API%E5%AE%9E%E7%8E%B0WordCount" rel="nofollow">批处理API实现WordCount</a></p> 
<p id="%E6%B5%81%E5%A4%84%E7%90%86API%E5%AE%9E%E7%8E%B0WordCount-toc" style="margin-left:40px;"><a href="#%E6%B5%81%E5%A4%84%E7%90%86API%E5%AE%9E%E7%8E%B0WordCount" rel="nofollow">流处理API实现WordCount</a></p> 
<p id="%E6%95%B0%E6%8D%AE%E6%BA%90%E6%98%AF%E6%96%87%E4%BB%B6-toc" style="margin-left:80px;"><a href="#%E6%95%B0%E6%8D%AE%E6%BA%90%E6%98%AF%E6%96%87%E4%BB%B6" rel="nofollow">数据源是文件</a></p> 
<p id="%E6%95%B0%E6%8D%AE%E6%BA%90%E6%98%AFsocket%E6%96%87%E6%9C%AC%E6%B5%81-toc" style="margin-left:80px;"><a href="#%E6%95%B0%E6%8D%AE%E6%BA%90%E6%98%AFsocket%E6%96%87%E6%9C%AC%E6%B5%81" rel="nofollow">数据源是socket文本流</a></p> 
<p id="%E6%89%93%E5%8C%85-toc" style="margin-left:40px;"><a href="#%E6%89%93%E5%8C%85" rel="nofollow">打包</a></p> 
<p id="%E6%8F%90%E4%BA%A4%E5%88%B0%E9%9B%86%E7%BE%A4%E8%BF%90%E8%A1%8C-toc" style="margin-left:40px;"><a href="#%E6%8F%90%E4%BA%A4%E5%88%B0%E9%9B%86%E7%BE%A4%E8%BF%90%E8%A1%8C" rel="nofollow">提交到集群运行</a></p> 
<p id="%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%8F%90%E4%BA%A4%E4%BD%9C%E4%B8%9A-toc" style="margin-left:80px;"><a href="#%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%8F%90%E4%BA%A4%E4%BD%9C%E4%B8%9A" rel="nofollow">命令行提交作业</a></p> 
<p id="Web%20UI%E6%8F%90%E4%BA%A4%E4%BD%9C%E4%B8%9A-toc" style="margin-left:80px;"><a href="#Web%20UI%E6%8F%90%E4%BA%A4%E4%BD%9C%E4%B8%9A" rel="nofollow">Web UI提交作业</a></p> 
<p id="%E9%A1%B9%E7%9B%AE%E4%BB%A3%E7%A0%81%E4%B8%8A%E4%BC%A0%E5%88%B0gitee-toc" style="margin-left:40px;"><a href="#%E9%A1%B9%E7%9B%AE%E4%BB%A3%E7%A0%81%E4%B8%8A%E4%BC%A0%E5%88%B0gitee" rel="nofollow">上传代码到gitee</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h3 id="%E5%89%8D%E6%8F%90%E6%9D%A1%E4%BB%B6">前提条件</h3> 
<p>Windows安装好jdk8、Maven3、IDEA</p> 
<p>Linux安装好Flink集群，可参考：<a class="link-info" href="https://blog.csdn.net/qq_42881421/article/details/137293343?spm=1001.2014.3001.5501" title="CentOS7安装flink1.17完全分布式">CentOS7安装flink1.17完全分布式</a><br>  </p> 
<h3 id="%E5%9F%BA%E6%9C%AC%E5%87%86%E5%A4%87">基本准备</h3> 
<h4 id="%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE">创建项目</h4> 
<p>使用IDEA创建一个新的Maven项目，项目名称，例如：flinkdemo</p> 
<p><img alt="" height="81" src="https://images2.imgbox.com/d7/f4/9r4s8iSg_o.png" width="531"></p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/e9/3d/ZnR0KrUl_o.png" width="1200"></p> 
<p></p> 
<h4 id="%E6%B7%BB%E5%8A%A0%E4%BE%9D%E8%B5%96">添加依赖</h4> 
<p>在项目的pom.xml文件中添加Flink的依赖。</p> 
<pre><code class="language-XML">	&lt;properties&gt;
        &lt;flink.version&gt;1.17.1&lt;/flink.version&gt;
    &lt;/properties&gt;

    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.flink&lt;/groupId&gt;
            &lt;artifactId&gt;flink-streaming-java&lt;/artifactId&gt;
            &lt;version&gt;${flink.version}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.flink&lt;/groupId&gt;
            &lt;artifactId&gt;flink-clients&lt;/artifactId&gt;
            &lt;version&gt;${flink.version}&lt;/version&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;</code></pre> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/b3/15/uSXHWg6S_o.png" width="1200"></p> 
<p></p> 
<p>刷新依赖</p> 
<p><img alt="" height="947" src="https://images2.imgbox.com/d8/38/BfWXFp5x_o.png" width="1200"></p> 
<p>刷新依赖后，能看到相关依赖如下</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/42/63/SIO6YJNy_o.png" width="1200"></p> 
<p>刷新依赖过程需要等待一些时间来下载相关依赖。</p> 
<p>如果依赖下载慢，可以设置阿里云仓库镜像：</p> 
<p> 1.设置maven的<code>settings.xml</code></p> 
<p><img alt="" height="332" src="https://images2.imgbox.com/b4/be/plkOd49M_o.png" width="1200"></p> 
<p></p> 
<p>在<code>&lt;/mirrors&gt;</code>上面一行添加阿里云仓库镜像</p> 
<pre><code class="language-XML">	&lt;mirror&gt;
      &lt;id&gt;alimaven&lt;/id&gt;
      &lt;name&gt;aliyun maven&lt;/name&gt;
      &lt;url&gt;http://maven.aliyun.com/nexus/content/groups/public/&lt;/url&gt;
      &lt;mirrorOf&gt;central&lt;/mirrorOf&gt;        
    &lt;/mirror&gt;</code></pre> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/53/26/hOQOdj4x_o.png" width="1200"></p> 
<p></p> 
<p>2.IDEA设置maven</p> 
<p><img alt="" height="718" src="https://images2.imgbox.com/eb/81/VMA50XXh_o.png" width="1200"></p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/cf/b2/PFZVTmv9_o.png" width="1200"></p> 
<p></p> 
<h4 id="%E6%95%B0%E6%8D%AE%E5%87%86%E5%A4%87">数据准备</h4> 
<p>在工程的根目录下，新建一个data文件夹</p> 
<p><img alt="" height="816" src="https://images2.imgbox.com/31/ff/uvciQA7d_o.png" width="1200"></p> 
<p>并在data文件夹下创建文本文件words.txt</p> 
<p><img alt="" height="826" src="https://images2.imgbox.com/60/f6/JjmAM813_o.png" width="1200"></p> 
<p>内容如下</p> 
<pre>hello world
hello java
hello flink</pre> 
<p><img alt="" height="1035" src="https://images2.imgbox.com/f8/b2/HZq8ZJ9Y_o.png" width="1200"></p> 
<p></p> 
<h4 id="%E6%96%B0%E5%BB%BA%E5%8C%85">新建包</h4> 
<p>右键src/main下的java，新建Package</p> 
<p><img alt="" height="991" src="https://images2.imgbox.com/51/9a/Hys2qyGX_o.png" width="1200"></p> 
<p></p> 
<p>填写包名<code>org.example</code>，包名与<code>groupId</code>的内容一致。</p> 
<p><img alt="" height="1170" src="https://images2.imgbox.com/eb/88/HDX4jHt8_o.png" width="1200"></p> 
<p></p> 
<p></p> 
<h3 id="%E6%89%B9%E5%A4%84%E7%90%86API%E5%AE%9E%E7%8E%B0WordCount">批处理API实现WordCount</h3> 
<p>在<code>org.exmaple</code>下新建<code>wc</code>包及<code>BatchWordCount</code>类</p> 
<p><img alt="" height="928" src="https://images2.imgbox.com/09/77/pUxxQUYJ_o.png" width="1200"></p> 
<p>填写<code>wc.BatchWordCount</code></p> 
<p><img alt="" height="1127" src="https://images2.imgbox.com/e9/f7/lPuuiu4z_o.png" width="1200"></p> 
<p>效果如下</p> 
<p><img alt="" height="1119" src="https://images2.imgbox.com/3e/71/JffhNIbG_o.png" width="1200"></p> 
<p><code>BatchWordCount.java</code>代码如下：</p> 
<pre><code class="language-java">package org.example.wc;

import org.apache.flink.api.common.functions.FlatMapFunction;
import org.apache.flink.api.java.ExecutionEnvironment;
import org.apache.flink.api.java.operators.AggregateOperator;
import org.apache.flink.api.java.operators.DataSource;
import org.apache.flink.api.java.operators.FlatMapOperator;
import org.apache.flink.api.java.operators.UnsortedGrouping;
import org.apache.flink.api.java.tuple.Tuple2;
import org.apache.flink.util.Collector;

public class BatchWordCount {
    public static void main(String[] args) throws Exception {
        // 1. 创建执行环境
        ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();

        // 2. 从文件读取数据 按行读取
        DataSource&lt;String&gt; lineDS = env.readTextFile("data/words.txt");

        // 3. 转换数据格式
        FlatMapOperator&lt;String, Tuple2&lt;String, Long&gt;&gt; wordAndOne = lineDS.flatMap(new FlatMapFunction&lt;String, Tuple2&lt;String, Long&gt;&gt;() {

            @Override
            public void flatMap(String line, Collector&lt;Tuple2&lt;String, Long&gt;&gt; out) throws Exception {

                String[] words = line.split(" ");

                for (String word : words) {
                    out.collect(Tuple2.of(word,1L));
                }
            }
        });

        // 4. 按照 word 进行分组
        UnsortedGrouping&lt;Tuple2&lt;String, Long&gt;&gt; wordAndOneUG = wordAndOne.groupBy(0);

        // 5. 分组内聚合统计
        AggregateOperator&lt;Tuple2&lt;String, Long&gt;&gt; sum = wordAndOneUG.sum(1);

        // 6. 打印结果
        sum.print();
    }
}
</code></pre> 
<p>运行程序，查看结果</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/48/09/tWqcyOPA_o.png" width="1200"></p> 
<p>注意，以上代码的实现方式是基于DataSet API的，是批处理API。而Flink本身是流批统一的处理架构，批量的数据集本质上也是流，没有必要用两套不同的API来实现。从Flink 1.12开始，官方推荐直接使用DataStream API，在提交任务时通过将执行模式设为BATCH来进行批处理：</p> 
<pre>$ flink run -Dexecution.runtime-mode=BATCH BatchWordCount.jar</pre> 
<h6></h6> 
<p></p> 
<h3 id="%E6%B5%81%E5%A4%84%E7%90%86API%E5%AE%9E%E7%8E%B0WordCount">流处理API实现WordCount</h3> 
<h4 id="%E6%95%B0%E6%8D%AE%E6%BA%90%E6%98%AF%E6%96%87%E4%BB%B6">数据源是文件</h4> 
<p>在<code>org.example.wc</code>包下新建Java类StreamWordCount，代码如下：</p> 
<pre><code class="language-java">package org.example.wc;

import org.apache.flink.api.common.functions.FlatMapFunction;
import org.apache.flink.api.java.tuple.Tuple2;
import org.apache.flink.streaming.api.datastream.DataStreamSource;
import org.apache.flink.streaming.api.datastream.SingleOutputStreamOperator;
import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;
import org.apache.flink.util.Collector;

public class StreamWordCount {
    public static void main(String[] args) throws Exception {
        // 1. 创建流式执行环境
        StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();

        // 2. 读取文件
        DataStreamSource&lt;String&gt; lineStream = env.readTextFile("input/words.txt");

        // 3. 转换、分组、求和，得到统计结果
        SingleOutputStreamOperator&lt;Tuple2&lt;String, Long&gt;&gt; sum = lineStream.flatMap(new FlatMapFunction&lt;String, Tuple2&lt;String, Long&gt;&gt;() {
                    @Override
                    public void flatMap(String line, Collector&lt;Tuple2&lt;String, Long&gt;&gt; out) throws Exception {

                        String[] words = line.split(" ");

                        for (String word : words) {
                            out.collect(Tuple2.of(word, 1L));
                        }
                    }
                }).keyBy(data -&gt; data.f0)
                .sum(1);

        // 4. 打印
        sum.print();

        // 5. 执行
        env.execute();
    }
}
</code></pre> 
<p>运行结果</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/01/f4/b9NE1m6B_o.png" width="1200"></p> 
<p></p> 
<p>与批处理程序BatchWordCount的区别：</p> 
<ul><li> <p>创建执行环境的不同，流处理程序使用的是StreamExecutionEnvironment。</p> </li><li> <p>转换处理之后，得到的数据对象类型不同。</p> </li><li> <p>分组操作调用的是keyBy方法，可以传入一个匿名函数作为键选择器（KeySelector），指定当前分组的key是什么。</p> </li><li> <p>代码末尾需要调用env的execute方法，开始执行任务。</p> </li></ul> 
<p></p> 
<h4 id="%E6%95%B0%E6%8D%AE%E6%BA%90%E6%98%AFsocket%E6%96%87%E6%9C%AC%E6%B5%81">数据源是socket文本流</h4> 
<p>流处理的输入数据通常是流数据，将StreamWordCount代码中读取文件数据的readTextFile方法，替换成读取socket文本流的方法socketTextStream。</p> 
<p>在<code>org.example.wc</code>包下新建Java类SocketStreamWordCount，代码如下：</p> 
<pre><code class="language-java">package org.example.wc;

import org.apache.flink.api.common.typeinfo.Types;
import org.apache.flink.api.java.tuple.Tuple2;
import org.apache.flink.streaming.api.datastream.DataStreamSource;
import org.apache.flink.streaming.api.datastream.SingleOutputStreamOperator;
import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;
import org.apache.flink.util.Collector;

public class SocketStreamWordCount {
    public static void main(String[] args) throws Exception {
        // 1. 创建流式执行环境
        StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();

        // 2. 读取文本流：node2表示发送端主机名（根据实际情况修改）、7777表示端口号
        DataStreamSource&lt;String&gt; lineStream = env.socketTextStream("node2", 7777);

        // 3. 转换、分组、求和，得到统计结果
        SingleOutputStreamOperator&lt;Tuple2&lt;String, Long&gt;&gt; sum = lineStream.flatMap((String line, Collector&lt;Tuple2&lt;String, Long&gt;&gt; out) -&gt; {
                    String[] words = line.split(" ");

                    for (String word : words) {
                        out.collect(Tuple2.of(word, 1L));
                    }
                }).returns(Types.TUPLE(Types.STRING, Types.LONG))
                .keyBy(data -&gt; data.f0)
                .sum(1);

        // 4. 打印
        sum.print();

        // 5. 执行
        env.execute();
    }
}</code></pre> 
<p></p> 
<p>进入node2终端，如果没有nc命令，需要先安装nc命令，安装nc命令如下：</p> 
<pre>[hadoop@node2 ~]$ sudo yum install nc -y</pre> 
<p></p> 
<p>开启nc监听</p> 
<pre>[hadoop@node2 ~]$ nc -lk 7777</pre> 
<p></p> 
<p>IDEA中，运行SocketStreamWordCount程序。</p> 
<p></p> 
<p></p> 
<p>往7777端口发送数据，例如发送<code>hello world</code></p> 
<p><img alt="" height="209" src="https://images2.imgbox.com/e4/12/HX5gYyWr_o.png" width="1200"></p> 
<p></p> 
<p>控制台输出</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/26/6d/39550O6F_o.png" width="1200"></p> 
<p></p> 
<p>继续往7777端口发送数据，例如发送<code>hello flink</code></p> 
<p><img alt="" height="277" src="https://images2.imgbox.com/13/d7/LB7GmHF0_o.png" width="1200"></p> 
<p></p> 
<p>控制台输出</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/46/7f/7KqmD2R3_o.png" width="1200"></p> 
<p></p> 
<p>停止SocketStreamWordCount程序。</p> 
<p></p> 
<p>按Ctrl+c停止nc命令。</p> 
<p></p> 
<h3 id="%E6%89%93%E5%8C%85">打包</h3> 
<p>这里的打包是将写好的程序打成jar包。</p> 
<p>点击IDEA右侧的Maven，按住Ctrl键同时选中clean和package（第一次打包可以只选中package），点击执行打包。</p> 
<p><img alt="" height="1163" src="https://images2.imgbox.com/f0/99/lrWMYJJr_o.png" width="1200"></p> 
<p></p> 
<p>打包成功后，看到如下输出信息，生成的jar包在项目的target目录下</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/b5/2e/CtRRJVzT_o.png" width="1200"></p> 
<p></p> 
<h3 id="%E6%8F%90%E4%BA%A4%E5%88%B0%E9%9B%86%E7%BE%A4%E8%BF%90%E8%A1%8C">提交到集群运行</h3> 
<p>把jar包提交到flink集群运行有两种方式：</p> 
<p>1.通过命令行提交作业   </p> 
<p>2.通过Web UI提交作业</p> 
<p></p> 
<h4 id="%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%8F%90%E4%BA%A4%E4%BD%9C%E4%B8%9A">命令行提交作业</h4> 
<h5 id="%E5%B0%86jar%E5%8C%85%E4%B8%8A%E4%BC%A0Linux">将jar包上传Linux</h5> 
<p><img alt="" height="672" src="https://images2.imgbox.com/72/c7/eqETtJdt_o.png" width="1200"></p> 
<h5 id="%E5%90%AF%E5%8A%A8flink%E9%9B%86%E7%BE%A4">启动flink集群</h5> 
<pre>[hadoop@node2 ~]$ start-cluster.sh 
Starting cluster.
Starting standalonesession daemon on host node2.
Starting taskexecutor daemon on host node2.
Starting taskexecutor daemon on host node3.
Starting taskexecutor daemon on host node4.
​
</pre> 
<h5 id="%E5%BC%80%E5%90%AFnc%E7%9B%91%E5%90%AC">开启nc监听</h5> 
<pre>[hadoop@node2 ~]$ nc -lk 7777
​
</pre> 
<h5 id="%E5%91%BD%E4%BB%A4%E6%8F%90%E4%BA%A4%E4%BD%9C%E4%B8%9A">命令提交作业</h5> 
<p>开启另一个node2终端，使用<code>flink run</code>命令提交作业到flink集群</p> 
<pre>[hadoop@node2 ~]$ flink run -m node2:8081 -c org.example.wc.SocketStreamWordCount flinkdemo-1.0-SNAPSHOT.jar</pre> 
<p><img alt="" height="310" src="https://images2.imgbox.com/68/84/2RHwqLzY_o.png" width="1200"></p> 
<p>-m指定提交到的JobManager，-c指定程序入口类。</p> 
<p></p> 
<h5 id="%E5%8F%91%E9%80%81%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE">发送测试数据</h5> 
<p>在nc监听终端，往7777端口发送数据</p> 
<p><img alt="" height="216" src="https://images2.imgbox.com/72/e5/JlH999xm_o.png" width="1200"></p> 
<h5 id="%E6%9F%A5%E7%9C%8B%E7%BB%93%E6%9E%9C">查看结果</h5> 
<h6 id="Web%20UI%E6%9F%A5%E7%9C%8B%E7%BB%93%E6%9E%9C">Web UI查看结果</h6> 
<p>浏览器访问</p> 
<pre>node2:8081</pre> 
<p>看到正在运行的作业如下</p> 
<p><img alt="" height="1082" src="https://images2.imgbox.com/fb/5b/zeYADdZJ_o.png" width="1200"></p> 
<p></p> 
<p>查看结果</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/03/0f/iUBPP7YT_o.png" width="1200"></p> 
<p><img alt="" height="1142" src="https://images2.imgbox.com/18/7c/Fk5gb1hc_o.png" width="1200"></p> 
<p></p> 
<h6 id="%E7%BB%A7%E7%BB%AD%E5%8F%91%E9%80%81%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE">继续发送测试数据</h6> 
<p>在nc终端继续发送数据</p> 
<p><img alt="" height="264" src="https://images2.imgbox.com/3f/df/nlOgiMUt_o.png" width="1200"></p> 
<p></p> 
<h6 id="Web%20UI%E5%88%B7%E6%96%B0%E7%BB%93%E6%9E%9C">Web UI刷新结果</h6> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/22/de/6zZ9kh4S_o.png" width="1200"></p> 
<p></p> 
<h6 id="%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%9F%A5%E7%9C%8B%E7%BB%93%E6%9E%9C">命令行查看结果</h6> 
<p>打开新的node2终端，查看结果</p> 
<pre>[hadoop@node2 ~]$ cd $FLINK_HOME/log
[hadoop@node2 log]$ ls
flink-hadoop-client-node2.log                 flink-hadoop-standalonesession-0-node2.out
flink-hadoop-standalonesession-0-node2.log    flink-hadoop-taskexecutor-0-node2.log
flink-hadoop-standalonesession-0-node2.log.1  flink-hadoop-taskexecutor-0-node2.log.1
flink-hadoop-standalonesession-0-node2.log.2  flink-hadoop-taskexecutor-0-node2.log.2
flink-hadoop-standalonesession-0-node2.log.3  flink-hadoop-taskexecutor-0-node2.log.3
flink-hadoop-standalonesession-0-node2.log.4  flink-hadoop-taskexecutor-0-node2.log.4
flink-hadoop-standalonesession-0-node2.log.5  flink-hadoop-taskexecutor-0-node2.out
[hadoop@node2 log]$ cat flink-hadoop-taskexecutor-0-node2.out 
(hello,1)
(flink,1)
(hello,2)
(world,1)
​</pre> 
<p><img alt="" height="804" src="https://images2.imgbox.com/b3/cf/zcZOeKza_o.png" width="1200"></p> 
<p></p> 
<h5 id="%E5%8F%96%E6%B6%88flink%E4%BD%9C%E4%B8%9A">取消flink作业</h5> 
<p><img alt="" height="978" src="https://images2.imgbox.com/01/ce/upln2USx_o.png" width="1200"></p> 
<p></p> 
<p>点击Cancel Job取消作业 </p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/04/fe/igpCePql_o.png" width="1200"></p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/1d/74/NPBkL6B2_o.png" width="1200"></p> 
<p></p> 
<h5 id="%E5%81%9C%E6%AD%A2nc%E7%9B%91%E5%90%AC">停止nc监听</h5> 
<p>按Ctrl+c停止nc命令</p> 
<p></p> 
<h4 id="Web%20UI%E6%8F%90%E4%BA%A4%E4%BD%9C%E4%B8%9A">Web UI提交作业</h4> 
<p></p> 
<h5>开启nc监听</h5> 
<p>开启nc监听发送数据</p> 
<pre>[hadoop@node2 ~]$ nc -lk 7777</pre> 
<p></p> 
<h5>Web UI提交作业</h5> 
<p>浏览器访问</p> 
<pre>node2:8081</pre> 
<p></p> 
<p>点击Submit New Job</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/8b/42/nTQhC3Y2_o.png" width="1200"></p> 
<p>点击Add New</p> 
<p><img alt="" height="1099" src="https://images2.imgbox.com/88/fb/x3gjS68G_o.png" width="1200"></p> 
<p>选择flink作业jar包所在路径</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/da/b7/xAXnn9BY_o.png" width="1200"></p> 
<p></p> 
<p>点击jar包名称</p> 
<p><img alt="" height="1159" src="https://images2.imgbox.com/c8/18/m5HnCAvw_o.png" width="1200"></p> 
<p></p> 
<p>填写相关内容，点击Submit提交作业</p> 
<p>Entry Class填写运行的主类，例如：org.example.wc.SocketStreamWordCount</p> 
<p>Parallesim填写作业的并行度，例如：1</p> 
<p><img alt="" height="1133" src="https://images2.imgbox.com/fd/23/A4RnAZ7w_o.png" width="1200"></p> 
<p></p> 
<p>提交后，在Running Jobs里看到运行的作业</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/8a/c4/wlTuRo5V_o.png" width="1200"></p> 
<p></p> 
<h5>发送测试数据</h5> 
<p>往7777端口发送数据</p> 
<p><img alt="" height="213" src="https://images2.imgbox.com/01/20/4Vv2YH5k_o.png" width="1200"></p> 
<p></p> 
<h5>查看结果</h5> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/10/53/THVcodpV_o.png" width="1200"></p> 
<p></p> 
<h5>继续发送测试数据</h5> 
<p><img alt="" height="269" src="https://images2.imgbox.com/bf/bd/QNyGoX7h_o.png" width="1200"></p> 
<p></p> 
<h5 id="%E5%88%B7%E6%96%B0%E7%BB%93%E6%9E%9C">刷新结果</h5> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/27/2a/erMe7yBX_o.png" width="1200"></p> 
<p></p> 
<h5 id="%E5%8F%96%E6%B6%88%E4%BD%9C%E4%B8%9A">取消作业</h5> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/86/09/JsIzC2DS_o.png" width="1200"></p> 
<p></p> 
<h5>停止nc监听</h5> 
<p>按住Ctrl+c停止nc命令</p> 
<p></p> 
<h5 id="%E5%85%B3%E9%97%ADflink%E9%9B%86%E7%BE%A4">关闭flink集群</h5> 
<pre>[hadoop@node2 ~]$ stop-cluster.sh 
Stopping taskexecutor daemon (pid: 2283) on host node2.
Stopping taskexecutor daemon (pid: 1827) on host node3.
Stopping taskexecutor daemon (pid: 1829) on host node4.
Stopping standalonesession daemon (pid: 1929) on host node2.</pre> 
<p></p> 
<p></p> 
<h3 id="%E9%A1%B9%E7%9B%AE%E4%BB%A3%E7%A0%81%E4%B8%8A%E4%BC%A0%E5%88%B0gitee" style="background-color:transparent;">上传代码到gitee</h3> 
<p></p> 
<h4 id="%E7%99%BB%E5%BD%95gitee">登录gitee</h4> 
<pre>https://gitee.com/</pre> 
<p>注意：如果还没有gitee账号，需要先注册；如果之前没有设置过SSH公钥，需要先设置SSH公钥。</p> 
<p></p> 
<h4 id="%E5%88%9B%E5%BB%BA%E4%BB%93%E5%BA%93" style="background-color:transparent;">创建仓库</h4> 
<h6 id="%E2%80%8B%E7%BC%96%E8%BE%91"><img alt="" height="317" src="https://images2.imgbox.com/d7/9a/wOggRaFP_o.png" width="1200"></h6> 
<p></p> 
<p></p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/6c/db/InMrCSNC_o.png" width="1200"></p> 
<p></p> 
<p></p> 
<p><img alt="" height="878" src="https://images2.imgbox.com/ed/72/7D1is2pZ_o.png" width="1200"></p> 
<p></p> 
<h4 id="%E6%8F%90%E4%BA%A4%E4%BB%A3%E7%A0%81" style="background-color:transparent;">提交代码</h4> 
<p>使用IDEA提交代码</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/4a/9c/oVAosEMi_o.png" width="1200"></p> 
<p></p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/a8/b4/1k4qYXvn_o.png" width="1200"></p> 
<p></p> 
<p>提示有警告，忽略警告，继续提交</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/01/e0/GXfCj1ve_o.png" width="1200"></p> 
<p></p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/bf/b2/DBxBxL8r_o.png" width="1200"></p> 
<p></p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/9a/d5/dmQbmmzG_o.png" width="1200"></p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/db/33/fMOsGjPe_o.png" width="1200"></p> 
<p></p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/0b/12/ynv526yW_o.png" width="1200"></p> 
<p></p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/f5/95/h4lovdIK_o.png" width="1200"></p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/a2/bd/XV3zV0Wg_o.png" width="1200"></p> 
<p></p> 
<p>提交成功后，IDEA显示如下</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/85/ae/jwHaLWXF_o.png" width="1200"></p> 
<p></p> 
<p>刷新浏览器查看gitee界面，看到代码已上传成功</p> 
<p><img alt="" height="1080" src="https://images2.imgbox.com/90/ab/ZObfnG9y_o.png" width="1200"></p> 
<p></p> 
<p></p> 
<p></p> 
<p>完成！enjoy it!</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/91fcaaf75f3d2ec89fb585df6a097588/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">强到离谱！Stable Diffusion让商业换装如此简单！AI一键换装，AI绘画教程</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5477f6a588838ad8d9a3916963535906/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">苍穹外卖11（Apache ECharts前端统计，营业额统计，用户统计，订单统计，销量排名Top10）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程学习者.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
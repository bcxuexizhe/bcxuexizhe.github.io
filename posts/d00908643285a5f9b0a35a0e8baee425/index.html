<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>一文带你深入浅出Web的自动化测试工具Selenium 4.xx【建议收藏】 - 编程学习者</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcxuexizhe.github.io/posts/d00908643285a5f9b0a35a0e8baee425/">
  <meta property="og:site_name" content="编程学习者">
  <meta property="og:title" content="一文带你深入浅出Web的自动化测试工具Selenium 4.xx【建议收藏】">
  <meta property="og:description" content="文章目录 前言发现宝藏第01节 Selenium概述第02节 安装浏览器驱动（以Google为例）第03节 定位页面元素1. 打开指定页面2. id 定位3. name 定位4. class 定位5. tag 定位6. xpath 定位7. css 选择器8. link 定位9. 示例 有道翻译 第04节 浏览器控制1. 修改浏览器窗口大小2. 浏览器前进&amp;后退3. 浏览器刷新4. 浏览器窗口切换5. 常见操作6. 示例 CSDN页面元素交互 第05节 鼠标控制1.单击元素2.双击元素3.在元素上右键单击4.在元素上悬停（鼠标悬停）5.拖拽元素到另一个位置 第06节 键盘控制1.输入文本2.按键3.组合键4. 其他键盘操作 第07节 元素等待1. 隐式等待2. 显示等待3. 自定义等待4. 强制等待 第08节 切换操作1. 窗口切换2. 表单切换 第09节 滚轮操作总结 前言 为了巩固所学的知识，作者尝试着开始发布一些学习笔记类的博客，方便日后回顾。当然，如果能帮到一些萌新进行新技术的学习那也是极好的。作者菜菜一枚，文章中如果有记录错误，欢迎读者朋友们批评指正。
（博客的参考源码可以在我主页的资源里找到，如果在学习的过程中有什么疑问欢迎大家在评论区向我提出）
发现宝藏 前些天发现了一个巨牛的人工智能学习网站，通俗易懂，风趣幽默，忍不住分享一下给大家。【宝藏入口】。
第01节 Selenium概述 Selenium 是一个Web的自动化测试工具，最初是为网站自动化测试而开发的，Selenium 可以直接运行
在浏览器上，它支持所有主流的浏览器
因为 Selenium 可以控制浏览器发送请求，并获取网页数据，因此可以应用于爬虫领域
Selenium 可以根据我们的指令，让浏览器自动加载页面，获取需要的数据，甚至页面截屏，或者判断网
站上某些动作是否发生
Selenium 自己不带浏览器，不支持浏览器的功能，它需要与第三方浏览器结合在一起才能使用
Selenium 库的版本不同对应的方法名也会有所不同">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-09T20:50:48+08:00">
    <meta property="article:modified_time" content="2024-03-09T20:50:48+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程学习者" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程学习者</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">一文带你深入浅出Web的自动化测试工具Selenium 4.xx【建议收藏】</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_1" rel="nofollow">前言</a></li><li><a href="#_7" rel="nofollow">发现宝藏</a></li><li><a href="#01_Selenium_11" rel="nofollow">第01节 Selenium概述</a></li><li><a href="#02_Google_28" rel="nofollow">第02节 安装浏览器驱动（以Google为例）</a></li><li><a href="#03__82" rel="nofollow">第03节 定位页面元素</a></li><li><ul><li><a href="#1__85" rel="nofollow">1. 打开指定页面</a></li><li><a href="#2_id__149" rel="nofollow">2. id 定位</a></li><li><a href="#3_name__176" rel="nofollow">3. name 定位</a></li><li><a href="#4_class__183" rel="nofollow">4. class 定位</a></li><li><a href="#5_tag__191" rel="nofollow">5. tag 定位</a></li><li><a href="#6_xpath__205" rel="nofollow">6. xpath 定位</a></li><li><a href="#7_css__300" rel="nofollow">7. css 选择器</a></li><li><a href="#8_link__367" rel="nofollow">8. link 定位</a></li><li><a href="#9___406" rel="nofollow">9. 示例 有道翻译</a></li></ul> 
  </li><li><a href="#04__460" rel="nofollow">第04节 浏览器控制</a></li><li><ul><li><a href="#1__462" rel="nofollow">1. 修改浏览器窗口大小</a></li><li><a href="#2__489" rel="nofollow">2. 浏览器前进&amp;后退</a></li><li><a href="#3__510" rel="nofollow">3. 浏览器刷新</a></li><li><a href="#4__527" rel="nofollow">4. 浏览器窗口切换</a></li><li><a href="#5__570" rel="nofollow">5. 常见操作</a></li><li><a href="#6__CSDN_643" rel="nofollow">6. 示例 CSDN页面元素交互</a></li></ul> 
  </li><li><a href="#05__688" rel="nofollow">第05节 鼠标控制</a></li><li><ul><li><a href="#1_693" rel="nofollow">1.单击元素</a></li><li><a href="#2_711" rel="nofollow">2.双击元素</a></li><li><a href="#3_718" rel="nofollow">3.在元素上右键单击</a></li><li><a href="#4_726" rel="nofollow">4.在元素上悬停（鼠标悬停）</a></li><li><a href="#5_736" rel="nofollow">5.拖拽元素到另一个位置</a></li></ul> 
  </li><li><a href="#06__748" rel="nofollow">第06节 键盘控制</a></li><li><ul><li><a href="#1_751" rel="nofollow">1.输入文本</a></li><li><a href="#2_767" rel="nofollow">2.按键</a></li><li><a href="#3_784" rel="nofollow">3.组合键</a></li><li><a href="#4__804" rel="nofollow">4. 其他键盘操作</a></li></ul> 
  </li><li><a href="#07__819" rel="nofollow">第07节 元素等待</a></li><li><ul><li><a href="#1__825" rel="nofollow">1. 隐式等待</a></li><li><a href="#2__840" rel="nofollow">2. 显示等待</a></li><li><a href="#3__864" rel="nofollow">3. 自定义等待</a></li><li><a href="#4__885" rel="nofollow">4. 强制等待</a></li></ul> 
  </li><li><a href="#08__915" rel="nofollow">第08节 切换操作</a></li><li><ul><li><a href="#1__920" rel="nofollow">1. 窗口切换</a></li><li><a href="#2__952" rel="nofollow">2. 表单切换</a></li></ul> 
  </li><li><a href="#09__1012" rel="nofollow">第09节 滚轮操作</a></li><li><a href="#_1036" rel="nofollow">总结</a></li></ul> 
</div> 
<p></p> 
<h2><a id="_1"></a>前言</h2> 
<p>为了巩固所学的知识，作者尝试着开始发布一些学习笔记类的博客，方便日后回顾。当然，如果能帮到一些萌新进行新技术的学习那也是极好的。作者菜菜一枚，文章中如果有记录错误，欢迎读者朋友们批评指正。<br> （博客的参考源码可以在我主页的资源里找到，如果在学习的过程中有什么疑问欢迎大家在评论区向我提出）</p> 
<h2><a id="_7"></a>发现宝藏</h2> 
<p>前些天发现了一个巨牛的人工智能学习网站，通俗易懂，风趣幽默，忍不住分享一下给大家。【<a href="https://www.captainbed.cn/dl" rel="nofollow">宝藏入口</a>】。</p> 
<h2><a id="01_Selenium_11"></a>第01节 Selenium概述</h2> 
<p><strong>Selenium</strong> 是一个<strong>Web的自动化测试工具</strong>，最初是为网站自动化测试而开发的，Selenium 可以直接运行<br> 在浏览器上，它支持所有主流的浏览器</p> 
<p>因为 Selenium 可以控制浏览器发送请求，并获取网页数据，因此可以应用于爬虫领域</p> 
<p>Selenium 可以根据我们的指令，让浏览器自动加载页面，获取需要的数据，甚至页面截屏，或者判断网<br> 站上某些动作是否发生</p> 
<p>Selenium 自己不带浏览器，不支持浏览器的功能，它<strong>需要与第三方浏览器结合在一起才能使用</strong></p> 
<p>Selenium 库的版本不同对应的方法名也会有所不同</p> 
<blockquote> 
 <p><font size="3">官方文档：<strong>http://selenium-python.readthedocs.io/index.html</strong></font></p> 
</blockquote> 
<h2><a id="02_Google_28"></a>第02节 安装浏览器驱动（以Google为例）</h2> 
<p><strong>1. 确认浏览器版本</strong></p> 
<p><img src="https://images2.imgbox.com/f9/bd/eKRag3d0_o.png" alt="在这里插入图片描述"></p> 
<p><strong>2. 下载对应版本的驱动</strong></p> 
<p><img src="https://images2.imgbox.com/fc/76/dbjfiHs5_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/bf/09/4jR7ulRS_o.png" alt="在这里插入图片描述"></p> 
<p><strong>3. 如何下载历史版本的 chorm</strong></p> 
<ul><li>获得浏览器版本号</li></ul> 
<p>访问 <strong>https://vikyd.github.io/download-chromium-history-version/</strong> ，可能需要科学上网（dddd），然后在 version 下拉里面选择你要的平台，然后在输入框输入版本号，例如 : windows 64位 113.0版本</p> 
<p><img src="https://images2.imgbox.com/9d/26/gIfYfLws_o.png" alt="在这里插入图片描述"></p> 
<ul><li>选择浏览器版本并下载压缩包<br> <img src="https://images2.imgbox.com/04/75/V2SPLX8n_o.png" alt="在这里插入图片描述"></li><li>下载完成后解压即可使用</li></ul> 
<p><img src="https://images2.imgbox.com/70/30/tBQ32BfH_o.png" alt="在这里插入图片描述"></p> 
<ul><li> <p>将 chromedriver.exe 保存到任意位置，并把当前路径保存到环境变量中（我的电脑&gt;&gt;右键属性&gt;&gt;高级系统设置&gt;&gt;高级&gt;&gt;环境变量&gt;&gt;系统变量&gt;&gt;Path），添加的时候要注意不要把 path 变量给覆盖了，如果覆盖了千万别关机，然后百度。添加成功后使用下面代码进行测试。</p> </li><li> <p>也可以尝试驱动文件在python安装目录或者和代码在同一个目录下</p> </li><li> <p>或者在实例化webdriver对象的时候把驱动路径传进去</p> </li></ul> 
<pre><code class="prism language-python"><span class="token comment"># 导入 webdriver</span>
<span class="token keyword">import</span> time
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token comment"># 调用环境变量指定的PhantomJS浏览器创建浏览器对象</span>
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># get方法会一直等到页面被完全加载，然后才会继续程序，通常测试会在这里选择</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://www.baidu.com/"</span><span class="token punctuation">)</span>

<span class="token comment"># id="kw"是百度搜索输入框，输入字符串"长城"</span>
driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span><span class="token string">"#kw"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">"长城"</span><span class="token punctuation">)</span>
<span class="token comment"># id="su"是百度搜索按钮，click() 是模拟点击</span>
driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span><span class="token string">"#su"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>

time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/70/48/Mjs71o1D_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="03__82"></a>第03节 定位页面元素</h2> 
<p><code>定位一个元素用 element,定位一组元素用 elements</code></p> 
<h3><a id="1__85"></a>1. 打开指定页面</h3> 
<p><strong>1. 不切换新窗口</strong></p> 
<p>要使用 <code>Selenium</code> 来打开指定页面，首先需要初始化一个 <code>WebDriver</code> 实例，然后使用该实例打开目标页面。下面是一个使用 <code>Python</code> 和 <code>Selenium</code> 的示例，演示如何打开指定的页面：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token comment"># 初始化一个WebDriver实例，这里使用Chrome作为浏览器</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 打开指定的页面，将URL替换为你要访问的网页地址</span>
url <span class="token operator">=</span> <span class="token string">"https://www.example.com"</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>

<span class="token comment"># 在这里，你可以执行与打开页面相关的操作</span>

<span class="token comment"># 最后，关闭浏览器窗口</span>
driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>在上述代码中，我们首先导入 <code>Selenium</code> 的 <code>webdriver</code> 模块，并初始化了一个 <code>Chrome</code> 浏览器的 <code>WebDriver</code> 实例。然后，<strong>使用 get 方法打开指定的页面</strong>，将目标网页的 <code>URL</code> 替换为你要访问的网页地址。之后，你可以在页面上执行与你的测试或任务相关的操作，然后使用 <code>quit</code> 方法关闭浏览器窗口</p> 
<p><strong>2. 切换新窗口</strong></p> 
<p>上面的方法会在当前窗口或标签页中打开一个新的页面，将当前页面替换为新的 URL ，使用 <strong>window.open(url)</strong> 打开新页面：</p> 
<pre><code class="prism language-python">driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">"window.open('https://www.example.com', '_blank');"</span><span class="token punctuation">)</span>  <span class="token comment"># 使用JavaScript打开一个新页面</span>
</code></pre> 
<p>这种方法使用 <code>execute_script</code> 方法执行 <code>JavaScript</code> 代码，在新的浏览器窗口或标签页中打开指定的 <code>URL</code>。<code>'_blank'</code> 参数告诉浏览器在新窗口或标签页中打开 <code>URL</code>。这种方式适用于在新窗口中打开页面，而不替换当前页面</p> 
<p>请注意，如果你使用 window.open() 方法打开新页面，你可能需要使用 <strong>driver.window_handles</strong> 和 <strong>driver.switch_to.window()</strong> 来管理不同窗口之间的切换，就像后面提到的窗口句柄一样。这可以让你在不同的浏览器窗口中执行操作</p> 
<p>总之，execute_script 方法通常与其他 Selenium 方法一起使用，用于执行 JavaScript 以实现特定的交互和操作，但它本身不用于打开新页面</p> 
<p><strong>3. 保持浏览器窗口打开</strong></p> 
<p>默认情况下，Selenium WebDriver 在脚本执行结束后会关闭浏览器窗口，但通过将选项 "<strong>detach"</strong> 设置为 <strong>True</strong>，你可以使浏览器窗口保持打开状态，以便手动进行操作</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token comment"># 创建ChromeOptions对象</span>
options <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>ChromeOptions<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 添加选项，防止浏览器自动关闭</span>
options<span class="token punctuation">.</span>add_experimental_option<span class="token punctuation">(</span><span class="token string">"detach"</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># 初始化一个WebDriver实例，将选项传递给Chrome</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>options<span class="token operator">=</span>options<span class="token punctuation">)</span>

<span class="token comment"># 打开指定的页面</span>
url <span class="token operator">=</span> <span class="token string">"https://www.csdn.net"</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>

<span class="token comment"># 在这里，你可以执行与打开页面相关的操作</span>

<span class="token comment"># 手动关闭浏览器时，可以保持它打开</span>

</code></pre> 
<h3><a id="2_id__149"></a>2. id 定位</h3> 
<p>要使用 Selenium 通过元素的 ID 进行定位，你可以使用 <strong>By.ID</strong> 选择器和 <strong>find_element</strong> 方法。以下是如何通过元素的ID进行定位的示例：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token comment"># 初始化一个WebDriver实例，这里使用Chrome作为浏览器</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 打开指定的页面</span>
url <span class="token operator">=</span> <span class="token string">"https://www.example.com"</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>

<span class="token comment"># 通过元素的ID进行定位并执行操作</span>
element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">"element_id"</span><span class="token punctuation">)</span>

<span class="token comment"># 在这里，你可以执行与该元素相关的操作，例如单击、输入文本等</span>
element<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 最后，关闭浏览器窗口</span>
driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>在上述示例中，<code>driver.find_element(By.ID, "element_id") </code>通过元素的ID属性来定位元素，并将其存储在变量 <code>element</code> 中，然后可以执行与该元素相关的操作。记得将 <code> "element_id"</code> 替换为你要查找的元素的实际 ID。</p> 
<h3><a id="3_name__176"></a>3. name 定位</h3> 
<pre><code class="prism language-python"><span class="token comment"># 通过元素的name属性进行定位并执行操作</span>
element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>NAME<span class="token punctuation">,</span><span class="token string">"element_name"</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="4_class__183"></a>4. class 定位</h3> 
<pre><code class="prism language-python"><span class="token comment"># 通过元素的CSS类名进行定位并执行操作</span>
element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>By<span class="token punctuation">.</span>CLASS_NAME<span class="token punctuation">,</span> <span class="token string">".element_class"</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="5_tag__191"></a>5. tag 定位</h3> 
<p>每个 tag 往往用来定义一类功能，所以通过 tag 来识别某个元素的成功率很低，每个页面一般都用很多相同的 tag</p> 
<pre><code class="prism language-python"><span class="token comment"># 通过元素的标签名进行定位并执行操作</span>
element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>TAG_NAME<span class="token punctuation">,</span><span class="token string">"element_tag"</span><span class="token punctuation">)</span>
</code></pre> 
<p><code>element_tag</code> 在示例代码中代表你要查找的元素的 <code>HTML</code> 标签名，例如 <code>&lt; div &gt;, &lt; a &gt;, &lt; p &gt;</code>等。具体来说，如果你要查找一个 <code>&lt; div &gt;</code> 元素，你可以将 <code>element_tag</code> 替换为 <code>"div"</code> ，如果你要查找一个 <code>&lt; a &gt;</code> 元素，你可以将 <code>element_tag</code> 替换为 <code>"a"</code>，以此类推</p> 
<h3><a id="6_xpath__205"></a>6. xpath 定位</h3> 
<p>XPath（XML Path Language）是一种用于在 XML 文档中定位元素的语言，也适用于HTML 文档，因为 HTML 是一种基于 XML 的标记语言的变体。XPath 是一种功能强大的元素定位方法，它允许你准确地定位网页上的元素，<strong>无论它们在文档中的位置如何</strong>。以下是XPath定位的一些示例：</p> 
<p><strong>1. 通过元素名称定位：</strong></p> 
<ul><li>定位<strong>所有的链接</strong>元素：<strong>//a</strong></li><li>定位<strong>所有的段落</strong>元素：<strong>//p</strong></li><li>定位<strong>第一个标题</strong>元素：<strong>//h1</strong></li></ul> 
<p><strong>2. 通过元素属性定位：</strong></p> 
<ul><li> <p>定位<strong>具有特定 id 属性</strong>的元素：</p> <pre><code>//*[@id='element_id']
</code></pre> </li><li> <p>定位<strong>具有特定 class</strong> 属性的元素：</p> <pre><code>//*[@class='element_class']
</code></pre> </li></ul> 
<p><strong>3. 通过文本内容定位：</strong></p> 
<ul><li> <p>定位<strong>包含特定文本的元素</strong>：</p> <pre><code>//*[text()='要查找的文本']
</code></pre> </li><li> <p>定位以<strong>特定文本开头</strong>的元素：</p> <pre><code>//*[starts-with(text(), '开头文本')]
</code></pre> </li><li> <p>定位<strong>包含特定文本的链接</strong>：</p> <pre><code>//a[contains(text(), '链接文本')]
</code></pre> </li></ul> 
<p><strong>4. 通过元素层次结构定位：</strong></p> 
<ul><li> <p>定位<strong>父元素的子元素</strong>：</p> <pre><code>//div[@id='parent_id']/p（查找 id 属性为 'parent_id' 的 &lt; div &gt; 元素下的所有 &lt; p &gt; 元素）
</code></pre> </li><li> <p>定位<strong>祖先元素的子元素</strong>：</p> <pre><code>//div[@class='grandparent_class']//span（查找 class 属性为 'grandparent_class' 的祖先元素下的所有&lt; span &gt;元素）
</code></pre> </li></ul> 
<p><strong>5. 使用逻辑运算符：</strong></p> 
<ul><li> <p>定位<strong>同时满足多个条件</strong>的元素：</p> <pre><code>//input[@type='text' and @name='username']（查找type属性为 'text' 且 name 属性为 'username' 的输入框）
</code></pre> </li></ul> 
<p>这些只是 XPath 的一些基本示例，XPath具有非常丰富的语法和功能，你可以根据需要组合和定制不同的条件来定位元素。在Selenium中，你可以使用 <strong>find_element + By.XPATH</strong> 方法来实现 XPath 定位，例如：</p> 
<pre><code class="prism language-python">element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>XPATH<span class="token punctuation">,</span><span class="token string">"//a[contains(text(), '链接文本')]"</span><span class="token punctuation">)</span>
</code></pre> 
<p>这将查找包含特定文本的链接元素,你可以根据需要修改 XPath 表达式来定位不同的元素。</p> 
<p><strong>6. 示例</strong></p> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>html<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>head<span class="token operator">&gt;</span><span class="token operator">...</span><span class="token operator">&lt;</span>head<span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>body<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"csdn-toolbar"</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"toolbar-inside"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"toolbar-container"</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"toolbar-container-left"</span><span class="token operator">&gt;</span><span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"toolbar-container-middle"</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"toolbar-search onlySearch"</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"toolbar-search-container"</span><span class="token operator">&gt;</span>
				<span class="token operator">&lt;</span>input id<span class="token operator">=</span><span class="token string">"toolbar-search-input"</span> autocomplete<span class="token operator">=</span><span class="token string">"off"</span> type<span class="token operator">=</span><span class="token string">"text"</span> value<span class="token operator">=</span><span class="token string">""</span> placeholder<span class="token operator">=</span><span class="token string">"C++难在哪里？"</span><span class="token operator">&gt;</span>
</code></pre> 
<p>根据上面的标签需要定位 最后一行 <code>input</code> 标签，以下列出了四种方式，<code>xpath</code> 定位的方式多样并不唯一，使用时根据情况进行解析即可。</p> 
<pre><code class="prism language-python"><span class="token comment"># 绝对路径（层级关系）定位</span>
driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>XPATH<span class="token punctuation">,</span>
	<span class="token string">"/html/body/div/div/div/div[2]/div/div/input[1]"</span><span class="token punctuation">)</span>
<span class="token comment"># 利用元素属性定位</span>
driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>XPATH<span class="token punctuation">,</span>
	<span class="token string">"//*[@id='toolbar-search-input']"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 层级+元素属性定位</span>
driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>XPATH<span class="token punctuation">,</span>
	<span class="token string">"//div[@id='csdn-toolbar']/div/div/div[2]/div/div/input[1]"</span><span class="token punctuation">)</span>
<span class="token comment"># 逻辑运算符定位</span>
driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>XPATH<span class="token punctuation">,</span>
	<span class="token string">"//*[@id='toolbar-search-input' and @autocomplete='off']"</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="7_css__300"></a>7. css 选择器</h3> 
<p>CSS 使用选择器来为页面元素绑定属性，它可以较为灵活的选择控件的任意属性，一般定位速度比 xpath 要快，使用CSS 选择器进行元素定位在 Selenium 中是非常常见和方便的。以下是一些常见的 CSS 选择器示例：</p> 
<p><strong>1. 通过元素名称定位：</strong></p> 
<ul><li>定位<strong>所有的链接元素</strong>：<strong>a</strong></li><li>定位<strong>所有的段落元素</strong>：<strong>p</strong></li><li>定位<strong>所有的按钮元素</strong>：<strong>button</strong></li></ul> 
<p><strong>2. 通过元素ID定位：</strong></p> 
<p>定位<strong>具有特定 ID属性</strong>的元素：<strong>#element_id</strong></p> 
<pre><code class="prism language-python">element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span><span class="token string">"#element_id"</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>3. 通过类名定位：</strong></p> 
<ul><li>定位<strong>具有特定 class 属性</strong>的元素：.<strong>element_class</strong></li></ul> 
<pre><code class="prism language-python">element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span><span class="token string">".element_class"</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>4. 通过元素属性定位：</strong></p> 
<ul><li>定位具有<strong>特定属性值</strong>的元素：<strong>[attribute=‘value’]</strong></li></ul> 
<pre><code class="prism language-python">element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span><span class="token string">"[name='username']"</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>5. 通过属性值的部分匹配：</strong></p> 
<ul><li>定位包含特定属性值的元素：[attribute*=‘value’]</li></ul> 
<pre><code class="prism language-python">element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span><span class="token string">"[href*='example.com']"</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>6. 通过组合条件：</strong></p> 
<ul><li>定位<strong>同时满足多个条件</strong>的元素：.<strong>class1.class2</strong></li></ul> 
<pre><code class="prism language-python">element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span><span class="token string">".element_class1.element_class2"</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>7. 子元素定位：</strong></p> 
<ul><li>定位<strong>父元素的子元素</strong>：<strong>#parent_id &gt; .child_class</strong></li></ul> 
<pre><code class="prism language-python">element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span><span class="token string">"#parent_id &gt; .child_class"</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>8. 伪类选择器：</strong></p> 
<p>例如 定位<strong>鼠标悬停</strong>的元素：:hover</p> 
<pre><code class="prism language-python">element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span><span class="token string">"a:hover"</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="8_link__367"></a>8. link 定位</h3> 
<p>使用 Selenium 来定位超链接（link）元素通常涉及到查找带有 &lt;a&gt; 标签的元素，这是 HTML 中的链接标签。你可以使用不同的方法来定位超链接，如通过文本内容、链接文本、部分链接文本等。以下是一些常见的链接定位示例：</p> 
<p><strong>1.通过链接文本（完全匹配）定位：</strong></p> 
<p>使用链接的文本内容来定位，确保文本与链接完全匹配：</p> 
<pre><code class="prism language-python">   <span class="token comment"># 查找所有链接文本为"下一页"的元素</span>
   element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_elements<span class="token punctuation">(</span>By<span class="token punctuation">.</span>LINK_TEXT<span class="token punctuation">,</span> <span class="token string">"文本"</span><span class="token punctuation">)</span>
</code></pre> 
<p><strong>2.通过链接文本（部分匹配）定位：</strong></p> 
<p>使用链接的部分文本内容来定位，可以匹配链接文本的一部分：</p> 
<pre><code class="prism language-python">   element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>PARTIAL_LINK_TEXT<span class="token punctuation">,</span><span class="token string">"部分文本"</span><span class="token punctuation">)</span>
</code></pre> 
<p>例如，如果你的链接文本是"点击这里以获取更多信息"，你可以使用"点击这里"或"获取更多信息"来进行部分匹配。</p> 
<p>这些方法非常方便，特别是当你知道链接的文本内容时。但请注意，它们对文本大小写敏感，所以确保文本内容的大小写与链接文本匹配。</p> 
<p>要查找多个链接，你可以使用 <code>find_element**s**(By.LINK_TEXT, "文本")</code> 或 <code>find_element**s**(By.PARTIAL_LINK_TEXT,"部分文本")</code>，它们会返回一个元素列表，你可以在列表中迭代查找多个链接元素。</p> 
<p>示例：</p> 
<pre><code class="prism language-python">elements <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_elements<span class="token punctuation">(</span>By<span class="token punctuation">.</span>PARTIAL_LINK_TEXT<span class="token punctuation">,</span><span class="token string">"部分文本"</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> element <span class="token keyword">in</span> elements<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>element<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
</code></pre> 
<p>这将打印所有包含"部分文本"的链接文本的链接元素。</p> 
<h3><a id="9___406"></a>9. 示例 有道翻译</h3> 
<p>访问有道翻译网站，输入单词，并获取翻译后的内容</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> time

<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support<span class="token punctuation">.</span>ui <span class="token keyword">import</span> WebDriverWait
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support <span class="token keyword">import</span> expected_conditions <span class="token keyword">as</span> EC

<span class="token comment"># 创建ChromeOptions对象</span>
options <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>ChromeOptions<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 添加选项，防止浏览器自动关闭</span>
options<span class="token punctuation">.</span>add_experimental_option<span class="token punctuation">(</span><span class="token string">"detach"</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># 创建Chrome WebDriver</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>options<span class="token operator">=</span>options<span class="token punctuation">)</span>

<span class="token comment"># 打开有道翻译页面</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://fanyi.youdao.com/"</span><span class="token punctuation">)</span>

<span class="token comment"># 等待输入框可见</span>
input_element <span class="token operator">=</span> WebDriverWait<span class="token punctuation">(</span>driver<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>until<span class="token punctuation">(</span>
    EC<span class="token punctuation">.</span>presence_of_element_located<span class="token punctuation">(</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">"js_fanyi_input"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token comment"># 输入内容</span>
input_element<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span>


<span class="token comment"># 如果有广告弹出框，关闭它</span>
<span class="token keyword">try</span><span class="token punctuation">:</span>
    close_btn <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CSS_SELECTOR<span class="token punctuation">,</span> <span class="token string">".close"</span><span class="token punctuation">)</span>
    close_btn<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">except</span> Exception<span class="token punctuation">:</span>
    <span class="token keyword">pass</span>  <span class="token comment"># 如果没有广告，继续执行</span>

<span class="token comment"># 等待翻译结果出现</span>
transTarget <span class="token operator">=</span> WebDriverWait<span class="token punctuation">(</span>driver<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>until<span class="token punctuation">(</span>
    EC<span class="token punctuation">.</span>presence_of_element_located<span class="token punctuation">(</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">"js_fanyi_output_resultOutput"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token comment"># 输出翻译结果</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>transTarget<span class="token punctuation">.</span>text<span class="token punctuation">)</span>

<span class="token comment"># 关闭浏览器</span>
<span class="token comment"># driver.quit()</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/c1/4f/AXS0MDlq_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="04__460"></a>第04节 浏览器控制</h2> 
<h3><a id="1__462"></a>1. 修改浏览器窗口大小</h3> 
<p>webdriver 提供 <strong>set_window_size()</strong> 方法来修改浏览器窗口的大小</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token comment"># 初始化浏览器驱动程序，这里使用Chrome作为示例</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 最大化浏览器窗口</span>
driver<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 或者设置特定大小的窗口</span>
<span class="token comment"># driver.set_window_size(1024, 768)  # 传递所需的宽度和高度</span>

<span class="token comment"># 访问网页</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://www.example.com"</span><span class="token punctuation">)</span>

<span class="token comment"># 在这里执行其他操作...</span>

<span class="token comment"># 关闭浏览器</span>
driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="2__489"></a>2. 浏览器前进&amp;后退</h3> 
<p>要在 Selenium 中执行浏览器的前进和后退操作，你可以使用 <strong>forward()</strong> 和 <strong>back()</strong> 方法</p> 
<pre><code class="prism language-python"><span class="token comment"># 在这里执行其他操作...</span>

<span class="token comment"># 执行前进操作</span>
driver<span class="token punctuation">.</span>forward<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 执行后退操作</span>
driver<span class="token punctuation">.</span>back<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 在这里执行其他操作...</span>
</code></pre> 
<p>请注意，前进和后退操作通常依赖于浏览器的历史记录。如果浏览器历史记录中没有前进或后退的页面，这些方法可能不会执行任何操作。因此，在使用前进和后退之前，<strong>确保浏览器已经访问了多个页面以建立历史记录</strong></p> 
<h3><a id="3__510"></a>3. 浏览器刷新</h3> 
<p>要在Selenium中执行浏览器刷新操作，你可以使用refresh()方法。以下是一个示例，演示如何在Python中使用Selenium来刷新浏览器页面：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token comment"># 刷新浏览器页面</span>
driver<span class="token punctuation">.</span>refresh<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>这个方法将会重新加载当前页面，就像用户手动点击浏览器的刷新按钮一样。刷新操作可用于重新加载页面内容，以确保你的测试脚本在页面状态变化时可以重新加载页面</p> 
<h3><a id="4__527"></a>4. 浏览器窗口切换</h3> 
<p>在 Selenium 中，要切换浏览器窗口，你可以使用 <strong>window_handles</strong> 属性来获取当前打开的<strong>所有窗口句柄</strong>，然后使用 <strong>switch_to.window()</strong> 方法<strong>切换到特定的窗口句柄</strong>。以下是一个示例，演示如何在 Python 中使用 Selenium 来切换浏览器窗口：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

<span class="token comment"># 初始化浏览器驱动程序，这里使用Chrome作为示例</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 打开第一个网页</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://www.example1.com"</span><span class="token punctuation">)</span>

<span class="token comment"># 打开第二个网页</span>
driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">"window.open('https://www.example2.com', '_blank');"</span><span class="token punctuation">)</span>

<span class="token comment"># 获取所有窗口句柄</span>
window_handles <span class="token operator">=</span> driver<span class="token punctuation">.</span>window_handles

<span class="token comment"># 切换到第二个窗口</span>
driver<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>window<span class="token punctuation">(</span>window_handles<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 在第二个窗口执行操作</span>

<span class="token comment"># 切换回第一个窗口</span>
driver<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>window<span class="token punctuation">(</span>window_handles<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 在第一个窗口执行操作</span>

<span class="token comment"># 关闭浏览器</span>
driver<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>在上述示例中，我们首先打开两个不同的网页，然后使用 <code>window_handles</code> 获取所有窗口句柄。通过切换到不同的窗口句柄，我们可以在不同的浏览器窗口中执行操作</p> 
<p>请注意，窗口句柄的索引通常是从 0 开始的，所以第一个窗口的句柄是 window_handles[0] ，第二个窗口的句柄是 window_handles[1] ，依此类推。你可以根据需要切换到其他窗口句柄以执行操作</p> 
<blockquote> 
 <p>窗口句柄（Window Handle）是一个用来唯一标识浏览器窗口的标识符或引用。每当你打开一个新的浏览器窗口或标签页时，浏览器会为该窗口分配一个唯一的句柄。这些句柄是在浏览器级别分配的，用于标识不同的浏览器窗口或标签页，以便在多窗口浏览器环境中进行切换和操作</p> 
</blockquote> 
<blockquote> 
 <p>在 Selenium 等自动化测试工具中，窗口句柄用于控制和切换不同的浏览器窗口，以便在多个窗口之间执行操作。通过获取窗口句柄，你可以将焦点从一个窗口切换到另一个窗口，从而执行各种操作，例如在不同窗口之间切换、操作弹出窗口等</p> 
</blockquote> 
<blockquote> 
 <p>窗口句柄通常是一个字符串，你可以使用它来定位和操作特定的浏览器窗口。在 Selenium 中，你可以使用 window_handles 属性来获取当前打开的所有窗口句柄，然后使用 switch_to.window() 方法切换到特定的窗口句柄。这使得在多窗口浏览器环境中进行自动化测试或操作变得更加容易</p> 
</blockquote> 
<h3><a id="5__570"></a>5. 常见操作</h3> 
<p>当使用 Selenium WebDriver 或类似的自动化测试工具时，这些方法可以用于与 Web 页面的元素进行交互和获取信息。以下是每个方法的使用示例：</p> 
<p><strong>1. send_keys(): 模拟输入指定内容</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://example.com"</span><span class="token punctuation">)</span>

<span class="token comment"># 找到输入框元素并输入文本</span>
input_element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span>
input_element<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">"myusername"</span><span class="token punctuation">)</span>
</code></pre> 
<p>在这个例子中，send_keys() 方法模拟在具有 id 为 “username” 的输入框中输入 “myusername”</p> 
<p><strong>2. clear(): 清除文本内容</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># 清除输入框中的文本</span>
input_element<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>clear() 方法用于清除之前输入框中的文本内容</p> 
<p><strong>3. is_displayed(): 判断该元素是否可见</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># 检查元素是否可见</span>
<span class="token keyword">if</span> input_element<span class="token punctuation">.</span>is_displayed<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Input element is visible on the page."</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Input element is not visible on the page."</span><span class="token punctuation">)</span>
</code></pre> 
<p>is_displayed() 方法用于检查页面上的元素是否可见。在这个例子中，如果输入框可见，将会打印 “Input element is visible on the page.”</p> 
<p><strong>4. get_attribute(): 获取标签属性值</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># 获取元素的href属性值</span>
link_element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_link_text<span class="token punctuation">(</span><span class="token string">"Example Link"</span><span class="token punctuation">)</span>
href_value <span class="token operator">=</span> link_element<span class="token punctuation">.</span>get_attribute<span class="token punctuation">(</span><span class="token string">"href"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Href attribute value is:"</span><span class="token punctuation">,</span> href_value<span class="token punctuation">)</span>
</code></pre> 
<p>get_attribute() 方法用于获取元素的指定属性的值。在这个例子中，它获取链接文本为 “Example Link” 的元素的 href 属性值</p> 
<p><strong>5. size: 返回元素的尺寸</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># 获取元素的宽度和高度</span>
element_size <span class="token operator">=</span> input_element<span class="token punctuation">.</span>size
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Element size is:"</span><span class="token punctuation">,</span> element_size<span class="token punctuation">)</span>
</code></pre> 
<p>size 是一个属性，用于返回元素的宽度和高度。在这个例子中，它获取输入框元素的尺寸</p> 
<p><strong>6. text: 返回元素文本</strong></p> 
<pre><code class="prism language-python"><span class="token comment"># 获取元素的文本内容</span>
paragraph_element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_css_selector<span class="token punctuation">(</span><span class="token string">"p"</span><span class="token punctuation">)</span>
paragraph_text <span class="token operator">=</span> paragraph_element<span class="token punctuation">.</span>text
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Paragraph text is:"</span><span class="token punctuation">,</span> paragraph_text<span class="token punctuation">)</span>
</code></pre> 
<p>text 是一个属性，用于返回元素的文本内容。在这个例子中，它获取 &lt;p&gt; 元素的文本内容</p> 
<h3><a id="6__CSDN_643"></a>6. 示例 CSDN页面元素交互</h3> 
<pre><code class="prism language-python"><span class="token comment"># coding=utf-8</span>
<span class="token keyword">import</span> time

<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>

driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'https://www.csdn.net/'</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment"># 定位搜索输入框</span>
text_label <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">"toolbar-search-input"</span><span class="token punctuation">)</span>

<span class="token comment"># 在搜索框中输入 东离与糖宝</span>
text_label<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">'东离与糖宝'</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># 清除搜索框中的内容</span>
text_label<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># 输出搜索框元素是否可见</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>text_label<span class="token punctuation">.</span>is_displayed<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># 输出placeholder的值</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>text_label<span class="token punctuation">.</span>get_attribute<span class="token punctuation">(</span><span class="token string">'placeholder'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># 定位搜索按钮</span>
button <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">'toolbar-search-button'</span><span class="token punctuation">)</span>
<span class="token comment"># 输出按钮的大小</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>button<span class="token punctuation">.</span>size<span class="token punctuation">)</span>
<span class="token comment"># 输出按钮上的文本</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>button<span class="token punctuation">.</span>text<span class="token punctuation">)</span>

<span class="token triple-quoted-string string">'''输出内容
True
搜CSDN
{'height': 32, 'width': 88}
搜索
'''</span>
</code></pre> 
<h2><a id="05__688"></a>第05节 鼠标控制</h2> 
<h3><a id="1_693"></a>1.单击元素</h3> 
<p><code>左键不需要用到 ActionChains</code></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>action_chains <span class="token keyword">import</span> ActionChains

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://example.com"</span><span class="token punctuation">)</span>

element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"my_element"</span><span class="token punctuation">)</span>

<span class="token comment"># 单击元素</span>
ActionChains<span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="2_711"></a>2.双击元素</h3> 
<pre><code class="prism language-python"><span class="token comment"># 双击元素</span>
ActionChains<span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">.</span>double_click<span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="3_718"></a>3.在元素上右键单击</h3> 
<pre><code class="prism language-python"><span class="token comment"># 右键单击元素</span>
ActionChains<span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">.</span>context_click<span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="4_726"></a>4.在元素上悬停（鼠标悬停）</h3> 
<p><code>模拟悬停的作用一般是为了显示隐藏的下拉框</code></p> 
<pre><code class="prism language-python"><span class="token comment"># 鼠标悬停在元素上</span>
ActionChains<span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">.</span>move_to_element<span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="5_736"></a>5.拖拽元素到另一个位置</h3> 
<pre><code class="prism language-python"><span class="token comment"># 拖拽元素到目标位置</span>
target_element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"target_element"</span><span class="token punctuation">)</span>
ActionChains<span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">.</span>drag_and_drop<span class="token punctuation">(</span>element<span class="token punctuation">,</span> target_element<span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<h2><a id="06__748"></a>第06节 键盘控制</h2> 
<h3><a id="1_751"></a>1.输入文本</h3> 
<p>使用 <strong>send_keys</strong> 方法可以将文本输入到活动元素中，就像用户手动键入一样</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://example.com"</span><span class="token punctuation">)</span>

<span class="token comment"># 定位到文本输入框并输入文本</span>
text_input <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"my_textbox"</span><span class="token punctuation">)</span>
text_input<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">"Hello, World!"</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="2_767"></a>2.按键</h3> 
<p>使用 send_keys 方法可以模拟特定按键的操作，如回车键、退格键、Tab键等。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>keys <span class="token keyword">import</span> Keys

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://example.com"</span><span class="token punctuation">)</span>

<span class="token comment"># 模拟按下回车键</span>
text_input <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"my_textbox"</span><span class="token punctuation">)</span>
text_input<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>Keys<span class="token punctuation">.</span>ENTER<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="3_784"></a>3.组合键</h3> 
<p>你可以使用 <strong>Keys 类</strong>来模拟键盘上的组合键，例如 Ctrl+C（复制）和Ctrl+V（粘贴）。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>keys <span class="token keyword">import</span> Keys

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://example.com"</span><span class="token punctuation">)</span>

<span class="token comment"># 模拟Ctrl+C（复制）</span>
text_input <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"my_textbox"</span><span class="token punctuation">)</span>
text_input<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>Keys<span class="token punctuation">.</span>CONTROL<span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">)</span>

<span class="token comment"># 模拟Ctrl+V（粘贴）</span>
another_text_input <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"another_textbox"</span><span class="token punctuation">)</span>
another_text_input<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>Keys<span class="token punctuation">.</span>CONTROL<span class="token punctuation">,</span> <span class="token string">'v'</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="4__804"></a>4. 其他键盘操作</h3> 
<table><thead><tr><th>操作</th><th>描述</th></tr></thead><tbody><tr><td><strong>Keys.F1</strong></td><td><strong>F1键</strong></td></tr><tr><td><strong>Keys.SPACE</strong></td><td><strong>空格</strong></td></tr><tr><td><strong>Keys.TAB</strong></td><td>Tab键</td></tr><tr><td><strong>Keys.ESCAPE</strong></td><td><strong>ESC键</strong></td></tr><tr><td><strong>Keys.ALT</strong></td><td><strong>Alt键</strong></td></tr><tr><td><strong>Keys.SHIFT</strong></td><td><strong>Shift键</strong></td></tr><tr><td><strong>Keys.ARROW_DOWN</strong></td><td><strong>向下箭头</strong></td></tr><tr><td><strong>Keys.ARROW_LEFT</strong></td><td><strong>向左箭头</strong></td></tr><tr><td><strong>Keys.ARROW_RIGHT</strong></td><td><strong>向右箭头</strong></td></tr><tr><td><strong>Keys.ARROW_UP</strong></td><td><strong>向上箭头</strong></td></tr></tbody></table> 
<h2><a id="07__819"></a>第07节 元素等待</h2> 
<p>现在的大多数的 Web 应用程序是使用 Ajax 技术。当一个页面被加载到浏览器时， 该页面内的元素可以在不同的时间点被加载。这使得定位元素变得困难， 如果元素不再页面之中，会抛出 ElementNotVisibleException 异常。 使用 waits, 我们可以解决这个问题。waits 提供了一些操作之间的时间间隔- 主要是定位元素或针对该元素的任何其他操作。</p> 
<p>Selenium Webdriver 提供两种类型的 waits - 隐式和显式。 显式等待会让 WebDriver 等待满足一定的条件以后再进一步的执行。 而隐式等待让 Webdriver 等待一定的时间后再才是查找某元素。</p> 
<h3><a id="1__825"></a>1. 隐式等待</h3> 
<p>隐式等待（Implicit Wait）：设置一个全局等待时间，如果 Selenium 无法立即找到元素，它会等待指定的时间，然后再次尝试。这对于整个测试过程都适用</p> 
<pre><code class="prism language-javascript">from selenium <span class="token keyword">import</span> webdriver

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span><span class="token function">Chrome</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span><span class="token function">implicitly_wait</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>  # 设置等待时间为<span class="token number">10</span>秒

driver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"https://example.com"</span><span class="token punctuation">)</span>
element <span class="token operator">=</span> driver<span class="token punctuation">.</span><span class="token function">find_element_by_id</span><span class="token punctuation">(</span><span class="token string">"myElement"</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="2__840"></a>2. 显示等待</h3> 
<p>显式等待（Explicit Wait）：显式等待允许你为特定操作等待特定条件。你可以等待元素可见、可点击等条件。</p> 
<pre><code class="prism language-javascript">from selenium <span class="token keyword">import</span> webdriver
from selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By
from selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support<span class="token punctuation">.</span>ui <span class="token keyword">import</span> WebDriverWait
from selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support <span class="token keyword">import</span> expected_conditions <span class="token keyword">as</span> <span class="token constant">EC</span>

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span><span class="token function">Chrome</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"https://example.com"</span><span class="token punctuation">)</span>

# 等待元素可见
element <span class="token operator">=</span> <span class="token function">WebDriverWait</span><span class="token punctuation">(</span>driver<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">until</span><span class="token punctuation">(</span>
    <span class="token constant">EC</span><span class="token punctuation">.</span><span class="token function">visibility_of_element_located</span><span class="token punctuation">(</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token constant">ID</span><span class="token punctuation">,</span> <span class="token string">"myElement"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

# 等待元素可点击
element <span class="token operator">=</span> <span class="token function">WebDriverWait</span><span class="token punctuation">(</span>driver<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">until</span><span class="token punctuation">(</span>
    <span class="token constant">EC</span><span class="token punctuation">.</span><span class="token function">element_to_be_clickable</span><span class="token punctuation">(</span><span class="token punctuation">(</span>By<span class="token punctuation">.</span><span class="token constant">ID</span><span class="token punctuation">,</span> <span class="token string">"myElement"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre> 
<h3><a id="3__864"></a>3. 自定义等待</h3> 
<p>自定义等待：你还可以根据需要创建自定义等待条件。例如，你可以等待元素的文本内容等于特定值。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>support<span class="token punctuation">.</span>ui <span class="token keyword">import</span> WebDriverWait

<span class="token keyword">def</span> <span class="token function">wait_for_element_with_text</span><span class="token punctuation">(</span>driver<span class="token punctuation">,</span> by<span class="token punctuation">,</span> value<span class="token punctuation">,</span> text<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> WebDriverWait<span class="token punctuation">(</span>driver<span class="token punctuation">,</span> timeout<span class="token punctuation">)</span><span class="token punctuation">.</span>until<span class="token punctuation">(</span>
        <span class="token keyword">lambda</span> driver<span class="token punctuation">:</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>by<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">.</span>text <span class="token operator">==</span> text
    <span class="token punctuation">)</span>

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://example.com"</span><span class="token punctuation">)</span>

<span class="token comment"># 等待元素文本内容等于特定值</span>
wait_for_element_with_text<span class="token punctuation">(</span>driver<span class="token punctuation">,</span> By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">"myElement"</span><span class="token punctuation">,</span> <span class="token string">"Hello, World!"</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="4__885"></a>4. 强制等待</h3> 
<p>将隐式等待改为强制等待（使用 time.sleep()）通常不是一个好的做法，因为它会导致代码效率低下并且可能会浪费时间。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> time
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://example.com"</span><span class="token punctuation">)</span>  <span class="token comment"># 替换为你要访问的网页URL</span>

<span class="token comment"># 假设你已经定位到了包含文本的 WebElement 对象</span>
element <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element_by_css_selector<span class="token punctuation">(</span><span class="token string">"span.red-packet-icon-mini &gt; span.num"</span><span class="token punctuation">)</span>

<span class="token comment"># 使用强制等待</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>  <span class="token comment"># 强制等待 5 秒</span>

<span class="token comment"># 获取 &lt;span&gt; 元素的文本内容</span>
text_content <span class="token operator">=</span> element<span class="token punctuation">.</span>text

<span class="token comment"># 打印文本内容</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>text_content<span class="token punctuation">)</span>

</code></pre> 
<p><code>值得一提的是，对于定位不到元素的时候，从耗时方面隐式等待和强制等待没什么区别</code></p> 
<h2><a id="08__915"></a>第08节 切换操作</h2> 
<p>在 selenium 操作页面的时候，可能会因为点击某个链接而跳转到一个新的页面（打开了一个新标签页），这时候 selenium 实际还是处于上一个页面的，需要我们进行切换才能够定位最新页面上的元素。</p> 
<p>窗口切换需要使用 switch_to.windows() 方法。</p> 
<h3><a id="1__920"></a>1. 窗口切换</h3> 
<p>在 selenium 操作页面的时候，可能会因为点击某个链接而跳转到一个新的页面（打开了一个新标签页），这时候 selenium 实际还是处于上一个页面的，需要我们进行切换才能够定位最新页面上的元素。</p> 
<p>窗口切换需要使用 switch_to.windows() 方法。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

handles <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'https://blog.csdn.net/'</span><span class="token punctuation">)</span>
<span class="token comment"># 设置隐式等待</span>
driver<span class="token punctuation">.</span>implicitly_wait<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token comment"># 获取当前窗口的句柄</span>
handles<span class="token punctuation">.</span>append<span class="token punctuation">(</span>driver<span class="token punctuation">.</span>current_window_handle<span class="token punctuation">)</span>
<span class="token comment"># 点击 python，进入分类页面</span>
driver<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="mainContent"]/aside/div[1]/div'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 切换窗口</span>
driver<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>window<span class="token punctuation">(</span>driver<span class="token punctuation">.</span>window_handles<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># 获取当前窗口的句柄</span>
handles<span class="token punctuation">.</span>append<span class="token punctuation">(</span>driver<span class="token punctuation">.</span>current_window_handle<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>handles<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>driver<span class="token punctuation">.</span>window_handles<span class="token punctuation">)</span>

</code></pre> 
<p><img src="https://images2.imgbox.com/6d/3f/RKrgpzQX_o.png" alt="在这里插入图片描述"><br> 上面代码在点击跳转后，使用 <code>switch_to</code> 切换窗口，<code>window_handles</code>返回的 <code>handle</code> 列表是按照页面出现时间进行排序的，最新打开的页面肯定是最后一个，这样用 <code>driver.window_handles[-1] + switch_to</code> 即可跳转到最新打开的页面了。</p> 
<p>那如果打开的窗口有多个，如何跳转到之前打开的窗口，如果确实有这个需求，那么打开窗口是就需要记录每一个窗口的 <code>key(别名)</code> 与 <code>value(handle)</code>，保存到字典中，后续根据 <code>key</code> 来取 <code>handle</code> 。</p> 
<h3><a id="2__952"></a>2. 表单切换</h3> 
<p><strong>1. iframe 切换</strong></p> 
<p>很多页面也会用带 frame/iframe 表单嵌套，对于这种内嵌的页面 selenium 是无法直接定位的，需要使用 switch_to.frame() 方法将当前操作的对象切换成 frame/iframe 内嵌的页面。</p> 
<p>switch_to.frame() 默认可以用的 id 或 name 属性直接定位，但如果 iframe 没有 id 或 name ，这时就需要使用 xpath 进行定位。</p> 
<pre><code class="prism language-python">   iframe <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">"my-iframe-id"</span><span class="token punctuation">)</span>
   driver<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>frame<span class="token punctuation">(</span>iframe<span class="token punctuation">)</span>
</code></pre> 
<p><strong>2.切换回默认内容：</strong></p> 
<p>如果在 iframe 中完成操作后，要切换回主页面，可以使用 switch_to.default_content() 方法：</p> 
<pre><code class="prism language-python">   driver<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>default_content<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>这些方法可以帮助你在 Selenium 中进行窗口和 iframe 的切换操作。记住，切换窗口或 iframe 之前，你需要获取到对应的窗口句柄或 iframe 元素。</p> 
<p><strong>3. 举例</strong></p> 
<p>确切地，要找到位于 iframe 中的元素，你需要按照以下步骤进行操作：</p> 
<p>1.首先，你需要找到 iframe 元素本身，然后切换到该 iframe</p> 
<p>2.在 iframe 内部，你可以使用常规的方法来查找和操作元素</p> 
<p>以下是一个示例，演示如何切换到 iframe 并找到其中的元素：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>by <span class="token keyword">import</span> By

driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token punctuation">)</span>
driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://example.com"</span><span class="token punctuation">)</span>

<span class="token comment"># 找到 iframe 元素，可以根据其 ID、名称或其他属性来定位</span>
iframe <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>ID<span class="token punctuation">,</span> <span class="token string">"my-iframe-id"</span><span class="token punctuation">)</span>

<span class="token comment"># 切换到 iframe</span>
driver<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>frame<span class="token punctuation">(</span>iframe<span class="token punctuation">)</span>

<span class="token comment"># 在 iframe 中查找元素并执行操作</span>
element_inside_iframe <span class="token operator">=</span> driver<span class="token punctuation">.</span>find_element<span class="token punctuation">(</span>By<span class="token punctuation">.</span>CLASS_NAME<span class="token punctuation">,</span> <span class="token string">"element-class"</span><span class="token punctuation">)</span>
element_inside_iframe<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 切换回主页面</span>
driver<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>default_content<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>在这个示例中，我们首先通过其 <code>ID</code> 找到了 <code>iframe</code> 元素，然后使用 <code>driver.switch_to.frame()</code> 切换到了 <code>iframe</code> 中，接下来在 <code>iframe</code> 内查找元素并执行操作。最后，使用 <code>driver.switch_to.default_content()</code> 切换回主页面。</p> 
<p>记住，要确保你正确找到了 iframe 元素，以及在切换到 iframe 后，使用 driver.find_element() 方法来查找位于 iframe 内部的元素。</p> 
<h2><a id="09__1012"></a>第09节 滚轮操作</h2> 
<p>要在 Selenium 中模拟滚轮操作，你可以使用 ActionChains 类的 send_keys 方法，将 Keys.PAGE_DOWN 或 Keys.SPACE 等按键发送到页面。这将模拟向下滚动页面。</p> 
<p>在你的示例代码中，你已经创建了一个 ActionChains 对象，所以你只需要在循环中使用 send_keys 方法来模拟滚轮操作。以下是如何修改你的代码以模拟滚轮向下滚动：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>keys <span class="token keyword">import</span> Keys

<span class="token comment"># ...</span>

<span class="token comment"># 计算滚动的时间间隔（以毫秒为单位）</span>
scroll_interval <span class="token operator">=</span> <span class="token number">500</span>  <span class="token comment"># 每500毫秒滚动一次</span>

<span class="token comment"># 创建ActionChains对象</span>
action_chains <span class="token operator">=</span> ActionChains<span class="token punctuation">(</span>driver<span class="token punctuation">)</span>

<span class="token comment"># 模拟滚动</span>
<span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>scroll_duration <span class="token operator">*</span> <span class="token number">1000</span> <span class="token operator">/</span> scroll_interval<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    action_chains<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>Keys<span class="token punctuation">.</span>PAGE_DOWN<span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span>scroll_interval <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">)</span>
</code></pre> 
<p>这段代码会模拟按下 Page Down 键来滚动页面。你可以根据需要调整 scroll_interval 和 scroll_duration 来控制滚动的速度和持续时间。</p> 
<h2><a id="_1036"></a>总结</h2> 
<p>欢迎各位留言交流以及批评指正，如果文章对您有帮助或者觉得作者写的还不错可以点一下关注，点赞，收藏支持一下。<br> （博客的参考源码可以在我主页的资源里找到，如果在学习的过程中有什么疑问欢迎大家在评论区向我提出）</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6101c63ffc8a869979660c278bb9c8f1/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">SpringBoot和JDK版本兼容性</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e3283e8e6e3eae6fabe70f7e395ba2e5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ChatGPT4.0直接出图功能上线！神奇一键画，AI让创作更轻松(chatgpt4.0直接出圖)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程学习者.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Python 处理 Excel 的14个常用操作详解 - 编程学习者</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcxuexizhe.github.io/posts/c61a1fa56d880d583f4148c0a641a098/">
  <meta property="og:site_name" content="编程学习者">
  <meta property="og:title" content="Python 处理 Excel 的14个常用操作详解">
  <meta property="og:description" content="更多资料获取 📚 个人网站：ipengtao.com
在数据处理和分析的领域中，Excel是一种被广泛使用的工具。然而，通过Python处理Excel，能够更好地实现自动化和批量处理。本文将深入探讨Python中处理Excel的14个常用操作，并提供详尽的示例代码，以助您更全面地掌握这些技能。
1. 读取 Excel 文件 使用 pandas 库读取 Excel 文件是一种常见的数据处理操作，它能够快速加载 Excel 中的表格数据，并将其转换为数据框架（DataFrame）。以下是一个简单的示例代码，演示如何使用 pandas 读取 Excel 文件。
import pandas as pd # 读取 Excel 文件 file_path = &#39;example_data.xlsx&#39; df = pd.read_excel(file_path) # 打印读取的数据框架 print(&#34;读取的数据框架：&#34;) print(df) 在这个例子中，使用 pd.read_excel 函数读取了一个名为 ‘example_data.xlsx’ 的 Excel 文件。读取后，数据被存储在一个 pandas 数据框架中。
2. 写入 Excel 文件 在处理数据后，将结果写入新的 Excel 文件是一项常见的任务。使用 pandas 库，可以将处理过的数据写入新的 Excel 文件。以下是一个简单的示例代码，演示如何使用 pandas 将数据写入 Excel 文件。
import pandas as pd # 创建示例数据框架 data = { &#39;Product&#39;: [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;], &#39;Price&#39;: [25.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-12-10T12:00:00+08:00">
    <meta property="article:modified_time" content="2023-12-10T12:00:00+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程学习者" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程学习者</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Python 处理 Excel 的14个常用操作详解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><img src="https://images2.imgbox.com/eb/34/k0LKP0SM_o.png" alt=""></p> 
<h2><a id="_1"></a>更多资料获取</h2> 
<p>📚 个人网站：<a href="http://ipengtao.com/" rel="nofollow">ipengtao.com</a></p> 
<hr> 
<p>在数据处理和分析的领域中，Excel是一种被广泛使用的工具。然而，通过Python处理Excel，能够更好地实现自动化和批量处理。本文将深入探讨Python中处理Excel的14个常用操作，并提供详尽的示例代码，以助您更全面地掌握这些技能。</p> 
<h3><a id="1__Excel__8"></a>1. 读取 Excel 文件</h3> 
<p>使用 <code>pandas</code> 库读取 Excel 文件是一种常见的数据处理操作，它能够快速加载 Excel 中的表格数据，并将其转换为数据框架（DataFrame）。以下是一个简单的示例代码，演示如何使用 <code>pandas</code> 读取 Excel 文件。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment"># 读取 Excel 文件</span>
file_path <span class="token operator">=</span> <span class="token string">'example_data.xlsx'</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>

<span class="token comment"># 打印读取的数据框架</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"读取的数据框架："</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span>
</code></pre> 
<p>在这个例子中，使用 <code>pd.read_excel</code> 函数读取了一个名为 ‘example_data.xlsx’ 的 Excel 文件。读取后，数据被存储在一个 <code>pandas</code> 数据框架中。</p> 
<h3><a id="2__Excel__26"></a>2. 写入 Excel 文件</h3> 
<p>在处理数据后，将结果写入新的 Excel 文件是一项常见的任务。使用 <code>pandas</code> 库，可以将处理过的数据写入新的 Excel 文件。以下是一个简单的示例代码，演示如何使用 <code>pandas</code> 将数据写入 Excel 文件。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment"># 创建示例数据框架</span>
data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'Product'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Price'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">25.5</span><span class="token punctuation">,</span> <span class="token number">30.2</span><span class="token punctuation">,</span> <span class="token number">15.8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Quantity'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token comment"># 将数据框架写入 Excel 文件</span>
df<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span><span class="token string">'output_data.xlsx'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</code></pre> 
<p>在这个例子中，使用 <code>to_excel</code> 函数将数据框架写入 Excel 文件。参数 <code>index=False</code> 表示不包含行索引信息。生成的 Excel 文件名为 ‘output_data.xlsx’。</p> 
<h3><a id="3__48"></a>3. 数据筛选与过滤</h3> 
<p>在数据分析中，经常需要根据特定条件筛选和过滤数据，以便只保留感兴趣的部分。使用 <code>pandas</code> 库，可以进行数据筛选和过滤。以下是一个简单的示例代码，演示如何使用 <code>pandas</code> 进行数据筛选与过滤。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment"># 创建示例数据框架</span>
data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'Product'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Price'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">25.5</span><span class="token punctuation">,</span> <span class="token number">30.2</span><span class="token punctuation">,</span> <span class="token number">15.8</span><span class="token punctuation">,</span> <span class="token number">22.0</span><span class="token punctuation">,</span> <span class="token number">18.5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Quantity'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token comment"># 筛选 Price 大于 20 的数据</span>
filtered_data <span class="token operator">=</span> df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'Price'</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">20</span><span class="token punctuation">]</span>

<span class="token comment"># 打印筛选后的数据框架</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Price 大于 20 的数据："</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>filtered_data<span class="token punctuation">)</span>
</code></pre> 
<p>在这个例子中，使用了条件筛选，保留了 ‘Price’ 列大于 20 的行数据。你可以根据实际需求定义不同的筛选条件，以过滤符合条件的数据。</p> 
<h3><a id="4__74"></a>4. 数据排序</h3> 
<p>在 Excel 中，数据排序是一种常见的操作，可以更好地理解数据的结构和趋势。使用 <code>pandas</code> 库，可以对数据进行排序。以下是一个简单的示例代码，演示如何使用 <code>pandas</code> 对数据进行排序。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment"># 创建示例数据框架</span>
data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'Product'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token string">'D'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Price'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">30.2</span><span class="token punctuation">,</span> <span class="token number">25.5</span><span class="token punctuation">,</span> <span class="token number">15.8</span><span class="token punctuation">,</span> <span class="token number">40.0</span><span class="token punctuation">,</span> <span class="token number">20.5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Quantity'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token comment"># 按 'Product' 列升序排序</span>
df_sorted <span class="token operator">=</span> df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'Product'</span><span class="token punctuation">)</span>

<span class="token comment"># 打印排序后的数据框架</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"按 'Product' 列升序排序："</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_sorted<span class="token punctuation">)</span>
</code></pre> 
<p>在这个例子中，使用 <code>sort_values</code> 函数按 ‘Product’ 列的值进行升序排序。也可以通过指定 <code>ascending=False</code> 参数来实现降序排序。这种排序方式使可以更容易地观察数据的特征和趋势。</p> 
<h3><a id="5__100"></a>5. 数据统计与汇总</h3> 
<p>通过<code>pandas</code>的统计函数，可以快速了解数据的统计信息，如均值、中位数等。</p> 
<p>假设有一个包含销售数据的数据框架<code>sales_data</code>，其中包括产品销售额(<code>sales_amount</code>)、销售数量(<code>quantity</code>)和单价(<code>unit_price</code>)等列。我们将使用这个数据框架来演示如何进行全面的数据统计与汇总。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment"># 假设我们有一个包含销售数据的数据框架</span>
data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'Product'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Sales_Amount'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">130</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Quantity'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Unit_Price'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

sales_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token comment"># 打印原始数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"原始数据："</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sales_data<span class="token punctuation">)</span>

<span class="token comment"># 统计与汇总</span>
mean_sales_amount <span class="token operator">=</span> sales_data<span class="token punctuation">[</span><span class="token string">'Sales_Amount'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
median_quantity <span class="token operator">=</span> sales_data<span class="token punctuation">[</span><span class="token string">'Quantity'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>median<span class="token punctuation">(</span><span class="token punctuation">)</span>
mode_product <span class="token operator">=</span> sales_data<span class="token punctuation">[</span><span class="token string">'Product'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
std_unit_price <span class="token operator">=</span> sales_data<span class="token punctuation">[</span><span class="token string">'Unit_Price'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span>
min_sales_amount <span class="token operator">=</span> sales_data<span class="token punctuation">[</span><span class="token string">'Sales_Amount'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
max_quantity <span class="token operator">=</span> sales_data<span class="token punctuation">[</span><span class="token string">'Quantity'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 打印统计结果</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n统计与汇总结果："</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"平均销售额：</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>mean_sales_amount<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"销售数量中位数：</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>median_quantity<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"产品销售频率最高的是：</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>mode_product<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"单价标准差：</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>std_unit_price<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"最小销售额：</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>min_sales_amount<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"最大销售数量：</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>max_quantity<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
</code></pre> 
<p>这个例子中，使用了均值、中位数、众数、标准差、最小值和最大值等统计方法来全面了解销售数据的特征。通过运用这些统计函数，可以更好地理解数据的分布、趋势和离散程度，为进一步的数据分析和决策提供了基础。</p> 
<h3><a id="6__143"></a>6. 单元格格式设置</h3> 
<p>在处理 Excel 数据时，自定义单元格格式是提高数据可读性和呈现效果的关键步骤。使用 <code>openpyxl</code> 库，可以轻松地对 Excel 单元格进行格式设置。下面是一些常见的单元格格式设置的例子。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> openpyxl <span class="token keyword">import</span> Workbook
<span class="token keyword">from</span> openpyxl<span class="token punctuation">.</span>styles <span class="token keyword">import</span> Font<span class="token punctuation">,</span> Alignment<span class="token punctuation">,</span> PatternFill

<span class="token comment"># 创建一个工作簿和工作表</span>
workbook <span class="token operator">=</span> Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>
sheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span>active

<span class="token comment"># 示例数据</span>
data <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">"Product"</span><span class="token punctuation">,</span> <span class="token string">"Price"</span><span class="token punctuation">,</span> <span class="token string">"Quantity"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">"A"</span><span class="token punctuation">,</span> <span class="token number">25.5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token number">30.2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token number">15.8</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token comment"># 将数据写入工作表</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> data<span class="token punctuation">:</span>
    sheet<span class="token punctuation">.</span>append<span class="token punctuation">(</span>row<span class="token punctuation">)</span>

<span class="token comment"># 单元格格式设置</span>
<span class="token comment"># 设置标题行的字体为粗体、字号14、颜色为蓝色</span>
sheet<span class="token punctuation">[</span><span class="token string">'A1'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>font <span class="token operator">=</span> Font<span class="token punctuation">(</span>bold<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">"0000FF"</span><span class="token punctuation">)</span>

<span class="token comment"># 设置数据区域的对齐方式为居中</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> sheet<span class="token punctuation">.</span>iter_rows<span class="token punctuation">(</span>min_row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> max_row<span class="token operator">=</span>sheet<span class="token punctuation">.</span>max_row<span class="token punctuation">,</span> min_col<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> max_col<span class="token operator">=</span>sheet<span class="token punctuation">.</span>max_column<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> cell <span class="token keyword">in</span> row<span class="token punctuation">:</span>
        cell<span class="token punctuation">.</span>alignment <span class="token operator">=</span> Alignment<span class="token punctuation">(</span>horizontal<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">,</span> vertical<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">)</span>

<span class="token comment"># 设置价格列的数值格式为货币格式</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> sheet<span class="token punctuation">.</span>iter_rows<span class="token punctuation">(</span>min_row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> max_row<span class="token operator">=</span>sheet<span class="token punctuation">.</span>max_row<span class="token punctuation">,</span> min_col<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> max_col<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> cell <span class="token keyword">in</span> row<span class="token punctuation">:</span>
        cell<span class="token punctuation">.</span>number_format <span class="token operator">=</span> <span class="token string">'"$"#,##0.00'</span>

<span class="token comment"># 设置数量列的背景颜色为浅黄色</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> sheet<span class="token punctuation">.</span>iter_rows<span class="token punctuation">(</span>min_row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> max_row<span class="token operator">=</span>sheet<span class="token punctuation">.</span>max_row<span class="token punctuation">,</span> min_col<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> max_col<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> cell <span class="token keyword">in</span> row<span class="token punctuation">:</span>
        cell<span class="token punctuation">.</span>fill <span class="token operator">=</span> PatternFill<span class="token punctuation">(</span>start_color<span class="token operator">=</span><span class="token string">"FFFF99"</span><span class="token punctuation">,</span> end_color<span class="token operator">=</span><span class="token string">"FFFF99"</span><span class="token punctuation">,</span> fill_type<span class="token operator">=</span><span class="token string">"solid"</span><span class="token punctuation">)</span>

<span class="token comment"># 保存工作簿</span>
workbook<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"formatted_excel.xlsx"</span><span class="token punctuation">)</span>
</code></pre> 
<p>在这个例子中，通过 <code>Font</code>、<code>Alignment</code> 和 <code>PatternFill</code> 类来设置单元格的字体、对齐方式和背景颜色。这种格式设置使得 Excel 表格更加美观、易读，有助于突出数据的重要性和结构。可以根据实际需求调整这些设置，以满足特定的数据展示要求。</p> 
<h3><a id="7__191"></a>7. 插入行与列</h3> 
<p>在处理 Excel 数据时，插入新的行和列是保持数据整洁和有序的关键步骤。使用 <code>openpyxl</code> 库，可以轻松地在 Excel 表格中插入新的行和列。以下是一些插入行和列的示例代码。</p> 
<h4><a id="_195"></a>插入新的行</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> openpyxl <span class="token keyword">import</span> Workbook

<span class="token comment"># 创建一个工作簿和工作表</span>
workbook <span class="token operator">=</span> Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>
sheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span>active

<span class="token comment"># 原始数据</span>
data <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">"Name"</span><span class="token punctuation">,</span> <span class="token string">"Age"</span><span class="token punctuation">,</span> <span class="token string">"Country"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">"Alice"</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token string">"USA"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">"Canada"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token comment"># 将数据写入工作表</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> data<span class="token punctuation">:</span>
    sheet<span class="token punctuation">.</span>append<span class="token punctuation">(</span>row<span class="token punctuation">)</span>

<span class="token comment"># 打印原始数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"原始数据："</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> sheet<span class="token punctuation">.</span>iter_rows<span class="token punctuation">(</span>values_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>

<span class="token comment"># 插入新的行（在第二行之后插入）</span>
new_row_data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Charlie"</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token string">"UK"</span><span class="token punctuation">]</span>
sheet<span class="token punctuation">.</span>insert_rows<span class="token punctuation">(</span>new_row_data<span class="token punctuation">,</span> row_idx<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># 打印插入新行后的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n插入新行后的数据："</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> sheet<span class="token punctuation">.</span>iter_rows<span class="token punctuation">(</span>values_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>

<span class="token comment"># 保存工作簿</span>
workbook<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"inserted_row.xlsx"</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="_233"></a>插入新的列</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> openpyxl <span class="token keyword">import</span> Workbook

<span class="token comment"># 创建一个工作簿和工作表</span>
workbook <span class="token operator">=</span> Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>
sheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span>active

<span class="token comment"># 原始数据</span>
data <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">"Name"</span><span class="token punctuation">,</span> <span class="token string">"Age"</span><span class="token punctuation">,</span> <span class="token string">"Country"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">"Alice"</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token string">"USA"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">"Canada"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token comment"># 将数据写入工作表</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> data<span class="token punctuation">:</span>
    sheet<span class="token punctuation">.</span>append<span class="token punctuation">(</span>row<span class="token punctuation">)</span>

<span class="token comment"># 打印原始数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"原始数据："</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> sheet<span class="token punctuation">.</span>iter_rows<span class="token punctuation">(</span>values_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>

<span class="token comment"># 插入新的列（在第二列之后插入）</span>
new_column_data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Female"</span><span class="token punctuation">,</span> <span class="token string">"Male"</span><span class="token punctuation">,</span> <span class="token string">"Female"</span><span class="token punctuation">]</span>
sheet<span class="token punctuation">.</span>insert_cols<span class="token punctuation">(</span>values<span class="token operator">=</span>new_column_data<span class="token punctuation">,</span> col_idx<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># 打印插入新列后的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n插入新列后的数据："</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> sheet<span class="token punctuation">.</span>iter_rows<span class="token punctuation">(</span>values_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>

<span class="token comment"># 保存工作簿</span>
workbook<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"inserted_column.xlsx"</span><span class="token punctuation">)</span>
</code></pre> 
<p>这些示例代码演示了如何使用 <code>insert_rows</code> 和 <code>insert_cols</code> 方法在 Excel 表格中插入新的行和列。</p> 
<h3><a id="8__273"></a>8. 合并单元格</h3> 
<p>在 Excel 中，合并单元格是一种常用的操作，用于创建更复杂的表格结构或突出某些信息。使用 <code>openpyxl</code> 库，可以实现合并和取消合并单元格的操作。以下是一些合并单元格的示例代码。</p> 
<h4><a id="_277"></a>合并单元格</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> openpyxl <span class="token keyword">import</span> Workbook

<span class="token comment"># 创建一个工作簿和工作表</span>
workbook <span class="token operator">=</span> Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>
sheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span>active

<span class="token comment"># 原始数据</span>
data <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">"Name"</span><span class="token punctuation">,</span> <span class="token string">"Age"</span><span class="token punctuation">,</span> <span class="token string">"Country"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">"Alice"</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token string">"USA"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">"Canada"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token comment"># 将数据写入工作表</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> data<span class="token punctuation">:</span>
    sheet<span class="token punctuation">.</span>append<span class="token punctuation">(</span>row<span class="token punctuation">)</span>

<span class="token comment"># 合并 A1 到 C1 的单元格</span>
sheet<span class="token punctuation">.</span>merge_cells<span class="token punctuation">(</span><span class="token string">'A1:C1'</span><span class="token punctuation">)</span>

<span class="token comment"># 在合并的单元格中写入标题</span>
sheet<span class="token punctuation">[</span><span class="token string">'A1'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Personal Information'</span>

<span class="token comment"># 保存工作簿</span>
workbook<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"merged_cells.xlsx"</span><span class="token punctuation">)</span>
</code></pre> 
<h4><a id="_307"></a>取消合并单元格</h4> 
<pre><code class="prism language-python"><span class="token keyword">from</span> openpyxl <span class="token keyword">import</span> load_workbook

<span class="token comment"># 加载已存在的工作簿</span>
workbook <span class="token operator">=</span> load_workbook<span class="token punctuation">(</span><span class="token string">"merged_cells.xlsx"</span><span class="token punctuation">)</span>
sheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span>active

<span class="token comment"># 取消合并 A1 到 C1 的单元格</span>
sheet<span class="token punctuation">.</span>unmerge_cells<span class="token punctuation">(</span><span class="token string">'A1:C1'</span><span class="token punctuation">)</span>

<span class="token comment"># 保存工作簿</span>
workbook<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"unmerged_cells.xlsx"</span><span class="token punctuation">)</span>
</code></pre> 
<p>在这个示例中，首先合并了 A1 到 C1 的单元格，创建了一个包含标题的大标题单元格。然后，演示了如何取消合并这些单元格。这种操作使得表格的布局更加灵活，可以根据实际需要进行定制。</p> 
<h3><a id="9__324"></a>9. 公式计算</h3> 
<p>在 Excel 中添加公式是一种常见的操作，可以实现自动计算，并随着数据的更新而动态调整。使用 <code>openpyxl</code> 库，可以轻松地在 Excel 中插入公式。以下是一个添加公式的示例代码。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> openpyxl <span class="token keyword">import</span> Workbook

<span class="token comment"># 创建一个工作簿和工作表</span>
workbook <span class="token operator">=</span> Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>
sheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span>active

<span class="token comment"># 原始数据</span>
data <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">"Product"</span><span class="token punctuation">,</span> <span class="token string">"Price"</span><span class="token punctuation">,</span> <span class="token string">"Quantity"</span><span class="token punctuation">,</span> <span class="token string">"Total"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">"A"</span><span class="token punctuation">,</span> <span class="token number">25.5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token number">30.2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token comment"># 将数据写入工作表</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> data<span class="token punctuation">:</span>
    sheet<span class="token punctuation">.</span>append<span class="token punctuation">(</span>row<span class="token punctuation">)</span>

<span class="token comment"># 添加公式计算 Total 列，Total = Price * Quantity</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> sheet<span class="token punctuation">.</span>max_row <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    sheet<span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f'D</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>row<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f'B</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>row<span class="token punctuation">}</span></span><span class="token string"> * C</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>row<span class="token punctuation">}</span></span><span class="token string">'</span></span>

<span class="token comment"># 保存工作簿</span>
workbook<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"formulas.xlsx"</span><span class="token punctuation">)</span>
</code></pre> 
<p>在这个例子中，通过循环遍历数据行，使用 Excel 公式 <code>B(row) * C(row)</code> 来计算 Total 列的值。这样，无论数据如何变化，Total 列都会自动更新。这种功能使得在 Excel 中进行复杂的数据计算变得更加方便和灵活。</p> 
<h3><a id="10__356"></a>10. 图表绘制</h3> 
<p>在 Excel 中插入图表是一种直观且生动的方式，可以更清晰地展示数据的趋势和关系。使用 <code>openpyxl</code> 和 <code>matplotlib</code> 库，可以将数据可视化为图表，并插入到 Excel 工作表中。以下是一个插入柱状图的示例代码。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> openpyxl <span class="token keyword">import</span> Workbook
<span class="token keyword">from</span> openpyxl<span class="token punctuation">.</span>chart <span class="token keyword">import</span> BarChart<span class="token punctuation">,</span> Reference
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> io <span class="token keyword">import</span> BytesIO

<span class="token comment"># 创建一个工作簿和工作表</span>
workbook <span class="token operator">=</span> Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>
sheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span>active

<span class="token comment"># 原始数据</span>
data <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">"Category"</span><span class="token punctuation">,</span> <span class="token string">"Value"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">"A"</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">"C"</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token comment"># 将数据写入工作表</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> data<span class="token punctuation">:</span>
    sheet<span class="token punctuation">.</span>append<span class="token punctuation">(</span>row<span class="token punctuation">)</span>

<span class="token comment"># 创建柱状图</span>
chart <span class="token operator">=</span> BarChart<span class="token punctuation">(</span><span class="token punctuation">)</span>
chart<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">"Category vs Value"</span>
chart<span class="token punctuation">.</span>x_axis<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">"Category"</span>
chart<span class="token punctuation">.</span>y_axis<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">"Value"</span>

<span class="token comment"># 数据范围</span>
data_range <span class="token operator">=</span> Reference<span class="token punctuation">(</span>sheet<span class="token punctuation">,</span> min_col<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> min_row<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> max_col<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> max_row<span class="token operator">=</span>sheet<span class="token punctuation">.</span>max_row<span class="token punctuation">)</span>

<span class="token comment"># 设置图表数据</span>
chart<span class="token punctuation">.</span>add_data<span class="token punctuation">(</span>data_range<span class="token punctuation">,</span> titles_from_data<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># 将图表插入到工作表中</span>
sheet<span class="token punctuation">.</span>add_chart<span class="token punctuation">(</span>chart<span class="token punctuation">,</span> <span class="token string">"D2"</span><span class="token punctuation">)</span>

<span class="token comment"># 保存工作簿</span>
workbook<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"chart_example.xlsx"</span><span class="token punctuation">)</span>
</code></pre> 
<p>在这个示例中，创建了一个包含柱状图的 Excel 工作表。首先，使用 <code>BarChart</code> 创建一个柱状图对象，然后设置图表的标题、X轴标题和Y轴标题。接着，通过 <code>Reference</code> 定义数据范围，并使用 <code>add_data</code> 将数据添加到图表中。最后，使用 <code>add_chart</code> 将图表插入到工作表中。这样，就能够在 Excel 中通过图表直观地展示数据的分布和关系。</p> 
<h3><a id="11__403"></a>11. 数据透视表</h3> 
<p>数据透视表是一种强大的数据分析工具，可以帮助我们快速透视和汇总数据。使用 <code>pandas</code> 的 <code>pivot_table</code> 函数，可以在 Python 中轻松创建数据透视表。以下是一个简单的示例代码。</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment"># 创建示例数据框架</span>
data <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string">'Category'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Value'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">'Quantity'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token comment"># 创建数据透视表</span>
pivot_table <span class="token operator">=</span> pd<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>df<span class="token punctuation">,</span> values<span class="token operator">=</span><span class="token string">'Value'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token string">'Category'</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token string">'Quantity'</span><span class="token punctuation">,</span> aggfunc<span class="token operator">=</span><span class="token string">'sum'</span><span class="token punctuation">,</span> fill_value<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token comment"># 打印数据透视表</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"数据透视表："</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>pivot_table<span class="token punctuation">)</span>
</code></pre> 
<p>在这个例子中，我们使用 <code>pivot_table</code> 函数根据 ‘Category’ 和 ‘Quantity’ 列创建了一个数据透视表。我们指定了值列为 ‘Value’，使用 ‘sum’ 函数进行汇总，如果某些组合不存在则用 0 填充。最后，打印了生成的数据透视表。</p> 
<h3><a id="12__429"></a>12. 数据验证</h3> 
<p>在 Excel 中设置数据验证规则是一种有效的方式，可以确保用户输入的数据符合预期的范围或格式。使用 <code>openpyxl</code> 库，可以添加数据验证规则。以下是一个简单的示例代码，演示如何在 Excel 中设置数据验证规则。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> openpyxl <span class="token keyword">import</span> Workbook
<span class="token keyword">from</span> openpyxl<span class="token punctuation">.</span>worksheet<span class="token punctuation">.</span>datavalidation <span class="token keyword">import</span> DataValidation

<span class="token comment"># 创建一个工作簿和工作表</span>
workbook <span class="token operator">=</span> Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>
sheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span>active

<span class="token comment"># 原始数据</span>
data <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">"Name"</span><span class="token punctuation">,</span> <span class="token string">"Age"</span><span class="token punctuation">,</span> <span class="token string">"Country"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">"Alice"</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token string">"USA"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">"Bob"</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token string">"Canada"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token comment"># 将数据写入工作表</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> data<span class="token punctuation">:</span>
    sheet<span class="token punctuation">.</span>append<span class="token punctuation">(</span>row<span class="token punctuation">)</span>

<span class="token comment"># 创建数据验证规则（Age 列只允许输入 18 到 60 之间的整数）</span>
dv <span class="token operator">=</span> DataValidation<span class="token punctuation">(</span><span class="token builtin">type</span><span class="token operator">=</span><span class="token string">"whole"</span><span class="token punctuation">,</span> operator<span class="token operator">=</span><span class="token string">"between"</span><span class="token punctuation">,</span> formula1<span class="token operator">=</span><span class="token number">18</span><span class="token punctuation">,</span> formula2<span class="token operator">=</span><span class="token number">60</span><span class="token punctuation">)</span>
dv<span class="token punctuation">.</span>errorTitle <span class="token operator">=</span> <span class="token string">"Invalid Input"</span>
dv<span class="token punctuation">.</span>error <span class="token operator">=</span> <span class="token string">"Age must be between 18 and 60."</span>
dv<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token string">"B2:B1048576"</span><span class="token punctuation">)</span>  <span class="token comment"># 应用规则到整个 B 列</span>

<span class="token comment"># 添加数据验证规则到工作表</span>
sheet<span class="token punctuation">.</span>add_data_validation<span class="token punctuation">(</span>dv<span class="token punctuation">)</span>

<span class="token comment"># 保存工作簿</span>
workbook<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"data_validation_example.xlsx"</span><span class="token punctuation">)</span>
</code></pre> 
<p>在这个例子中，使用 <code>DataValidation</code> 类创建了一个数据验证规则，要求在 ‘B’ 列（Age 列）中输入整数，并且范围必须在 18 到 60 之间。然后，将这个规则应用到整个 ‘B’ 列。这样，用户在输入数据时，将受到相应范围和格式的限制，提高了数据的准确性。</p> 
<h3><a id="13__467"></a>13. 批量操作</h3> 
<p>批量操作是在 Excel 中处理大量数据时提高效率的关键。使用循环和函数，可以对数据进行批量处理。以下是一个简单的示例代码，演示如何使用循环和函数批量操作 Excel 数据。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> openpyxl <span class="token keyword">import</span> Workbook

<span class="token comment"># 创建一个工作簿和工作表</span>
workbook <span class="token operator">=</span> Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>
sheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span>active

<span class="token comment"># 原始数据</span>
data <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">"Product"</span><span class="token punctuation">,</span> <span class="token string">"Price"</span><span class="token punctuation">,</span> <span class="token string">"Quantity"</span><span class="token punctuation">,</span> <span class="token string">"Total"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">"A"</span><span class="token punctuation">,</span> <span class="token number">25.5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token number">30.2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token comment"># 将数据写入工作表</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> data<span class="token punctuation">:</span>
    sheet<span class="token punctuation">.</span>append<span class="token punctuation">(</span>row<span class="token punctuation">)</span>

<span class="token comment"># 批量计算 Total 列的值（Total = Price * Quantity）</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> sheet<span class="token punctuation">.</span>max_row <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    price <span class="token operator">=</span> sheet<span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f'B</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>row<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">]</span><span class="token punctuation">.</span>value
    quantity <span class="token operator">=</span> sheet<span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f'C</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>row<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">]</span><span class="token punctuation">.</span>value
    total <span class="token operator">=</span> price <span class="token operator">*</span> quantity
    sheet<span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f'D</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>row<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> total

<span class="token comment"># 打印批量计算后的数据</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"批量计算后的数据："</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> sheet<span class="token punctuation">.</span>iter_rows<span class="token punctuation">(</span>values_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>

<span class="token comment"># 保存工作簿</span>
workbook<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"batch_operations.xlsx"</span><span class="token punctuation">)</span>
</code></pre> 
<p>在这个例子中，使用循环遍历数据行，并批量计算了 ‘Total’ 列的值。通过使用循环，可以对整个数据集进行高效的操作，而不需要逐个手动处理每一行数据。</p> 
<h3><a id="14__506"></a>14. 错误处理</h3> 
<p>在处理 Excel 数据时，错误是不可避免的。为了提高代码的健壮性，可以使用异常处理机制来处理可能出现的错误。以下是一个简单的示例代码，演示如何使用异常处理来处理 Excel 操作中的错误。</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> openpyxl <span class="token keyword">import</span> Workbook

<span class="token keyword">try</span><span class="token punctuation">:</span>
    <span class="token comment"># 创建一个工作簿和工作表</span>
    workbook <span class="token operator">=</span> Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span>active

    <span class="token comment"># 原始数据</span>
    data <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token punctuation">[</span><span class="token string">"Product"</span><span class="token punctuation">,</span> <span class="token string">"Price"</span><span class="token punctuation">,</span> <span class="token string">"Quantity"</span><span class="token punctuation">,</span> <span class="token string">"Total"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string">"A"</span><span class="token punctuation">,</span> <span class="token number">25.5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token string">"B"</span><span class="token punctuation">,</span> <span class="token number">30.2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>

    <span class="token comment"># 将数据写入工作表</span>
    <span class="token keyword">for</span> row <span class="token keyword">in</span> data<span class="token punctuation">:</span>
        sheet<span class="token punctuation">.</span>append<span class="token punctuation">(</span>row<span class="token punctuation">)</span>

    <span class="token comment"># 尝试计算 Total 列的值，但存在空值导致的错误</span>
    <span class="token keyword">for</span> row <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> sheet<span class="token punctuation">.</span>max_row <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            price <span class="token operator">=</span> sheet<span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f'B</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>row<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">]</span><span class="token punctuation">.</span>value
            quantity <span class="token operator">=</span> sheet<span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f'C</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>row<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">]</span><span class="token punctuation">.</span>value
            total <span class="token operator">=</span> price <span class="token operator">*</span> quantity
            sheet<span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f'D</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>row<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">]</span> <span class="token operator">=</span> total
        <span class="token keyword">except</span> TypeError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Error in row </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>row<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

    <span class="token comment"># 打印处理后的数据</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"处理后的数据："</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> row <span class="token keyword">in</span> sheet<span class="token punctuation">.</span>iter_rows<span class="token punctuation">(</span>values_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>

    <span class="token comment"># 保存工作簿</span>
    workbook<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"error_handling_example.xlsx"</span><span class="token punctuation">)</span>

<span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"An error occurred: </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span>e<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
</code></pre> 
<p>在这个例子中，使用了两层异常处理。外层的异常处理捕获了可能发生的任何异常，而内层的异常处理仅捕获特定的 <code>TypeError</code>，这是由于在计算 ‘Total’ 列时可能遇到的错误类型。</p> 
<h3><a id="_553"></a>总结</h3> 
<p>在这篇博客中，分享了使用 Python 处理 Excel 数据的各种技巧和方法。首先，学习了如何使用 <code>pandas</code> 库读取 Excel 文件，将表格数据转换为数据框架，为后续处理打下了基础。接着，介绍了数据筛选与过滤的方法，利用条件筛选功能，轻松地过滤和保留感兴趣的数据。然后，学习了数据排序的操作，通过 <code>pandas</code> 的排序功能，使数据更具可读性，更容易理解数据的结构和趋势。</p> 
<p>还分享了数据的批量操作，通过循环和函数，高效地对 Excel 数据进行批量处理，提高了代码的复用性和效率。学习了如何利用 <code>pandas</code> 的数据透视表功能，轻松进行数据透视和汇总，以及如何通过数据验证规则提高数据的准确性。</p> 
<p>进一步，了解了如何处理 Excel 中的错误，通过异常处理机制提高代码的健壮性，确保在面对异常情况时程序能够正常执行。最后，学习了如何将处理过的数据写入新的 Excel 文件，为数据的分享和进一步分析提供了便捷的方式。</p> 
<p>通过这些技巧和方法，我们能够在 Python 中更灵活、高效地处理和分析 Excel 数据，为数据科学和数据处理工作提供了丰富的工具和思路。无论是初学者还是有经验的开发者，这些技能都将为处理实际工作中的 Excel 数据提供强大的支持。</p> 
<hr> 
<h2><a id="Python_565"></a>Python学习路线</h2> 
<p><img src="https://images2.imgbox.com/18/26/WEUXv23R_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="_567"></a>更多资料获取</h2> 
<p>📚 个人网站：<a href="http://ipengtao.com/" rel="nofollow">ipengtao.com</a></p> 
<p>如果还想要领取更多更丰富的资料，可以点击文章下方名片，回复【<strong>优质资料</strong>】，即可获取 全方位学习资料包。</p> 
<p><img src="https://images2.imgbox.com/14/be/6DF3mnWh_o.png" alt="在这里插入图片描述"><br> 点击文章下方链接卡片，回复【<strong>优质资料</strong>】，可直接领取资料大礼包。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/052380db598c1523484a1a0ce37cf81e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">头歌实践教学平台Python-Python第七章集合与字典作业</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/aeaafb4375667c2a21d47872b859e89a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">合成孔径雷达(SAR)RD算法点目标成像与分析Matlab仿真</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程学习者.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Django新手必看：如何创建应用和定义数据表。(详细讲解) - 编程学习者</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcxuexizhe.github.io/posts/77a191c7e6a57090c289f5d7f734b4b2/">
  <meta property="og:site_name" content="编程学习者">
  <meta property="og:title" content="Django新手必看：如何创建应用和定义数据表。(详细讲解)">
  <meta property="og:description" content="Django新手必看：如何创建应用和定义数据表。 1. Django创建应用1.1 创建应用1.2 应用的添加 2. Django ORM2.1 定义数据表2.2 定义项目数据表2.3 通用字段选项2.4 外键使用2.5 应用数据库迁移 🏘️🏘️个人简介：以山河作礼。
🎖️🎖️:Python领域新星创作者，CSDN实力新星认证，阿里云社区专家博主 🎁🎁:Web全栈开发专栏：《Web全栈开发》免费专栏，欢迎阅读！
🎁🎁:文章末尾扫描二维码可以加入粉丝交流群，不定期免费送书。
1. Django创建应用 Django 项目就是基于 Django 框架开发的 Web 应用，它包含了一组配置和多个应用，我们把应用称之为App，在前文中对它也做了相应的介绍，比如 auth、admin，它们都属于 APP。一个 App 就是一个 Python 包，通常一个 App 可以包含模型、视图、模板和 URL 配置文件，可以被应用到多个 Django项目中，因为它们的本质就是可被重用的 Python 软件包。 1.1 创建应用 Django 的设计目标是让开发者关注应用的功能逻辑的实现。
所以，创建应用的过程是非常简单的，利用 manage.py 提供的 startapp 命令就可以创建一个APP。
具体命令如下所示：
语法:
python manage.py startapp 应用名
python manage.py startapp index startapp 同样也属于 manage.py 的子命令，用来创建 Django 的应用。 执行这个命令不会在命令行看到任何输出，但是可以在 manage.py 的同级目录下看到多出了一个 index 目录：
我们对这些文件做逐一的解释：">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-06-10T12:14:09+08:00">
    <meta property="article:modified_time" content="2023-06-10T12:14:09+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程学习者" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程学习者</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Django新手必看：如何创建应用和定义数据表。(详细讲解)</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>Django新手必看：如何创建应用和定义数据表。</h4> 
 <ul><li><a href="#1_Django_14" rel="nofollow">1. Django创建应用</a></li><li><ul><li><ul><li><a href="#11__19" rel="nofollow">1.1 创建应用</a></li><li><a href="#12__56" rel="nofollow">1.2 应用的添加</a></li></ul> 
  </li></ul> 
  </li><li><a href="#2_Django_ORM_77" rel="nofollow">2. Django ORM</a></li><li><ul><li><ul><li><a href="#21__84" rel="nofollow">2.1 定义数据表</a></li><li><a href="#22__114" rel="nofollow">2.2 定义项目数据表</a></li><li><a href="#23__160" rel="nofollow">2.3 通用字段选项</a></li><li><a href="#24__211" rel="nofollow">2.4 外键使用</a></li><li><a href="#25__258" rel="nofollow">2.5 应用数据库迁移</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<blockquote> 
 <p>🏘️🏘️个人简介：<a href="https://blog.csdn.net/weixin_50804299?type=blog">以山河作礼</a>。<br> 🎖️🎖️:<font color="Red">Python领域新星创作者，CSDN实力新星认证，阿里云社区专家博主 </font><br> 🎁🎁:Web全栈开发专栏：《<a href="https://blog.csdn.net/weixin_50804299/category_12313749.html">Web全栈开发</a>》免费专栏，欢迎阅读！<br> 🎁🎁:<font color="blue">文章末尾扫描二维码可以加入粉丝交流群，不定期免费送书。</font></p> 
</blockquote> 
<font color="①②③④⑤⑥⑦⑧⑨⑩⑪⑫⑬⑭⑮⑯⑰⑱⑲⑳"> </font> 
<p><font color="LightSkyBlue"> </font><br> <font color="MediumSlateBlue"></font></p> 
<h2><a id="1_Django_14"></a>1. Django创建应用</h2> 
<ul><li>Django 项目就是基于 Django 框架开发的 Web 应用，它包含了一组配置和多个应用，我们把应用称之为App，在前文中对它也做了相应的介绍，比如 auth、admin，它们都属于 APP。</li><li>一个 App 就是一个 Python 包，通常一个 App 可以包含模型、视图、模板和 URL 配置文件，可以被应用到多个 Django项目中，因为它们的本质就是可被重用的 Python 软件包。</li></ul> 
<h4><a id="11__19"></a>1.1 创建应用</h4> 
<p>Django 的设计目标是让开发者关注应用的功能逻辑的实现。</p> 
<p>所以，创建应用的过程是非常简单的，利用 manage.py 提供的 startapp 命令就可以创建一个APP。</p> 
<p><strong>具体命令如下所示：</strong><br> <mark>语法:</mark></p> 
<blockquote> 
 <p><code>python manage.py startapp 应用名</code></p> 
</blockquote> 
<pre><code class="prism language-python">python manage<span class="token punctuation">.</span>py startapp index
</code></pre> 
<ul><li>startapp 同样也属于 manage.py 的子命令，用来创建 Django 的应用。</li></ul> 
<p><strong>执行这个命令不会在命令行看到任何输出，但是可以在 manage.py 的同级目录下看到多出了一个 index 目录：</strong></p> 
<p><img src="https://images2.imgbox.com/6d/e6/Fnt781dm_o.png" alt="在这里插入图片描述"></p> 
<p><strong>我们对这些文件做逐一的解释：</strong></p> 
<ul><li><code>admin.py </code>用于将 Model 定义的数据表注册到管理后台，是 Django Admin 应用的配置文件</li><li><code>apps.py</code> 用于应用程序本身的属性配置文件</li><li><code>models.py</code> 用于定义应用中所需要的数据表</li><li><code>tests.py </code>文件用于编写当前应用程序的单元测试</li><li><code>views.py </code>用来定义视图处理函数的文件</li><li>一级目录下的 <code>__init__.py</code>文件标识 index 应用是一个 Python 包</li><li><code>migrations </code>目录用于存储数据库迁移时生成的文件，该目录下的 <code>__init__.py</code>文件标识 migrations 是一个 Python 包</li></ul> 
<blockquote> 
 <p>这就是 index<br> 应用涉及到的所有文件，当然在实际的开发工作中，该应用目录下的文件也不是一成不变的，开发者根据自己的需要会相应的增加文件或者子目录，比如<br> urls.py 文件或者存储静态文件的 static 目录等。所以大家千万不要认为 Django<br> 框架自动生成的目录，无需我们做其他操作或者更改，这是使用 Django 的一个误区。</p> 
</blockquote> 
<h4><a id="12__56"></a>1.2 应用的添加</h4> 
<blockquote> 
 <p>应用创建完成后，我们还需要在 settings.py 配置文件中对其进行添加。</p> 
</blockquote> 
<p><strong>我们已经对 INSTALLED_APPS 做了介绍，把我们创建的应用添加到这个列表，如下所示：</strong></p> 
<pre><code class="prism language-python">INSTALLED_APPS <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">'django.contrib.admin'</span><span class="token punctuation">,</span>
    <span class="token string">'django.contrib.auth'</span><span class="token punctuation">,</span>
    <span class="token string">'django.contrib.contenttypes'</span><span class="token punctuation">,</span>
    <span class="token string">'django.contrib.sessions'</span><span class="token punctuation">,</span>
    <span class="token string">'django.contrib.messages'</span><span class="token punctuation">,</span>
    <span class="token string">'django.contrib.staticfiles'</span><span class="token punctuation">,</span>
    <span class="token string">'index'</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre> 
<ul><li>用如上方式添加完成后，就可以让 index 应用的和整个项目融为一体了。</li><li>接下来，就可以正式进入开发应用阶段了，通过实现一些小的功能点，让我们更加全面的了解 Django 框架。</li></ul> 
<h2><a id="2_Django_ORM_77"></a>2. Django ORM</h2> 
<ul><li>ORM （Object Realtional Mapping）即对象关系映射，它是一种基于关系型数据库的程序技术。<strong>ORM允许你使用类和对象对数据库进行操作，这大大提高了对数据库的控制，避免了直接使用 SQL语句对数据库进行操作</strong>。这种程序技术的底层主要是通过映射机制实现的，后面会讲解映射的使用！</li><li>Web 开发中对数据库的操作是必不可少的，然而每种数据库的操作方式以及用法不尽相同。由于 Django 中 ORM的存在，为我们操作不同种类的数据库提供了统一的方法，ORM 适配了多种常用的关系型数据库。</li></ul> 
<p><img src="https://images2.imgbox.com/99/eb/9MrrzN8n_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="21__84"></a>2.1 定义数据表</h4> 
<p><strong>在定义数据表之前，我们应该首先理解什么是模型类。</strong></p> 
<ul><li> <p><code>模型类</code></p> <p><mark>其实模型类本质上属于一个 Python 类，只不过在 Django 中称之为做模型类</mark>，它是由 <code>django.db.models.Model </code>派生出的子类</p> <p>通过上述介绍，我们可以这样理解：Django 中模型类就相当于 ORM 模块。</p> </li><li> <p><code>定义数据表</code></p> <p>现在有一张用户信息表 UserInfo，它有两个字段 name 和 password，可以定义如下：</p> <pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>db <span class="token keyword">import</span> models
<span class="token keyword">class</span> <span class="token class-name">UserInfo</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    name <span class="token operator">=</span> models<span class="token punctuation">.</span>CharFiled<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
    password <span class="token operator">=</span> models<span class="token punctuation">.</span>CharFiled<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
</code></pre> </li></ul> 
<p>通过以上代码，UserInfo 数据表就已经创建完成，我们对代码进行逐行解析：</p> 
<ul><li> <p>第 1 行，使用 from django.db import models 导入 models 模块</p> </li><li> <p>第 2 行，使用 class 关键字对 UserInfo 表进行类定义，并继承了models 模块中的 Model 类</p> </li><li> <p>第3、4 行，数据表中的字段 name 和 password 是 UserInfo 类的属性，name 和 password 字段类型都是 CharFiled，字段长度均是100。</p> </li></ul> 
<h4><a id="22__114"></a>2.2 定义项目数据表</h4> 
<p><strong>下面我们用 ORM 定义 index 应用所需的数据表，首选找到 index 应用下的 models.py 文件。</strong></p> 
<p>在文件里添加如下代码：</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>db <span class="token keyword">import</span> models


<span class="token comment"># Create your models here.</span>


<span class="token comment"># 创建book表</span>
<span class="token keyword">class</span> <span class="token class-name">Book</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    title <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span> unique<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">'书名'</span><span class="token punctuation">)</span>
    public <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">'出版社'</span><span class="token punctuation">)</span>
    price <span class="token operator">=</span> models<span class="token punctuation">.</span>DecimalField<span class="token punctuation">(</span>max_digits<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span> decimal_places<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">'定价'</span><span class="token punctuation">)</span>
    retail_price <span class="token operator">=</span> models<span class="token punctuation">.</span>DecimalField<span class="token punctuation">(</span>max_digits<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">,</span> decimal_places<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">'零售价'</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">"30"</span><span class="token punctuation">)</span>


<span class="token comment"># 创建作者表</span>
<span class="token keyword">class</span> <span class="token class-name">Author</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>  
    name <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">'姓名'</span><span class="token punctuation">)</span>
    email <span class="token operator">=</span> models<span class="token punctuation">.</span>EmailField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">'邮箱'</span><span class="token punctuation">)</span>


<span class="token comment"># 创建用户信息表</span>
<span class="token keyword">class</span> <span class="token class-name">UserInfo</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span> 
    username <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">'用户注册'</span><span class="token punctuation">)</span>
    password <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">24</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">'密码'</span><span class="token punctuation">)</span>
</code></pre> 
<ul><li>通过上述代码，我们定义了一个名叫 Book 的数据表。</li><li>数据表由以下字段构成书名（title）、出版社（public）、价格（price）、零售价（retail_price），而且对每个字段都做添加了相应的字段属性以及字段选项。</li></ul> 
<blockquote> 
 <p>为什么表中没有设置主键呢，当定义一个模型类时，Django会自动创建一个主键字段，该字段名为<code>id</code>，类型为<code>AutoField</code>，其自增长。</p> 
</blockquote> 
<p><strong>也可以手动创建</strong></p> 
<pre><code class="prism language-python"><span class="token builtin">id</span> <span class="token operator">=</span> models<span class="token punctuation">.</span>AutoField<span class="token punctuation">(</span>primary_key<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment"># id 会自动创建,可以手动写入</span>
</code></pre> 
<h4><a id="23__160"></a>2.3 通用字段选项</h4> 
<p>Model 中添加的字段都是 Field 类型的实例，不同的 Field 类型可能会支持不同的字段选项，但是也有很多字段选项是通用的，即可以用在任何一种 Field 类型中。这里介绍一些常用且重要的通用字段选项，它们都有对应的默认值，这些字段选项都是可选的，理解这些有助于更好地使用它们。</p> 
<ul><li> <p><code>blank</code></p> <p>默认值是 False，设置为 True 时，字段可以为空。设置为 False 时，字段是必须填写的。如果是字符型字段 CharField 和 TextField，它们是用空字符串来存储空值的。</p> </li><li> <p><code>unique</code></p> <p>默认值是 False，它是一个数据库级别的选项，规定该字段在表中必须是唯一的。</p> </li><li> <p><code>null</code></p> <p>默认为 False，如果此选项为 False 建议加入 default 选项来设置默认值。如果设置为 True，表示该列值允许为空。日期型、时间型以及数字型字段不接受空字符串。所以当设置 IntegerField，DateTimeField 型字段可以为空时，需要将 blank 与 null 均设为 True 才可以。</p> </li><li> <p>`db_index</p> <p>默认值是 False，如果设置为 True，Django 则会为该字段创建数据库索引，如果该字段经常作为查询的条件，那么就需要设置 db_index 选项，从而加快数据的检索速度。</p> </li><li> <p><code>db_column</code></p> <p>这个选项用于设置数据库表字段的名称。如果没有指定，Django 默认使用 Model 中字段的名字。</p> </li><li> <p><code>default</code></p> <p>用于给字段设置默认值，该选项可以设置为一个值或者是可以调用对象，但不能是可变对象，不同字段类型默认值也不同，比如 BooleanFiled 布尔类型 default 值为Ture 或者 False。主要的使用场景是当一个字段的值被用户省略时，后台服务器自动为该字段的设置默认值。</p> </li><li> <p><code>primary_key</code></p> <p>默认值是 False，如果设置为 True，表示该字段为主键，在 Django 中 默认 id 为主键，也就是说即使你的数据表中没有创建 id 字段，Django 也会自动为你创建 id 字段并将其设置为主键。如果你在表中设置了其他字段为主键的时，那么 Django 将取消为 id 字段设置主键。</p> </li><li> <p><code>choices </code><br> 这个选项用于给字段设置可以选择的值。它是一个可迭代对象，即列表或者元组，其中每一个元素都是一个二元组（a，b）的形式，a 是用来选择的对象，b 是对 a 的描述信息。比如我们对某个人性别定义数据表如下所示：</p> <pre><code class="prism language-python"><span class="token comment"># 创建表</span>
<span class="token keyword">class</span> <span class="token class-name">UserInfo</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 定义chocies参数的对应关系，以元组（或者列表）的形式进行表述：</span>
    choices <span class="token operator">=</span> <span class="token punctuation">(</span>
        <span class="token punctuation">(</span>male<span class="token punctuation">,</span> <span class="token string">'男性'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span>female<span class="token punctuation">,</span> <span class="token string">'女性'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    gender <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>choices <span class="token operator">=</span> choices<span class="token punctuation">,</span>default<span class="token operator">=</span><span class="token string">'male'</span><span class="token punctuation">)</span>
</code></pre> </li><li> <p><code>verbose_name</code></p> <p>设置此字段在 admin 后台管理系统界面上的显示名称，<strong>如果没有设置这个字段，Django 将会直接展示字段名并且将字段中的下划线转变为空格</strong>。</p> </li></ul> 
<h4><a id="24__211"></a>2.4 外键使用</h4> 
<p><mark>有一个数据表，就应该对应一个模型 在models.py中定义模型</mark></p> 
<blockquote> 
 <p>引入：from django.db import models</p> 
</blockquote> 
<p><strong>模型类要继承models.Model类</strong></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>db <span class="token keyword">import</span> models

<span class="token comment"># Create your models here.</span>
<span class="token keyword">class</span> <span class="token class-name">Grades</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""班级表"""</span>
    gname <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>  <span class="token comment"># 班级名称</span>
    gdate <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># date</span>
    gtotal <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># total</span>

<span class="token keyword">class</span> <span class="token class-name">Students</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""学生表"""</span>
    sname <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>  <span class="token comment"># name</span>
    sgender <span class="token operator">=</span> models<span class="token punctuation">.</span>BooleanField<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># gender</span>
    sage <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># age</span>
    <span class="token comment"># 关联外键</span>
    sgrade <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>Grades<span class="token punctuation">,</span>models<span class="token punctuation">.</span>DO_NOTHING<span class="token punctuation">)</span>
</code></pre> 
<pre><code class="prism language-python">on_delete<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>  <span class="token comment"># 删除关联表中的数据时,当前表与其关联的field的行为</span>

on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">,</span>     <span class="token comment"># 删除关联数据,与之关联也删除</span>

on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>DO_NOTHING<span class="token punctuation">,</span>  <span class="token comment"># 删除关联数据,什么也不做</span>

on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>PROTECT<span class="token punctuation">,</span>     <span class="token comment"># 删除关联数据,引发错误ProtectedError</span>

\# models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span><span class="token string">'关联表'</span><span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>SET_NULL<span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>SET_NULL<span class="token punctuation">,</span>  <span class="token comment"># 删除关联数据,与之关联的值设置为null（前提FK字段需要设置为可空,一对一同理）</span>

\# models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span><span class="token string">'关联表'</span><span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>SET_DEFAULT<span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">'默认值'</span><span class="token punctuation">)</span>
on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>SET_DEFAULT<span class="token punctuation">,</span> <span class="token comment"># 删除关联数据,与之关联的值设置为默认值（前提FK字段需要设置默认值,一对一同理）</span>
</code></pre> 
<h4><a id="25__258"></a>2.5 应用数据库迁移</h4> 
<blockquote> 
 <p>上面我们创建好了 index应用所需的数据表，下一步就是执行数据库的迁移，之后让我们再来看一下又有什么新的变化发生呢？数据库迁移的两个命令分步骤执行，</p> 
</blockquote> 
<p>如下所示：</p> 
<pre><code class="prism language-shell">$ python manage.py makemigrations
$ python manage.py migrate
</code></pre> 
<p><strong>执行完毕后会在命令行得到如下输出：</strong><br> <img src="https://images2.imgbox.com/cf/74/q5WGZ4OR_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/a8/80/FlCrsDdA_o.png" alt="在这里插入图片描述"></p> 
<p><strong>若迁移过程中出现报错提示，首先检查您的 models.py 文件是否正确书写，除此之外，也可能由于 Django 与 MySQL 版本问题导致报错。</strong></p> 
<ul><li>从上述输出结果可以看出，我们对 index 应用进行了数据库迁移工作。</li><li>并且在数据库中创建了三张表，分别是 Author、Book、UserInfo。</li></ul> 
<p><strong>而且在 index 应用下的 migrations 目录下生还成了一个 0001_initial.py 的文件：</strong></p> 
<p><img src="https://images2.imgbox.com/ec/31/4NBtoBkV_o.png" alt="在这里插入图片描述"></p> 
<p>这个迁移文件包含了创建数据表时用到的所有信息，这是一个临时的过度文件。</p> 
<p><code>makemigrations</code> 和 <code>migrate</code> 是 Django 中的两个命令，用于数据库迁移和同步模型。</p> 
<blockquote> 
 <p><code>makemigrations</code> 命令会基于你的 Django应用中的模型定义，生成一组迁移文件，这些文件描述如何在数据库中创建或修改表结构。在执行 <code>makemigrations</code>命令时，Django 会比较当前模型定义与最近一次迁移所定义的模型之间的差异，并生成一系列 SQL 命令来执行这些更改。</p> 
</blockquote> 
<p>示例命令：</p> 
<pre><code class="prism language-shell">$ python manage.py makemigrations
</code></pre> 
<blockquote> 
 <p><code>migrate</code> 命令用于应用迁移，它会将迁移文件中定义的更改应用到数据库中。执行 <code>migrate</code> 命令时，Django会检查其中的每个迁移，执行其中定义的 SQL 命令，并将这些更改反映到数据库模式中。如果执行成功，你的 Django应用的数据模型就和数据库之间保持同步了。</p> 
</blockquote> 
<p>示例命令：</p> 
<pre><code class="prism language-shell">$ python manage.py migrate
</code></pre> 
<blockquote> 
 <p>总之，<code>makemigrations</code> 命令会生成迁移文件，描述如何在数据库中创建或修改表结构，而 <code>migrate</code>命令会将这些迁移文件应用到数据库中，使数据模型保持和数据库之间的同步。这两个命令通常会在 Django开发过程中被频繁使用，需要对数据库进行修改，增加和删除操作。</p> 
</blockquote> 
<p>              ⭐感谢赞助⭐</p> 
<blockquote> 
 <p><img src="https://images2.imgbox.com/bd/73/1UX4iia4_o.png" alt="在这里插入图片描述"><br> 618，清华社 IT BOOK 多得图书活动开始啦！活动时间为2023年6月7日至6月18日，清华社为您精选多款高分好书，涵盖了C++、Java、Python、前端、后端、数据库、算法与机器学习等多个IT开发领域，适合不同层次的读者。全场5折，扫码领券更有优惠哦！快来京东点击链接IT BOOK多得<a href="https://pro.m.jd.com/mall/active/3Rho97HkMaGFycLzAWfFdvZdyvRn/index.html" rel="nofollow">https://pro.m.jd.com/mall/active/3Rho97HkMaGFycLzAWfFdvZdyvRn/index.html</a></p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b4a5845d49170da798b62a29ec3fb1bb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">学生信息管理系统(数据库)</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/7604b9a9a4a7c05fe690b424d0a0056e/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">微信小程序获取用户手机号码教程（前端＋后端）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程学习者.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
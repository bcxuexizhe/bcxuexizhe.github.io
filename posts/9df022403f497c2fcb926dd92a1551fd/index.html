<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>一文教你在windows上实现ollama&#43;open webui、外网访问本地模型、ollama使用GPU加速 - 编程学习者</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcxuexizhe.github.io/posts/9df022403f497c2fcb926dd92a1551fd/">
  <meta property="og:site_name" content="编程学习者">
  <meta property="og:title" content="一文教你在windows上实现ollama&#43;open webui、外网访问本地模型、ollama使用GPU加速">
  <meta property="og:description" content="前言： ollama工具的出现让大语言模型的部署变得格外的轻松，但是在windows系统部署之后发现无法使用GPU进行加速，通过多方面查找资料发现可以在docker中使用命令启用GPU加速。另外通过Docker也可以快速部署open webui,于是本文基于docker实现ollama模型的部署，以及webui部署。
最终部署成功后可以实现公网访问本地大语言模型功能。
目录： 安装docker
在docker中安装ollama
在docker中安装webui
内网穿透实现公网访问本地大语言模型
环境： 系统：windows10
CPU：i5-9400
GPU：GTX1050ti
内容 安装docker 第一步：启动Hyper-v 如果之前没有安装过docker，需要先进行设置一下。
依次打开 控制面板&gt;程序&gt;程序和功能&gt;启用或关闭windows功能
勾选Hyper-V、虚拟机平台、Linux子系统并点击确认
确认后重启计算机
第二步：安装WSL 打开 powershell，以管理员的身份启动命令窗口
输入
wsl --update 安装
wsl --install 安装成功后重启电脑
第三步：访问Docker官网进行下载 点击下载链接：https://docs.docker.com/desktop/install/windows-install/
下载完成后，双击安装程序进行安装，如果是第一次安装，安装后会提示重启电脑，重启后点击桌面的Docker Desktop图标：选择先不注册直接登录即可。
打开Docker Desktop后，左下角显示是绿色的running就代表我们成功了：
在docker中使用GPU运行ollama 第一步：安装英伟达容器安装包 打开之前安装的ubuntu
依次将一下命令输入ubuntu
配置apt源
curl -fsSL https://nvidia.github.io/libnvidia-container/gpgkey | sudo gpg --dearmor -o /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg \ &amp;&amp; curl -s -L https://nvidia.github.io/libnvidia-container/stable/deb/nvidia-container-toolkit.list | \ sed &#39;s#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g&#39; | \ sudo tee /etc/apt/sources.list.d/nvidia-container-toolkit.list 更新源">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-26T11:49:46+08:00">
    <meta property="article:modified_time" content="2024-04-26T11:49:46+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程学习者" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程学习者</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">一文教你在windows上实现ollama&#43;open webui、外网访问本地模型、ollama使用GPU加速</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p></p> 
<p></p> 
<h2>前言：</h2> 
<p>ollama工具的出现让大语言模型的部署变得格外的轻松，但是在windows系统部署之后发现无法使用GPU进行加速，通过多方面查找资料发现可以在docker中使用命令启用GPU加速。另外通过Docker也可以快速部署open webui,于是本文基于docker实现ollama模型的部署，以及webui部署。</p> 
<p>最终部署成功后可以实现公网访问本地大语言模型功能。</p> 
<h2 style="background-color:transparent;">目录：</h2> 
<p>安装docker</p> 
<p>在docker中安装ollama</p> 
<p>在docker中安装webui</p> 
<p>内网穿透实现公网访问本地大语言模型</p> 
<h2>环境：</h2> 
<p>系统：windows10</p> 
<p>CPU：i5-9400</p> 
<p>GPU：GTX1050ti</p> 
<h2>内容</h2> 
<h3 style="background-color:transparent;">安装docker</h3> 
<h4><strong>第一步：启动Hyper-v</strong></h4> 
<p>如果之前没有安装过docker，需要先进行设置一下。</p> 
<p>依次打开 控制面板&gt;程序&gt;程序和功能&gt;启用或关闭windows功能</p> 
<p><img alt="" height="641" src="https://images2.imgbox.com/43/8a/DpoeucoM_o.png" width="1032"></p> 
<p><strong>勾选Hyper-V、</strong><strong>虚拟机</strong><strong>平台、Linux子系统并点击确认</strong></p> 
<p><img alt="" height="417" src="https://images2.imgbox.com/15/af/GN2Ix7BB_o.png" width="405"></p> 
<p>确认后重启计算机</p> 
<h4><strong>第二步：安装WSL</strong></h4> 
<p>打开 powershell，以管理员的身份启动命令窗口</p> 
<p><img alt="" height="673" src="https://images2.imgbox.com/bd/f4/crsQaCpx_o.png" width="778"></p> 
<p>输入</p> 
<pre><code class="language-javascript">wsl --update</code></pre> 
<p>安装</p> 
<pre><code class="language-javascript">wsl --install</code></pre> 
<p><img alt="" height="312" src="https://images2.imgbox.com/d1/24/82ueV0pe_o.png" width="564"></p> 
<p>安装成功后重启电脑</p> 
<p></p> 
<h4><strong>第三步：访问Docker官网进行下载</strong></h4> 
<p>点击下载链接：https://docs.docker.com/desktop/install/windows-install/</p> 
<p><img alt="" height="541" src="https://images2.imgbox.com/ea/c0/TOQnexrY_o.png" width="762"></p> 
<p>下载完成后，双击安装程序进行安装，如果是第一次安装，安装后会提示重启电脑，重启后点击桌面的Docker Desktop图标：选择先不注册直接登录即可。</p> 
<p></p> 
<p>打开Docker Desktop后，左下角显示是绿色的running就代表我们成功了：</p> 
<p><img alt="" height="720" src="https://images2.imgbox.com/0b/4a/qHeUMRsd_o.png" width="1200"></p> 
<h3>在docker中使用GPU运行ollama</h3> 
<h4>第一步：安装英伟达容器安装包</h4> 
<p>打开之前安装的ubuntu</p> 
<p><img alt="" height="678" src="https://images2.imgbox.com/c5/b7/pmdh7ras_o.png" width="647"></p> 
<p>依次将一下命令输入ubuntu</p> 
<p></p> 
<p>配置apt源</p> 
<pre><code class="language-javascript">curl -fsSL https://nvidia.github.io/libnvidia-container/gpgkey | sudo gpg --dearmor -o /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg \
  &amp;&amp; curl -s -L https://nvidia.github.io/libnvidia-container/stable/deb/nvidia-container-toolkit.list | \
    sed 's#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g' | \
    sudo tee /etc/apt/sources.list.d/nvidia-container-toolkit.list</code></pre> 
<p>更新源</p> 
<pre><code class="language-javascript">sudo apt-get update</code></pre> 
<p>安装工具包</p> 
<pre><code class="language-javascript">sudo apt-get install -y nvidia-container-toolkit</code></pre> 
<h4>第二步：使用GPU运行ollama</h4> 
<pre><code class="language-javascript">docker run --gpus all -d -v /opt/ai/ollama:/root/.ollama -p 11434:11434 --name ollama ollama/ollama</code></pre> 
<h4 style="background-color:transparent;">第三步：使用ollama下载模型</h4> 
<pre><code class="language-java">docker exec -it ollama ollama run qwen:7b</code></pre> 
<p>如果想要下载其他的模型，点击连接：<a href="https://ollama.com/library" rel="nofollow" title="library">library</a>，选择并于同的模型</p> 
<p></p> 
<p><img alt="" height="655" src="https://images2.imgbox.com/6e/59/dNgdJXkc_o.png" width="1158"></p> 
<p>选择不同的模型复制下载命令</p> 
<p><img alt="" height="529" src="https://images2.imgbox.com/16/7c/WjGtlmTY_o.png" width="994"></p> 
<pre><code class="language-javascript">docker exec -it ollama  ollama run llama3</code></pre> 
<h3 style="background-color:transparent;">在docker中安装webui</h3> 
<h4 style="background-color:transparent;"></h4> 
<p>github开源地址：</p> 
<p><a href="https://github.com/open-webui/open-webui" title="https://github.com/open-webui/open-webui">https://github.com/open-webui/open-webui</a></p> 
<p><img alt="" height="356" src="https://images2.imgbox.com/68/e6/Y1AzRG4K_o.png" width="1098">直接复制命令在windows powershell中运行</p> 
<pre><code class="language-javascript">docker run -d -p 3000:8080 --add-host=host.docker.internal:host-gateway -v open-webui:/app/backend/data --name open-webui --restart always ghcr.io/open-webui/open-webui:main</code></pre> 
<p>等待安装完毕<img alt="" height="461" src="https://images2.imgbox.com/aa/a1/WNusiwBd_o.png" width="1200"></p> 
<p>安装完毕后打开docker，点击地址</p> 
<p><img alt="" height="720" src="https://images2.imgbox.com/ee/cf/unfUAnla_o.png" width="1200"></p> 
<p>点击注册管理员账号</p> 
<p><img alt="" height="390" src="https://images2.imgbox.com/46/ea/DOxRYapx_o.png" width="496"></p> 
<p>创建账户后登录</p> 
<p><img alt="" height="491" src="https://images2.imgbox.com/37/66/0g6TwawI_o.png" width="489"></p> 
<h3>内网穿透实现公网访问本地大语言模型</h3> 
<p>第一步：下载cpolar</p> 
<p>cpolar官网地址: <a href="https://cloud.tencent.com/developer/tools/blog-entry?target=https%3A%2F%2Fwww.cpolar.com%2F&amp;source=article&amp;objectId=2410044" rel="nofollow" title="https://www.cpolar.com">https://www.cpolar.com</a></p> 
<p>点击免费注册，注册一个账号</p> 
<p><img alt="" height="625" src="https://images2.imgbox.com/e9/58/e8QiFkj8_o.png" width="1200"></p> 
<p>注册登录后下载cpolar</p> 
<p><img alt="" height="685" src="https://images2.imgbox.com/48/5d/CKaMg5j0_o.png" width="1013"></p> 
<p>安装成功后在浏览器访问<a href="http://localhost:9200" rel="nofollow" title="http://localhost:9200">http://localhost:9200</a> ，使用已经注册好的账号登录<img alt="" height="546" src="https://images2.imgbox.com/8b/f5/Cgqc2Xuo_o.png" width="832"></p> 
<p>点击创建隧道，并配置</p> 
<p><img alt="" height="569" src="https://images2.imgbox.com/b7/61/5JFbIX6T_o.png" width="1200"></p> 
<p></p> 
<p>创建一个 ollama1 的公网http地址隧道：</p> 
<ul><li>隧道名称：ollama（可自定义命名，注意不要与已有的隧道名称重复）</li><li>协议：选择http</li><li>本地地址：3000 (本地访问的地址)</li><li>域名类型：免费选择随机域名</li><li>地区：选择China Top</li></ul> 
<p>创建好后可以选择在线隧道列表，复制公网网址即可实现公网访问本地模型</p> 
<p><img alt="" height="453" src="https://images2.imgbox.com/48/48/kq2lUyeq_o.png" width="1200"></p> 
<h2>本文参考</h2> 
<p><a href="https://cloud.tencent.com/developer/article/2410044" rel="nofollow" title="Windows本地部署Ollama+qwen本地大语言模型Web交互界面并实现公网访问-腾讯云开发者社区-腾讯云">Windows本地部署Ollama+qwen本地大语言模型Web交互界面并实现公网访问-腾讯云开发者社区-腾讯云</a><a href="https://github.com/1Panel-dev/MaxKB/wiki/%E5%A6%82%E4%BD%95%E8%AE%A9Ollama%E4%BD%BF%E7%94%A8GPU%E8%BF%90%E8%A1%8CLLM%E6%A8%A1%E5%9E%8B" title="https://github.com/1Panel-dev/MaxKB/wiki/%E5%A6%82%E4%BD%95%E8%AE%A9Ollama%E4%BD%BF%E7%94%A8GPU%E8%BF%90%E8%A1%8CLLM%E6%A8%A1%E5%9E%8B">https://github.com/1Panel-dev/MaxKB/wiki/%E5%A6%82%E4%BD%95%E8%AE%A9Ollama%E4%BD%BF%E7%94%A8GPU%E8%BF%90%E8%A1%8CLLM%E6%A8%A1%E5%9E%8B</a></p> 
<p><a href="https://blog.csdn.net/qq_60750453/article/details/128636298" title="Windows安装使用Docker，方便你的开发和部署(DockerDesktop篇)_windows安装docker-CSDN博客">Windows安装使用Docker，方便你的开发和部署(DockerDesktop篇)_windows安装docker-CSDN博客</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/dfb711eafcedf5a9048ed1a287004e2e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【JS】前端文件读取FileReader操作总结</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/8fc61c6166626046a1e4a19882e30aa7/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">MySQL 数据库的特点和优势</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程学习者.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
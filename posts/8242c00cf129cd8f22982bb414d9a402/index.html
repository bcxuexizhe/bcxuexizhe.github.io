<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Hadoop 安装及目录结构 - 编程学习者</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcxuexizhe.github.io/posts/8242c00cf129cd8f22982bb414d9a402/">
  <meta property="og:site_name" content="编程学习者">
  <meta property="og:title" content="Hadoop 安装及目录结构">
  <meta property="og:description" content="优质博文IT-BLOG-CN
一、准备工作 【1】创建用户： useradd用户名
【2】配置创建的用户具有root权限，修改/etc/sudoers文件，找到下面一行，在root下面添加一行，如下所示：（注意：需要先给sudoer文件赋权限，修改完会后，将权限修改回来）修改完毕，现在可以用创建的帐号登录，然后用命令su - ，即可获得root权限进行操作。
## Allow root to run any commands anywhere root ALL=(ALL) ALL 创建的用户 ALL=(ALL) ALL 【3】在/opt目录下创建module、software文件夹，同时修改文件的所有者 sudo chmod 777文件地址。
sudo mkdir module sudo mkdir software 二、下载地址 下载地址
解压：tar -zxvf hadoop-2.7.2.tar.gz -C /opt/module/
三、配置环境变量 【1】查看Hadoop解压目录
[zzx@localhost hadoop-2.7.2-src]$ pwd /opt/module/hadoop-2.7.2-src 【2】打开/etc/profile
[zzx@localhost etc]$ sudo vi profile 【3】在文件中添加Hadoop的环境变量
##HADOOP_HOME export HADOOP_HOME=/opt/module/hadoop-2.7.2 export PATH=$PATH:$HADOOP_HOME/bin export PATH=$PATH:$HADOOP_HOME/sbin 【4】重启配置文件，让修改的配置文件生效
[root@localhost etc]# source /etc/profile 【5】测试是否安装成功（如果Hadoop命令不生效就重启试试reboot)
[root@localhost soft]# hadoop version Hadoop 2.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-22T05:00:00+08:00">
    <meta property="article:modified_time" content="2024-05-22T05:00:00+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程学习者" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程学习者</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Hadoop 安装及目录结构</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <blockquote> 
 <p>优质博文<a href="https://it-blog-cn.com/" rel="nofollow">IT-BLOG-CN</a></p> 
</blockquote> 
<h3><a id="_1"></a>一、准备工作</h3> 
<p><strong>【1】创建用户：</strong> <code>useradd</code>用户名<br> 【2】配置创建的用户具有<code>root</code>权限，修改<code>/etc/sudoers</code>文件，找到下面一行，在<code>root</code>下面添加一行，如下所示：（注意：需要先给<code>sudoer</code>文件赋权限，修改完会后，将权限修改回来）修改完毕，现在可以用创建的帐号登录，然后用命令<code>su - </code>，即可获得<code>root</code>权限进行操作。</p> 
<pre><code class="prism language-shell"><span class="token comment">## Allow root to run any commands anywhere</span>
root    <span class="token assign-left variable">ALL</span><span class="token operator">=</span><span class="token punctuation">(</span>ALL<span class="token punctuation">)</span>     ALL
创建的用户 <span class="token assign-left variable">ALL</span><span class="token operator">=</span><span class="token punctuation">(</span>ALL<span class="token punctuation">)</span>     ALL
</code></pre> 
<p>【3】在<code>/opt</code>目录下创建<code>module</code>、<code>software</code>文件夹，同时修改文件的所有者 <code>sudo chmod 777</code>文件地址。</p> 
<pre><code class="prism language-shell"><span class="token function">sudo</span> <span class="token function">mkdir</span> module
<span class="token function">sudo</span> <span class="token function">mkdir</span> software
</code></pre> 
<h3><a id="_14"></a>二、下载地址</h3> 
<p><a href="https://archive.apache.org/dist/hadoop/common/hadoop-2.7.2/" rel="nofollow">下载地址</a><br> 解压：<code>tar -zxvf hadoop-2.7.2.tar.gz -C /opt/module/</code></p> 
<h3><a id="_18"></a>三、配置环境变量</h3> 
<p><strong>【1】查看<code>Hadoop</code>解压目录</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>zzx@localhost hadoop-2.7.2-src<span class="token punctuation">]</span>$ <span class="token builtin class-name">pwd</span>
/opt/module/hadoop-2.7.2-src
</code></pre> 
<p><strong>【2】打开<code>/etc/profile</code></strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>zzx@localhost etc<span class="token punctuation">]</span>$ <span class="token function">sudo</span> <span class="token function">vi</span> profile
</code></pre> 
<p><strong>【3】在文件中添加<code>Hadoop</code>的环境变量</strong></p> 
<pre><code class="prism language-shell"><span class="token comment">##HADOOP_HOME</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HADOOP_HOME</span><span class="token operator">=</span>/opt/module/hadoop-2.7.2
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token environment constant">$PATH</span><span class="token builtin class-name">:</span><span class="token variable">$HADOOP_HOME</span>/bin
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token environment constant">$PATH</span><span class="token builtin class-name">:</span><span class="token variable">$HADOOP_HOME</span>/sbin
</code></pre> 
<p><strong>【4】重启配置文件，让修改的配置文件生效</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost etc<span class="token punctuation">]</span><span class="token comment"># source /etc/profile</span>
</code></pre> 
<p><strong>【5】测试是否安装成功（如果<code>Hadoop</code>命令不生效就重启试试<code>reboot</code>)</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost soft<span class="token punctuation">]</span><span class="token comment"># hadoop version</span>
Hadoop <span class="token number">2.7</span>.2
Subversion https://git-wip-us.apache.org/repos/asf/hadoop.git <span class="token parameter variable">-r</span> b165c4fe8a74265c792ce23f546c64604acf0e41
Compiled by jenkins on <span class="token number">2016</span>-01-26T00:08Z
Compiled with protoc <span class="token number">2.5</span>.0
From <span class="token builtin class-name">source</span> with checksum d0fda26633fa762bff87ec759ebe689c
This <span class="token builtin class-name">command</span> was run using /opt/module/hadoop-2.7.2/share/hadoop/common/hadoop-common-2.7.2.jar
</code></pre> 
<h3><a id="_50"></a>四、可能会遇见的问题</h3> 
<p>【问题描述】<code>Error: JAVA_HOME is not set and could not be found.</code><br> 【解决办法】在安装目录下<code>/etc/hadoop/</code>下，找到<code>hadoop-env.sh</code></p> 
<pre><code class="prism language-shell"><span class="token comment">#将下面的 $JAVA_HOME 修改为绝对路径，下面一行为默认的，错误展示</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">JAVA_HOME</span><span class="token operator">=</span><span class="token variable">$JAVA_HOME</span>   
              
<span class="token comment">#修改后的正确展示 </span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">JAVA_HOME</span><span class="token operator">=</span>/usr/local/soft/jdk8    
</code></pre> 
<h3><a id="Hadoop_61"></a>五、Hadoop目录结构</h3> 
<p><strong>【1】查看<code>Hadoop</code>目录结构</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost hadoop-2.7.2<span class="token punctuation">]</span><span class="token comment"># ll</span>
总用量 <span class="token number">28</span>
drwxr-xr-x. <span class="token number">2</span> <span class="token number">10011</span> <span class="token number">10011</span>   <span class="token number">194</span> <span class="token number">1</span>月  <span class="token number">26</span> <span class="token number">2016</span> bin
drwxr-xr-x. <span class="token number">3</span> <span class="token number">10011</span> <span class="token number">10011</span>    <span class="token number">20</span> <span class="token number">1</span>月  <span class="token number">26</span> <span class="token number">2016</span> etc
drwxr-xr-x. <span class="token number">2</span> <span class="token number">10011</span> <span class="token number">10011</span>   <span class="token number">106</span> <span class="token number">1</span>月  <span class="token number">26</span> <span class="token number">2016</span> include
drwxr-xr-x. <span class="token number">3</span> <span class="token number">10011</span> <span class="token number">10011</span>    <span class="token number">20</span> <span class="token number">1</span>月  <span class="token number">26</span> <span class="token number">2016</span> lib
drwxr-xr-x. <span class="token number">2</span> <span class="token number">10011</span> <span class="token number">10011</span>   <span class="token number">239</span> <span class="token number">1</span>月  <span class="token number">26</span> <span class="token number">2016</span> libexec
-rw-r--r--. <span class="token number">1</span> <span class="token number">10011</span> <span class="token number">10011</span> <span class="token number">15429</span> <span class="token number">1</span>月  <span class="token number">26</span> <span class="token number">2016</span> LICENSE.txt
-rw-r--r--. <span class="token number">1</span> <span class="token number">10011</span> <span class="token number">10011</span>   <span class="token number">101</span> <span class="token number">1</span>月  <span class="token number">26</span> <span class="token number">2016</span> NOTICE.txt
-rw-r--r--. <span class="token number">1</span> <span class="token number">10011</span> <span class="token number">10011</span>  <span class="token number">1366</span> <span class="token number">1</span>月  <span class="token number">26</span> <span class="token number">2016</span> README.txt
drwxr-xr-x. <span class="token number">2</span> <span class="token number">10011</span> <span class="token number">10011</span>  <span class="token number">4096</span> <span class="token number">1</span>月  <span class="token number">26</span> <span class="token number">2016</span> sbin
drwxr-xr-x. <span class="token number">4</span> <span class="token number">10011</span> <span class="token number">10011</span>    <span class="token number">31</span> <span class="token number">1</span>月  <span class="token number">26</span> <span class="token number">2016</span> share
</code></pre> 
<p><strong>【2】重要目录：</strong><br> ◕‿-｡ <strong><code>bin</code>目录：</strong> 存放对<code>Hadoop</code>相关服务（<code>HDFS</code>，<code>YARN</code>）进行操作的脚本，里面常用的就是<code>hadoop</code>这个配置；<br> ｡◕‿◕｡ <strong><code>etc</code>目录：</strong> <code>Hadoop</code>的配置文件目录，存放<code>Hadoop</code>的配置文件。后期会修改大量配置文件；<br> ◕‿-｡ <strong><code>lib</code>目录：</strong> 存放<code>Hadoop</code>的本地库（对数据进行压缩解压缩功能）；<br> ｡◕‿◕｡ <strong><code>sbin</code>目录：</strong> 存放启动或停止<code>Hadoop</code>相关服务的脚本，很重要；<br> ◕‿-｡ <strong><code>share</code>目录：</strong> 存放<code>Hadoop</code>的依赖<code>jar</code>包、文档、和官方案例；</p> 
<h3><a id="_HDFS_MapReduce_85"></a>六、启动 HDFS并运行 MapReduce程序</h3> 
<p><strong>【1】配置：</strong> <code>hadoop-env.sh</code>：在<code>etc/hadoop/hadoop-en.sh</code>修改<code>JAVA_HOME</code>路径为<code>JDK</code>的绝对路径。</p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">export</span> <span class="token assign-left variable">JAVA_HOME</span><span class="token operator">=</span>/usr/local/soft/jdk8
</code></pre> 
<p><img src="https://images2.imgbox.com/30/72/GAwKUan6_o.png" alt="在这里插入图片描述"></p> 
<p><strong>【2】配置：</strong> <code>core-site.xml</code>：<code>hadoop01</code>需要配置<code>hosts</code>映射，存储系统会自动创建</p> 
<pre><code class="prism language-xml"><span class="token comment">&lt;!-- 指定HDFS中NameNode的地址 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>fs.defaultFS<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hdfs://hadoop1:9000<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 指定Hadoop运行时产生文件的存储目录 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hadoop.tmp.dir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/opt/module/hadoop-2.7.2/data/tmp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p><img src="https://images2.imgbox.com/13/31/AeUHzRwL_o.png" alt="在这里插入图片描述"></p> 
<p><strong>【3】配置：</strong> <code>hdfs-site.xml</code>：默认副本数是3个</p> 
<pre><code class="prism language-xml"><span class="token comment">&lt;!-- 指定HDFS副本的数量 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.replication<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p><strong>【4】格式化<code>NameNode</code></strong> （第一次启动时格式化，以后就不要总格式化）</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost hadoop-2.7.2<span class="token punctuation">]</span><span class="token comment"># bin/hdfs namenode -format</span>
</code></pre> 
<p><strong>【5】启动<code>NameNode</code></strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost hadoop-2.7.2<span class="token punctuation">]</span><span class="token comment"># sbin/hadoop-daemon.sh start namenode</span>
</code></pre> 
<p>【问题描述】 可能会出现：<code>Error: Cannot find configuration directory: /etc/hadoop</code><br> 【问题解决】 在<code>hadoop-env.sh</code>修改<code>hadoop</code>配置文件所在目录，并进行重启 <code>source xx</code>。同时，需要删除<code>namenode</code>的<code>data</code>中的数据和<code>logs</code>中的<code>namenode</code>和<code>namedate</code>所有文件。</p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">export</span> <span class="token assign-left variable">HADOOP_CONF_DIR</span><span class="token operator">=</span>/opt/module/hadoop-2.7.2/etc/hadoop/
</code></pre> 
<p><strong>【6】启动<code>DataNode</code></strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost hadoop-2.7.2<span class="token punctuation">]</span><span class="token comment"># sbin/hadoop-daemon.sh start datanode</span>
</code></pre> 
<p>【7】 使用JPS命令查看是否启动成功，JPS 是JDK中的命令，不是Linux命令。不安装JDK不能使用 JPS<br> <img src="https://images2.imgbox.com/69/95/hyhREsft_o.png" alt="在这里插入图片描述"></p> 
<p><strong>【8】web端查看<code>HDFS</code>文件系统（注意需要配置<code>hosts</code>）：</strong> <code>http://hadoop1:50070/dfshealth.html#tab-overview</code><br> <img src="https://images2.imgbox.com/18/64/nyBTFjCy_o.png" alt="在这里插入图片描述"></p> 
<p><strong>【9】查看产生的<code>Log</code>日志：</strong> 在企业中遇到<code>Bug</code>时，经常根据日志提示信息去分析问题、解决<code>Bug</code>。当前目录：<code>/opt/module/hadoop-2.7.2/logs</code></p> 
<p><img src="https://images2.imgbox.com/b9/16/KGTTVuhm_o.png" alt="在这里插入图片描述"></p> 
<p><strong>【10】操作集群：</strong> 在<code>HDFS</code>文件系统上创建一个<code>input</code>文件夹，<code>-P</code>创建多级目录</p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost hadoop-2.7.2<span class="token punctuation">]</span><span class="token comment"># bin/hdfs dfs -mkdir -p /user/zzx/input</span>
</code></pre> 
<p><strong>【11】 将测试文件内容上传到文件系统上：</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost hadoop-2.7.2<span class="token punctuation">]</span><span class="token comment"># bin/hdfs dfs -put input/zzx /user/zzx/input/</span>
</code></pre> 
<p><strong>【12】 查看上传的文件是否正确</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost hadoop-2.7.2<span class="token punctuation">]</span><span class="token comment"># bin/hdfs dfs -ls /user/zzx/input/</span>
Found <span class="token number">1</span> items
-rw-r--r--   <span class="token number">1</span> root supergroup         <span class="token number">74</span> <span class="token number">2020</span>-06-20 <span class="token number">16</span>:44 /user/zzx/input/zzx
</code></pre> 
<p><strong>【13】查看上传的文件是否正确</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost hadoop-2.7.2<span class="token punctuation">]</span><span class="token comment"># bin/hdfs dfs -cat /user/zzx/input/zzx</span>
zzx
jinlong
tangjin
zzx
zzx
jinlong
jian
fanjing
fanjing
fanjing
fanjing
</code></pre> 
<p><strong>【14】运行<code>MapReduce</code>程序，与开始时执行的本地是一致的。</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost hadoop-2.7.2<span class="token punctuation">]</span><span class="token comment"># hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-2.7.2.jar wordcount /user/zzx/input/ /user/zzx/output/</span>
</code></pre> 
<p><strong>【15】查看输出结果，命令行查看</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost hadoop-2.7.2<span class="token punctuation">]</span><span class="token comment"># bin/hdfs dfs -cat /user/zzx/output/*</span>
fanjing    <span class="token number">4</span>
jian    <span class="token number">1</span>
jinlong    <span class="token number">2</span>
tangjin    <span class="token number">1</span>
zzx    <span class="token number">3</span>
</code></pre> 
<p><strong>【16】查看输出结果，浏览器查看：</strong> <code>Utilities-Brower...-user-zzx-output</code></p> 
<p><img src="https://images2.imgbox.com/4d/75/LfIrXT3o_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_YARN_MapReduce_190"></a>七、启动 YARN并运行 MapReduce程序</h3> 
<p><strong>【1】配置<code>yarn-env.sh</code>，配置一下<code>JAVA_HOME</code></strong></p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">export</span> <span class="token assign-left variable">JAVA_HOME</span><span class="token operator">=</span>/usr/local/soft/jdk8
</code></pre> 
<p><strong>【2】配置<code>yarn-site.xml</code></strong></p> 
<pre><code class="prism language-xml"> <span class="token comment">&lt;!-- Reducer获取数据的方式 --&gt;</span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.nodemanager.aux-services<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>mapreduce_shuffle<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
 
 <span class="token comment">&lt;!-- 指定YARN的ResourceManager的地址 --&gt;</span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.resourcemanager.hostname<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hadoop1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p><img src="https://images2.imgbox.com/22/a8/zP9ixfi8_o.png" alt="在这里插入图片描述"></p> 
<p><strong>【3】配置：<code>mapred-env.sh</code>，配置一下<code>JAVA_HOME</code></strong></p> 
<pre><code class="prism language-shell"><span class="token builtin class-name">export</span> <span class="token builtin class-name">export</span> <span class="token assign-left variable">JAVA_HOME</span><span class="token operator">=</span>/usr/local/soft/jdk8
</code></pre> 
<p><strong>【4】 配置： (对<code>mapred-site.xml.template</code>重新命名为) <code>mapred-site.xml</code></strong></p> 
<pre><code class="prism language-shell"><span class="token function">mv</span> mapred-site.xml.template mapred-site.xml
</code></pre> 
<p><strong>【5】配置：<code>mapred-site.xml</code></strong></p> 
<pre><code class="prism language-xml"><span class="token comment">&lt;!-- 指定MR运行在YARN上 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>mapreduce.framework.name<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>yarn<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f1/2f/rQ4po54n_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_230"></a>八、启动集群</h3> 
<p><strong>【1】启动前必须保证<code>NameNode</code>和<code>DataNode</code>已经启动；</strong><br> <strong>【2】启动<code>ResourceManager</code></strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost hadoop-2.7.2<span class="token punctuation">]</span><span class="token comment"># sbin/yarn-daemon.sh start resourcemanager</span>
</code></pre> 
<p><strong>【3】启动<code>NodeManager</code></strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost hadoop-2.7.2<span class="token punctuation">]</span><span class="token comment"># sbin/yarn-daemon.sh start nodemanager</span>
</code></pre> 
<p><strong>【4】<code>YARN</code>的浏览器页面查看：<code>http://hadoop1:8088/cluster</code></strong><br> <img src="https://images2.imgbox.com/52/87/x9yJldk6_o.png" alt="在这里插入图片描述"></p> 
<p><strong>【5】 删除文件系统上的<code>output</code>文件</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost hadoop-2.7.2<span class="token punctuation">]</span><span class="token comment"># bin/hdfs dfs -rm -R /user/zzx/output</span>
<span class="token number">20</span>/06/20 <span class="token number">17</span>:20:20 INFO fs.TrashPolicyDefault: Namenode trash configuration: Deletion interval <span class="token operator">=</span> <span class="token number">0</span> minutes, Emptier interval <span class="token operator">=</span> <span class="token number">0</span> minutes.
Deleted /user/zzx/output
</code></pre> 
<p><strong>【6】执行<code>MapReduce</code>程序</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost hadoop-2.7.2<span class="token punctuation">]</span><span class="token comment"># bin/hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-2.7.2.jar wordcount /user/zzx/input /user/zzx/output</span>
</code></pre> 
<p><strong>【7】查看运行结果，刷新页面即可</strong><br> <img src="https://images2.imgbox.com/a4/15/hTHZxf0X_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_256"></a>九、配置历史服务器</h3> 
<p>为了查看程序的历史运行情况，需要配置一下历史服务器。具体配置步骤如下：<br> <strong>【1】配置<code>mapred-site.xml</code>，在该文件里面增加如下配置。</strong></p> 
<pre><code class="prism language-xml"><span class="token comment">&lt;!-- 历史服务器端地址 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>mapreduce.jobhistory.address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hadoop1:10020<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 历史服务器web端地址 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>mapreduce.jobhistory.webapp.address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hadoop1:19888<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p><strong>【2】启动历史服务器</strong></p> 
<pre><code class="prism language-shell"><span class="token punctuation">[</span>root@localhost hadoop-2.7.2<span class="token punctuation">]</span><span class="token comment"># sbin/mr-jobhistory-daemon.sh start historyserver</span>
</code></pre> 
<p><strong>【3】查看历史服务器是否启动<code>JPS</code></strong><br> <img src="https://images2.imgbox.com/8e/f4/RCzIuJZQ_o.png" alt="在这里插入图片描述"></p> 
<p>【4】查看<code>JobHistory</code>：<code>http://hadoop1:19888/jobhistory</code></p> 
<h3><a id="_280"></a>十、配置日志的聚集</h3> 
<p><strong>日志聚集概念：</strong> 应用运行完成以后，将程序运行日志信息上传到<code>HDFS</code>系统上。<br> <strong>日志聚集功能好处：</strong> 可以方便的查看到程序运行详情，方便开发调试。<br> <strong>注意：</strong> 开启日志聚集功能，需要重新启动<code>NodeManager</code>、<code>ResourceManager</code>和<code>HistoryManager</code>。</p> 
<p><strong>开启日志聚集功能具体步骤如下：</strong><br> <strong>【1】配置<code>yarn-site.xml</code>，在该文件里面增加如下配置</strong></p> 
<pre><code class="prism language-xml"> <span class="token comment">&lt;!-- 日志聚集功能使能 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.log-aggregation-enable<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 日志保留时间设置7天 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.log-aggregation.retain-seconds<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>604800<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p><strong>【2】关闭<code>NodeManager </code>、<code>ResourceManager</code>和<code>HistoryManager</code></strong></p> 
<pre><code class="prism language-c"><span class="token punctuation">[</span>root@localhost hadoop<span class="token operator">-</span><span class="token number">2.7</span><span class="token number">.2</span><span class="token punctuation">]</span># sbin<span class="token operator">/</span>yarn<span class="token operator">-</span>daemon<span class="token punctuation">.</span>sh stop resourcemanager
stopping resourcemanager
<span class="token punctuation">[</span>root@localhost hadoop<span class="token operator">-</span><span class="token number">2.7</span><span class="token number">.2</span><span class="token punctuation">]</span># sbin<span class="token operator">/</span>yarn<span class="token operator">-</span>daemon<span class="token punctuation">.</span>sh stop nodemanager
stopping nodemanager
nodemanager did not stop gracefully after <span class="token number">5</span> seconds<span class="token operator">:</span> killing with kill <span class="token operator">-</span><span class="token number">9</span>
<span class="token punctuation">[</span>root@localhost hadoop<span class="token operator">-</span><span class="token number">2.7</span><span class="token number">.2</span><span class="token punctuation">]</span># sbin<span class="token operator">/</span>mr<span class="token operator">-</span>jobhistory<span class="token operator">-</span>daemon<span class="token punctuation">.</span>sh stop historyserver
stopping historyserver
</code></pre> 
<p><strong>【3】 启动<code>NodeManager</code> 、<code>ResourceManager</code>和<code>HistoryManager</code></strong></p> 
<pre><code class="prism language-c"><span class="token punctuation">[</span>root@localhost hadoop<span class="token operator">-</span><span class="token number">2.7</span><span class="token number">.2</span><span class="token punctuation">]</span># sbin<span class="token operator">/</span>yarn<span class="token operator">-</span>daemon<span class="token punctuation">.</span>sh start resourcemanager
starting resourcemanager<span class="token punctuation">,</span> logging to <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hadoop<span class="token operator">-</span><span class="token number">2.7</span><span class="token number">.2</span><span class="token operator">/</span>logs<span class="token operator">/</span>yarn<span class="token operator">-</span>root<span class="token operator">-</span>resourcemanager<span class="token operator">-</span>localhost<span class="token punctuation">.</span>localdomain<span class="token punctuation">.</span>out
<span class="token punctuation">[</span>root@localhost hadoop<span class="token operator">-</span><span class="token number">2.7</span><span class="token number">.2</span><span class="token punctuation">]</span># sbin<span class="token operator">/</span>yarn<span class="token operator">-</span>daemon<span class="token punctuation">.</span>sh start nodemanager
starting nodemanager<span class="token punctuation">,</span> logging to <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hadoop<span class="token operator">-</span><span class="token number">2.7</span><span class="token number">.2</span><span class="token operator">/</span>logs<span class="token operator">/</span>yarn<span class="token operator">-</span>root<span class="token operator">-</span>nodemanager<span class="token operator">-</span>localhost<span class="token punctuation">.</span>localdomain<span class="token punctuation">.</span>out
<span class="token punctuation">[</span>root@localhost hadoop<span class="token operator">-</span><span class="token number">2.7</span><span class="token number">.2</span><span class="token punctuation">]</span># sbin<span class="token operator">/</span>mr<span class="token operator">-</span>jobhistory<span class="token operator">-</span>daemon<span class="token punctuation">.</span>sh start historyserver
starting historyserver<span class="token punctuation">,</span> logging to <span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hadoop<span class="token operator">-</span><span class="token number">2.7</span><span class="token number">.2</span><span class="token operator">/</span>logs<span class="token operator">/</span>mapred<span class="token operator">-</span>root<span class="token operator">-</span>historyserver<span class="token operator">-</span>localhost<span class="token punctuation">.</span>localdomain<span class="token punctuation">.</span>out
<span class="token punctuation">[</span>root@localhost hadoop<span class="token operator">-</span><span class="token number">2.7</span><span class="token number">.2</span><span class="token punctuation">]</span># jps
<span class="token number">21937</span> ResourceManager
<span class="token number">15458</span> NameNode
<span class="token number">22197</span> NodeManager
<span class="token number">22374</span> JobHistoryServer
<span class="token number">16123</span> DataNode
<span class="token number">22415</span> Jps
</code></pre> 
<p><strong>【4】删除<code>HDFS</code>上已经存在的输出文件</strong></p> 
<pre><code class="prism language-c"><span class="token punctuation">[</span>root@localhost hadoop<span class="token operator">-</span><span class="token number">2.7</span><span class="token number">.2</span><span class="token punctuation">]</span># bin<span class="token operator">/</span>hdfs dfs <span class="token operator">-</span>rm <span class="token operator">-</span>R <span class="token operator">/</span>user<span class="token operator">/</span>zzx<span class="token operator">/</span>output
</code></pre> 
<p><strong>【5】执行<code>WordCount</code>程序</strong></p> 
<pre><code class="prism language-c"><span class="token punctuation">[</span>root@localhost hadoop<span class="token operator">-</span><span class="token number">2.7</span><span class="token number">.2</span><span class="token punctuation">]</span># hadoop jar share<span class="token operator">/</span>hadoop<span class="token operator">/</span>mapreduce<span class="token operator">/</span>hadoop<span class="token operator">-</span>mapreduce<span class="token operator">-</span>examples<span class="token operator">-</span><span class="token number">2.7</span><span class="token number">.2</span><span class="token punctuation">.</span>jar wordcount <span class="token operator">/</span>user<span class="token operator">/</span>zzx<span class="token operator">/</span>input <span class="token operator">/</span>user<span class="token operator">/</span>zzx<span class="token operator">/</span>output
</code></pre> 
<p><strong>【6】查看日志，进入<code>JobHistory</code>点击<code>JobID</code></strong><br> <img src="https://images2.imgbox.com/04/61/BdDcbl5J_o.png" alt="在这里插入图片描述"></p> 
<p><strong>【7】点击<code>logs</code></strong><br> <img src="https://images2.imgbox.com/e8/41/1RSsSqKI_o.png" alt="在这里插入图片描述"></p> 
<p><strong>【8】日志的具体信息</strong><br> <img src="https://images2.imgbox.com/8b/5b/V92eo90d_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_344"></a>十一、配置文件说明</h3> 
<p><code>Hadoop</code>配置文件分两类：默认配置文件和自定义配置文件，只有用户想修改某一默认配置值时，才需要修改自定义配置文件，更改相应属性值。</p> 
<p><strong>【1】默认配置文件：</strong></p> 
<table><thead><tr><th>要获取的默认文件</th><th>文件存放在<code>Hadoop</code>的<code>jar</code>包中的位置</th></tr></thead><tbody><tr><td><code>[core-default.xml]</code></td><td><code>hadoop-common-2.7.2.jar/ core-default.xml</code></td></tr><tr><td><code>[hdfs-default.xml]</code></td><td><code>hadoop-hdfs-2.7.2.jar/ hdfs-default.xml</code></td></tr><tr><td>[<code>yarn-default.xml]</code></td><td><code>hadoop-yarn-common-2.7.2.jar/ yarn-default.xml</code></td></tr><tr><td>[<code>mapred-default.xml]</code></td><td><code>hadoop-mapreduce-client-core-2.7.2.jar/ mapred-default.xml</code></td></tr></tbody></table> 
<p><strong>【2】 自定义配置文件：</strong><code>core-site.xml</code>、<code>hdfs-site.xml</code>、<code>yarn-site.xml</code>、<code>mapred-site.xml</code>四个配置文件存放在<code>$HADOOP_HOME/etc/hadoop</code>这个路径上，用户可以根据项目需求重新进行修改配置。</p> 
<h3><a id="_359"></a>十二、完全分布式运行模式</h3> 
<p>【1】将<code>/etc/profile</code>和<code>/opt/module</code>下的文件拷贝到其它两台服务器上，并进行 <code>source xxx</code>。可以自己去拉<code>hadoop1</code>，<code>hadoop1</code>也可自行给你推，<code>hadoop1</code>也可以将<code>hadoop2</code>中的文件推给<code>hadoop3</code>，当传文件夹的时记得加<code>-r</code>递归复制。</p> 
<pre><code class="prism language-c"><span class="token punctuation">[</span>root@localhost <span class="token operator">~</span><span class="token punctuation">]</span># scp root@<span class="token number">192.168</span><span class="token number">.52</span><span class="token number">.131</span><span class="token operator">:</span><span class="token operator">/</span>etc<span class="token operator">/</span>bash<span class="token punctuation">.</span>bashrc <span class="token operator">/</span>etc<span class="token operator">/</span>bash<span class="token punctuation">.</span>bashrc 
<span class="token punctuation">[</span>root@localhost opt<span class="token punctuation">]</span># scp <span class="token operator">-</span>r root@hadoop1<span class="token operator">:</span><span class="token operator">/</span>opt <span class="token operator">/</span>opt
</code></pre> 
<p><strong>【2】集群部署规划：</strong> 根据这个配置修改上面的伪分布式就可以了</p> 
<table><thead><tr><th></th><th>hadoop1</th><th>hadoop2</th><th>hadoop3</th></tr></thead><tbody><tr><td>HDFS</td><td>NameNode DataNode</td><td>DataNode</td><td>SecondaryNameNode DataNode</td></tr><tr><td>YARN</td><td>NodeManager</td><td>ResourceManager NodeManager</td><td>NodeManager</td></tr></tbody></table> 
<p><strong>【3】<code>hadoop1</code>配置<code>hdfs-site.xml</code></strong></p> 
<pre><code class="prism language-xml"><span class="token comment">&lt;!-- 指定HDFS副本的数量 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.replication<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 指定Hadoop辅助名称节点主机配置 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.namenode.secondary.http-address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hadoop3:50090<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<p><img src="https://images2.imgbox.com/9f/d1/TFA1vZae_o.png" alt="在这里插入图片描述"><br> <strong>【4】配置<code>yarn-site.xml</code></strong></p> 
<pre><code class="prism language-xml"><span class="token comment">&lt;!-- Reducer获取数据的方式 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.nodemanager.aux-services<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>mapreduce_shuffle<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 指定YARN的ResourceManager的地址 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.resourcemanager.hostname<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hadoop2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<blockquote> 
 <p>提前配置<code>SSH</code>免密配置</p> 
</blockquote> 
<h3><a id="_401"></a>十三、群起集群</h3> 
<p><strong>【1】配置<code>slaves</code></strong></p> 
<pre><code class="prism language-c"><span class="token punctuation">[</span>root@hadoop1 hadoop<span class="token operator">-</span><span class="token number">2.7</span><span class="token number">.2</span><span class="token punctuation">]</span># vi etc<span class="token operator">/</span>hadoop<span class="token operator">/</span>slaves 
</code></pre> 
<p>在该文件中增加如下内容： 该文件中添加的内容结尾不允许有空格，文件中不允许有空行。</p> 
<pre><code class="prism language-java">hadoop1
hadoop2
hadoop3
</code></pre> 
<p>同步所有节点配置文件</p> 
<pre><code class="prism language-c"><span class="token punctuation">[</span>root@hadoop1 hadoop<span class="token operator">-</span><span class="token number">2.7</span><span class="token number">.2</span><span class="token punctuation">]</span># xsync etc<span class="token operator">/</span>hadoop<span class="token operator">/</span>slaves
</code></pre> 
<p><strong>【2】启动集群：</strong> 如果集群是第一次启动，需要格式化<code>NameNode</code>（注意格式化之前，一定要先停止上次启动的所有<code>namenode</code>和<code>datanode</code>进程，然后再删除<code>data</code>和<code>log</code>数据）</p> 
<pre><code class="prism language-c"><span class="token punctuation">[</span>root@hadoop1 hadoop<span class="token operator">-</span><span class="token number">2.7</span><span class="token number">.2</span><span class="token punctuation">]</span># bin<span class="token operator">/</span>hdfs namenode <span class="token operator">-</span>format
</code></pre> 
<p><strong>【3】启动<code>HDFS</code></strong>（前提：终止之前运行namenode 等）</p> 
<pre><code class="prism language-c"><span class="token punctuation">[</span>root@hadoop1 hadoop<span class="token operator">-</span><span class="token number">2.7</span><span class="token number">.2</span><span class="token punctuation">]</span># sbin<span class="token operator">/</span>start<span class="token operator">-</span>dfs<span class="token punctuation">.</span>sh 
</code></pre> 
<p>启动完成之后，<code>Hadoop1</code>会启动<code>NameNode</code>和<code>DataNode</code>，其他两台只会启动 <code>DataNode</code><br> <strong>【4】在<code>Hadoop2</code>中启动<code>YARN</code></strong>。注意：<code>NameNode</code>和<code>ResourceManger</code>如果不是同一台机器，不能在<code>NameNode</code>上启动<code>YARN</code>，应该在 <code>ResouceManager</code>所在的机器上启动<code>YARN</code>。</p> 
<pre><code class="prism language-c"><span class="token punctuation">[</span>root@hadoop2 hadoop<span class="token operator">-</span><span class="token number">2.7</span><span class="token number">.2</span><span class="token punctuation">]</span># sbin<span class="token operator">/</span>start<span class="token operator">-</span>yarn<span class="token punctuation">.</span>sh 
</code></pre> 
<p>【5】查看<code>SecondaryNameNode</code>信息：<code>http://hadoop3:50090/status.html</code><br> <img src="https://images2.imgbox.com/2f/4a/97UcLQ03_o.png" alt="在这里插入图片描述"></p> 
<p><strong>【6】<code>NameNode</code>测试，创建<code>/user/zzx/input</code>并上传文件</strong></p> 
<pre><code class="prism language-c"><span class="token punctuation">[</span>root@hadoop1 hadoop<span class="token operator">-</span><span class="token number">2.7</span><span class="token number">.2</span><span class="token punctuation">]</span># bin<span class="token operator">/</span>hdfs dfs <span class="token operator">-</span>mkdir <span class="token operator">-</span>p <span class="token operator">/</span>user<span class="token operator">/</span>zzx<span class="token operator">/</span>input
<span class="token punctuation">[</span>root@hadoop1 hadoop<span class="token operator">-</span><span class="token number">2.7</span><span class="token number">.2</span><span class="token punctuation">]</span># bin<span class="token operator">/</span>hdfs dfs <span class="token operator">-</span>put input<span class="token operator">/</span>zzx <span class="token operator">/</span>user<span class="token operator">/</span>zzx<span class="token operator">/</span>input
</code></pre> 
<p>【7】上传文件后查看文件存放在什么位置：查看<code>HDFS</code>文件存储路径</p> 
<pre><code class="prism language-c"><span class="token punctuation">[</span>root@hadoop1 subdir0<span class="token punctuation">]</span># ll
总用量 <span class="token number">8</span>
<span class="token operator">-</span>rw<span class="token operator">-</span>r<span class="token operator">--</span>r<span class="token operator">--</span><span class="token punctuation">.</span> <span class="token number">1</span> root root <span class="token number">74</span> <span class="token number">6</span>月  <span class="token number">21</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">19</span> blk_1073741825
<span class="token operator">-</span>rw<span class="token operator">-</span>r<span class="token operator">--</span>r<span class="token operator">--</span><span class="token punctuation">.</span> <span class="token number">1</span> root root <span class="token number">11</span> <span class="token number">6</span>月  <span class="token number">21</span> <span class="token number">19</span><span class="token operator">:</span><span class="token number">19</span> blk_1073741825_1001<span class="token punctuation">.</span>meta
<span class="token punctuation">[</span>root@hadoop1 subdir0<span class="token punctuation">]</span># pwd
<span class="token operator">/</span>opt<span class="token operator">/</span>module<span class="token operator">/</span>hadoop<span class="token operator">-</span><span class="token number">2.7</span><span class="token number">.2</span><span class="token operator">/</span>data<span class="token operator">/</span>tmp<span class="token operator">/</span>dfs<span class="token operator">/</span>data<span class="token operator">/</span>current<span class="token operator">/</span>BP<span class="token operator">-</span><span class="token number">1538823143</span><span class="token operator">-</span><span class="token number">192.168</span><span class="token number">.52</span><span class="token number">.131</span><span class="token operator">-</span><span class="token number">1592727848753</span><span class="token operator">/</span>current<span class="token operator">/</span>finalized<span class="token operator">/</span>subdir0<span class="token operator">/</span>subdir0
</code></pre> 
<h3><a id="_448"></a>十四、集群启动/停止方式总结</h3> 
<p><strong>【1】 各个服务组件逐一启动/停止</strong></p> 
<pre><code class="prism language-c">#分别启动<span class="token operator">/</span>停止HDFS组件
hadoop<span class="token operator">-</span>daemon<span class="token punctuation">.</span>sh  start<span class="token operator">/</span>stop  namenode<span class="token operator">/</span>datanode<span class="token operator">/</span>secondarynamenode
#启动<span class="token operator">/</span>停止YARN
yarn<span class="token operator">-</span>daemon<span class="token punctuation">.</span>sh  start<span class="token operator">/</span>stop  resourcemanager<span class="token operator">/</span>nodemanager
</code></pre> 
<p><strong>【2】各个模块分开启动/停止（配置<code>ssh</code>是前提）</strong></p> 
<pre><code class="prism language-shell"><span class="token comment">#整体启动/停止HDFS</span>
start-dfs.sh/stop-dfs.sh
<span class="token comment">#整体启动/停止YARN</span>
start-yarn.sh/stop-yarn.sh
</code></pre> 
<h3><a id="__464"></a>十五 扩展</h3> 
<p>如果装的是<code>3.x.x</code>的<code>Hadoop</code>改了挺多东西的。<br> 管理页面端口变动，<code>Hadoop NameNode</code>管理页面默认端口为<code>9870</code><br> 集群配置变动，<code>etc/hadoop/slaves</code>改成了<code>etc/hadoop/workers</code><br> 启动命令变动，<code>sbin/yarn-daemon.sh start resourcemanager</code>这种也能用，但是启动时会标记已被弃用，变成<code>yarn -daemon start resourcemanger</code>类似这种命令</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4be6d3184867faf82ea43b4927281926/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">使用api和rpc的一个综合使用</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/9453df5d4439d741a80500d322087f85/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【C语言】C语言零基础纯干货教学（下）</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程学习者.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
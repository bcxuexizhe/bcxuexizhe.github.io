<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【Python脚本】Python自动大麦网抢票，准点原价秒杀演唱会门票，拒绝黄牛交易！从我做起！！！ - 编程学习者</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcxuexizhe.github.io/posts/6cc29e1e2b967f5078755d3d5b350a23/">
  <meta property="og:site_name" content="编程学习者">
  <meta property="og:title" content="【Python脚本】Python自动大麦网抢票，准点原价秒杀演唱会门票，拒绝黄牛交易！从我做起！！！">
  <meta property="og:description" content="为了帮助大家在激烈的抢票竞争中获得更大的成功机会，本文将介绍抢票软件的实现原理以及我所了解的一些抢票方式。
但是，请不要过度将希望寄托于抢票软件，它有时也不灵，经过我的验证，即使你用到了抢票软件，也不一定能抢到票。
票务平台会经常调整反爬策略打击爬虫行为，如果希望抢票软件保持较高的成功率，是需要开发者针对票务平台的打击策略作出逻辑调整，这个成本是很高的，所以你能随手获得的抢票软件很大概率是抢不到票的或者说是不安全的。
在调研过程发现一个有意思的点 “黄牛的票从来不是抢来的”。相关规定，面向市场公开销售的营业性演出门票数量，不得低于核准观众数量的70%。 而剩下的那 30%，即非公开销售的票，则是黄牛票的主要来源，也叫渠道票。这里面涉及主办方对热门票和冷门票的售票策略，黄牛在这链条中扮演着重要的角色，只要演唱会门票的二级市场不会消失，黄牛就永远不会消失，对于市场本身来说，愿意花更多钱买黄牛票的人，一定是更有需求的人，黄牛不过是市场调节的人格化。
一、分析购票过程 现在无论是买火车票、飞机票、演唱会票基本都是使用电子支付网上购票，之后得到一张电子票凭证，进场前打印纸质票或者闸机核销票据二维码进场，那么我们从用户角度看下，一次完整的购票过程是什么样。
用户的购票流程：
首先用户登录 票务 APP 搜索爱豆的门票，点击查看门票详情，然后选择场次和票档。等待抢票倒计时，才能进入到下一个页面；.倒计时结束后，开抢按钮被点亮，用户进入下一步选择观演人，确认信息后选择付款方式提交订单；如果手速足够快、运气足够好，抢到了票就会唤起所选的支付方式 APP 提示付款；如果没有抢到则会提示拥堵，跳转到票档选择页面。下面，我将这个图补充一下，思考下哪些步骤是用户可以提高出票成功率的关键时间节点： 很显然，用户在倒计时之前看不到的页面就是竞争手速的关键时机，当这个开抢按钮被倒计时点亮的一瞬间，要以最快的速度点击到达隐藏页面，然后选中观演人，通常使用默认的支付方式，最后提交订单。一旦订单被提交成功，就说明锁定了席位抢到了票。如果用户在规定的时间内未付款，该席位会重新流入票池，捡漏的人就可以抢到。到这里，我们知道了购票流程和提高抢票成功率的突破口，人的手速肯定没有机器快，接下来介绍下两种常用的技术抢票方案。
二、Selenium 模拟浏览器操作 在使用 Chrome 浏览器，用户可以使用鼠标滑动、按键点击以及键盘输入，作为信号输入设备向浏览器传达指令，浏览器收到指令后执行渲染。这里提到的 Selenium WebDriver 是对浏览器提供的原生 API 进行封装，使用这套 API 可以操控浏览器的开启、关闭，打开网页，操作界面元素，控制 Cookie。简单说就是，可以通过写代码的方式来自动实现用户鼠标和键盘信号的输入。这么一来，可以做的事就非常多了。
下面是一个简单脚本，它首先打开 chrome 浏览器输入 google 的网址，等待 5 秒，浏览器网页打开后，找到输入框输入 ”ChromeDriver“，然后模拟点击搜索按钮，就能看到浏览器上搜索的结果。
import time from selenium import webdriver from selenium.webdriver.common.by import By browser.get(&#34;https://www.google.com&#34;) time.sleep(5) # 查找元素 search_box = browser.find_element(By.NAME, &#39;q&#39;) # 模拟按键输入 search_box.send_keys(&#39;ChromeDriver&#39;) # 搜索框模拟回车 search_box.submit() time.sleep(5) # 关闭所有窗口 browser.quit() 回到抢票的主题上来，我们可以使用这种技术能力，写一个 Python 脚本，在本地机器上执行起来。脚本内容是在指定的时间打开浏览器，打开票务网页，然后自动模拟用户选择观影人然后自动提交订单。（在这里我原本很想做一个演示视频，理解起来更直观，奈何时间精力有限，这里就不详细介绍 Selenium WebDriver 开发环境配置，感兴趣的可以继续深挖）。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-01-05T16:04:25+08:00">
    <meta property="article:modified_time" content="2024-01-05T16:04:25+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程学习者" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程学习者</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【Python脚本】Python自动大麦网抢票，准点原价秒杀演唱会门票，拒绝黄牛交易！从我做起！！！</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atelier-sulphurpool-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>为了帮助大家在激烈的抢票竞争中获得更大的成功机会，本文将介绍抢票软件的实现原理以及我所了解的一些抢票方式。<br> 但是，请不要过度将希望寄托于抢票软件，它有时也不灵，经过我的验证，即使你用到了抢票软件，也不一定能抢到票。<br> 票务平台会经常调整反爬策略打击爬虫行为，如果希望抢票软件保持较高的成功率，是需要开发者针对票务平台的打击策略作出逻辑调整，这个成本是很高的，所以你能随手获得的抢票软件很大概率是抢不到票的或者说是不安全的。<br> 在调研过程发现一个有意思的点 “黄牛的票从来不是抢来的”。相关规定，面向市场公开销售的营业性演出门票数量，不得低于核准观众数量的70%。 而剩下的那 30%，即非公开销售的票，则是黄牛票的主要来源，也叫渠道票。这里面涉及主办方对热门票和冷门票的售票策略，黄牛在这链条中扮演着重要的角色，只要演唱会门票的二级市场不会消失，黄牛就永远不会消失，对于市场本身来说，愿意花更多钱买黄牛票的人，一定是更有需求的人，黄牛不过是市场调节的人格化。</p> 
<h3><a id="_5"></a>一、分析购票过程</h3> 
<p>现在无论是买火车票、飞机票、演唱会票基本都是使用电子支付网上购票，之后得到一张电子票凭证，进场前打印纸质票或者闸机核销票据二维码进场，那么我们从用户角度看下，一次完整的购票过程是什么样。<img src="https://images2.imgbox.com/df/98/r5R1G0C0_o.png" alt="在这里插入图片描述"></p> 
<p>用户的购票流程：</p> 
<ol><li>首先用户登录 票务 APP 搜索爱豆的门票，点击查看门票详情，然后选择场次和票档。等待抢票倒计时，才能进入到下一个页面；</li><li>.倒计时结束后，开抢按钮被点亮，用户进入下一步选择观演人，确认信息后选择付款方式提交订单；</li><li>如果手速足够快、运气足够好，抢到了票就会唤起所选的支付方式 APP 提示付款；如果没有抢到则会提示拥堵，跳转到票档选择页面。下面，我将这个图补充一下，思考下哪些步骤是用户可以提高出票成功率的关键时间节点：<img src="https://images2.imgbox.com/a4/95/8Kl4M064_o.png" alt="在这里插入图片描述"></li></ol> 
<p>很显然，用户在倒计时之前看不到的页面就是竞争手速的关键时机，当这个开抢按钮被倒计时点亮的一瞬间，要以最快的速度点击到达隐藏页面，然后选中观演人，通常使用默认的支付方式，最后提交订单。一旦订单被提交成功，就说明锁定了席位抢到了票。如果用户在规定的时间内未付款，该席位会重新流入票池，捡漏的人就可以抢到。到这里，我们知道了购票流程和提高抢票成功率的突破口，人的手速肯定没有机器快，接下来介绍下两种常用的技术抢票方案。</p> 
<h3><a id="Selenium__16"></a>二、Selenium 模拟浏览器操作</h3> 
<p>在使用 Chrome 浏览器，用户可以使用鼠标滑动、按键点击以及键盘输入，作为信号输入设备向浏览器传达指令，浏览器收到指令后执行渲染。这里提到的 Selenium WebDriver 是对浏览器提供的原生 API 进行封装，使用这套 API 可以操控浏览器的开启、关闭，打开网页，操作界面元素，控制 Cookie。简单说就是，可以通过写代码的方式来自动实现用户鼠标和键盘信号的输入。这么一来，可以做的事就非常多了。<br> 下面是一个简单脚本，它首先打开 chrome 浏览器输入 google 的网址，等待 5 秒，浏览器网页打开后，找到输入框输入 ”ChromeDriver“，然后模拟点击搜索按钮，就能看到浏览器上搜索的结果。</p> 
<pre><code>import time

from selenium import webdriver
from selenium.webdriver.common.by import By

browser.get("https://www.google.com")
time.sleep(5)
# 查找元素
search_box = browser.find_element(By.NAME, 'q')
# 模拟按键输入
search_box.send_keys('ChromeDriver')
# 搜索框模拟回车
search_box.submit()
time.sleep(5)
# 关闭所有窗口
browser.quit()

</code></pre> 
<p>回到抢票的主题上来，我们可以使用这种技术能力，写一个 Python 脚本，在本地机器上执行起来。脚本内容是在指定的时间打开浏览器，打开票务网页，然后自动模拟用户选择观影人然后自动提交订单。（在这里我原本很想做一个演示视频，理解起来更直观，奈何时间精力有限，这里就不详细介绍 Selenium WebDriver 开发环境配置，感兴趣的可以继续深挖）。</p> 
<h3><a id="_44"></a>三、逆向工程：抢票接口</h3> 
<p>什么是逆向？即通过技术手段对票务 APP 的通讯流量抓包，定位 获取票档、提交订单的关键请求解密 https 流量，然后分析解密流量数据。<img src="https://images2.imgbox.com/0b/77/79FTrgMI_o.png" alt="在这里插入图片描述"></p> 
<p>我们继续回到这张图，仔细观察会发现，用户查看门票详情以及选择票档等一些动作都是 APP 上完成的都是提前加载好的，而真正决定用户抢票的是 “提交订单” 这个关键请求。如果我们可以将这个这个请求的流量抓到，然后分析其参数构造规则，就可以编写程序自动发送请求了。<img src="https://images2.imgbox.com/2c/8c/RbH2WsCq_o.png" alt="在这里插入图片描述"></p> 
<p>下面抓包示例，选取了一个门票，抓包获取了其票档信息。<img src="https://images2.imgbox.com/f1/ec/Ik2xgLYv_o.png" alt="在这里插入图片描述"></p> 
<p>以此类推，抓包 下单接口 观察其参数构成，编写程序模拟用户请求。</p> 
<pre><code># 等待开售
def wait_for_buy():
    # 抢购时间
    start_timestamp = 1686475533
    # 当前时间
    current_timestamp = int(time.time())
    while current_timestamp &gt; start_timestamp:
        # 开始购买
        place_order()
</code></pre> 
<p>这里简要介绍了下实现思路和方向，不展开逆向过程的细节。具体实现没有这么简单的，有攻击方必然有防守方，票务方为了保障平台方利益，势必会定义打击策略，例如，我们会看到验证码从文字到图片再到滑块验证的一个迭代过程。技术方面是一个问题，法律方面也是一个问题，所以全当一次攻防演练的学习，不要伤害票务方的利益。</p> 
<h3><a id="_67"></a>四、最后总结</h3> 
<p>生活有时很操蛋，我们会感到力不从心，但请守住你的热爱，别让它被挫折磨灭。祝大家买票的时候都能以正常价格抢到自己心仪的演唱会门票 ~</p> 
<p>如果你对Python感兴趣，想要学习python，这里给大家分享一份<strong>Python全套学习资料</strong>，都是我自己学习时整理的，希望可以帮到你，一起加油！</p> 
<p>😝有需要的小伙伴，可以<mark>V扫描下方二维码免费领取</mark>🆓</p> 
<p>​<img src="https://images2.imgbox.com/ed/a7/Hk92jc5i_o.jpg"></p> 
<h3><a id="1_80"></a>1️⃣零基础入门</h3> 
<h4><a id="__82"></a>① 学习路线</h4> 
<p>对于从来没有接触过Python的同学，我们帮你准备了详细的<strong>学习成长路线图</strong>。可以说是<strong>最科学最系统的学习路线</strong>，你可以按照上面的知识点去找对应的学习资源，保证自己学得较为全面。<br> <img src="https://images2.imgbox.com/bb/03/jJawSzvs_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="__87"></a>② 路线对应学习视频</h4> 
<p>还有很多适合0基础入门的学习视频，有了这些视频，轻轻松松上手Python~<br> <img src="https://images2.imgbox.com/34/fe/QVJLcM4c_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_92"></a>③练习题</h4> 
<p>每节视频课后，都有对应的练习题哦，可以检验学习成果哈哈！<br> <img src="https://images2.imgbox.com/7e/ea/lJ7aWOLU_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="2Python_97"></a><strong>2️⃣国内外Python书籍、文档</strong></h3> 
<h4><a id="__99"></a>① 文档和书籍资料</h4> 
<p><img src="https://images2.imgbox.com/ea/aa/2y9grneB_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="3Python_103"></a>3️⃣Python工具包+项目源码合集</h3> 
<h4><a id="Python_105"></a>①Python工具包</h4> 
<p>学习Python常用的开发软件都在这里了！每个都有详细的安装教程，保证你可以安装成功哦！<br> <img src="https://images2.imgbox.com/19/2d/fM19TwfE_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="Python_110"></a>②Python实战案例</h4> 
<p>光学理论是没用的，要学会跟着一起敲代码，动手实操，才能将自己的所学运用到实际当中去，这时候可以搞点实战案例来学习。<strong>100+实战案例源码等你来拿！</strong><br> <img src="https://images2.imgbox.com/50/8f/Mv9xAXdQ_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="Python_115"></a>③Python小游戏源码</h4> 
<p>如果觉得上面的实战案例有点枯燥，可以试试自己用Python编写小游戏，让你的学习过程中增添一点趣味！<br> <img src="https://images2.imgbox.com/d3/6e/Fm7EL2D2_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="4Python_120"></a>4️⃣Python面试题</h3> 
<p>我们学会了Python之后，有了技能就可以出去找工作啦！下面这些面试题是都来自阿里、腾讯、字节等一线互联网大厂，并且有阿里大佬给出了权威的解答，刷完这一套面试资料相信大家都能找到满意的工作。<br> <img src="https://images2.imgbox.com/12/93/YZjaWKok_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/91/ef/gf4HGhdS_o.png" alt="在这里插入图片描述"></p> 
<p>上述所有资料 ⚡️ ，朋友们如果有需要的，可以扫描下方👇👇👇二维码免费领取🆓<br> ​<img src="https://images2.imgbox.com/99/6e/rpwEAcHS_o.jpg"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/d0a46bcb42669d27035783d7ea021dee/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">全网最全stable diffusion图生图教程！！！小白必收藏！！！！</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/70e634301ebca3d80b4f1814b6929826/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Mac上安装 Node.js 的版本管理工具 n，以及 n 使用，的使用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程学习者.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
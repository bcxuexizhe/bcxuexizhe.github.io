<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>spring boot3整合spring AI组件 - 编程学习者</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcxuexizhe.github.io/posts/8e1e4531f9b36d7dc350b3b7eb356d5e/">
  <meta property="og:site_name" content="编程学习者">
  <meta property="og:title" content="spring boot3整合spring AI组件">
  <meta property="og:description" content="⛰️个人主页: 蒾酒
🔥系列专栏：《spring boot实战》
目录
写在前面
spring ai简介
单独整合al接口
整合Spring AI组件
起步条件
​编辑
进行必要配置
写在最后 最近发现了一个巨牛的人工智能学习网站，通俗易懂，风趣幽默，忍不住分享一下给大家。
点击跳转到学习网站
写在前面 本文介绍了springboot开发后端服务中，AI组件(Spring AI)的整合与使用。坚持看完相信对你有帮助。
同时欢迎订阅springboot系列专栏，持续分享spring boot的使用经验。
spring ai简介 先看官网介绍：
翻译：
Spring AI 是 AI 工程的应用框架。其目标是将 Spring 生态系统设计原则（如可移植性和模块化设计）应用于 AI，并推广使用 POJO 作为 AI 领域应用程序的构建块。
翻译：
特征
跨 AI 提供商的可移植 API 支持，适用于聊天、文本到图像和嵌入模型。支持同步和流 API 选项。还支持下拉以访问特定于模型的功能。
在spring-ai组件没发布前，我们在spring boot中对接各种ai接口，由于接口规范格式的不同，我们通常每种接口都得单独去写代码去对接，最后通过实现策略模式来实现灵活切换ai接口源。这样是比较麻烦的。而spring-ai组件就是帮我们做了类似的封装，使得我们对接多种ai接口变得十分方便。
单独整合al接口 我们先来看spring boot简单整合经典的chatGPT 3.5接口
代码如下：
import cn.hutool.http.HttpRequest; import cn.hutool.json.JSONArray; import cn.hutool.json.JSONObject; import cn.hutool.json.JSONUtil; import java.util.ArrayList; import java.util.HashMap; import java.util.List; import java.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-22T14:20:49+08:00">
    <meta property="article:modified_time" content="2024-05-22T14:20:49+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程学习者" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程学习者</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">spring boot3整合spring AI组件</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p><img alt="" height="68" src="https://images2.imgbox.com/2a/89/GLQzQaoN_o.jpg" width="68"></p> 
<p>⛰️<a href="https://so.csdn.net/so/search?q=%E4%B8%AA%E4%BA%BA%E4%B8%BB%E9%A1%B5&amp;spm=1001.2101.3001.7020" title="个人主页">个人主页</a>:     <a href="https://blog.csdn.net/qq_62262918?spm=1011.2266.3001.5343" title="蒾酒">蒾酒</a></p> 
<p>🔥系列专栏：<a href="https://blog.csdn.net/qq_62262918/category_12571219.html?spm=1001.2014.3001.5482" title="《spring boot实战》">《spring boot实战》</a></p> 
<hr> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="%E5%86%99%E5%9C%A8%E5%89%8D%E9%9D%A2-toc" style="margin-left:0px;"><a href="#%E5%86%99%E5%9C%A8%E5%89%8D%E9%9D%A2" rel="nofollow">写在前面</a></p> 
<p id="spring%20ai%E7%AE%80%E4%BB%8B-toc" style="margin-left:0px;"><a href="#spring%20ai%E7%AE%80%E4%BB%8B" rel="nofollow">spring ai简介</a></p> 
<p id="%E5%8D%95%E7%8B%AC%E6%95%B4%E5%90%88al%E6%8E%A5%E5%8F%A3-toc" style="margin-left:0px;"><a href="#%E5%8D%95%E7%8B%AC%E6%95%B4%E5%90%88al%E6%8E%A5%E5%8F%A3" rel="nofollow">单独整合al接口</a></p> 
<p id="%E6%95%B4%E5%90%88Spring%20AI%E7%BB%84%E4%BB%B6-toc" style="margin-left:0px;"><a href="#%E6%95%B4%E5%90%88Spring%20AI%E7%BB%84%E4%BB%B6" rel="nofollow">整合Spring AI组件</a></p> 
<p id="%E8%B5%B7%E6%AD%A5%E6%9D%A1%E4%BB%B6-toc" style="margin-left:40px;"><a href="#%E8%B5%B7%E6%AD%A5%E6%9D%A1%E4%BB%B6" rel="nofollow">起步条件</a></p> 
<p id="%E2%80%8B%E7%BC%96%E8%BE%91-toc" style="margin-left:40px;"><a href="#%E2%80%8B%E7%BC%96%E8%BE%91" rel="nofollow">​编辑</a></p> 
<p id="%E8%BF%9B%E8%A1%8C%E5%BF%85%E8%A6%81%E9%85%8D%E7%BD%AE-toc" style="margin-left:40px;"><a href="#%E8%BF%9B%E8%A1%8C%E5%BF%85%E8%A6%81%E9%85%8D%E7%BD%AE" rel="nofollow">进行必要配置</a></p> 
<p id="%E5%86%99%E5%9C%A8%E6%9C%80%E5%90%8E%C2%A0-toc" style="margin-left:40px;"><a href="#%E5%86%99%E5%9C%A8%E6%9C%80%E5%90%8E%C2%A0" rel="nofollow">写在最后 </a></p> 
<hr id="hr-toc"> 
<blockquote> 
 <p> 最近发现了一个巨牛的人工智能学习网站，通俗易懂，风趣幽默，忍不住分享一下给大家。</p> 
 <p>    <a href="https://www.captainbed.cn/ding" rel="nofollow" title="点击跳转到学习网站">点击跳转到学习网站</a></p> 
 <p><img alt="" height="352" src="https://images2.imgbox.com/73/11/EDEcL6TO_o.png" width="748"></p> 
</blockquote> 
<h2>写在前面</h2> 
<p>本文介绍了<a href="https://so.csdn.net/so/search?q=springboot%E5%BC%80%E5%8F%91&amp;spm=1001.2101.3001.7020" title="springboot开发">springboot开发</a>后端服务中，AI组件(Spring AI)的整合与使用。坚持看完相信对你有帮助。</p> 
<p>同时欢迎订阅springboot系列专栏，持续分享spring boot的使用经验。</p> 
<h2 id="spring%20ai%E7%AE%80%E4%BB%8B">spring ai简介</h2> 
<p>先看官网介绍：</p> 
<p><img alt="" height="418" src="https://images2.imgbox.com/ea/7a/Kuo5micE_o.png" width="1200"></p> 
<p>翻译：</p> 
<blockquote> 
 <p>Spring AI 是 AI 工程的应用框架。其目标是将 Spring 生态系统设计原则（如可移植性和模块化设计）应用于 AI，并推广使用 POJO 作为 AI 领域应用程序的构建块。</p> 
</blockquote> 
<p><img alt="" height="210" src="https://images2.imgbox.com/fe/44/cEimjPJ7_o.png" width="1200"></p> 
<p>翻译：</p> 
<blockquote> 
 <p>特征</p> 
 <p style="margin-left:0;">跨 AI 提供商的可移植 API 支持，适用于聊天、文本到图像和嵌入模型。支持同步和流 API 选项。还支持下拉以访问特定于模型的功能。</p> 
</blockquote> 
<p>在spring-ai组件没发布前，我们在spring boot中对接各种ai接口，由于接口规范格式的不同，我们通常每种接口都得单独去写代码去对接，最后通过实现策略模式来实现灵活切换ai接口源。这样是比较麻烦的。而spring-ai组件就是帮我们做了类似的封装，使得我们对接多种ai接口变得十分方便。</p> 
<h2 id="%E5%8D%95%E7%8B%AC%E6%95%B4%E5%90%88al%E6%8E%A5%E5%8F%A3">单独整合al接口</h2> 
<p>我们先来看spring boot简单整合经典的chatGPT 3.5接口</p> 
<p>代码如下：</p> 
<pre><code class="language-java">


import cn.hutool.http.HttpRequest;
import cn.hutool.json.JSONArray;
import cn.hutool.json.JSONObject;
import cn.hutool.json.JSONUtil;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

/**
 * @author mijiu
 * ClassName:OpenAIAPI.java
 * date:2024-05-06 16:49
 * Description:
 */

public class OpenAIAPI {
    /**
     * 聊天端点
     */
    private final static String CHAT_ENDPOINT = "https://api.openai.com/v1/chat/completions";//官网接口地址
    private final static  String PROXY_ENDPOINT ="https://www.chatgp.fun/v1/chat/completions";//国内代理接口

    private final static  String API_KEY = "Bearer sk-pbatvlgKeYScAS3kD4820bA1CcE741F996E0BaAb205421D1";

    /**
     * 需要代理服务器访问
     *
     * @param txt 内容
     * @return {@link String}
     */
    public static String chat(String txt) {
        Map&lt;String, Object&gt; paramMap = new HashMap&lt;&gt;();


        paramMap.put("model", "gpt-3.5-turbo");
        List&lt;Map&lt;String, String&gt;&gt; dataList = new ArrayList&lt;&gt;();
        dataList.add(new HashMap&lt;String, String&gt;(){<!-- -->{
            put("role", "user");
            put("content", txt);
        }});
        paramMap.put("messages", dataList);
        System.out.println(JSONUtil.toJsonStr(paramMap));
        JSONObject message = null;
        try {
            String body = HttpRequest.post(PROXY_ENDPOINT)
                    .header("Authorization", API_KEY)
                    .header("Content-Type", "application/json")
                    .body(JSONUtil.toJsonStr(paramMap))
                    .execute()
                    .body();
            JSONObject jsonObject = JSONUtil.parseObj(body);
            System.out.println(jsonObject);
            JSONArray choices = jsonObject.getJSONArray("choices");
            JSONObject result = choices.get(0, JSONObject.class, Boolean.TRUE);
            message = result.getJSONObject("message");

        } catch (Exception e) {
            return "抱歉，我无法回答你的问题。";
        }
        return message.getStr("content");
    }

    public static void main(String[] args) {
        System.out.println(chat("你是？"));
    }
}
</code></pre> 
<p>这段代码依赖hutool工具包的http工具包</p> 
<pre><code class="language-XML"> &lt;dependency&gt;
    &lt;groupId&gt;cn.hutool&lt;/groupId&gt;
    &lt;artifactId&gt;hutool-all&lt;/artifactId&gt;
    &lt;version&gt;5.7.22&lt;/version&gt;
 &lt;/dependency&gt;</code></pre> 
<p>现在运行测试一下：</p> 
<p><img alt="" height="162" src="https://images2.imgbox.com/1a/87/FKRQiJg6_o.png" width="1200"></p> 
<p>可以看到目前整合调用测试成功了。</p> 
<p>代码里面的api-key有一定量的token新手可以复制代码运行下试试。言归正传下面开始介绍核心内容。</p> 
<h2 id="%E6%95%B4%E5%90%88Spring%20AI%E7%BB%84%E4%BB%B6">整合Spring AI组件</h2> 
<h3 id="%E8%B5%B7%E6%AD%A5%E6%9D%A1%E4%BB%B6">起步条件</h3> 
<blockquote> 
 <ul><li>jdk不低于17</li><li>spring boot 3x</li></ul> 
</blockquote> 
<p>我们直接新建一个demo项目</p> 
<p>为何直接新建一个项目的，主要是为了避开一些麻烦。如，阿里云maven镜像没有此依赖，需要到中央仓库下载。</p> 
<p><span style="background-color:#ffd900;">一定要选不低于Java17的jdk</span></p> 
<h3 id="%E2%80%8B%E7%BC%96%E8%BE%91"><img alt="" height="1059" src="https://images2.imgbox.com/b6/64/5COmySx9_o.png" width="1200"></h3> 
<p>选择这两个依赖就够了</p> 
<blockquote> 
 <ul><li>Spring Web</li><li>OpenAI</li></ul> 
</blockquote> 
<p><img alt="" height="987" src="https://images2.imgbox.com/1e/fb/iAqp0s0S_o.png" width="1200"></p> 
<p><span style="background-color:#ffd900;">spring boot的版本不要低于3.0</span></p> 
<p><img alt="" height="987" src="https://images2.imgbox.com/a4/cc/x5SzoG4F_o.png" width="1200"></p> 
<p>等待依赖下载完成。</p> 
<h3 id="%E8%BF%9B%E8%A1%8C%E5%BF%85%E8%A6%81%E9%85%8D%E7%BD%AE">进行必要配置</h3> 
<p>这个api-key需要你去openal官网去申请购买，或者在一些购物软件直接购买现成的用。</p> 
<p>共需要配置：</p> 
<blockquote> 
 <ol><li> <p><strong><code>spring.ai.openai.api-key：</code></strong> 这是你的 OpenAI API 密钥，它是用于通过 API 访问 OpenAI 服务的凭证。密钥应该是一个长字符串，用于标识你的账户并授权访问。</p> </li><li> <p><strong><code>spring.ai.openai.chat.options.model</code>：</strong> 这是用于设置对话系统所使用的 OpenAI 模型的选项之一。在这种情况下，模型选择为 GPT-3.5 Turbo，这是 OpenAI 提供的一种强大的自然语言处理模型，适用于生成对话。</p> </li><li> <p><strong><code>spring.ai.openai.chat.options.temperature：</code></strong> 这是对话系统生成响应时的温度参数。温度参数控制着生成文本的多样性，值越高，生成文本的多样性越大。在这里，温度设置为 0.7，这意味着对话系统生成的文本会相对保守，但仍具有一定的多样性。</p> </li></ol> 
</blockquote> 
<p>application.properties：</p> 
<pre><code class="language-XML">spring.ai.openai.api-key=sk-uVfM7GiD9RIdIKRrF70eT3BlbkyhdHGHGH
spring.ai.openai.chat.options.model=gpt-3.5-turbo
spring.ai.openai.chat.options.temperature=0.7</code></pre> 
<p>代码里面的api-key是我随意写的一个，需要换成你自己的且有效的 。</p> 
<p>测试控制器</p> 
<pre><code class="language-java">

import org.springframework.ai.embedding.EmbeddingClient;
import org.springframework.ai.embedding.EmbeddingResponse;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

import java.util.List;
import java.util.Map;

/**
 * @author mijiupro
 */
@RestController
public class EmbeddingController {

    private final EmbeddingClient embeddingClient;

    @Autowired
    public EmbeddingController(EmbeddingClient embeddingClient) {
        this.embeddingClient = embeddingClient;
    }

    @GetMapping("/ai/embedding")
    public Map embed(@RequestParam(value = "message", defaultValue = "Tell me a joke") String message) {
        EmbeddingResponse embeddingResponse = this.embeddingClient.embedForResponse(List.of(message));
        return Map.of("embedding", embeddingResponse);
    }
}</code></pre> 
<p>最后启动项目浏览器地址栏访问测试接口即可。</p> 
<pre><code class="language-XML">http://localhost:8080/ai/embedding</code></pre> 
<h3 id="%E5%86%99%E5%9C%A8%E6%9C%80%E5%90%8E%C2%A0">写在最后 </h3> 
<p>spring boot3整合AI组件到这里就结束了。任何问题评论区或私信讨论，欢迎指正。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/9a2975bbf394a66ebc56cf64f2267545/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【SpringBoot】SpringBoot中防止接口重复提交（单机环境和分布式环境）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a89c74d94c74a5db4e1b7bd584466bc3/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">MySQL慢SQL优化方案汇总</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程学习者.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
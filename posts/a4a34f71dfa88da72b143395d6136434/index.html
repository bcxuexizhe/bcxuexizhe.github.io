<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Vue3 exceljs库实现前端导入导出Excel - 编程学习者</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcxuexizhe.github.io/posts/a4a34f71dfa88da72b143395d6136434/">
  <meta property="og:site_name" content="编程学习者">
  <meta property="og:title" content="Vue3 exceljs库实现前端导入导出Excel">
  <meta property="og:description" content="前言 需求场景 最近在开发项目时需要批量导入和导出Excel数据，在实现这个需求时，我们既可以在前端完成数据解析和文件生成工作，也可以通过前端发起导入以及导出请求后，后端实现解析文件流解析文件内容以及生成文件并提供下载链接的功能。
相较于后端处理Excel数据而言，使用前端导入导出可以提供更高的实时性，用户可以直接在浏览器中触发导出操作，无需等待后端处理。且可以在前端完成数据生成以及数据校验处理工作，大大减轻后端服务器的压力，大幅增强用户体验。
具体的技术方案选型主要看业务场景，如果对于小型数据集、实时性需求较高的导入导出操作，优先考虑前端实现。而对于大型数据集、需要业务逻辑处理、以及安全性要求高的场景，则后端处理更为合适。
技术方案 xlsx与xlsx-style组合方案：xlsx 是目前前端最常用的Excel解决方案，又叫做SheetJS，但社区版不支持修改Excel的样式，需要购买Pro版才可以，如果需要修改导出的Excel文件样式，需要结合xlsx-style库一起使用。但遗憾的是xlsx库已经两年多不更新，而xlsx-style上一个版本更是8年前发布，目前已经不再推荐使用该方案。
exceljs与file-saver方案：exceljs是一款免费开源支持导入导出Excel 操作工具，并且可以实现样式的修改以及 Excel 的高级功能，是非常值得推荐的一个处理 Excel 的库，file-saver可以实现保存文件到本地。本文以exceljs与file-saver操作xlsx格式文件为例介绍如何具体上手使用。
exceljs介绍 ExcelJS是一个用于在Node.js和浏览器中创建、读取和修改Excel文件的强大JavaScript库。它提供了丰富的功能和灵活的API，使你能够在你的应用程序中处理和操作Excel文件。
下面是一些ExcelJS库的关键特性和功能：
创建和修改Excel文件：ExcelJS允许你创建新的Excel工作簿，并在其中添加工作表、行和单元格。你可以设置单元格的值、样式、数据类型以及其他属性。读取和解析Excel文件：ExcelJS支持读取和解析现有的Excel文件。你可以将Excel文件加载到工作簿中，然后访问工作表、行和单元格的数据。导出和保存Excel文件：ExcelJS可以将工作簿保存为Excel文件，支持多种格式，如XLSX、XLS和CSV。你可以将工作簿保存到本地文件系统或将其发送到客户端以供下载。处理复杂的Excel功能：ExcelJS支持处理复杂的Excel功能，如公式、图表、数据验证、条件格式和保护工作表等。你可以根据需要设置和操作这些功能。支持自定义样式和格式：ExcelJS允许你自定义单元格、行、列和工作表的样式和格式。你可以设置字体、颜色、填充、边框、对齐方式以及数字和日期格式等。 参考文档 npm仓库地址：https://www.npmjs.com/package/exceljs
官方中文文档地址：https://github.com/exceljs/exceljs/blob/HEAD/README_zh.md
快速上手 安装依赖 exceljs用于Excel数据处理，file-sever用于保存到本地文件。
npm i exceljs npm i file-saver 导出Excel 让我们先从简单的数据导出开始，快速体验如何使用exceljs导出Excel文件，需要注意的是在浏览器环境中运行 JavaScript，浏览器的安全策略通常不允许直接访问读写本地文件系统。在这种情况下，需要通过其他方式将文件转换为buffer数据，在导出Excel时使用FileSaver.js库将缓冲区数据保存到文件中。
&lt;template&gt; &lt;el-button type=&#34;primary&#34; @click=&#34;exportExcel&#34;&gt;导出excel&lt;/el-button&gt; &lt;/template&gt; &lt;script setup&gt; import ExcelJS from &#34;exceljs&#34;; import FileSaver from &#34;file-saver&#34;; // 导出excel文件 const exportExcel = () =&gt; { // 创建工作簿 const workbook = new ExcelJS.Workbook(); // 添加工作表，名为sheet1 const sheet1 = workbook.addWorksheet(&#34;sheet1&#34;); // 导出数据列表 const data = [ {&#34;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-02-25T14:17:25+08:00">
    <meta property="article:modified_time" content="2024-02-25T14:17:25+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程学习者" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程学习者</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Vue3 exceljs库实现前端导入导出Excel</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="_0"></a>前言</h2> 
<h3><a id="_1"></a>需求场景</h3> 
<p>最近在开发项目时需要批量导入和导出Excel数据，在实现这个需求时，我们既可以在前端完成数据解析和文件生成工作，也可以通过前端发起导入以及导出请求后，后端实现解析文件流解析文件内容以及生成文件并提供下载链接的功能。<br> 相较于后端处理Excel数据而言，使用前端导入导出可以提供更高的实时性，用户可以直接在浏览器中触发导出操作，无需等待后端处理。且可以在前端完成数据生成以及数据校验处理工作，大大减轻后端服务器的压力，大幅增强用户体验。<br> 具体的技术方案选型主要看业务场景，如果对于小型数据集、实时性需求较高的导入导出操作，优先考虑前端实现。而对于大型数据集、需要业务逻辑处理、以及安全性要求高的场景，则后端处理更为合适。</p> 
<h3><a id="_5"></a>技术方案</h3> 
<p>xlsx与xlsx-style组合方案：xlsx 是目前前端最常用的Excel解决方案，又叫做SheetJS，但社区版不支持修改Excel的样式，需要购买Pro版才可以，如果需要修改导出的Excel文件样式，需要结合xlsx-style库一起使用。但遗憾的是xlsx库已经两年多不更新，而xlsx-style上一个版本更是8年前发布，目前已经不再推荐使用该方案。<br> exceljs与file-saver方案：exceljs是一款免费开源支持导入导出Excel 操作工具，并且可以实现样式的修改以及 Excel 的高级功能，是非常值得推荐的一个处理 Excel 的库，file-saver可以实现保存文件到本地。本文以exceljs与file-saver操作xlsx格式文件为例介绍如何具体上手使用。</p> 
<h3><a id="exceljs_8"></a>exceljs介绍</h3> 
<p>ExcelJS是一个用于在Node.js和浏览器中创建、读取和修改Excel文件的强大JavaScript库。它提供了丰富的功能和灵活的API，使你能够在你的应用程序中处理和操作Excel文件。<br> 下面是一些ExcelJS库的关键特性和功能：</p> 
<ol><li>创建和修改Excel文件：ExcelJS允许你创建新的Excel工作簿，并在其中添加工作表、行和单元格。你可以设置单元格的值、样式、数据类型以及其他属性。</li><li>读取和解析Excel文件：ExcelJS支持读取和解析现有的Excel文件。你可以将Excel文件加载到工作簿中，然后访问工作表、行和单元格的数据。</li><li>导出和保存Excel文件：ExcelJS可以将工作簿保存为Excel文件，支持多种格式，如XLSX、XLS和CSV。你可以将工作簿保存到本地文件系统或将其发送到客户端以供下载。</li><li>处理复杂的Excel功能：ExcelJS支持处理复杂的Excel功能，如公式、图表、数据验证、条件格式和保护工作表等。你可以根据需要设置和操作这些功能。</li><li>支持自定义样式和格式：ExcelJS允许你自定义单元格、行、列和工作表的样式和格式。你可以设置字体、颜色、填充、边框、对齐方式以及数字和日期格式等。</li></ol> 
<h3><a id="_17"></a>参考文档</h3> 
<p>npm仓库地址：<a href="https://www.npmjs.com/package/exceljs" rel="nofollow">https://www.npmjs.com/package/exceljs</a><br> 官方中文文档地址：<a href="https://github.com/exceljs/exceljs/blob/HEAD/README_zh.md">https://github.com/exceljs/exceljs/blob/HEAD/README_zh.md</a></p> 
<h2><a id="_20"></a>快速上手</h2> 
<h3><a id="_21"></a>安装依赖</h3> 
<p>exceljs用于Excel数据处理，file-sever用于保存到本地文件。</p> 
<pre><code class="prism language-bash"><span class="token function">npm</span> i exceljs
<span class="token function">npm</span> i file-saver
</code></pre> 
<h3><a id="Excel_27"></a>导出Excel</h3> 
<p>让我们先从简单的数据导出开始，快速体验如何使用exceljs导出Excel文件，需要注意的是在浏览器环境中运行 JavaScript，浏览器的安全策略通常不允许直接访问读写本地文件系统。在这种情况下，需要通过其他方式将文件转换为buffer数据，在导出Excel时使用FileSaver.js库将缓冲区数据保存到文件中。</p> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">"primary"</span> @click<span class="token operator">=</span><span class="token string">"exportExcel"</span><span class="token operator">&gt;</span>导出excel<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> ExcelJS <span class="token keyword">from</span> <span class="token string">"exceljs"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FileSaver <span class="token keyword">from</span> <span class="token string">"file-saver"</span><span class="token punctuation">;</span>
<span class="token comment">// 导出excel文件</span>
<span class="token keyword">const</span> <span class="token function-variable function">exportExcel</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 创建工作簿</span>
  <span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelJS<span class="token punctuation">.</span>Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 添加工作表，名为sheet1</span>
  <span class="token keyword">const</span> sheet1 <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">addWorksheet</span><span class="token punctuation">(</span><span class="token string">"sheet1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 导出数据列表</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{<!-- --></span><span class="token string-property property">"姓名"</span><span class="token operator">:</span> <span class="token string">"张三"</span><span class="token punctuation">,</span> <span class="token string-property property">"年龄"</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string-property property">"身高"</span><span class="token operator">:</span> <span class="token number">175</span><span class="token punctuation">,</span> <span class="token string-property property">"体重"</span><span class="token operator">:</span> <span class="token number">74</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span><span class="token string-property property">"姓名"</span><span class="token operator">:</span> <span class="token string">"李四"</span><span class="token punctuation">,</span> <span class="token string-property property">"年龄"</span><span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token string-property property">"身高"</span><span class="token operator">:</span> <span class="token number">177</span><span class="token punctuation">,</span> <span class="token string-property property">"体重"</span><span class="token operator">:</span> <span class="token number">84</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span><span class="token string-property property">"姓名"</span><span class="token operator">:</span> <span class="token string">"王五"</span><span class="token punctuation">,</span> <span class="token string-property property">"年龄"</span><span class="token operator">:</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token string-property property">"身高"</span><span class="token operator">:</span> <span class="token number">155</span><span class="token punctuation">,</span> <span class="token string-property property">"体重"</span><span class="token operator">:</span> <span class="token number">64</span><span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
  <span class="token comment">// 获取表头所有键</span>
  <span class="token keyword">const</span> headers <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token comment">// 将标题写入第一行</span>
  sheet1<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span>headers<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 将数据写入工作表</span>
  data<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">row</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> values <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>
    sheet1<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 导出表格文件</span>
  workbook<span class="token punctuation">.</span>xlsx<span class="token punctuation">.</span><span class="token function">writeBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">buffer</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>buffer<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"application/octet-stream"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    FileSaver<span class="token punctuation">.</span><span class="token function">saveAs</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token string">"ExcelJS.xlsx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Error writing excel export'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped lang<span class="token operator">=</span><span class="token string">"scss"</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre> 
<p>当我们点击导出excel按钮时，调用exportFile函数，完成excel文件下载，下载后的文件内容如下：<br> <img src="https://images2.imgbox.com/47/72/CorrI7NG_o.png" alt="image.png"></p> 
<h3><a id="Excel_72"></a>导入Excel</h3> 
<p>导入excel文件时，同样使用FileReader的readAsArrayBuffer方法，将文件转换为二进制字符串，然后从buffer中加载数据并解析。</p> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>input
      type<span class="token operator">=</span><span class="token string">"file"</span>
      accept<span class="token operator">=</span><span class="token string">".xls,.xlsx"</span>
      <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"upload-file"</span>
      @change<span class="token operator">=</span><span class="token string">"importExcel($event)"</span><span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> ExcelJS <span class="token keyword">from</span> <span class="token string">"exceljs"</span><span class="token punctuation">;</span>
<span class="token comment">// 导出excel文件</span>
<span class="token keyword">const</span> <span class="token function-variable function">importExcel</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">//获取选择的文件</span>
  <span class="token keyword">const</span> files <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>files
  <span class="token comment">//创建Workbook实例</span>
  <span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelJS<span class="token punctuation">.</span>Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 使用FileReader对象来读取文件内容</span>
  <span class="token keyword">const</span> fileReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// 二进制字符串的形式加载文件</span>
  fileReader<span class="token punctuation">.</span><span class="token function">readAsArrayBuffer</span><span class="token punctuation">(</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  fileReader<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token parameter">ev</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ev<span class="token punctuation">)</span>
    <span class="token comment">// 从 buffer中加载数据解析</span>
    workbook<span class="token punctuation">.</span>xlsx<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>ev<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">workbook</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 获取第一个worksheet内容</span>
      <span class="token keyword">const</span> worksheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">getWorksheet</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 获取第一行的标题</span>
      <span class="token keyword">const</span> headers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      worksheet<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eachCell</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">cell</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        headers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"headers"</span><span class="token punctuation">,</span> headers<span class="token punctuation">)</span>
      <span class="token comment">// 创建一个空的JavaScript对象数组，用于存储解析后的数据</span>
      <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token comment">// 遍历工作表的每一行（从第二行开始，因为第一行通常是标题行）</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> rowNumber <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> rowNumber <span class="token operator">&lt;=</span> worksheet<span class="token punctuation">.</span>rowCount<span class="token punctuation">;</span> rowNumber<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">const</span> rowData <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> row <span class="token operator">=</span> worksheet<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span>rowNumber<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 遍历当前行的每个单元格</span>
        row<span class="token punctuation">.</span><span class="token function">eachCell</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">cell<span class="token punctuation">,</span> colNumber</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
          <span class="token comment">// 获取标题对应的键，并将当前单元格的值存储到相应的属性名中</span>
          rowData<span class="token punctuation">[</span>headers<span class="token punctuation">[</span>colNumber <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> cell<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 将当前行的数据对象添加到数组中</span>
        data<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>rowData<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped lang<span class="token operator">=</span><span class="token string">"scss"</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre> 
<p>上传文件后，解析内容如下所示：<br> <img src="https://images2.imgbox.com/f9/70/KjL8Uv19_o.png" alt="image.png"></p> 
<h2><a id="_133"></a>进阶操作</h2> 
<h3><a id="_134"></a>添加数据</h3> 
<p>我们可以通过columns方法添加列标题并定义列键和宽度，设置好表头后，我们可以直接通过addRow方法，根据key值去添加每一行的数据。<br> 参考文档：<a href="https://github.com/exceljs/exceljs/blob/HEAD/README_zh.md#%E5%88%97">https://github.com/exceljs/exceljs/blob/HEAD/README_zh.md#%E5%88%97</a><br> 完整代码如下：</p> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">"primary"</span> @click<span class="token operator">=</span><span class="token string">"exportExcel"</span><span class="token operator">&gt;</span>导出excel<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> ExcelJS <span class="token keyword">from</span> <span class="token string">"exceljs"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FileSaver <span class="token keyword">from</span> <span class="token string">"file-saver"</span><span class="token punctuation">;</span>
<span class="token comment">// 导出excel文件</span>
<span class="token keyword">const</span> <span class="token function-variable function">exportExcel</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 创建工作簿</span>
  <span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelJS<span class="token punctuation">.</span>Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 添加工作表，名为sheet1</span>
  <span class="token keyword">const</span> sheet1 <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">addWorksheet</span><span class="token punctuation">(</span><span class="token string">"sheet1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 添加表头列数据</span>
  sheet1<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{<!-- --></span><span class="token literal-property property">header</span><span class="token operator">:</span> <span class="token string">"姓名"</span><span class="token punctuation">,</span> <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span><span class="token literal-property property">header</span><span class="token operator">:</span> <span class="token string">"年龄"</span><span class="token punctuation">,</span> <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">"age"</span><span class="token punctuation">,</span> <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span><span class="token literal-property property">header</span><span class="token operator">:</span> <span class="token string">"身高"</span><span class="token punctuation">,</span> <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">"height"</span><span class="token punctuation">,</span> <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span><span class="token literal-property property">header</span><span class="token operator">:</span> <span class="token string">"体重"</span><span class="token punctuation">,</span> <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">"weight"</span><span class="token punctuation">,</span> <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// 添加内容列数据</span>
  sheet1<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">sort</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"张三"</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">175</span><span class="token punctuation">,</span> <span class="token literal-property property">weight</span><span class="token operator">:</span> <span class="token number">74</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  sheet1<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">sort</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"李四"</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">177</span><span class="token punctuation">,</span> <span class="token literal-property property">weight</span><span class="token operator">:</span> <span class="token number">88</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  sheet1<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">sort</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"王五"</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">155</span><span class="token punctuation">,</span> <span class="token literal-property property">weight</span><span class="token operator">:</span> <span class="token number">62</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 导出表格文件</span>
  workbook<span class="token punctuation">.</span>xlsx<span class="token punctuation">.</span><span class="token function">writeBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">buffer</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>buffer<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"application/octet-stream"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    FileSaver<span class="token punctuation">.</span><span class="token function">saveAs</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token string">"ExcelJS.xlsx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Error writing excel export'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped lang<span class="token operator">=</span><span class="token string">"scss"</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre> 
<p>添加数据后导出文件效果如下：<br> <img src="https://images2.imgbox.com/6f/69/KoNHCdwx_o.png" alt="image.png"></p> 
<h3><a id="_178"></a>读取数据</h3> 
<p>我们可以使用getRow方法，传入指定行参数读取行数据。<br> 使用getColumn方法，传入键、字母、id参数读取列数据。<br> 使用eachCell方法可以遍历每个单元格内容。<br> 参考文档：<a href="https://github.com/exceljs/exceljs/blob/HEAD/README_zh.md#%E8%A1%8C">https://github.com/exceljs/exceljs/blob/HEAD/README_zh.md#%E8%A1%8C</a><br> 代码如下：</p> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">"primary"</span> @click<span class="token operator">=</span><span class="token string">"exportExcel"</span><span class="token operator">&gt;</span>导出excel<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> ExcelJS <span class="token keyword">from</span> <span class="token string">"exceljs"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FileSaver <span class="token keyword">from</span> <span class="token string">"file-saver"</span><span class="token punctuation">;</span>
<span class="token comment">// 导出excel文件</span>
<span class="token keyword">const</span> <span class="token function-variable function">exportExcel</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 创建工作簿</span>
  <span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelJS<span class="token punctuation">.</span>Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 添加工作表，名为sheet1</span>
  <span class="token keyword">const</span> sheet1 <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">addWorksheet</span><span class="token punctuation">(</span><span class="token string">"sheet1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 添加表头列数据</span>
  sheet1<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{<!-- --></span><span class="token literal-property property">header</span><span class="token operator">:</span> <span class="token string">"姓名"</span><span class="token punctuation">,</span> <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span><span class="token literal-property property">header</span><span class="token operator">:</span> <span class="token string">"年龄"</span><span class="token punctuation">,</span> <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">"age"</span><span class="token punctuation">,</span> <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span><span class="token literal-property property">header</span><span class="token operator">:</span> <span class="token string">"身高"</span><span class="token punctuation">,</span> <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">"height"</span><span class="token punctuation">,</span> <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span><span class="token literal-property property">header</span><span class="token operator">:</span> <span class="token string">"体重"</span><span class="token punctuation">,</span> <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">"weight"</span><span class="token punctuation">,</span> <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// 添加内容列数据</span>
  sheet1<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">sort</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"张三"</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">175</span><span class="token punctuation">,</span> <span class="token literal-property property">weight</span><span class="token operator">:</span> <span class="token number">74</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  sheet1<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">sort</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"李四"</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">177</span><span class="token punctuation">,</span> <span class="token literal-property property">weight</span><span class="token operator">:</span> <span class="token number">88</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  sheet1<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token literal-property property">sort</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">"王五"</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">155</span><span class="token punctuation">,</span> <span class="token literal-property property">weight</span><span class="token operator">:</span> <span class="token number">62</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 读取行数据</span>
  sheet1<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eachCell</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">cell<span class="token punctuation">,</span> rowIdx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"行数据"</span><span class="token punctuation">,</span> cell<span class="token punctuation">.</span>value<span class="token punctuation">,</span> rowIdx<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 读取列数据,可以通过键(name)，字母(B)和基于id(1)的列号访问单个列</span>
  sheet1<span class="token punctuation">.</span><span class="token function">getColumn</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eachCell</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">cell<span class="token punctuation">,</span> rowIdx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"列数据"</span><span class="token punctuation">,</span> cell<span class="token punctuation">.</span>value<span class="token punctuation">,</span> rowIdx<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped lang<span class="token operator">=</span><span class="token string">"scss"</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre> 
<p>效果<br> <img src="https://images2.imgbox.com/83/21/GeoCO7UI_o.png" alt="image.png"></p> 
<h3><a id="_227"></a>样式</h3> 
<p>在导出excel文件时，默认没有任何样式的，为了美观我们需要添加样式，而exceljs支持修改表格样式，具体内容可参考文档<a href="https://github.com/exceljs/exceljs/blob/HEAD/README_zh.md#%E6%A0%B7%E5%BC%8F">https://github.com/exceljs/exceljs/blob/HEAD/README_zh.md#%E6%A0%B7%E5%BC%8F</a><br> 例如，我们需要设置所有单元格居中对齐，并添加边框。并分别指定标题行和内容行字体大小、背景颜色、行高属性，代码如下：</p> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">"primary"</span> @click<span class="token operator">=</span><span class="token string">"exportExcel"</span><span class="token operator">&gt;</span>导出excel<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> ExcelJS <span class="token keyword">from</span> <span class="token string">"exceljs"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FileSaver <span class="token keyword">from</span> <span class="token string">"file-saver"</span><span class="token punctuation">;</span>
<span class="token comment">// 导出excel文件</span>
<span class="token keyword">const</span> <span class="token function-variable function">exportExcel</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 创建工作簿</span>
  <span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelJS<span class="token punctuation">.</span>Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 添加工作表，名为sheet1</span>
  <span class="token keyword">const</span> sheet1 <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">addWorksheet</span><span class="token punctuation">(</span><span class="token string">"sheet1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 导出数据列表</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{<!-- --></span><span class="token string-property property">"姓名"</span><span class="token operator">:</span> <span class="token string">"张三"</span><span class="token punctuation">,</span> <span class="token string-property property">"年龄"</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string-property property">"身高"</span><span class="token operator">:</span> <span class="token number">175</span><span class="token punctuation">,</span> <span class="token string-property property">"体重"</span><span class="token operator">:</span> <span class="token number">74</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span><span class="token string-property property">"姓名"</span><span class="token operator">:</span> <span class="token string">"李四"</span><span class="token punctuation">,</span> <span class="token string-property property">"年龄"</span><span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token string-property property">"身高"</span><span class="token operator">:</span> <span class="token number">177</span><span class="token punctuation">,</span> <span class="token string-property property">"体重"</span><span class="token operator">:</span> <span class="token number">84</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span><span class="token string-property property">"姓名"</span><span class="token operator">:</span> <span class="token string">"王五"</span><span class="token punctuation">,</span> <span class="token string-property property">"年龄"</span><span class="token operator">:</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token string-property property">"身高"</span><span class="token operator">:</span> <span class="token number">155</span><span class="token punctuation">,</span> <span class="token string-property property">"体重"</span><span class="token operator">:</span> <span class="token number">64</span><span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
  <span class="token comment">// 获取表头所有键</span>
  <span class="token keyword">const</span> headers <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token comment">// 将标题写入第一行</span>
  sheet1<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span>headers<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 将数据写入工作表</span>
  data<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">row</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> values <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>
    sheet1<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 修改所有单元格样式</span>
  <span class="token comment">// 遍历每一行</span>
  sheet1<span class="token punctuation">.</span><span class="token function">eachRow</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">row<span class="token punctuation">,</span> rowNumber</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 遍历每个单元格</span>
    row<span class="token punctuation">.</span><span class="token function">eachCell</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">cell</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">// 设置边框样式</span>
      cell<span class="token punctuation">.</span>border <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">top</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token string">'thin'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">left</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token string">'thin'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">bottom</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token string">'thin'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">right</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token string">'thin'</span><span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token comment">// 设置居中对齐</span>
      cell<span class="token punctuation">.</span>alignment <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">vertical</span><span class="token operator">:</span> <span class="token string">'middle'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">horizontal</span><span class="token operator">:</span> <span class="token string">'center'</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 获取标题行数据</span>
  <span class="token keyword">const</span> titleCell <span class="token operator">=</span> sheet1<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 设置行高为30</span>
  titleCell<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">30</span>
  <span class="token comment">// 设置标题行单元格样式</span>
  titleCell<span class="token punctuation">.</span><span class="token function">eachCell</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">cell</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 设置标题行背景颜色为黄色</span>
    cell<span class="token punctuation">.</span>fill <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'pattern'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">pattern</span><span class="token operator">:</span> <span class="token string">'solid'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">fgColor</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">argb</span><span class="token operator">:</span> <span class="token string">'FFFF00'</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// 设置标题行字体</span>
    cell<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
      <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">argb</span><span class="token operator">:</span> <span class="token string">'FF0000'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">//颜色为红色</span>
      <span class="token literal-property property">bold</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">// 字体粗体</span>
      <span class="token literal-property property">size</span><span class="token operator">:</span> <span class="token number">18</span> <span class="token comment">// 设置字体大小为18</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// 获取第二行到最后一行的内容数据</span>
  <span class="token keyword">const</span> bodyRows <span class="token operator">=</span> sheet1<span class="token punctuation">.</span><span class="token function">getRows</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> sheet1<span class="token punctuation">.</span>rowCount<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 处理内容行的数据</span>
  bodyRows<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">bodyRow</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 设置行高为20</span>
    bodyRow<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">20</span>
    bodyRow<span class="token punctuation">.</span><span class="token function">eachCell</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">cell</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      cell<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">size</span><span class="token operator">:</span> <span class="token number">16</span> <span class="token comment">// 设置内容行字体大小为16</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 导出表格文件</span>
  workbook<span class="token punctuation">.</span>xlsx<span class="token punctuation">.</span><span class="token function">writeBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">buffer</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>buffer<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"application/octet-stream"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    FileSaver<span class="token punctuation">.</span><span class="token function">saveAs</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token string">"ExcelJS.xlsx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Error writing excel export'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped lang<span class="token operator">=</span><span class="token string">"scss"</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre> 
<p>导出Excel样式效果如下所示，已经成功按我们指定的样式导出了文件：<br> <img src="https://images2.imgbox.com/bd/97/lntZOnZS_o.png" alt="image.png"></p> 
<h3><a id="_324"></a>筛选</h3> 
<p>在很多的时候我们需要对表格中每一列的数据进行筛选，比如直接筛选姓名等列信息，我们可以通过 autoFilter 来添加筛选。参考文档：<a href="https://github.com/exceljs/exceljs/blob/HEAD/README_zh.md#%E8%87%AA%E5%8A%A8%E7%AD%9B%E9%80%89%E5%99%A8">https://github.com/exceljs/exceljs/blob/HEAD/README_zh.md#%E8%87%AA%E5%8A%A8%E7%AD%9B%E9%80%89%E5%99%A8</a><br> 代码如下：</p> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">"primary"</span> @click<span class="token operator">=</span><span class="token string">"exportExcel"</span><span class="token operator">&gt;</span>导出excel<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> ExcelJS <span class="token keyword">from</span> <span class="token string">"exceljs"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FileSaver <span class="token keyword">from</span> <span class="token string">"file-saver"</span><span class="token punctuation">;</span>
<span class="token comment">// 导出excel文件</span>
<span class="token keyword">const</span> <span class="token function-variable function">exportExcel</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 创建工作簿</span>
  <span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelJS<span class="token punctuation">.</span>Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 添加工作表，名为sheet1</span>
  <span class="token keyword">const</span> sheet1 <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">addWorksheet</span><span class="token punctuation">(</span><span class="token string">"sheet1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 导出数据列表</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{<!-- --></span><span class="token string-property property">"姓名"</span><span class="token operator">:</span> <span class="token string">"张三"</span><span class="token punctuation">,</span> <span class="token string-property property">"年龄"</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string-property property">"身高"</span><span class="token operator">:</span> <span class="token number">175</span><span class="token punctuation">,</span> <span class="token string-property property">"体重"</span><span class="token operator">:</span> <span class="token number">74</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span><span class="token string-property property">"姓名"</span><span class="token operator">:</span> <span class="token string">"李四"</span><span class="token punctuation">,</span> <span class="token string-property property">"年龄"</span><span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token string-property property">"身高"</span><span class="token operator">:</span> <span class="token number">177</span><span class="token punctuation">,</span> <span class="token string-property property">"体重"</span><span class="token operator">:</span> <span class="token number">84</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span><span class="token string-property property">"姓名"</span><span class="token operator">:</span> <span class="token string">"王五"</span><span class="token punctuation">,</span> <span class="token string-property property">"年龄"</span><span class="token operator">:</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token string-property property">"身高"</span><span class="token operator">:</span> <span class="token number">155</span><span class="token punctuation">,</span> <span class="token string-property property">"体重"</span><span class="token operator">:</span> <span class="token number">64</span><span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
  <span class="token comment">// 获取表头所有键</span>
  <span class="token keyword">const</span> headers <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token comment">// 将标题写入第一行</span>
  sheet1<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span>headers<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 将数据写入工作表</span>
  data<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">row</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> values <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>
    sheet1<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 单列筛选</span>
  <span class="token comment">// sheet1.autoFilter = "A1";</span>
  <span class="token comment">// 多个列筛选</span>
  sheet1<span class="token punctuation">.</span>autoFilter <span class="token operator">=</span> <span class="token string">"A1:C1"</span><span class="token punctuation">;</span>
  <span class="token comment">// 导出表格文件</span>
  workbook<span class="token punctuation">.</span>xlsx<span class="token punctuation">.</span><span class="token function">writeBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">buffer</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>buffer<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"application/octet-stream"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    FileSaver<span class="token punctuation">.</span><span class="token function">saveAs</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token string">"ExcelJS.xlsx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Error writing excel export'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped lang<span class="token operator">=</span><span class="token string">"scss"</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre> 
<p>导入后的效果如下，在姓名、年龄、身高列添加了筛选按钮：<br> <img src="https://images2.imgbox.com/1b/88/toufc7Gt_o.png" alt="image.png"></p> 
<h3><a id="_375"></a>公式值</h3> 
<p>参考文档：<a href="https://github.com/exceljs/exceljs/blob/HEAD/README_zh.md#%E5%80%BC%E7%B1%BB%E5%9E%8B">https://github.com/exceljs/exceljs/blob/HEAD/README_zh.md#%E5%80%BC%E7%B1%BB%E5%9E%8B</a><br> 我们可以直接对表格中的数据进行公式计算，比如 求和(SUM)，平均数(AVERAGE) 等。<br> 例如我们需要计算平均值、最大值、指定公式时，代码如下：</p> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">"primary"</span> @click<span class="token operator">=</span><span class="token string">"exportExcel"</span><span class="token operator">&gt;</span>导出excel<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> ExcelJS <span class="token keyword">from</span> <span class="token string">"exceljs"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FileSaver <span class="token keyword">from</span> <span class="token string">"file-saver"</span><span class="token punctuation">;</span>
<span class="token comment">// 导出excel文件</span>
<span class="token keyword">const</span> <span class="token function-variable function">exportExcel</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 创建工作簿</span>
  <span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelJS<span class="token punctuation">.</span>Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 添加工作表，名为sheet1</span>
  <span class="token keyword">const</span> sheet1 <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">addWorksheet</span><span class="token punctuation">(</span><span class="token string">"sheet1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 导出数据列表</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{<!-- --></span><span class="token string-property property">"姓名"</span><span class="token operator">:</span> <span class="token string">"张三"</span><span class="token punctuation">,</span> <span class="token string-property property">"年龄"</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string-property property">"身高"</span><span class="token operator">:</span> <span class="token number">1.75</span><span class="token punctuation">,</span> <span class="token string-property property">"体重"</span><span class="token operator">:</span> <span class="token number">74</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span><span class="token string-property property">"姓名"</span><span class="token operator">:</span> <span class="token string">"李四"</span><span class="token punctuation">,</span> <span class="token string-property property">"年龄"</span><span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token string-property property">"身高"</span><span class="token operator">:</span> <span class="token number">1.77</span><span class="token punctuation">,</span> <span class="token string-property property">"体重"</span><span class="token operator">:</span> <span class="token number">84</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span><span class="token string-property property">"姓名"</span><span class="token operator">:</span> <span class="token string">"王五"</span><span class="token punctuation">,</span> <span class="token string-property property">"年龄"</span><span class="token operator">:</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token string-property property">"身高"</span><span class="token operator">:</span> <span class="token number">1.55</span><span class="token punctuation">,</span> <span class="token string-property property">"体重"</span><span class="token operator">:</span> <span class="token number">64</span><span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
  <span class="token comment">// 获取表头所有键</span>
  <span class="token keyword">const</span> headers <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token comment">// 将标题写入第一行</span>
  sheet1<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span>headers<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 将数据写入工作表</span>
  data<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">row</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> values <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>
    sheet1<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 添加单元格</span>
  sheet1<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">"E1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">"BMI指数"</span><span class="token punctuation">;</span>
  sheet1<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">"F1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">"平均身高"</span><span class="token punctuation">;</span>
  sheet1<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">"G1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">"最大体重"</span><span class="token punctuation">;</span>
  <span class="token comment">// 计算平均身高</span>
  sheet1<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">"F2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">formula</span><span class="token operator">:</span> <span class="token string">"=AVERAGE(C2:C4)"</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token comment">// 计算最大体重</span>
  sheet1<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">"G2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">formula</span><span class="token operator">:</span> <span class="token string">"=MAX(D2:D4)"</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token comment">// 计算BMI指数</span>
  <span class="token comment">// 获取第5列对象</span>
  <span class="token keyword">const</span> BMIRange <span class="token operator">=</span> sheet1<span class="token punctuation">.</span><span class="token function">getColumn</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
  BMIRange<span class="token punctuation">.</span><span class="token function">eachCell</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">cell</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"cell"</span><span class="token punctuation">,</span> cell<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span>row<span class="token punctuation">)</span>
    <span class="token comment">// 从第二列开始添加计算公式</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>cell<span class="token punctuation">.</span>row <span class="token operator">&gt;=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      sheet1<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">"E"</span> <span class="token operator">+</span> cell<span class="token punctuation">.</span>row<span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">formula</span><span class="token operator">:</span> <span class="token string">"D"</span> <span class="token operator">+</span> cell<span class="token punctuation">.</span>row <span class="token operator">+</span> <span class="token string">"/"</span> <span class="token operator">+</span> <span class="token string">"(C"</span> <span class="token operator">+</span> cell<span class="token punctuation">.</span>row <span class="token operator">+</span> <span class="token string">"*"</span> <span class="token operator">+</span> <span class="token string">"C"</span> <span class="token operator">+</span> cell<span class="token punctuation">.</span>row <span class="token operator">+</span> <span class="token string">")"</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// 导出表格文件</span>
  workbook<span class="token punctuation">.</span>xlsx<span class="token punctuation">.</span><span class="token function">writeBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">buffer</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>buffer<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"application/octet-stream"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    FileSaver<span class="token punctuation">.</span><span class="token function">saveAs</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token string">"ExcelJS.xlsx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Error writing excel export'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped lang<span class="token operator">=</span><span class="token string">"scss"</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre> 
<p>导出Excel文件效果如下，E列已经自动替换为公式计算。<br> <img src="https://images2.imgbox.com/6a/51/1GFtCGWw_o.png" alt="image.png"></p> 
<h3><a id="_442"></a>合并单元格</h3> 
<p>表格的合并应该是业务需求中最频繁的功能。当然这一功能使用 xlsx 也可以实现，我们只需要使用mergeCells方法，传入合并单元格范围参数即可。<br> 参考文档：<a href="https://github.com/exceljs/exceljs/blob/HEAD/README_zh.md#%E5%90%88%E5%B9%B6%E5%8D%95%E5%85%83%E6%A0%BC">https://github.com/exceljs/exceljs/blob/HEAD/README_zh.md#%E5%90%88%E5%B9%B6%E5%8D%95%E5%85%83%E6%A0%BC</a><br> 具体代码实现如下所示：</p> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">"primary"</span> @click<span class="token operator">=</span><span class="token string">"exportExcel"</span><span class="token operator">&gt;</span>导出excel<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> ExcelJS <span class="token keyword">from</span> <span class="token string">"exceljs"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FileSaver <span class="token keyword">from</span> <span class="token string">"file-saver"</span><span class="token punctuation">;</span>
<span class="token comment">// 导出excel文件</span>
<span class="token keyword">const</span> <span class="token function-variable function">exportExcel</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 创建工作簿</span>
  <span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelJS<span class="token punctuation">.</span>Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 添加工作表，名为sheet1</span>
  <span class="token keyword">const</span> sheet1 <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">addWorksheet</span><span class="token punctuation">(</span><span class="token string">"sheet1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 导出数据列表</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{<!-- --></span><span class="token string-property property">"姓名"</span><span class="token operator">:</span> <span class="token string">"张三"</span><span class="token punctuation">,</span> <span class="token string-property property">"年龄"</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string-property property">"身高"</span><span class="token operator">:</span> <span class="token number">175</span><span class="token punctuation">,</span> <span class="token string-property property">"体重"</span><span class="token operator">:</span> <span class="token number">74</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span><span class="token string-property property">"姓名"</span><span class="token operator">:</span> <span class="token string">"李四"</span><span class="token punctuation">,</span> <span class="token string-property property">"年龄"</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string-property property">"身高"</span><span class="token operator">:</span> <span class="token string">'未知'</span><span class="token punctuation">,</span> <span class="token string-property property">"体重"</span><span class="token operator">:</span> <span class="token string">'未知'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span><span class="token string-property property">"姓名"</span><span class="token operator">:</span> <span class="token string">"王五"</span><span class="token punctuation">,</span> <span class="token string-property property">"年龄"</span><span class="token operator">:</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token string-property property">"身高"</span><span class="token operator">:</span> <span class="token string">'未知'</span><span class="token punctuation">,</span> <span class="token string-property property">"体重"</span><span class="token operator">:</span> <span class="token string">'未知'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span><span class="token string-property property">"姓名"</span><span class="token operator">:</span> <span class="token string">"赵六"</span><span class="token punctuation">,</span> <span class="token string-property property">"年龄"</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">"身高"</span><span class="token operator">:</span> <span class="token string">'未知'</span><span class="token punctuation">,</span> <span class="token string-property property">"体重"</span><span class="token operator">:</span> <span class="token string">'未知'</span><span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
  <span class="token comment">// 获取表头所有键</span>
  <span class="token keyword">const</span> headers <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token comment">// 将标题写入第一行</span>
  sheet1<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span>headers<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 将数据写入工作表</span>
  data<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">row</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> values <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>
    sheet1<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 上下合并单元格</span>
  sheet1<span class="token punctuation">.</span><span class="token function">mergeCells</span><span class="token punctuation">(</span><span class="token string">"B2:B3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 左右合并单元格</span>
  sheet1<span class="token punctuation">.</span><span class="token function">mergeCells</span><span class="token punctuation">(</span><span class="token string">"C3:D3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 范围合并单元格</span>
  sheet1<span class="token punctuation">.</span><span class="token function">mergeCells</span><span class="token punctuation">(</span><span class="token string">"C4:D5"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 导出表格文件</span>
  workbook<span class="token punctuation">.</span>xlsx<span class="token punctuation">.</span><span class="token function">writeBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">buffer</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>buffer<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"application/octet-stream"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    FileSaver<span class="token punctuation">.</span><span class="token function">saveAs</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token string">"ExcelJS.xlsx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Error writing excel export'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped lang<span class="token operator">=</span><span class="token string">"scss"</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>

</code></pre> 
<p>单元格合并后导出文件效果如下：<br> <img src="https://images2.imgbox.com/23/5d/jYpspg3k_o.png" alt="image.png"></p> 
<h3><a id="_498"></a>数据验证</h3> 
<p>有时候我们需要为某个单元格添加数据可以方便直接下拉选择指定的值，此时就需要使用数据验证功能，传入可填写的选项列表。<br> 参考文档：<a href="https://github.com/exceljs/exceljs/blob/HEAD/README_zh.md#%E6%95%B0%E6%8D%AE%E9%AA%8C%E8%AF%81">https://github.com/exceljs/exceljs/blob/HEAD/README_zh.md#%E6%95%B0%E6%8D%AE%E9%AA%8C%E8%AF%81</a><br> 例如我们对是否注册列添加数据验证，可填值为"是、否、未知"，具体代码如下：</p> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">"primary"</span> @click<span class="token operator">=</span><span class="token string">"exportExcel"</span><span class="token operator">&gt;</span>导出excel<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> ExcelJS <span class="token keyword">from</span> <span class="token string">"exceljs"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FileSaver <span class="token keyword">from</span> <span class="token string">"file-saver"</span><span class="token punctuation">;</span>
<span class="token comment">// 导出excel文件</span>
<span class="token keyword">const</span> <span class="token function-variable function">exportExcel</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 创建工作簿</span>
  <span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelJS<span class="token punctuation">.</span>Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 添加工作表，名为sheet1</span>
  <span class="token keyword">const</span> sheet1 <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">addWorksheet</span><span class="token punctuation">(</span><span class="token string">"sheet1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 导出数据列表</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{<!-- --></span><span class="token string-property property">"姓名"</span><span class="token operator">:</span> <span class="token string">"张三"</span><span class="token punctuation">,</span> <span class="token string-property property">"年龄"</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string-property property">"身高"</span><span class="token operator">:</span> <span class="token number">1.75</span><span class="token punctuation">,</span> <span class="token string-property property">"体重"</span><span class="token operator">:</span> <span class="token number">74</span><span class="token punctuation">,</span> <span class="token string-property property">"是否注册"</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span><span class="token string-property property">"姓名"</span><span class="token operator">:</span> <span class="token string">"李四"</span><span class="token punctuation">,</span> <span class="token string-property property">"年龄"</span><span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token string-property property">"身高"</span><span class="token operator">:</span> <span class="token number">1.77</span><span class="token punctuation">,</span> <span class="token string-property property">"体重"</span><span class="token operator">:</span> <span class="token number">84</span><span class="token punctuation">,</span> <span class="token string-property property">"是否注册"</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span><span class="token string-property property">"姓名"</span><span class="token operator">:</span> <span class="token string">"王五"</span><span class="token punctuation">,</span> <span class="token string-property property">"年龄"</span><span class="token operator">:</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token string-property property">"身高"</span><span class="token operator">:</span> <span class="token number">1.55</span><span class="token punctuation">,</span> <span class="token string-property property">"体重"</span><span class="token operator">:</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token string-property property">"是否注册"</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
  <span class="token comment">// 获取表头所有键</span>
  <span class="token keyword">const</span> headers <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token comment">// 将标题写入第一行</span>
  sheet1<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span>headers<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 将数据写入工作表</span>
  data<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">row</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> values <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>
    sheet1<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 获取第5列对象</span>
  <span class="token keyword">const</span> VerificationRange <span class="token operator">=</span> sheet1<span class="token punctuation">.</span><span class="token function">getColumn</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
  VerificationRange<span class="token punctuation">.</span><span class="token function">eachCell</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">cell</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 从第二列开始添加数据验证规则</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>cell<span class="token punctuation">.</span>row <span class="token operator">&gt;=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
      sheet1<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">"E"</span> <span class="token operator">+</span> cell<span class="token punctuation">.</span>row<span class="token punctuation">)</span><span class="token punctuation">.</span>dataValidation <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"list"</span><span class="token punctuation">,</span>
        <span class="token literal-property property">allowBlank</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">formulae</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'"是,否,未知"'</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// 导出表格文件</span>
  workbook<span class="token punctuation">.</span>xlsx<span class="token punctuation">.</span><span class="token function">writeBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">buffer</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>buffer<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"application/octet-stream"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    FileSaver<span class="token punctuation">.</span><span class="token function">saveAs</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token string">"ExcelJS.xlsx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Error writing excel export'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped lang<span class="token operator">=</span><span class="token string">"scss"</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>

</code></pre> 
<p>导出的excel文件效果如下：<br> <img src="https://images2.imgbox.com/c5/a0/FhnUcR5y_o.png" alt="image.png"></p> 
<h3><a id="_559"></a>条件格式化</h3> 
<p>我们可以为指定单元格添加条件格式，对满足条件的单元格设置指定的样式。<br> 参考文档：<a href="https://github.com/exceljs/exceljs/blob/HEAD/README_zh.md#%E6%9D%A1%E4%BB%B6%E6%A0%BC%E5%BC%8F%E5%8C%96">https://github.com/exceljs/exceljs/blob/HEAD/README_zh.md#%E6%9D%A1%E4%BB%B6%E6%A0%BC%E5%BC%8F%E5%8C%96</a><br> 例如为年龄大于18岁单元格进行红色标注，代码如下：</p> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">"primary"</span> @click<span class="token operator">=</span><span class="token string">"exportExcel"</span><span class="token operator">&gt;</span>导出excel<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> ExcelJS <span class="token keyword">from</span> <span class="token string">"exceljs"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FileSaver <span class="token keyword">from</span> <span class="token string">"file-saver"</span><span class="token punctuation">;</span>
<span class="token comment">// 导出excel文件</span>
<span class="token keyword">const</span> <span class="token function-variable function">exportExcel</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// 创建工作簿</span>
  <span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelJS<span class="token punctuation">.</span>Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 添加工作表，名为sheet1</span>
  <span class="token keyword">const</span> sheet1 <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">addWorksheet</span><span class="token punctuation">(</span><span class="token string">"sheet1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 导出数据列表</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{<!-- --></span><span class="token string-property property">"姓名"</span><span class="token operator">:</span> <span class="token string">"张三"</span><span class="token punctuation">,</span> <span class="token string-property property">"年龄"</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string-property property">"身高"</span><span class="token operator">:</span> <span class="token number">1.75</span><span class="token punctuation">,</span> <span class="token string-property property">"体重"</span><span class="token operator">:</span> <span class="token number">74</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span><span class="token string-property property">"姓名"</span><span class="token operator">:</span> <span class="token string">"李四"</span><span class="token punctuation">,</span> <span class="token string-property property">"年龄"</span><span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token string-property property">"身高"</span><span class="token operator">:</span> <span class="token number">1.77</span><span class="token punctuation">,</span> <span class="token string-property property">"体重"</span><span class="token operator">:</span> <span class="token number">84</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{<!-- --></span><span class="token string-property property">"姓名"</span><span class="token operator">:</span> <span class="token string">"王五"</span><span class="token punctuation">,</span> <span class="token string-property property">"年龄"</span><span class="token operator">:</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token string-property property">"身高"</span><span class="token operator">:</span> <span class="token number">1.55</span><span class="token punctuation">,</span> <span class="token string-property property">"体重"</span><span class="token operator">:</span> <span class="token number">64</span><span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
  <span class="token comment">// 获取表头所有键</span>
  <span class="token keyword">const</span> headers <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token comment">// 将标题写入第一行</span>
  sheet1<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span>headers<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 将数据写入工作表</span>
  data<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">row</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> values <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>
    sheet1<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 年龄大于18岁红色标注</span>
  sheet1<span class="token punctuation">.</span><span class="token function">addConditionalFormatting</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">ref</span><span class="token operator">:</span> <span class="token string">"B2:B4"</span><span class="token punctuation">,</span>
    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{<!-- --></span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"cellIs"</span><span class="token punctuation">,</span>
        <span class="token literal-property property">operator</span><span class="token operator">:</span> <span class="token string">"greaterThan"</span><span class="token punctuation">,</span>
        <span class="token literal-property property">priority</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token literal-property property">formulae</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
          <span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"pattern"</span><span class="token punctuation">,</span>
            <span class="token literal-property property">pattern</span><span class="token operator">:</span> <span class="token string">"solid"</span><span class="token punctuation">,</span>
            <span class="token literal-property property">bgColor</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span> <span class="token literal-property property">argb</span><span class="token operator">:</span> <span class="token string">"FFFFC0CB"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 导出表格文件</span>
  workbook<span class="token punctuation">.</span>xlsx<span class="token punctuation">.</span><span class="token function">writeBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">buffer</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">let</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>buffer<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"application/octet-stream"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    FileSaver<span class="token punctuation">.</span><span class="token function">saveAs</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token string">"ExcelJS.xlsx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Error writing excel export'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped lang<span class="token operator">=</span><span class="token string">"scss"</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre> 
<p>导出后的文件效果如下：<br> <img src="https://images2.imgbox.com/d5/07/l3vSeKzH_o.png" alt="image.png"></p> 
<h2><a id="exceljs_627"></a>封装exceljs</h2> 
<h3><a id="_628"></a>封装导入导出函数</h3> 
<p>为了提高项目代码的复用性，通常会将excel导入导出功能封装到单独的函数中方便调用，封装后的函数如下：</p> 
<pre><code class="prism language-javascript"><span class="token keyword">import</span> ExcelJS <span class="token keyword">from</span> <span class="token string">"exceljs"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FileSaver <span class="token keyword">from</span> <span class="token string">"file-saver"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>timeFile<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@/utils/timeFormat"</span><span class="token punctuation">;</span>
<span class="token comment">// 导出excel文件</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">exportFile</span><span class="token punctuation">(</span><span class="token parameter">export_data<span class="token punctuation">,</span> filename</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// 创建工作簿</span>
    <span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelJS<span class="token punctuation">.</span>Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 添加工作表，名为sheet1</span>
    <span class="token keyword">const</span> sheet1 <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">addWorksheet</span><span class="token punctuation">(</span><span class="token string">"sheet1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 获取表头所有键</span>
    <span class="token keyword">const</span> headers <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>export_data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment">// 将标题写入第一行</span>
    sheet1<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span>headers<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 将数据写入工作表</span>
    export_data<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">row</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">const</span> values <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>
        sheet1<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 设置默认宽高属性</span>
    sheet1<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>defaultColWidth <span class="token operator">=</span> <span class="token number">20</span>
    sheet1<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>defaultRowHeight <span class="token operator">=</span> <span class="token number">20</span>
    <span class="token comment">// 修改所有单元格样式</span>
    <span class="token comment">// 遍历每一行</span>
    sheet1<span class="token punctuation">.</span><span class="token function">eachRow</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">row<span class="token punctuation">,</span> rowNumber</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 遍历每个单元格</span>
        row<span class="token punctuation">.</span><span class="token function">eachCell</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">cell</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 设置边框样式</span>
            cell<span class="token punctuation">.</span>border <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">top</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token string">'thin'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">left</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token string">'thin'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">bottom</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token string">'thin'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">right</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token string">'thin'</span><span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            <span class="token comment">// 设置居中对齐</span>
            cell<span class="token punctuation">.</span>alignment <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
                <span class="token literal-property property">vertical</span><span class="token operator">:</span> <span class="token string">'middle'</span><span class="token punctuation">,</span>
                <span class="token literal-property property">horizontal</span><span class="token operator">:</span> <span class="token string">'center'</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 获取标题行数据</span>
    <span class="token keyword">const</span> titleCell <span class="token operator">=</span> sheet1<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 设置标题行单元格样式</span>
    titleCell<span class="token punctuation">.</span><span class="token function">eachCell</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">cell</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 设置标题行背景颜色</span>
        cell<span class="token punctuation">.</span>fill <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'pattern'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">pattern</span><span class="token operator">:</span> <span class="token string">'solid'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">fgColor</span><span class="token operator">:</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">argb</span><span class="token operator">:</span> <span class="token string">'3498db'</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token comment">// 设置标题行字体</span>
        cell<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
            <span class="token literal-property property">bold</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">// 字体粗体</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">// 导出表格文件</span>
    workbook<span class="token punctuation">.</span>xlsx<span class="token punctuation">.</span><span class="token function">writeBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">buffer</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">let</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>buffer<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{<!-- --></span><span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"application/octet-stream"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        FileSaver<span class="token punctuation">.</span><span class="token function">saveAs</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> filename <span class="token operator">+</span> <span class="token function">timeFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">".xlsx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Error writing excel export'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 导入excel文件</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">importFile</span><span class="token punctuation">(</span><span class="token parameter">content</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 创建一个空的JavaScript对象数组，用于存储解析后的数据</span>
        <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment">//创建Workbook实例</span>
        <span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelJS<span class="token punctuation">.</span>Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        workbook<span class="token punctuation">.</span>xlsx<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">workbook</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">// 获取第一个worksheet内容</span>
            <span class="token keyword">const</span> worksheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">getWorksheet</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 获取第一行的标题</span>
            <span class="token keyword">const</span> headers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            worksheet<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eachCell</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">cell</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
                headers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// console.log("headers", headers)</span>
            <span class="token comment">// 遍历工作表的每一行（从第二行开始，因为第一行通常是标题行）</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> rowNumber <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> rowNumber <span class="token operator">&lt;=</span> worksheet<span class="token punctuation">.</span>rowCount<span class="token punctuation">;</span> rowNumber<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">const</span> rowData <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>
                <span class="token keyword">const</span> row <span class="token operator">=</span> worksheet<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span>rowNumber<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 遍历当前行的每个单元格</span>
                row<span class="token punctuation">.</span><span class="token function">eachCell</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">cell<span class="token punctuation">,</span> colNumber</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
                    <span class="token comment">// 获取标题对应的键，并将当前单元格的值存储到相应的属性名中</span>
                    rowData<span class="token punctuation">[</span>headers<span class="token punctuation">[</span>colNumber <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> cell<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 将当前行的数据对象添加到数组中</span>
                data<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>rowData<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// console.log("data", data)</span>
            <span class="token function">resolve</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
            <span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="vue_729"></a>vue组件调用</h3> 
<p>以element plus为例，调用函数完成Excel文件导入与导出，代码如下：</p> 
<pre><code class="prism language-javascript"><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">"primary"</span> @click<span class="token operator">=</span><span class="token string">"exportExcel"</span><span class="token operator">&gt;</span>导出excel<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">"success"</span> @click<span class="token operator">=</span><span class="token string">"importExcel"</span><span class="token operator">&gt;</span>导入excel<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>导入数据预览<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
  <span class="token punctuation">{<!-- --></span><span class="token punctuation">{<!-- --></span> uploadData<span class="token punctuation">}</span><span class="token punctuation">}</span>
  <span class="token operator">&lt;</span>el<span class="token operator">-</span>dialog
      v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">"uploadDialogVisible"</span>
      title<span class="token operator">=</span><span class="token string">"批量添加数据"</span>
      width<span class="token operator">=</span><span class="token string">"40%"</span>
  <span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>el<span class="token operator">-</span>form label<span class="token operator">-</span>width<span class="token operator">=</span><span class="token string">"120px"</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item label<span class="token operator">=</span><span class="token string">"模板下载："</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">"info"</span> @click<span class="token operator">=</span><span class="token string">"downloadTemplate"</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>el<span class="token operator">-</span>icon<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>Download<span class="token operator">/</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>icon<span class="token operator">&gt;</span>
          点击下载
        <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item label<span class="token operator">=</span><span class="token string">"文件上传："</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>upload drag accept<span class="token operator">=</span><span class="token string">".xls,.xlsx"</span> <span class="token operator">:</span>auto<span class="token operator">-</span>upload<span class="token operator">=</span><span class="token string">"false"</span> <span class="token operator">:</span>on<span class="token operator">-</span>change<span class="token operator">=</span><span class="token string">"handleChange"</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>el<span class="token operator">-</span>icon <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"el-icon--upload"</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>upload<span class="token operator">-</span>filled<span class="token operator">/</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>icon<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"el-upload__text"</span><span class="token operator">&gt;</span>
            将文件拖到此处，或<span class="token operator">&lt;</span>em<span class="token operator">&gt;</span>点击上传<span class="token operator">&lt;</span><span class="token operator">/</span>em<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>template #tip<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"el-upload__tip"</span><span class="token operator">&gt;</span>
              请上传<span class="token punctuation">.</span>xls<span class="token punctuation">,</span><span class="token punctuation">.</span>xlsx格式文件，文件最大为500kb
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>upload<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">-</span>item<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>form<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>template #footer<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"dialog-footer"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>button @click<span class="token operator">=</span><span class="token string">"uploadDialogVisible = false"</span><span class="token operator">&gt;</span>取消<span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>el<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">"primary"</span> @click<span class="token operator">=</span><span class="token string">"submitUpload"</span><span class="token operator">&gt;</span>
          导入
        <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>el<span class="token operator">-</span>dialog<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>ref<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vue"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>ElMessage<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"element-plus"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>Download<span class="token punctuation">,</span> UploadFilled<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@element-plus/icons-vue"</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>getDemo<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@/api/home"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>timeFormatConversion<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@/utils/timeFormat"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{<!-- --></span>exportFile<span class="token punctuation">,</span> importFile<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@/utils/excel"</span><span class="token punctuation">;</span>
<span class="token comment">// 表格字段配置</span>
<span class="token keyword">const</span> fieldConfig <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">'label'</span><span class="token operator">:</span> <span class="token string">'ID'</span><span class="token punctuation">,</span> <span class="token comment">// 标签</span>
    <span class="token string-property property">'model'</span><span class="token operator">:</span> <span class="token string">'id'</span><span class="token punctuation">,</span><span class="token comment">// 字段名</span>
    <span class="token string-property property">'is_export'</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">// 是否导出该字段</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">'label'</span><span class="token operator">:</span> <span class="token string">'用户名'</span><span class="token punctuation">,</span> <span class="token comment">// 标签</span>
    <span class="token string-property property">'model'</span><span class="token operator">:</span> <span class="token string">'username'</span><span class="token punctuation">,</span><span class="token comment">// 字段名</span>
    <span class="token string-property property">'is_export'</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 是否导出该字段</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">'label'</span><span class="token operator">:</span> <span class="token string">'省份'</span><span class="token punctuation">,</span> <span class="token comment">// 标签</span>
    <span class="token string-property property">'model'</span><span class="token operator">:</span> <span class="token string">'province'</span><span class="token punctuation">,</span><span class="token comment">// 字段名</span>
    <span class="token string-property property">'is_export'</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// 是否导出该字段</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">'label'</span><span class="token operator">:</span> <span class="token string">'性别'</span><span class="token punctuation">,</span> <span class="token comment">// 标签</span>
    <span class="token string-property property">'model'</span><span class="token operator">:</span> <span class="token string">'sex_name'</span><span class="token punctuation">,</span><span class="token comment">// 字段名</span>
    <span class="token string-property property">'is_export'</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// 是否导出该字段</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">'label'</span><span class="token operator">:</span> <span class="token string">'生日'</span><span class="token punctuation">,</span> <span class="token comment">// 标签</span>
    <span class="token string-property property">'model'</span><span class="token operator">:</span> <span class="token string">'birthday'</span><span class="token punctuation">,</span><span class="token comment">// 字段名</span>
    <span class="token string-property property">'is_export'</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 是否导出该字段</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">'label'</span><span class="token operator">:</span> <span class="token string">'身高(cm)'</span><span class="token punctuation">,</span> <span class="token comment">// 标签</span>
    <span class="token string-property property">'model'</span><span class="token operator">:</span> <span class="token string">'height'</span><span class="token punctuation">,</span><span class="token comment">// 字段名</span>
    <span class="token string-property property">'is_export'</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 是否导出该字段</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">'label'</span><span class="token operator">:</span> <span class="token string">'体重(kg)'</span><span class="token punctuation">,</span> <span class="token comment">// 标签</span>
    <span class="token string-property property">'model'</span><span class="token operator">:</span> <span class="token string">'weight'</span><span class="token punctuation">,</span><span class="token comment">// 字段名</span>
    <span class="token string-property property">'is_export'</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">// 是否导出该字段</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">'label'</span><span class="token operator">:</span> <span class="token string">'注册时间'</span><span class="token punctuation">,</span> <span class="token comment">// 标签</span>
    <span class="token string-property property">'model'</span><span class="token operator">:</span> <span class="token string">'created_time'</span><span class="token punctuation">,</span><span class="token comment">// 字段名</span>
    <span class="token string-property property">'is_export'</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 是否导出该字段</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">'label'</span><span class="token operator">:</span> <span class="token string">'个人介绍'</span><span class="token punctuation">,</span> <span class="token comment">// 标签</span>
    <span class="token string-property property">'model'</span><span class="token operator">:</span> <span class="token string">'introduction'</span><span class="token punctuation">,</span><span class="token comment">// 字段名</span>
    <span class="token string-property property">'is_export'</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">// 是否导出该字段</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">// 导出Excel事件</span>
<span class="token keyword">const</span> <span class="token function-variable function">exportExcel</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token function">ElMessage</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span>
    <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'开始导出数据，请稍候！'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'success'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token comment">// 导出数据查询参数</span>
  <span class="token keyword">const</span> printParams <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token string-property property">'size'</span><span class="token operator">:</span> <span class="token number">1000</span><span class="token punctuation">,</span>
    <span class="token string-property property">'page'</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 获取需要导出的字段配置</span>
  <span class="token keyword">const</span> export_fields <span class="token operator">=</span> fieldConfig<span class="token punctuation">.</span>value
      <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">obj</span> <span class="token operator">=&gt;</span> obj<span class="token punctuation">[</span><span class="token string">'is_export'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{<!-- --></span>label<span class="token punctuation">,</span> model<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span><span class="token punctuation">[</span>model<span class="token punctuation">]</span><span class="token operator">:</span> label<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token comment">// 处理数据结构</span>
  <span class="token function">getDemo</span><span class="token punctuation">(</span>printParams<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// console.log(response.results)</span>
    <span class="token keyword">const</span> export_data <span class="token operator">=</span> response<span class="token punctuation">.</span>results<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">obj</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token keyword">const</span> newObj <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      export_fields<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">field</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">const</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span> value<span class="token punctuation">]</span> <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>field<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">'created_time'</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
          newObj<span class="token punctuation">[</span>value<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">timeFormatConversion</span><span class="token punctuation">(</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'YYYY-MM-DD HH:mm:ss'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
          newObj<span class="token punctuation">[</span>value<span class="token punctuation">]</span> <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> newObj<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> filename <span class="token operator">=</span> <span class="token string">'示例用户'</span>
    <span class="token function">exportFile</span><span class="token punctuation">(</span>export_data<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">//发生错误时执行的代码</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span>
    ElMessage<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'获取列表数据失败！'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 导入excel弹窗是否显示</span>
<span class="token keyword">const</span> uploadDialogVisible <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token comment">// 点击导入excel按钮事件</span>
<span class="token keyword">const</span> <span class="token function-variable function">importExcel</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  uploadDialogVisible<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
<span class="token comment">// 下载模板文件</span>
<span class="token keyword">const</span> <span class="token function-variable function">downloadTemplate</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  window<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'https://api.cuiliangblog.cn/static/demo-template.xlsx'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 文件数据</span>
<span class="token keyword">const</span> uploadData<span class="token operator">=</span><span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">// 文件上传事件</span>
<span class="token keyword">const</span> <span class="token function-variable function">handleChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">file</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">const</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  reader<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">const</span> content <span class="token operator">=</span> reader<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
    <span class="token function">importFile</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
      uploadData<span class="token punctuation">.</span>value <span class="token operator">=</span> data
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">//发生错误时执行的代码</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span>
      ElMessage<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'获取列表数据失败！'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  reader<span class="token punctuation">.</span><span class="token function">readAsBinaryString</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span>raw<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 点击导入excel提交数据事件</span>
<span class="token keyword">const</span> <span class="token function-variable function">submitUpload</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{<!-- --></span>
  uploadDialogVisible<span class="token punctuation">.</span>value <span class="token operator">=</span><span class="token boolean">false</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped lang<span class="token operator">=</span><span class="token string">"scss"</span><span class="token operator">&gt;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre> 
<h3><a id="_909"></a>页面效果</h3> 
<p>封装后的页面效果如下，至此，一个简单的vue前端实现Excel文件导入导出功能便开发完成了。<br> <img src="https://images2.imgbox.com/7e/b5/GiP9L4yp_o.png" alt="image.png"></p> 
<h2><a id="_912"></a>完整代码</h2> 
<p>gitee：<a href="https://gitee.com/cuiliang0302/vue3_vite_element-plus" rel="nofollow">https://gitee.com/cuiliang0302/vue3_vite_element-plus</a><br> github：<a href="https://github.com/cuiliang0302/vue3-vite-template">https://github.com/cuiliang0302/vue3-vite-template</a></p> 
<h2><a id="_916"></a>查看更多</h2> 
<h3><a id="_918"></a>微信公众号</h3> 
<p>微信公众号同步更新，欢迎关注微信公众号《崔亮的博客》第一时间获取最近文章。</p> 
<h3><a id="_921"></a>博客网站</h3> 
<p>崔亮的博客-专注devops自动化运维，传播优秀it运维技术文章。更多原创运维开发相关文章，欢迎访问<a href="https://www.cuiliangblog.cn" rel="nofollow">https://www.cuiliangblog.cn</a></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/39a61dcf06343b1ee7a78426a567235b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">如何降低aigc查重率【解决方案】</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/5360bc78eaa342ef655f048d036a0c04/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">[ai笔记13] 大模型架构对比盘点：Encoder-Only、Decoder-Only、Encoder-Decoder</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程学习者.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
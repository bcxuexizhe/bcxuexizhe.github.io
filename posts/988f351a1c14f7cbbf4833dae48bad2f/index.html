<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【Stable Diffusion】最新换脸模型：IP-Adapter Face ID Plus V2 WebUI 效果超赞！ - 编程学习者</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcxuexizhe.github.io/posts/988f351a1c14f7cbbf4833dae48bad2f/">
  <meta property="og:site_name" content="编程学习者">
  <meta property="og:title" content="【Stable Diffusion】最新换脸模型：IP-Adapter Face ID Plus V2 WebUI 效果超赞！">
  <meta property="og:description" content="ControlNet 是 Stable Diffusion Web UI 中功能最强大的插件。基于 ControlNet 的各种控制类型让 Stable Diffusion 成为 AI 绘图工具中最可控的一种。
IP Adapter 就是其中的一种非常有用的控制类型。它不仅能够实现像 Midjourney 一样的“垫图”功能，还能用来给肖像人物换脸。
IP Adapter 的很多老的模型都可以用来换脸，如 Plus Face。然而，IP Adapter 不断推出了更新的模型，持续为我们带来惊喜。通过我的亲身测试，我发现新的 Face ID Plus V2 模型在换脸效果上远胜以往。
我尝试将好莱坞女星 Angelina Jolie 的脸部特征融合到了由 Midjourney 生成的多个图片中，包括一名中世纪女战士、一幅文艺复兴时期的美女肖像，以及一位女王的形象，效果都非常令人满意。
怎么样？效果还不错吧？接下来我来介绍如何在 Web UI 中安装并使用这个模型。
准备工作 我们主要利用 Control Net 中的 IP Adapter 来进行换脸，同时使用 OpenPose 保持原图人物的头部姿势。
相对于 Control Net 的其他控制类型，IP Adapter 是后来才有的。如果你的 Control Net 版本较旧，可能需要更新以支持 IP Adapter 功能。
我们需要下载以下内容：
Open Pose 模型IP-Adapter FaceID Plus V2 模型和 Lora 其中 IP Adapter 用来换脸，Open Pose 用来保持住原图人物的头部姿势。Lora 可以提升面部 ID 的一致性。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-17T11:22:07+08:00">
    <meta property="article:modified_time" content="2024-04-17T11:22:07+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程学习者" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程学习者</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【Stable Diffusion】最新换脸模型：IP-Adapter Face ID Plus V2 WebUI 效果超赞！</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>ControlNet 是 Stable Diffusion Web UI 中功能最强大的插件。基于 ControlNet 的各种控制类型让 Stable Diffusion 成为 AI 绘图工具中最可控的一种。</p> 
<p>IP Adapter 就是其中的一种非常有用的控制类型。它不仅能够实现像 Midjourney 一样的“垫图”功能，还能用来给肖像人物换脸。</p> 
<p>IP Adapter 的很多老的模型都可以用来换脸，如 Plus Face。然而，IP Adapter 不断推出了更新的模型，持续为我们带来惊喜。通过我的亲身测试，我发现新的 Face ID Plus V2 模型在换脸效果上远胜以往。</p> 
<p>我尝试将好莱坞女星 Angelina Jolie 的脸部特征融合到了由 Midjourney 生成的多个图片中，包括一名中世纪女战士、一幅文艺复兴时期的美女肖像，以及一位女王的形象，效果都非常令人满意。</p> 
<p><img src="https://images2.imgbox.com/ae/c8/Kq6cpOod_o.png" alt=""></p> 
<p><img src="https://images2.imgbox.com/6b/d5/sEnlefqg_o.png" alt=""></p> 
<p><img src="https://images2.imgbox.com/c1/31/PWlh2WKX_o.png" alt=""></p> 
<p>怎么样？效果还不错吧？接下来我来介绍如何在 Web UI 中安装并使用这个模型。</p> 
<h3><a id="_19"></a>准备工作</h3> 
<p>我们主要利用 Control Net 中的 IP Adapter 来进行换脸，同时使用 OpenPose 保持原图人物的头部姿势。</p> 
<p><img src="https://images2.imgbox.com/8d/49/fX8dAVSl_o.png" alt=""></p> 
<p>相对于 Control Net 的其他控制类型，IP Adapter 是后来才有的。如果你的 Control Net 版本较旧，可能需要更新以支持 IP Adapter 功能。</p> 
<p>我们需要下载以下内容：</p> 
<ul><li><strong>Open Pose</strong> 模型</li><li><strong>IP-Adapter FaceID Plus V2</strong> 模型和 Lora</li></ul> 
<p><img src="https://images2.imgbox.com/3c/b3/TZy4Dw6s_o.png" alt=""></p> 
<p>其中 IP Adapter 用来换脸，Open Pose 用来保持住原图人物的头部姿势。Lora 可以提升面部 ID 的一致性。</p> 
<p>这些文件都可以在 Hugging Face 上找到，接下来我将介绍如何下载和安装。</p> 
<h3><a id="Lora_40"></a>下载模型和Lora</h3> 
<h4><a id="_Open_Pose__43"></a>获取 Open Pose 模型</h4> 
<p>1️⃣ 首先，访问 HuggingFace 网页 ，定位到 Control Net 模型的下载页面。这里列出了所有 Control Net 的基础模型及其配置文件。</p> 
<p>2️⃣ 在页面中向下滚动，搜索包含“Open Pose”关键词的文件。</p> 
<p>3️⃣ 你会发现有两种文件类型：以 <code>.pth</code> 结尾的是模型文件，而以 <code>.yaml</code> 结尾的则是模型的配置文件。通常，<code>.yaml</code> 配置文件已经在 Control Net 安装时包含在内，因此我们主要关注的是下载 <code>.pth</code> 结尾的模型文件。</p> 
<p><img src="https://images2.imgbox.com/31/b2/WuHeIG9I_o.png" alt=""></p> 
<p>4️⃣ 点击下载按钮开始下载所需的 <code>.pth</code> 文件。</p> 
<p>5️⃣ 下载完成以后，放在 <code>stable-diffusion-webui\extensions\sd-webui-controlnet\models</code>文件夹。</p> 
<h4><a id="_IP_Adapter__Face_ID__Lora_57"></a>下载 IP Adapter 需要的 Face ID 模型和 Lora</h4> 
<p>1️⃣ 继续访问另一个HuggingFace 下载页面 ，寻找 IP Adapter Face ID Plus sd15 和 sd15 lora 文件。这些文件专为 sd 1.5 的模型设计，提供了良好的性能和对 Control Net 其他控制类型的支持。</p> 
<p>2️⃣点击下载按钮，开始下载这些文件。注意，sd15 代表这些文件适用于 sd 1.5 版本的模型，而不是 sdxl 版本。</p> 
<p><img src="https://images2.imgbox.com/2a/47/AAlQOwcp_o.png" alt=""></p> 
<p>3️⃣Lora 文件特别用于提升面部 ID 的一致性，对于提高换脸效果的自然度非常关键。</p> 
<p>4️⃣下载完成以后，以<code>.bin</code>结尾的模型文件放在 <code>stable-diffusion-webui\extensions\sd-webui-controlnet\models</code>文件夹。</p> 
<p>5️⃣ 以<code>.safetensors</code>结尾的Lora文件放在 <code>stable-diffusion-webui\models\Lora</code>文件夹。</p> 
<h4><a id="_InsightFace_72"></a>安装 InsightFace</h4> 
<p>如果你在使用FaceID的过程中可能会遇到终端提示<code>No module named 'insightface'</code>的错误，如下图所示。</p> 
<p><img src="https://images2.imgbox.com/19/ed/gUP3g4y0_o.png" alt=""></p> 
<p>这时候你需要安装 InsightFace。Stable Diffusion 很多换脸的插件都会用到它，比如 Reactor。</p> 
<p>GitHub 上有个 Issue专门讨论这个问题。用户<code>MMoneer</code>给出了如下解决方案：</p> 
<p>1️⃣下载预编译的 Insightface 软件包</p> 
<p>2️⃣下载后将其放入 stable-diffusion-webui 的根文件夹（"webui-user.bat "文件所在文件夹）</p> 
<p>3️⃣在 WebUI的根目录分别运行<code>CMD</code>和<code>.\venv\Scripts\activate</code>。</p> 
<p>4️⃣ 升级一下Pip：<code>python -m pip install -U pip</code>。</p> 
<p>5️⃣取决于你的Python版本，运行下面两个代码的其中一个：pip install insightface-0.7.3-cp310-cp310-win_amd64.whl (对于3.10) 或者 pip install insightface-0.7.3-cp311-cp311-win_amd64.whl (对于3.11)。</p> 
<h3><a id="_92"></a>换脸实操</h3> 
<p>在开始换脸操作之前，准备工作是必不可少的。这不仅包括了模型的下载和安装，也涉及到被换脸图片的预处理。接下来，我会详细介绍从准备头像到在 Web UI 中进行换脸的整个流程。</p> 
<h5><a id="_97"></a>准备头像</h5> 
<p>1️⃣选择了好莱坞明星 Angelina Jolie 的头像作为换脸的源图片。但发现原图偏亮，这可能会导致换脸后的图像在脸部区域过亮。</p> 
<p>2️⃣为了解决这个问题，我使用 PS 对头像的亮度进行了调整，将其降至平均水平，并对脸部的高光区域进行了调暗处理。</p> 
<p><img src="https://images2.imgbox.com/c8/b1/7hTvEaO1_o.png" alt=""></p> 
<h5><a id="_105"></a>选择模型</h5> 
<p>1️⃣图片处理完毕后，进入 Stable Diffusion 的 Web UI 界面。</p> 
<p>2️⃣在这里，需要选择一个适合进行写实风格生成的 SD 1.5 模型。我个人选择的是 <code>cyber realistic</code> 模型，但大家可以根据自己的需求选择其他模型，比较不同模型的效果。</p> 
<p>3️⃣在提示词区域暂时不输入任何内容，直接转向我们之前下载的 Lora 文件，这个文件用于增强脸部的一致性。</p> 
<p>4️⃣ 点击“Lora”选项，选择我们下载的 <code>face_id_plus_v2_sd15_lora</code> 文件。选中后，Lora 将会被添加到提示词输入框中。</p> 
<p>5️⃣接着，通过按住 Ctrl 键并使用向下方向键，调整 Lora 的权重，建议设置在 0.5 到 0.7 的范围内。</p> 
<p><img src="https://images2.imgbox.com/1c/df/Lzmpz6Yx_o.png" alt=""></p> 
<h5><a id="_119"></a>局部绘制设置</h5> 
<p>1️⃣接下来的步骤是点击“局部绘制”选项，这一功能允许 Stable Diffusion 专注于重绘特定的面部区域。</p> 
<p>2️⃣上传想要被换脸的图片，然后使用画笔工具在人物的脸部区域进行标记。为了更好地实现融合效果，标记的区域可以适当大一些。</p> 
<p><img src="https://images2.imgbox.com/6b/2a/dJ90gher_o.png" alt=""></p> 
<p>通过上述步骤，我们完成了换脸操作的所有准备工作，包括头像的预处理和在 Web UI 中的设置。下一步，我们将进入实际的生成过程，利用 Stable Diffusion 的强大功能，为 Angelina Jolie 创建全新的面孔。</p> 
<h5><a id="_129"></a>局部重绘的参数设置</h5> 
<p>进行局部重绘时，正确的参数设置可以显著提升换脸效果的自然度和细节。以下是详细的参数调整指南：</p> 
<ul><li><strong>蒙版模糊度</strong>：增加蒙版模糊度有助于减少换脸后图像中可能出现的生硬接缝。这一步骤是为了确保脸部与原图更加平滑地融合。</li><li><strong>采样方法</strong>：选择与写实模型相匹配的采样方法，以便生成的图像贴合预期风格。</li><li><strong>采样步数</strong>：适当增加采样步数可以改善生成图像的质量，使细节更加丰富和精确。</li><li><strong>宽度和高度</strong>：保持与原图相同的宽度和高度，以确保图像的一致性。</li><li><strong>提示词引导系数</strong>：设置在6到8之间，以平衡图像内容与生成的一致性。</li><li><strong>重绘强度</strong>：调整到0.4-0.6之间，控制重绘区域的强度，以达到理想的换脸效果。</li></ul> 
<p><img src="https://images2.imgbox.com/c5/fa/HVJ3fDbb_o.png" alt=""></p> 
<h5><a id="ControlNet_IPAdapter_142"></a>设置第一个ControlNet: IP-Adapter</h5> 
<p>接下来是 IP-Adapter 的配置，这一步骤确保了换脸操作可以准确地识别和应用面部特征。</p> 
<ol start="0"><li><strong>启用 Control Net</strong>：在 Web UI 中找到 Control Net 设置并展开，勾选“启用”选项。</li><li><strong>完美匹配像素</strong>：选择此项以提高生成图像的精确度。</li><li><strong>上传独立控制图像</strong>：点击上传区域，从文件浏览器中选择 Angelina Jolie 的头像作为控制图像。</li><li><strong>选择控制网络类型</strong>：在“控制网络类型”选项中选择 IP Adapter。</li><li><strong>预处理和模型选择</strong>：确保预处理选择为“ip_adapter_face_id_plus”，并选择相应的“ip_adapter_face_id_plus_v2_sd”模型。这一步骤关键在于保证预处理器与模型相匹配，以免 IP Adapter 功能失效。</li><li><strong>预览效果</strong>：点击形状像爆炸一样的按钮，预览 IP Adapter 的效果，确认没有问题。</li></ol> 
<p><img src="https://images2.imgbox.com/bf/eb/tq9l4bUr_o.png" alt=""></p> 
<h5><a id="_Control_Net_OpenPose_155"></a>设置第二个 Control Net: OpenPose</h5> 
<p>在完成了首个 Control Net 的配置后，我们进入到设置第二个 Control Net 的步骤，这次是为了利用 OpenPose 保持人物头部姿势的自然和一致性。这一步骤对于确保换脸后的图像在姿势上与原始图像保持一致非常关键。</p> 
<ol start="0"><li><strong>启用 Control Net Unit 1</strong>：在 Web UI 中找到并展开“Control Net Unit 1”的设置部分，确保勾选“启用”以激活此单元。</li><li><strong>上传独立控制图像</strong>：点击上传区域，从文件浏览器中选择要被换脸的图片作为控制图像。</li><li><strong>选择控制网络类型为 Open Pose</strong>：在“控制网络类型”中选择 OpenPose，这是为了捕捉并保持原始人物的头部姿势。</li><li><strong>预处理和模型选择</strong>：对于预处理，选择最基础的“openpose”选项。对于模型，选择与 Open Pose 相关的“sd15 openpose”模型。</li><li><strong>预览 Open Pose 效果</strong>：点击预览按钮（形状像爆炸一样的图标），查看 OpenPose 的效果，确保骨骼图正确生成，没有问题。</li></ol> 
<p><img src="https://images2.imgbox.com/b9/0d/vgoALyCo_o.png" alt=""></p> 
<h4><a id="_167"></a>生成图片</h4> 
<p>完成两个 Control Net 的设置之后，我们准备好生成最终的图片了：</p> 
<ul><li>向上滚动页面，找到并点击“Generate”按钮开始生成过程。</li><li>等待过程完成，你将看到换脸效果呈现出来，其中包括面部的角度和光线的自然融合。</li></ul> 
<p><img src="https://images2.imgbox.com/76/b3/fD65usXn_o.png" alt=""></p> 
<h3><a id="_176"></a>结果评估与调整</h3> 
<ul><li>生成的图像中，Angelina Jolie 的特征——如弯曲的睫毛、蓝绿色的眼睛和性感的嘴唇——都得到了精准的呈现。</li><li>如果在最终的图像中仍存在一些细微的问题，我们可以使用 Photoshop 进行进一步的调整，以达到完美的效果。</li></ul> 
<p>通过细心配置 Open Pose 和 IP Adapter 的 Control Net，我们能够确保换脸效果不仅在视觉上令人满意，而且在姿势和表情上也与原图保持高度一致，从而实现了高质量的换脸效果。</p> 
<h3><a id="_185"></a>写在最后</h3> 
<p><font face="幼圆" size="4" color="red">感兴趣的小伙伴，赠送全套AIGC学习资料，包含AI绘画、AI人工智能等前沿科技教程和软件工具，具体看这里。<br> ​<img src="https://images2.imgbox.com/0c/05/5soIsJtB_o.jpg"></font></p> 
<p>AIGC技术的未来发展前景广阔，随着人工智能技术的不断发展，AIGC技术也将不断提高。未来，AIGC技术将在游戏和计算领域得到更广泛的应用，使游戏和计算系统具有更高效、更智能、更灵活的特性。同时，AIGC技术也将与人工智能技术紧密结合，在更多的领域得到广泛应用，对程序员来说影响至关重要。未来，AIGC技术将继续得到提高，同时也将与人工智能技术紧密结合，在更多的领域得到广泛应用。<br>  <br> <img src="https://images2.imgbox.com/46/a3/nfqwJKNw_o.png" alt="在这里插入图片描述"></p> 
<p><strong>一、AIGC所有方向的学习路线</strong></p> 
<p>AIGC所有方向的技术点做的整理，形成各个领域的知识点汇总，它的用处就在于，你可以按照下面的知识点去找对应的学习资源，保证自己学得较为全面。</p> 
<p><img src="https://images2.imgbox.com/25/20/W8EkZuqq_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/a5/5a/B4WzgqHg_o.png" alt="在这里插入图片描述"></p> 
<p><strong>二、AIGC必备工具</strong></p> 
<p>工具都帮大家整理好了，安装就可直接上手！<br> <img src="https://images2.imgbox.com/a5/9d/1NLgdIky_o.png" alt="在这里插入图片描述"></p> 
<p><strong>三、最新AIGC学习笔记</strong></p> 
<p>当我学到一定基础，有自己的理解能力的时候，会去阅读一些前辈整理的书籍或者手写的笔记资料，这些笔记详细记载了他们对一些技术点的理解，这些理解是比较独到，可以学到不一样的思路。<br> <img src="https://images2.imgbox.com/10/ee/pfAvmJLs_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/fd/6c/0R0xm9s1_o.png" alt="在这里插入图片描述"></p> 
<p><strong>四、AIGC视频教程合集</strong></p> 
<p>观看全面零基础学习视频，看视频学习是最快捷也是最有效果的方式，跟着视频中老师的思路，从基础到深入，还是很容易入门的。</p> 
<p><img src="https://images2.imgbox.com/7c/5d/jzLbA5RH_o.png" alt="在这里插入图片描述"></p> 
<p><strong>五、实战案例</strong></p> 
<p>纸上得来终觉浅，要学会跟着视频一起敲，要动手实操，才能将自己的所学运用到实际当中去，这时候可以搞点实战案例来学习。<br> <img src="https://images2.imgbox.com/30/51/ya2LOCet_o.png" alt="在这里插入图片描述"><br> ​<img src="https://images2.imgbox.com/fd/29/YXqxGqOc_o.jpg"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/6ddd0f39e3a5c141c9b08ecd60cef6ed/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">StarRocks实战——多点大数据数仓构建</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1800a24e4ee85c215c2ba80b03584dca/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">ZooKeeper中节点的操作命令（查看、创建、删除节点）_zookeeper 删除 节点</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程学习者.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C#è¿›é˜¶-OleDbæ“ä½œExcelå’Œæ•°æ®åº“ - ç¼–ç¨‹å­¦ä¹ è€…</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcxuexizhe.github.io/posts/b68fabb53e8d1b6d112aacf7e5a2d3d5/">
  <meta property="og:site_name" content="ç¼–ç¨‹å­¦ä¹ è€…">
  <meta property="og:title" content="C#è¿›é˜¶-OleDbæ“ä½œExcelå’Œæ•°æ®åº“">
  <meta property="og:description" content="åœ¨C#ç¼–ç¨‹ä¸­ï¼Œä½¿ç”¨OleDbå¯ä»¥æ–¹ä¾¿åœ°å®ç°å¯¹Excelæ–‡ä»¶å’Œæ•°æ®åº“çš„æ“ä½œã€‚æœ¬æ–‡æ¢è®¨äº†åœ¨C#ä¸­ä½¿ç”¨OleDbæŠ€æœ¯æ“ä½œExcelå’Œæ•°æ®åº“çš„ç­–ç•¥ã€‚æ–‡ç« è¯¦è¿°äº†OleDbçš„å®šä¹‰ã€é…ç½®ç¯å¢ƒçš„æ­¥éª¤ï¼Œå¹¶é€šè¿‡å®é™…ä»£ç ç¤ºä¾‹æ¼”ç¤ºäº†å¦‚ä½•é«˜æ•ˆè¯»å†™Excelæ–‡ä»¶å’Œäº¤äº’æ•°æ®åº“ã€‚æ–‡ä¸­è¿˜è¯„ä¼°äº†OleDbæŠ€æœ¯çš„ä¼˜ç¼ºç‚¹ï¼Œä¸ºéœ€è¦å¤„ç†å¤šç§æ•°æ®æºçš„å¼€å‘è€…æä¾›äº†ä¸€ç§æœ‰æ•ˆçš„æ•°æ®æ“ä½œæ–¹æ¡ˆã€‚
ä¸€ã€OleDbç®€ä»‹ OleDbï¼ˆObject Linking and Embedding, Databaseï¼‰æ˜¯å¾®è½¯çš„ä¸€å¥—æ•°æ®åº“è®¿é—®æ¥å£ï¼Œæ”¯æŒå¯¹å¤šç§æ•°æ®æºçš„è®¿é—®ï¼ŒåŒ…æ‹¬SQL Serverã€Accessä»¥åŠExcelç­‰ã€‚å®ƒæä¾›äº†ä¸€ç§ç»Ÿä¸€çš„æ–¹æ³•æ¥è®¿é—®ä¸åŒçš„æ•°æ®æºã€‚åœ¨.NETç¯å¢ƒä¸‹ï¼ŒOleDbå¯ä»¥é€šè¿‡System.Data.OleDbå‘½åç©ºé—´æä¾›çš„ç±»æ¥ä½¿ç”¨ã€‚
äºŒã€OleDbå®‰è£…å‰å‡†å¤‡ 1. ç¯å¢ƒå‡†å¤‡ .NET Framework: ç¡®ä¿æ‚¨çš„å¼€å‘ç¯å¢ƒä¸­å®‰è£…äº†.NET Frameworkï¼Œå› ä¸ºOleDbç±»åº“æ˜¯åŸºäº.NET Frameworkçš„ã€‚
å¼•ç”¨è®¾ç½®: åœ¨Visual Studioä¸­ï¼Œéœ€è¦æ·»åŠ å¯¹System.Data.dllçš„å¼•ç”¨ï¼Œä»¥ç¡®ä¿é¡¹ç›®å¯ä»¥ä½¿ç”¨System.Data.OleDbå‘½åç©ºé—´ã€‚
2. å®‰è£…ç›¸åº”çš„é©±åŠ¨ ä½¿ç”¨ OLE DB æ“ä½œæ•°æ®åº“æˆ– Excel æ—¶ï¼Œä½ éœ€è¦ç¡®ä¿å®‰è£…äº†é€‚å½“çš„ OLE DB é©±åŠ¨ç¨‹åºï¼Œè¿™å–å†³äºä½ è¦è¿æ¥çš„å…·ä½“æ•°æ®åº“ç³»ç»Ÿã€‚æ¯ç§æ•°æ®åº“ç³»ç»Ÿéƒ½å¯èƒ½æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªä¸“ç”¨çš„ OLE DB é©±åŠ¨ï¼Œè¿™äº›é©±åŠ¨å…è®¸åº”ç”¨ç¨‹åºé€šè¿‡ OLE DB æ¥å£ä¸æ•°æ®åº“é€šä¿¡ã€‚
Excel çš„ OLE DB é©±åŠ¨ï¼š
å¯¹äºExcelæ–‡ä»¶çš„æ•°æ®æ“ä½œï¼Œä½ å¯ä»¥ä½¿ç”¨Microsoftæä¾›çš„OLE DBé©±åŠ¨æ¥è¿›è¡Œè¯»å–å’Œå†™å…¥æ“ä½œã€‚è¿™äº›é©±åŠ¨å…è®¸é€šè¿‡OLE DBæ¥å£ä¸Excelæ–‡ä»¶è¿›è¡Œäº¤äº’ã€‚å…·ä½“ä½¿ç”¨çš„é©±åŠ¨å–å†³äºExcelæ–‡ä»¶çš„ç‰ˆæœ¬å’Œä½ çš„ç³»ç»Ÿç±»å‹ï¼ˆ32ä½æˆ–64ä½ï¼‰ã€‚
â‘  ğŸ¯Microsoft Access Database Engine OLE DB Provider
é€‚ç”¨ç‰ˆæœ¬ï¼šExcel 2007 åŠæ›´é«˜ç‰ˆæœ¬çš„æ–‡ä»¶ï¼ˆ.xlsxï¼‰ã€‚é©±åŠ¨åç§°ï¼š å¯¹äºæ—§ç‰ˆæœ¬æˆ–éœ€è¦å…¼å®¹æ€§çš„ï¼Œå¯ä»¥ä½¿ç”¨ Microsoft.ACE.OLEDB.12.0ã€‚å¯¹äºæ›´é«˜ç‰ˆæœ¬çš„Officeï¼Œå¯ä»¥ä½¿ç”¨ Microsoft.ACE.OLEDB.16.0ã€‚ â‘¡ ğŸ”¥Microsoft Jet OLE DB Provider
é€‚ç”¨ç‰ˆæœ¬ï¼šExcel 2003 åŠæ›´æ—©ç‰ˆæœ¬çš„æ–‡ä»¶ï¼ˆ.xlsï¼‰ã€‚é©±åŠ¨åç§°ï¼šMicrosoft.Jet.OLEDB.4.0ã€‚æ³¨æ„ï¼šè¿™ä¸ªé©±åŠ¨ä»…æ”¯æŒ32ä½ç³»ç»Ÿã€‚ é©±åŠ¨ä¸‹è½½åœ°å€
Access Database Engineæœ€æ–°ç‰ˆæœ¬ä¸‹è½½åœ°å€ï¼š(https://learn.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-10T11:40:09+08:00">
    <meta property="article:modified_time" content="2024-05-10T11:40:09+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="ç¼–ç¨‹å­¦ä¹ è€…" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">ç¼–ç¨‹å­¦ä¹ è€…</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C#è¿›é˜¶-OleDbæ“ä½œExcelå’Œæ•°æ®åº“</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>åœ¨C#ç¼–ç¨‹ä¸­ï¼Œä½¿ç”¨OleDbå¯ä»¥æ–¹ä¾¿åœ°å®ç°å¯¹Excelæ–‡ä»¶å’Œæ•°æ®åº“çš„æ“ä½œã€‚æœ¬æ–‡æ¢è®¨äº†åœ¨C#ä¸­ä½¿ç”¨OleDbæŠ€æœ¯æ“ä½œExcelå’Œæ•°æ®åº“çš„ç­–ç•¥ã€‚æ–‡ç« è¯¦è¿°äº†OleDbçš„å®šä¹‰ã€é…ç½®ç¯å¢ƒçš„æ­¥éª¤ï¼Œå¹¶é€šè¿‡å®é™…ä»£ç ç¤ºä¾‹æ¼”ç¤ºäº†å¦‚ä½•é«˜æ•ˆè¯»å†™Excelæ–‡ä»¶å’Œäº¤äº’æ•°æ®åº“ã€‚æ–‡ä¸­è¿˜è¯„ä¼°äº†OleDbæŠ€æœ¯çš„ä¼˜ç¼ºç‚¹ï¼Œä¸ºéœ€è¦å¤„ç†å¤šç§æ•°æ®æºçš„å¼€å‘è€…æä¾›äº†ä¸€ç§æœ‰æ•ˆçš„æ•°æ®æ“ä½œæ–¹æ¡ˆã€‚</p> 
<hr> 
<h3><a id="OleDb_3"></a>ä¸€ã€OleDbç®€ä»‹</h3> 
<p>OleDbï¼ˆObject Linking and Embedding, Databaseï¼‰æ˜¯å¾®è½¯çš„ä¸€å¥—æ•°æ®åº“è®¿é—®æ¥å£ï¼Œæ”¯æŒå¯¹å¤šç§æ•°æ®æºçš„è®¿é—®ï¼ŒåŒ…æ‹¬SQL Serverã€Accessä»¥åŠExcelç­‰ã€‚å®ƒæä¾›äº†ä¸€ç§ç»Ÿä¸€çš„æ–¹æ³•æ¥è®¿é—®ä¸åŒçš„æ•°æ®æºã€‚åœ¨.NETç¯å¢ƒä¸‹ï¼ŒOleDbå¯ä»¥é€šè¿‡System.Data.OleDbå‘½åç©ºé—´æä¾›çš„ç±»æ¥ä½¿ç”¨ã€‚</p> 
<hr> 
<h3><a id="OleDb_8"></a>äºŒã€OleDbå®‰è£…å‰å‡†å¤‡</h3> 
<h4><a id="1__9"></a>1. ç¯å¢ƒå‡†å¤‡</h4> 
<p><strong>.NET Framework</strong>: ç¡®ä¿æ‚¨çš„å¼€å‘ç¯å¢ƒä¸­å®‰è£…äº†.NET Frameworkï¼Œå› ä¸ºOleDbç±»åº“æ˜¯åŸºäº.NET Frameworkçš„ã€‚</p> 
<p><strong>å¼•ç”¨è®¾ç½®</strong>: åœ¨Visual Studioä¸­ï¼Œéœ€è¦æ·»åŠ å¯¹System.Data.dllçš„å¼•ç”¨ï¼Œä»¥ç¡®ä¿é¡¹ç›®å¯ä»¥ä½¿ç”¨System.Data.OleDbå‘½åç©ºé—´ã€‚</p> 
<hr> 
<h4><a id="2__16"></a>2. å®‰è£…ç›¸åº”çš„é©±åŠ¨</h4> 
<p>ä½¿ç”¨ OLE DB æ“ä½œæ•°æ®åº“æˆ– Excel æ—¶ï¼Œä½ éœ€è¦ç¡®ä¿å®‰è£…äº†é€‚å½“çš„ OLE DB é©±åŠ¨ç¨‹åºï¼Œè¿™å–å†³äºä½ è¦è¿æ¥çš„å…·ä½“æ•°æ®åº“ç³»ç»Ÿã€‚æ¯ç§æ•°æ®åº“ç³»ç»Ÿéƒ½å¯èƒ½æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªä¸“ç”¨çš„ OLE DB é©±åŠ¨ï¼Œè¿™äº›é©±åŠ¨å…è®¸åº”ç”¨ç¨‹åºé€šè¿‡ OLE DB æ¥å£ä¸æ•°æ®åº“é€šä¿¡ã€‚</p> 
<p><strong>Excel çš„ OLE DB é©±åŠ¨ï¼š</strong><br> å¯¹äºExcelæ–‡ä»¶çš„æ•°æ®æ“ä½œï¼Œä½ å¯ä»¥ä½¿ç”¨Microsoftæä¾›çš„OLE DBé©±åŠ¨æ¥è¿›è¡Œè¯»å–å’Œå†™å…¥æ“ä½œã€‚è¿™äº›é©±åŠ¨å…è®¸é€šè¿‡OLE DBæ¥å£ä¸Excelæ–‡ä»¶è¿›è¡Œäº¤äº’ã€‚å…·ä½“ä½¿ç”¨çš„é©±åŠ¨å–å†³äºExcelæ–‡ä»¶çš„ç‰ˆæœ¬å’Œä½ çš„ç³»ç»Ÿç±»å‹ï¼ˆ32ä½æˆ–64ä½ï¼‰ã€‚</p> 
<p><strong>â‘  ğŸ¯Microsoft Access Database Engine OLE DB Provider</strong></p> 
<ul><li><strong>é€‚ç”¨ç‰ˆæœ¬</strong>ï¼šExcel 2007 åŠæ›´é«˜ç‰ˆæœ¬çš„æ–‡ä»¶ï¼ˆ.xlsxï¼‰ã€‚</li><li><strong>é©±åŠ¨åç§°</strong>ï¼š 
  <ul><li>å¯¹äºæ—§ç‰ˆæœ¬æˆ–éœ€è¦å…¼å®¹æ€§çš„ï¼Œå¯ä»¥ä½¿ç”¨ <code>Microsoft.ACE.OLEDB.12.0</code>ã€‚</li><li>å¯¹äºæ›´é«˜ç‰ˆæœ¬çš„Officeï¼Œå¯ä»¥ä½¿ç”¨ <code>Microsoft.ACE.OLEDB.16.0</code>ã€‚</li></ul> </li></ul> 
<p><strong>â‘¡ ğŸ”¥Microsoft Jet OLE DB Provider</strong></p> 
<ul><li><strong>é€‚ç”¨ç‰ˆæœ¬</strong>ï¼šExcel 2003 åŠæ›´æ—©ç‰ˆæœ¬çš„æ–‡ä»¶ï¼ˆ.xlsï¼‰ã€‚</li><li><strong>é©±åŠ¨åç§°</strong>ï¼š<code>Microsoft.Jet.OLEDB.4.0</code>ã€‚</li><li><strong>æ³¨æ„</strong>ï¼šè¿™ä¸ªé©±åŠ¨ä»…æ”¯æŒ32ä½ç³»ç»Ÿã€‚</li></ul> 
<p><strong>é©±åŠ¨ä¸‹è½½åœ°å€</strong></p> 
<p>Access Database Engineæœ€æ–°ç‰ˆæœ¬ä¸‹è½½åœ°å€ï¼š(<a href="https://learn.microsoft.com/zh-cn/sql/connect/oledb/download-oledb-driver-for-sql-server?view=sql-server-ver16" rel="nofollow">https://learn.microsoft.com/zh-cn/sql/connect/oledb/download-oledb-driver-for-sql-server?view=sql-server-ver16</a>)ï¼›<br> Access Database Engineå†å²ç‰ˆæœ¬(16åŠä¹‹å)ä¸‹è½½åœ°å€ï¼š(<a href="https://learn.microsoft.com/zh-cn/sql/connect/oledb/release-notes-for-oledb-driver-for-sql-server?view=sql-server-ver16#previous-releases" rel="nofollow">https://learn.microsoft.com/zh-cn/sql/connect/oledb/release-notes-for-oledb-driver-for-sql-server?view=sql-server-ver16#previous-releases</a>)ï¼›<br> å·²ç»ç»ç‰ˆçš„Microsoft.ACE.OLEDB.12.0(Microsoft Access 2010 æ•°æ®åº“å¼•æ“)ä¸‹è½½åœ°å€ï¼š(<a href="https://download.csdn.net/download/weixin_41793160/89286174">https://download.csdn.net/download/weixin_41793160/89286174</a>) (æ³¨æ„åªæ”¯æŒ32ä½ï¼Œ.NETç¨‹åºç›®æ ‡ç”Ÿæˆä¸èƒ½ä½X64)ï¼›<br> å·²ç»ç»ç‰ˆçš„Microsoft.Jet.OLEDB.4.0(2007 Office system é©±åŠ¨ç¨‹åº)ä¸‹è½½åœ°å€ï¼š<br> åŒMicrosoft.ACE.OLEDB.12.0ã€‚</p> 
<p><strong>å®‰è£…æµç¨‹</strong><br> æœªå®‰è£…Microsoft.ACE.OLEDB.12.0é©±åŠ¨æŠ¥é”™çš„æˆªå›¾ã€‚<br> <img src="https://images2.imgbox.com/18/86/eVp5w3Fm_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> ä¸‹è½½Microsoft.ACE.OLEDB.12.0é©±åŠ¨å®‰è£…ç¨‹åºã€‚<br> <img src="https://images2.imgbox.com/a1/3e/JfNxEIES_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> ç‚¹å‡»å®‰è£…ã€‚<br> <img src="https://images2.imgbox.com/d9/31/Ibc9P4q0_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> é€‰æ‹©å®‰è£…è·¯å¾„ã€‚<br> <img src="https://images2.imgbox.com/be/cd/goraajIL_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br> å®‰è£…å®Œæˆã€‚<br> <img src="https://images2.imgbox.com/28/51/oEobCIKb_o.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p> 
<hr> 
<p><strong>å¸¸è§æ•°æ®åº“çš„ OLE DB é©±åŠ¨ï¼š</strong></p> 
<p><strong>â‘  ğŸŒˆMicrosoft SQL Server</strong>ï¼š</p> 
<ul><li><strong>Microsoft OLE DB Driver for SQL Server (MSOLEDBSQL)</strong>ï¼šæ˜¯å½“å‰æ¨èçš„é©±åŠ¨ï¼Œæ”¯æŒæœ€æ–°çš„SQL ServeråŠŸèƒ½ã€‚</li><li><strong>SQL Server Native Client (SQLNCLI)</strong>ï¼šæ—§ç‰ˆæœ¬çš„é©±åŠ¨ï¼Œä¾ç„¶å¹¿æ³›ä½¿ç”¨ï¼Œä½†å¯èƒ½ä¸æ”¯æŒæœ€æ–°çš„æ•°æ®åº“åŠŸèƒ½ã€‚</li></ul> 
<p><strong>â‘¡ âœ¨Microsoft Access</strong>ï¼š</p> 
<ul><li><strong>Microsoft Access Database Engine OLE DB Provider (ACEOLEDB)</strong>ï¼šé€‚ç”¨äº Access 2007 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚</li><li><strong>Microsoft Jet OLE DB Provider (Jet.OLEDB)</strong>ï¼šç”¨äº Access 2003 åŠæ›´æ—©ç‰ˆæœ¬ã€‚</li></ul> 
<p><strong>â‘¢ ğŸš€Oracle</strong>ï¼š</p> 
<ul><li><strong>Oracle Provider for OLE DB</strong>ï¼šOracle å®˜æ–¹æä¾›çš„ OLE DB é©±åŠ¨ã€‚</li></ul> 
<p><strong>â‘£ ğŸ€MySQL</strong>ï¼š</p> 
<ul><li>MySQL å®˜æ–¹æ²¡æœ‰ç›´æ¥æä¾›ä¸“ç”¨çš„ OLE DB é©±åŠ¨ï¼Œé€šå¸¸æ¨èä½¿ç”¨ ODBC é©±åŠ¨æˆ–ç¬¬ä¸‰æ–¹æä¾›çš„ OLE DB é©±åŠ¨ã€‚</li></ul> 
<p><strong>â‘¤ ğŸ§©PostgreSQL</strong>ï¼š</p> 
<ul><li>ç±»ä¼¼äº MySQLï¼ŒPostgreSQL å®˜æ–¹ä¹Ÿæ²¡æœ‰æä¾› OLE DB é©±åŠ¨ã€‚æ¨èä½¿ç”¨ ODBC é©±åŠ¨æˆ–ç¬¬ä¸‰æ–¹æä¾›çš„ OLE DB é©±åŠ¨ã€‚</li></ul> 
<p>ç¡®ä¿é©±åŠ¨å®‰è£…æ­£ç¡®å¹¶ä¸”è¿æ¥å­—ç¬¦ä¸²é…ç½®é€‚å½“æ˜¯æˆåŠŸä½¿ç”¨ OLE DB çš„å…³é”®ã€‚ä¸æ­£ç¡®çš„é©±åŠ¨å®‰è£…æˆ–é…ç½®å¯èƒ½å¯¼è‡´è¿æ¥å¤±è´¥æˆ–æ•°æ®è®¿é—®é”™è¯¯ã€‚</p> 
<hr> 
<h3><a id="OleDbEXCEL_77"></a>ä¸‰ã€OleDbæ“ä½œEXCEL</h3> 
<h4><a id="1__78"></a>1. è¿æ¥å­—ç¬¦ä¸²</h4> 
<p>è¿æ¥Excelæ–‡ä»¶æ—¶ï¼Œæ‚¨çš„è¿æ¥å­—ç¬¦ä¸²ä¼šç•¥æœ‰ä¸åŒï¼Œè¿™å–å†³äºExcelæ–‡ä»¶çš„ç‰ˆæœ¬ï¼ˆä¾‹å¦‚Excel 97-2003å·¥ä½œç°¿.xlsä¸Excel å·¥ä½œç°¿.xlsxï¼‰ï¼š</p> 
<ul><li>å¯¹äº.xlsæ–‡ä»¶ï¼š<code>Provider=Microsoft.Jet.OLEDB.4.0;Data Source=è·¯å¾„;Extended Properties="Excel 8.0;HDR=Yes;IMEX=1";</code></li><li>å¯¹äº.xlsxæ–‡ä»¶ï¼š<code>Provider=Microsoft.ACE.OLEDB.12.0;Data Source=è·¯å¾„;Extended Properties="Excel 12.0 Xml;HDR=Yes;IMEX=1";</code></li></ul> 
<hr> 
<h4><a id="2__86"></a>2. è¯»å–æ•°æ®</h4> 
<p>ä½¿ç”¨OleDbè¯»å–Excelæ–‡ä»¶é€šå¸¸æ¶‰åŠä»¥ä¸‹æ­¥éª¤ï¼š</p> 
<ol><li><strong>åˆ›å»ºOleDbConnectionå¯¹è±¡</strong>æ¥å»ºç«‹åˆ°Excelæ–‡ä»¶çš„è¿æ¥ã€‚</li><li><strong>åˆ›å»ºOleDbCommandå¯¹è±¡</strong>æ¥å®šä¹‰è¦æ‰§è¡Œçš„SQLæŸ¥è¯¢ã€‚</li><li><strong>åˆ›å»ºOleDbDataAdapterå’ŒDataSet</strong>ï¼Œç”¨äºæ¥æ”¶æŸ¥è¯¢ç»“æœã€‚</li><li><strong>æ‰§è¡ŒæŸ¥è¯¢</strong>å¹¶å¡«å……DataSetï¼Œä¹‹åå¯ä»¥é€šè¿‡DataTableå¯¹è±¡æ¥æ“ä½œæ•°æ®ã€‚</li></ol> 
<pre><code class="prism language-csharp"><span class="token class-name"><span class="token keyword">string</span></span> connectionString <span class="token operator">=</span> <span class="token string">"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=c:\\path\\to\\file.xlsx;Extended Properties='Excel 12.0 Xml;HDR=YES;'"</span><span class="token punctuation">;</span>
<span class="token keyword">using</span><span class="token punctuation">(</span><span class="token class-name">OleDbConnection</span> conn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OleDbConnection</span><span class="token punctuation">(</span>connectionString<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    conn<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">OleDbCommand</span> cmd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OleDbCommand</span><span class="token punctuation">(</span><span class="token string">"SELECT * FROM [Sheet1$]"</span><span class="token punctuation">,</span> conn<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">OleDbDataAdapter</span> adapter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OleDbDataAdapter</span><span class="token punctuation">(</span>cmd<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">DataSet</span> ds <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">DataSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    adapter<span class="token punctuation">.</span><span class="token function">Fill</span><span class="token punctuation">(</span>ds<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">DataTable</span> data <span class="token operator">=</span> ds<span class="token punctuation">.</span>Tables<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// æ•°æ®ç°åœ¨å­˜å‚¨åœ¨dataä¸­ï¼Œå¯ä»¥è¿›è¡Œè¿›ä¸€æ­¥å¤„ç†</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h4><a id="3__110"></a>3. å†™å…¥æ•°æ®</h4> 
<p>è¦å‘Excelæ–‡ä»¶å†™å…¥æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨<code>OleDbConnection</code>å’Œ<code>OleDbCommand</code>å¯¹è±¡ã€‚</p> 
<p>ä¸‹é¢ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•æ‰“å¼€ä¸€ä¸ªè¿æ¥ï¼Œå•æ¡å†™å…¥æ•°æ®åˆ°Excelè¡¨æ ¼ä¸­ã€‚</p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">OleDbConnection</span> conn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OleDbConnection</span><span class="token punctuation">(</span>connectionString<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    conn<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// æ‰“å¼€è¿æ¥</span>

    <span class="token comment">// æ„å»ºæ’å…¥å‘½ä»¤</span>
    <span class="token class-name">OleDbCommand</span> cmd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OleDbCommand</span><span class="token punctuation">(</span><span class="token string">"INSERT INTO [Sheet1$] (Column1, Column2) VALUES ('Value1', 'Value2')"</span><span class="token punctuation">,</span> conn<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// æ‰§è¡Œæ’å…¥å‘½ä»¤</span>
    cmd<span class="token punctuation">.</span><span class="token function">ExecuteNonQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// å…³é—­è¿æ¥</span>
    conn<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>å¦‚æœéœ€è¦å‘Excelæ–‡ä»¶æ‰¹é‡å†™å…¥æ•°æ®ï¼Œå¯ä»¥æ„å»ºå¤šä¸ªINSERTè¯­å¥ï¼Œæˆ–ä½¿ç”¨<code>OleDbDataAdapter</code>å’Œ<code>DataTable</code>ï¼Œé€šè¿‡è°ƒæ•´<code>DataTable</code>ä¸­çš„æ•°æ®ç„¶åè°ƒç”¨<code>Update()</code>æ–¹æ³•æ¥å®ç°ã€‚</p> 
<pre><code class="prism language-csharp"><span class="token class-name">DataTable</span> dt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">DataTable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// å‡è®¾dtå·²ç»è¢«å¡«å……äº†æ•°æ®</span>
<span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">OleDbConnection</span> conn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OleDbConnection</span><span class="token punctuation">(</span>connectionString<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token class-name">OleDbDataAdapter</span> adapter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OleDbDataAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    adapter<span class="token punctuation">.</span>InsertCommand <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OleDbCommand</span><span class="token punctuation">(</span><span class="token string">"INSERT INTO [Sheet1$] (Column1, Column2) VALUES (?, ?)"</span><span class="token punctuation">,</span> conn<span class="token punctuation">)</span><span class="token punctuation">;</span>
    adapter<span class="token punctuation">.</span>InsertCommand<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">"@Column1"</span><span class="token punctuation">,</span> OleDbType<span class="token punctuation">.</span>VarChar<span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token string">"Column1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    adapter<span class="token punctuation">.</span>InsertCommand<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">"@Column2"</span><span class="token punctuation">,</span> OleDbType<span class="token punctuation">.</span>VarChar<span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token string">"Column2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    conn<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    adapter<span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span>dt<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// æ›´æ–°Excelæ–‡ä»¶</span>
    conn<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>è¿™ç§æ–¹æ³•ç‰¹åˆ«é€‚åˆå¤„ç†å¤§é‡æ•°æ®ï¼Œå¯ä»¥æ˜¾è‘—æé«˜æ•°æ®æ’å…¥çš„æ•ˆç‡ã€‚</p> 
<hr> 
<h3><a id="OleDb_153"></a>å››ã€OleDbæ“ä½œæ•°æ®åº“</h3> 
<p>ä½¿ç”¨OLE DBè¿›è¡Œæ•°æ®åº“è®¿é—®ï¼ˆåŒ…æ‹¬å¢åŠ ã€åˆ é™¤ã€ä¿®æ”¹å’ŒæŸ¥è¯¢æ“ä½œï¼‰æ¶‰åŠåˆ°å‡ ä¸ªå…³é”®çš„.NETç±»ï¼Œä¸»è¦æ˜¯<code>OleDbConnection</code>ã€<code>OleDbCommand</code>ã€<code>OleDbDataAdapter</code>å’Œ<code>OleDbDataReader</code>ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨OLE DBæ¥æ‰§è¡Œå¢åˆ æ”¹æŸ¥ï¼ˆCRUDï¼šCreate, Read, Update, Deleteï¼‰æ“ä½œçš„åŸºæœ¬ç¤ºä¾‹ï¼Œè¿™é‡Œå‡è®¾æ•°æ®åº“æ˜¯ä¸€ä¸ªç®€å•çš„Microsoft Accessæ•°æ®åº“æˆ–å…¶ä»–æ”¯æŒOLE DBçš„æ•°æ®åº“ã€‚</p> 
<h4><a id="1_OleDb_155"></a>1. OleDbå®ç°æ•°æ®å¢åˆ æ”¹æŸ¥</h4> 
<p><strong>ä»£ç ç¤ºä¾‹</strong></p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Data</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>OleDb</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name"><span class="token keyword">string</span></span> connectionString <span class="token operator">=</span> <span class="token string">"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\\yourdatabase.mdb;"</span><span class="token punctuation">;</span>

        <span class="token comment">// åˆ›å»ºä¸€ä¸ªæ–°çš„OleDbConnectionï¼Œå¹¶å°†å…¶å°è£…åœ¨usingè¯­å¥ä¸­ä»¥ç¡®ä¿èµ„æºçš„é‡Šæ”¾</span>
        <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">OleDbConnection</span> connection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OleDbConnection</span><span class="token punctuation">(</span>connectionString<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            connection<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// åˆ›å»ºï¼ˆCreateï¼‰</span>
            <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">OleDbCommand</span> command <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OleDbCommand</span><span class="token punctuation">(</span><span class="token string">"INSERT INTO Employees (FirstName, LastName) VALUES ('John', 'Doe')"</span><span class="token punctuation">,</span> connection<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                command<span class="token punctuation">.</span><span class="token function">ExecuteNonQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// è¯»å–ï¼ˆReadï¼‰</span>
            <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">OleDbCommand</span> command <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OleDbCommand</span><span class="token punctuation">(</span><span class="token string">"SELECT FirstName, LastName FROM Employees"</span><span class="token punctuation">,</span> connection<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">OleDbDataReader</span> reader <span class="token operator">=</span> command<span class="token punctuation">.</span><span class="token function">ExecuteReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">while</span> <span class="token punctuation">(</span>reader<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">reader<span class="token punctuation">[</span><span class="token string">"FirstName"</span><span class="token punctuation">]</span></span><span class="token punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">reader<span class="token punctuation">[</span><span class="token string">"LastName"</span><span class="token punctuation">]</span></span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// æ›´æ–°ï¼ˆUpdateï¼‰</span>
            <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">OleDbCommand</span> command <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OleDbCommand</span><span class="token punctuation">(</span><span class="token string">"UPDATE Employees SET LastName = 'Smith' WHERE FirstName = 'John'"</span><span class="token punctuation">,</span> connection<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                command<span class="token punctuation">.</span><span class="token function">ExecuteNonQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// åˆ é™¤ï¼ˆDeleteï¼‰</span>
            <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">OleDbCommand</span> command <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OleDbCommand</span><span class="token punctuation">(</span><span class="token string">"DELETE FROM Employees WHERE FirstName = 'John'"</span><span class="token punctuation">,</span> connection<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                command<span class="token punctuation">.</span><span class="token function">ExecuteNonQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>è§£é‡Š</strong></p> 
<ol><li><strong>è¿æ¥å­—ç¬¦ä¸²</strong> (<code>connectionString</code>): æŒ‡å®šäº†OLE DBæä¾›è€…ã€æ•°æ®åº“æ–‡ä»¶è·¯å¾„ç­‰ä¿¡æ¯ã€‚</li><li><strong>OleDbConnection</strong>: ç”¨äºå»ºç«‹ä¸æ•°æ®åº“çš„è¿æ¥ã€‚</li><li><strong>OleDbCommand</strong>: ç”¨äºæ‰§è¡ŒSQLå‘½ä»¤ã€‚</li><li><strong>OleDbDataReader</strong>: ç”¨äºè¯»å–ä»æ•°æ®åº“è¿”å›çš„ç»“æœã€‚</li></ol> 
<p><strong>æ³¨æ„äº‹é¡¹</strong></p> 
<ul><li>ç¡®ä¿ä¿®æ”¹è¿æ¥å­—ç¬¦ä¸²ä»¥åŒ¹é…ä½ çš„æ•°æ®åº“è®¾ç½®ã€‚</li><li>è¿™ä¸ªä¾‹å­ä¸­ä½¿ç”¨çš„æ˜¯Microsoft Accessçš„OLE DBæä¾›è€… (<code>Microsoft.Jet.OLEDB.4.0</code>)ï¼Œä½ å¯èƒ½éœ€è¦æ ¹æ®ä½ çš„æ•°æ®åº“ç±»å‹è°ƒæ•´æä¾›è€…ã€‚</li><li>ç¡®ä¿æ•°æ®åº“è·¯å¾„ã€SQLè¯­å¥å’Œæ•°æ®åº“è¡¨ç»“æ„ä¸ç¤ºä¾‹ä»£ç ä¸­çš„ç›¸ç¬¦ã€‚</li></ul> 
<hr> 
<h4><a id="2_OleDb_221"></a>2. OleDbå®ç°äº‹åŠ¡ç®¡ç†</h4> 
<p>OLE DB å…è®¸ä½ é€šè¿‡<code>OleDbTransaction</code>æ¥æ§åˆ¶äº‹åŠ¡ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§ã€‚åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œä½ å¯ä»¥æ‰§è¡Œå¤šä¸ªæ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ï¼Œä»è€Œé¿å…æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µå‡ºç°ã€‚</p> 
<p><strong>ä»£ç ç¤ºä¾‹</strong></p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Data</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>OleDb</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name"><span class="token keyword">string</span></span> connectionString <span class="token operator">=</span> <span class="token string">"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\\yourdatabase.mdb;"</span><span class="token punctuation">;</span>
        <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">OleDbConnection</span> connection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OleDbConnection</span><span class="token punctuation">(</span>connectionString<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            connection<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">OleDbTransaction</span> transaction <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">BeginTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">try</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">OleDbCommand</span> command <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">CreateCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                command<span class="token punctuation">.</span>Transaction <span class="token operator">=</span> transaction<span class="token punctuation">;</span>

                command<span class="token punctuation">.</span>CommandText <span class="token operator">=</span> <span class="token string">"INSERT INTO Table1 (Column1) VALUES ('Value1')"</span><span class="token punctuation">;</span>
                command<span class="token punctuation">.</span><span class="token function">ExecuteNonQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                command<span class="token punctuation">.</span>CommandText <span class="token operator">=</span> <span class="token string">"INSERT INTO Table2 (Column2) VALUES ('Value2')"</span><span class="token punctuation">;</span>
                command<span class="token punctuation">.</span><span class="token function">ExecuteNonQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// æäº¤äº‹åŠ¡</span>
                transaction<span class="token punctuation">.</span><span class="token function">Commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Both records are written to database."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token comment">// å›æ»šäº‹åŠ¡</span>
                transaction<span class="token punctuation">.</span><span class="token function">Rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"There was an error, transaction was rolled back."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>ex<span class="token punctuation">.</span>Message<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>è¿™ä¸ªç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨äº‹åŠ¡æ¥ç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§ï¼Œåªæœ‰å½“æ‰€æœ‰æ“ä½œéƒ½æˆåŠŸæ—¶æ‰æäº¤äº‹åŠ¡ï¼Œå¦åˆ™å›æ»šæ‰€æœ‰æ“ä½œã€‚è¿™æ˜¯æ•°æ®åº“æ“ä½œä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„é«˜çº§åŠŸèƒ½ã€‚</p> 
<hr> 
<h4><a id="3_OleDb_271"></a>3. OleDbå®ç°å¼‚æ­¥æ“ä½œ</h4> 
<p>åœ¨.NETä¸­ï¼Œä½¿ç”¨OLE DBè¿›è¡Œå¼‚æ­¥æ•°æ®åº“æ“ä½œå¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å®ç°ï¼Œæ¯”å¦‚ä½¿ç”¨<code>Task</code>å’Œ<code>async/await</code>æ¨¡å¼ã€‚</p> 
<p><strong>ä»£ç ç¤ºä¾‹</strong></p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Data</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>OleDb</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Threading<span class="token punctuation">.</span>Tasks</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">static</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task</span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name"><span class="token keyword">string</span></span> connectionString <span class="token operator">=</span> <span class="token string">"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\\yourdatabase.mdb;"</span><span class="token punctuation">;</span>
        <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">OleDbConnection</span> connection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OleDbConnection</span><span class="token punctuation">(</span>connectionString<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">await</span> connection<span class="token punctuation">.</span><span class="token function">OpenAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">OleDbCommand</span> command <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OleDbCommand</span><span class="token punctuation">(</span><span class="token string">"SELECT * FROM Employees"</span><span class="token punctuation">,</span> connection<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">OleDbDataReader</span> reader <span class="token operator">=</span> <span class="token punctuation">(</span>OleDbDataReader<span class="token punctuation">)</span><span class="token keyword">await</span> command<span class="token punctuation">.</span><span class="token function">ExecuteReaderAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">{<!-- --></span>
                    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token keyword">await</span> reader<span class="token punctuation">.</span><span class="token function">ReadAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">{<!-- --></span>
                        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">$"</span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">reader<span class="token punctuation">[</span><span class="token string">"FirstName"</span><span class="token punctuation">]</span></span><span class="token punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">{<!-- --></span><span class="token expression language-csharp">reader<span class="token punctuation">[</span><span class="token string">"LastName"</span><span class="token punctuation">]</span></span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>OpenAsync</code>, <code>ExecuteReaderAsync</code>, å’Œ <code>ReadAsync</code> æ–¹æ³•è¢«ç”¨æ¥å¼‚æ­¥æ‰“å¼€è¿æ¥ã€æ‰§è¡ŒæŸ¥è¯¢å’Œè¯»å–ç»“æœã€‚è¿™ç§æ–¹æ³•éå¸¸é€‚åˆç”¨åœ¨éœ€è¦ç»´æŠ¤åº”ç”¨ç¨‹åºå“åº”æ€§çš„åœºæ™¯ä¸­ï¼Œæ¯”å¦‚GUIåº”ç”¨ç¨‹åºæˆ–è€…é«˜è´Ÿè½½Webåº”ç”¨ç¨‹åºã€‚</p> 
<hr> 
<h4><a id="4_OleDb_310"></a>4. OleDbè°ƒç”¨å­˜å‚¨è¿‡ç¨‹</h4> 
<p><strong>ä»£ç ç¤ºä¾‹</strong></p> 
<pre><code class="prism language-csharp"><span class="token keyword">using</span> <span class="token namespace">System</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Data</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">System<span class="token punctuation">.</span>Data<span class="token punctuation">.</span>OleDb</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Program</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">static</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token class-name"><span class="token keyword">string</span></span> connectionString <span class="token operator">=</span> <span class="token string">"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\\yourdatabase.mdb;"</span><span class="token punctuation">;</span>
        <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">OleDbConnection</span> connection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OleDbConnection</span><span class="token punctuation">(</span>connectionString<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span>
            connection<span class="token punctuation">.</span><span class="token function">Open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name">OleDbCommand</span> command <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OleDbCommand</span><span class="token punctuation">(</span><span class="token string">"GetEmployeeDetails"</span><span class="token punctuation">,</span> connection<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">{<!-- --></span>
                command<span class="token punctuation">.</span>CommandType <span class="token operator">=</span> CommandType<span class="token punctuation">.</span>StoredProcedure<span class="token punctuation">;</span>

                <span class="token comment">// æ·»åŠ è¾“å…¥å‚æ•°</span>
                command<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">AddWithValue</span><span class="token punctuation">(</span><span class="token string">"@EmployeeId"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// å¦‚æœå­˜å‚¨è¿‡ç¨‹æœ‰è¿”å›å€¼</span>
                command<span class="token punctuation">.</span>Parameters<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">OleDbParameter</span><span class="token punctuation">(</span><span class="token string">"@ReturnValue"</span><span class="token punctuation">,</span> OleDbType<span class="token punctuation">.</span>VarChar<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                command<span class="token punctuation">.</span>Parameters<span class="token punctuation">[</span><span class="token string">"@ReturnValue"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Direction <span class="token operator">=</span> ParameterDirection<span class="token punctuation">.</span>Output<span class="token punctuation">;</span>

                command<span class="token punctuation">.</span><span class="token function">ExecuteNonQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">// è¯»å–è¾“å‡ºå‚æ•°çš„å€¼</span>
                <span class="token class-name"><span class="token keyword">string</span></span> result <span class="token operator">=</span> command<span class="token punctuation">.</span>Parameters<span class="token punctuation">[</span><span class="token string">"@ReturnValue"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Value<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Result: "</span> <span class="token operator">+</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>è¿™ä¸ªç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•è°ƒç”¨åä¸º"GetEmployeeDetails"çš„å­˜å‚¨è¿‡ç¨‹ï¼Œå®ƒå‡å®šæ­¤å­˜å‚¨è¿‡ç¨‹æ¥æ”¶ä¸€ä¸ªåä¸º<code>@EmployeeId</code>çš„è¾“å…¥å‚æ•°ï¼Œå¹¶è¿”å›ä¸€äº›æ•°æ®ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä½ éœ€è¦æ ¹æ®å®é™…å­˜å‚¨è¿‡ç¨‹çš„å®šä¹‰æ¥è°ƒæ•´å‚æ•°çš„åç§°å’Œç±»å‹ã€‚</p> 
<hr> 
<h3><a id="OleDb_354"></a>äº”ã€OleDbæ“ä½œæ€»ç»“</h3> 
<h4><a id="1_OleDb_356"></a>1. OleDbå’Œå…¶ä»–æ•°æ®åº“æ“ä½œæ–¹å¼çš„å¯¹æ¯”</h4> 
<table><thead><tr><th>ç‰¹æ€§</th><th>OleDb</th><th>ADO.NETï¼ˆSqlClientç­‰ï¼‰</th><th>Entity Framework</th></tr></thead><tbody><tr><td>æ•°æ®åº“æ”¯æŒ</td><td>æ”¯æŒå¤šç§æ•°æ®åº“ï¼ŒåŒ…æ‹¬SQL Serverã€Oracleç­‰</td><td>ç‰¹å®šäºæ•°æ®åº“ï¼ˆå¦‚SqlClienté’ˆå¯¹SQL Serverï¼‰</td><td>æ”¯æŒå¤šç§æ•°æ®åº“</td></tr><tr><td>æ€§èƒ½</td><td>é€šå¸¸è¾ƒæ…¢ï¼Œå› ä¸ºå®ƒæä¾›äº†ä¸€å±‚æŠ½è±¡</td><td>ç›´æ¥ä¸æ•°æ®åº“é€šä¿¡ï¼Œæ€§èƒ½è¾ƒé«˜</td><td>é«˜çº§æŠ½è±¡ï¼Œæ€§èƒ½ä¼˜åŒ–å¯å˜</td></tr><tr><td>æ“ä½œæ–¹å¼</td><td>ä½çº§ï¼Œéœ€è¦æ‰‹åŠ¨ç¼–å†™SQLè¯­å¥å’Œç®¡ç†è¿æ¥</td><td>ä½çº§ï¼ŒåŒæ ·éœ€è¦æ‰‹åŠ¨å¤„ç†SQLå’Œè¿æ¥</td><td>é«˜çº§æŠ½è±¡ï¼Œè‡ªåŠ¨å¤„ç†SQL</td></tr><tr><td>ä»£ç å¤æ‚æ€§</td><td>è¾ƒé«˜ï¼Œéœ€è¦å¤„ç†æ›´å¤šçš„ç»†èŠ‚</td><td>è¾ƒé«˜ï¼Œç±»ä¼¼OleDb</td><td>è¾ƒä½ï¼Œç®€åŒ–æ•°æ®æ“ä½œ</td></tr><tr><td>å¹³å°ä¾èµ–æ€§</td><td>è¾ƒé«˜ï¼Œä¾èµ–äºå®‰è£…çš„OLE DBæä¾›ç¨‹åº</td><td>è¾ƒä½ï¼Œé€šå¸¸å†…ç½®æ”¯æŒ</td><td>è¾ƒä½ï¼Œå†…ç½®æ”¯æŒ</td></tr><tr><td>è®¾è®¡ç›®çš„</td><td>æ•°æ®è®¿é—®çš„é€šç”¨è§£å†³æ–¹æ¡ˆï¼Œå…¼å®¹æ€§å¥½</td><td>é’ˆå¯¹ç‰¹å®šæ•°æ®åº“çš„ä¼˜åŒ–è®¿é—®</td><td>å…¨é¢çš„ORMè§£å†³æ–¹æ¡ˆ</td></tr></tbody></table> 
<h4><a id="2_OleDbExcel_367"></a>2. OleDbå’Œå…¶ä»–Excelæ“ä½œæ–¹å¼çš„å¯¹æ¯”</h4> 
<table><thead><tr><th>ç‰¹æ€§</th><th>OleDb</th><th>Excel Interop</th><th>EPPlusç­‰ç¬¬ä¸‰æ–¹åº“</th></tr></thead><tbody><tr><td>ç³»ç»Ÿè¦æ±‚</td><td>éœ€è¦å®‰è£…OLE DBé©±åŠ¨</td><td>éœ€è¦å®‰è£…Microsoft Office</td><td>æ— é¢å¤–å®‰è£…è¦æ±‚</td></tr><tr><td>æ€§èƒ½</td><td>ä¸­ç­‰ï¼Œé€‚åˆä¸­å°è§„æ¨¡æ•°æ®å¤„ç†</td><td>è¾ƒæ…¢ï¼Œå°¤å…¶æ˜¯å¤§é‡æ•°æ®æ—¶</td><td>è¾ƒå¿«ï¼Œé’ˆå¯¹å¤§æ•°æ®è¿›è¡Œäº†ä¼˜åŒ–</td></tr><tr><td>æ“ä½œå¤æ‚æ€§</td><td>é«˜ï¼Œéœ€è¦ç¼–å†™SQLè¯­å¥</td><td>é«˜ï¼Œéœ€è¦ä½¿ç”¨Office COM API</td><td>ä½ï¼Œç®€æ´çš„API</td></tr><tr><td>åŠŸèƒ½ä¸°å¯Œæ€§</td><td>é€‚åˆç®€å•çš„æ•°æ®è¯»å†™</td><td>åŠŸèƒ½ä¸°å¯Œï¼Œå¯ä»¥æ“ä½œExcelçš„å‡ ä¹æ‰€æœ‰ç‰¹æ€§</td><td>åŠŸèƒ½ä¸°å¯Œï¼Œä¸“æ³¨äºæ•°æ®å¤„ç†</td></tr><tr><td>ç¼–ç¨‹æ¨¡å‹</td><td>é€šè¿‡SQLè¯­å¥è®¿é—®æ•°æ®</td><td>ç›´æ¥æ“ä½œExcelå¯¹è±¡æ¨¡å‹</td><td>ä½¿ç”¨ç±»ä¼¼Excelçš„å¯¹è±¡æ¨¡å‹</td></tr><tr><td>å¤„ç†å¤æ‚æ–‡æ¡£èƒ½åŠ›</td><td>é™åˆ¶è¾ƒå¤šï¼Œä¸é€‚åˆå¤„ç†å¤æ‚çš„Excelæ–‡ä»¶æ ¼å¼</td><td>éå¸¸é€‚åˆå¤„ç†å¤æ‚æ–‡æ¡£</td><td>è¾ƒé€‚åˆå¤„ç†æ•°æ®å¯†é›†å‹æ–‡æ¡£</td></tr></tbody></table> 
<h4><a id="3_OleDb_378"></a>3. OleDbæ“ä½œæ€»ç»“</h4> 
<ul><li><strong>é€šç”¨æ€§</strong>ï¼šOleDbæä¾›äº†ä¸€ä¸ªå¹¿æ³›çš„æ•°æ®åº“è®¿é—®è§£å†³æ–¹æ¡ˆï¼Œæ”¯æŒå¤šç§æ•°æ®åº“ç³»ç»Ÿã€‚è¿™ä½¿å¾—å®ƒéå¸¸é€‚åˆéœ€è¦ä¸å¤šç§æ•°æ®æºäº¤äº’çš„åº”ç”¨ç¨‹åºã€‚</li><li><strong>æ€§èƒ½è€ƒè™‘</strong>ï¼šç”±äºOleDbæä¾›äº†ä¸€ä¸ªé€šç”¨çš„æ¥å£ï¼Œå¯èƒ½åœ¨æ€§èƒ½ä¸Šä¸å¦‚ä¸“ç”¨çš„æ•°æ®åº“è®¿é—®æŠ€æœ¯ï¼Œå¦‚ç›´æ¥ä½¿ç”¨SqlClientç­‰ã€‚</li><li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šOleDbéå¸¸é€‚åˆé‚£äº›ä¸éœ€è¦é«˜æ€§èƒ½æ•°æ®åº“äº¤äº’ï¼Œä½†éœ€è¦ä¸å¤šç§æ•°æ®åº“å…¼å®¹çš„åº”ç”¨ç¨‹åºã€‚å¯¹äºç®€å•çš„Excelæ•°æ®æ“ä½œä¹Ÿå¾ˆæœ‰ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨æ²¡æœ‰å®‰è£…Excelçš„æœåŠ¡å™¨ç¯å¢ƒä¸­ã€‚</li><li><strong>ç¼–ç¨‹å¤æ‚æ€§</strong>ï¼šä½¿ç”¨OleDbè¿›è¡Œæ•°æ®åº“æ“ä½œé€šå¸¸éœ€è¦è¾ƒä¸ºå¤æ‚çš„ä»£ç æ¥ç®¡ç†è¿æ¥ã€æ‰§è¡ŒSQLå‘½ä»¤ç­‰ï¼Œä¸å¦‚æŸäº›ç°ä»£ORMæ¡†æ¶ï¼ˆå¦‚Entity Frameworkï¼‰æä¾›çš„æŠ½è±¡çº§åˆ«é«˜ã€‚</li></ul> 
<p>æ€»çš„æ¥è¯´ï¼ŒOleDbæ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„å·¥å…·ï¼Œç‰¹åˆ«æ˜¯åœ¨éœ€è¦æ“ä½œå¤šç§æ•°æ®æºçš„æƒ…å†µä¸‹ã€‚ç„¶è€Œï¼Œå¯¹äºç‰¹å®šçš„åº”ç”¨éœ€æ±‚ï¼Œä½¿ç”¨æ›´ç°ä»£å’Œä¸“ç”¨çš„åº“å¯èƒ½ä¼šæ›´åŠ é«˜æ•ˆå’Œç®€æ´ã€‚</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/098f5d8d0e435fdd97db7f79160bbfca/" rel="prev">
			<span class="pager__subtitle">Â«&thinsp;Previous</span>
			<p class="pager__title">Go ä½¿ç”¨ MongoDB</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/c6ffed89bcf11dfed5f1ec54a7299cff/" rel="next">
			<span class="pager__subtitle">Next&thinsp;Â»</span>
			<p class="pager__title">ã€MySQLæ•°æ®åº“ã€‘ä¸¨ä¸€æ–‡è¯¦è§£ JdbcTemplate(Springä¸­çš„CRUD)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 ç¼–ç¨‹å­¦ä¹ è€….
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
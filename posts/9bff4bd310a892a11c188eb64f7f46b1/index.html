<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>从UUID到替代方案：探索Java中唯一ID生成的多种方法 - 编程学习者</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcxuexizhe.github.io/posts/9bff4bd310a892a11c188eb64f7f46b1/">
  <meta property="og:site_name" content="编程学习者">
  <meta property="og:title" content="从UUID到替代方案：探索Java中唯一ID生成的多种方法">
  <meta property="og:description" content="hi，我是程序员王也，一个资深Java开发工程师，平时十分热衷于技术副业变现和各种搞钱项目的程序员~，如果你也是，可以一起交流交流。
今天我们来聊聊UUID。
UUID的基本知识 UUID（Universally Unique Identifier）是一个128位长的数字，用于在分布式系统中唯一标识信息。它由两部分组成：一个32位的段和一个96位的段，通过特定的算法生成，以确保在全球范围内的唯一性。
UUID的结构和版本类型
UUID的标准格式由32个十六进制数字组成，以连字符分为五组，形式为8-4-4-4-12，例如：123e4567-e89b-12d3-a456-426614174000。每个部分都有特定的含义，其中前8位（第一段）是多播或单播地址，接下来的两个4位（第二和第三段）表示时间戳，最后的12位（第四段和第五段）是节点标识符。
Java中的UUID类提供了几种不同的方法来生成UUID，每种方法对应不同的版本。版本1基于时间和节点标识符，版本2（DCE Security UUID）基于域名和时间，版本3和5基于名称空间和名称的散列值，版本4完全随机生成。
// 示例：生成版本1的UUID（基于时间） UUID uuid1 = new UUID(0, System.currentTimeMillis()); System.out.println(&#34;Version 1 UUID: &#34; &#43; uuid1); // 示例：生成版本4的UUID（随机） UUID uuid4 = UUID.randomUUID(); System.out.println(&#34;Version 4 UUID: &#34; &#43; uuid4); 在这个例子中，我们使用UUID类的构造函数生成了一个版本1的UUID和一个版本4的UUID。
不同版本UUID的特点和生成方式
不同版本的UUID有不同的生成算法和用途。例如，版本1的UUID依赖于系统时间，因此可能存在重复的风险，尤其是在高并发的环境下。而版本4的UUID则完全随机生成，提供了更高的唯一性保证。
// 示例：生成版本3的UUID（基于名称的散列值） String name = &#34;example.com&#34;; UUID uuid3 = UUID.nameUUIDFromBytes(name.getBytes(StandardCharsets.UTF_8)); System.out.println(&#34;Version 3 UUID: &#34; &#43; uuid3); 在这个例子中，我们使用nameUUIDFromBytes方法根据一个字符串名称生成了一个版本3的UUID。
UUID的标准化组织和规范
UUID遵循RFC 4122标准，由IETF（Internet Engineering Task Force）定义。这个标准详细描述了UUID的结构、版本、以及生成算法。
// 示例：根据RFC 4122生成UUID // 通常不需要手动实现，java.util.UUID类已提供了标准的实现 在实际应用中，我们通常不需要手动实现UUID的生成，因为java.util.UUID类已经提供了符合标准的实现。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-15T01:05:49+08:00">
    <meta property="article:modified_time" content="2024-04-15T01:05:49+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程学习者" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程学习者</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">从UUID到替代方案：探索Java中唯一ID生成的多种方法</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>hi，我是程序员王也，一个资深Java开发工程师，平时十分热衷于技术副业变现和各种搞钱项目的程序员~，如果你也是，可以一起交流交流。</p> 
<p>今天我们来聊聊UUID。</p> 
<p><img src="https://images2.imgbox.com/ca/ff/6yWpcfuM_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h3><a id="UUID_11"></a>UUID的基本知识</h3> 
<p>UUID（Universally Unique Identifier）是一个128位长的数字，用于在分布式系统中唯一标识信息。它由两部分组成：一个32位的段和一个96位的段，通过特定的算法生成，以确保在全球范围内的唯一性。</p> 
<ol><li> <p><strong>UUID的结构和版本类型</strong></p> <p>UUID的标准格式由32个十六进制数字组成，以连字符分为五组，形式为<code>8-4-4-4-12</code>，例如：<code>123e4567-e89b-12d3-a456-426614174000</code>。每个部分都有特定的含义，其中前8位（第一段）是多播或单播地址，接下来的两个4位（第二和第三段）表示时间戳，最后的12位（第四段和第五段）是节点标识符。</p> <p>Java中的<code>UUID</code>类提供了几种不同的方法来生成UUID，每种方法对应不同的版本。版本1基于时间和节点标识符，版本2（DCE Security UUID）基于域名和时间，版本3和5基于名称空间和名称的散列值，版本4完全随机生成。</p> <pre><code class="prism language-java"><span class="token comment">// 示例：生成版本1的UUID（基于时间）</span>
<span class="token class-name">UUID</span> uuid1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UUID</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Version 1 UUID: "</span> <span class="token operator">+</span> uuid1<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 示例：生成版本4的UUID（随机）</span>
<span class="token class-name">UUID</span> uuid4 <span class="token operator">=</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Version 4 UUID: "</span> <span class="token operator">+</span> uuid4<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <p>在这个例子中，我们使用<code>UUID</code>类的构造函数生成了一个版本1的UUID和一个版本4的UUID。</p> </li><li> <p><strong>不同版本UUID的特点和生成方式</strong></p> <p>不同版本的UUID有不同的生成算法和用途。例如，版本1的UUID依赖于系统时间，因此可能存在重复的风险，尤其是在高并发的环境下。而版本4的UUID则完全随机生成，提供了更高的唯一性保证。</p> <pre><code class="prism language-java"><span class="token comment">// 示例：生成版本3的UUID（基于名称的散列值）</span>
<span class="token class-name">String</span> name <span class="token operator">=</span> <span class="token string">"example.com"</span><span class="token punctuation">;</span>
<span class="token class-name">UUID</span> uuid3 <span class="token operator">=</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">nameUUIDFromBytes</span><span class="token punctuation">(</span>name<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Version 3 UUID: "</span> <span class="token operator">+</span> uuid3<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <p>在这个例子中，我们使用<code>nameUUIDFromBytes</code>方法根据一个字符串名称生成了一个版本3的UUID。</p> </li><li> <p><strong>UUID的标准化组织和规范</strong></p> <p>UUID遵循RFC 4122标准，由IETF（Internet Engineering Task Force）定义。这个标准详细描述了UUID的结构、版本、以及生成算法。</p> <pre><code class="prism language-java"><span class="token comment">// 示例：根据RFC 4122生成UUID</span>
<span class="token comment">// 通常不需要手动实现，java.util.UUID类已提供了标准的实现</span>
</code></pre> <p>在实际应用中，我们通常不需要手动实现UUID的生成，因为<code>java.util.UUID</code>类已经提供了符合标准的实现。</p> </li></ol> 
<hr> 
<h3><a id="JavaUUID_59"></a>Java中生成UUID的方法</h3> 
<p>在Java中，<code>java.util.UUID</code>类是生成UUID的主要工具。这个类提供了多种静态方法来创建不同类型的UUID，以及一些实用的方法来操作和转换UUID。</p> 
<ol><li> <p><strong>使用<code>UUID.randomUUID()</code>生成随机UUID</strong></p> <p><code>UUID.randomUUID()</code>是生成随机UUID最简单和最常用的方法。它创建一个版本4的UUID，这意味着UUID的大多数位都是随机生成的，确保了高度的唯一性。</p> <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RandomUUIDExample</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">UUID</span> randomUUID <span class="token operator">=</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Random UUID: "</span> <span class="token operator">+</span> randomUUID<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <p>在这个例子中，我们生成了一个随机UUID并打印到控制台。</p> </li><li> <p><strong>使用<code>UUID.fromString()</code>解析UUID</strong></p> <p><code>UUID.fromString()</code>方法可以将一个符合标准格式的字符串解析为UUID对象。</p> <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UUIDFromStringExample</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">String</span> uuidString <span class="token operator">=</span> <span class="token string">"123e4567-e89b-12d3-a456-426614174000"</span><span class="token punctuation">;</span>
        <span class="token class-name">UUID</span> uuid <span class="token operator">=</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">fromString</span><span class="token punctuation">(</span>uuidString<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Parsed UUID: "</span> <span class="token operator">+</span> uuid<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <p>在这个例子中，我们将一个字符串解析为UUID对象，并打印出来。</p> </li><li> <p><strong>使用<code>UUID.nameUUIDFromBytes()</code>生成名称基UUID</strong></p> <p><code>UUID.nameUUIDFromBytes()</code>方法可以根据任意字节序列生成一个版本3的UUID，这个UUID是基于名称的散列值。</p> <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NameBasedUUIDExample</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">String</span> name <span class="token operator">=</span> <span class="token string">"example.com"</span><span class="token punctuation">;</span>
        <span class="token class-name">UUID</span> nameBasedUUID <span class="token operator">=</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">nameUUIDFromBytes</span><span class="token punctuation">(</span>name<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Name-based UUID: "</span> <span class="token operator">+</span> nameBasedUUID<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <p>在这个例子中，我们根据一个域名生成了一个名称基UUID。</p> </li><li> <p><strong>UUID的其他实用方法</strong></p> <p><code>UUID</code>类还提供了一些其他实用方法，例如<code>toString()</code>用于将UUID转换为其字符串表示形式，<code>compareTo()</code>用于比较两个UUID的先后顺序。</p> <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UUIDUtilsExample</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">UUID</span> uuid1 <span class="token operator">=</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">UUID</span> uuid2 <span class="token operator">=</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"UUID1: "</span> <span class="token operator">+</span> uuid1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"UUID2: "</span> <span class="token operator">+</span> uuid2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// 比较两个UUID</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>uuid1<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>uuid2<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"UUID1 is lexicographically before UUID2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>uuid1<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>uuid2<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"UUID1 is lexicographically after UUID2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"UUID1 and UUID2 are equal"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <p>在这个例子中，我们生成了两个UUID并比较了它们的字典顺序。</p> </li></ol> 
<hr> 
<h3><a id="UUID_138"></a>案例：生成随机UUID</h3> 
<p>在实际应用中，随机UUID的生成是最常见和直接的需求。Java的<code>UUID.randomUUID()</code>方法为我们提供了一个简单而有效的方式来生成这样的UUID。下面是一个具体的案例，展示了如何在Java程序中生成并使用随机UUID。</p> 
<ol><li> <p><strong>生成并打印随机UUID</strong></p> <p>最简单的使用<code>UUID.randomUUID()</code>方法的方式是在程序中生成一个随机UUID并打印出来。</p> <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GenerateRandomUUID</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 生成一个随机UUID</span>
        <span class="token class-name">UUID</span> randomUUID <span class="token operator">=</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 打印UUID的字符串表示形式</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Generated Random UUID: "</span> <span class="token operator">+</span> randomUUID<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <p>在这个例子中，我们生成了一个随机UUID并将其转换为字符串形式打印出来。</p> </li><li> <p><strong>生成多个随机UUID并存储</strong></p> <p>有时候，我们需要生成多个UUID并将它们存储起来，例如在创建多个实体或会话时。</p> <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GenerateMultipleUUIDs</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span>UUID<span class="token punctuation">&gt;</span></span> uuids <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">UUID</span> uuid <span class="token operator">=</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            uuids<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>uuid<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 打印所有生成的UUID</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token constant">UUID</span> uuid <span class="token operator">:</span> uuids<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Generated UUID: "</span> <span class="token operator">+</span> uuid<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <p>在这个例子中，我们生成了5个随机UUID并将它们存储在一个列表中，然后遍历列表打印每个UUID。</p> </li><li> <p><strong>使用随机UUID作为数据库记录的唯一标识</strong></p> <p>在数据库中，UUID常被用作唯一键，以确保每条记录都有一个唯一的标识符。</p> <pre><code class="prism language-java"><span class="token comment">// 假设我们有一个名为Entity的实体类，其中包含一个UUID字段</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Entity</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">UUID</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> data<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Entity</span><span class="token punctuation">(</span><span class="token class-name">UUID</span> id<span class="token punctuation">,</span> <span class="token class-name">String</span> data<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>data <span class="token operator">=</span> data<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Getter和Setter方法省略...</span>

    <span class="token comment">// 重写toString方法以打印实体信息</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token string">"Entity{"</span> <span class="token operator">+</span>
                <span class="token string">"id="</span> <span class="token operator">+</span> id <span class="token operator">+</span>
                <span class="token string">", data='"</span> <span class="token operator">+</span> data <span class="token operator">+</span> <span class="token char">'\''</span> <span class="token operator">+</span>
                <span class="token char">'}'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DatabaseExample</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 创建几个实体实例</span>
        <span class="token class-name">Entity</span> entity1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Entity</span><span class="token punctuation">(</span><span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Data for entity 1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Entity</span> entity2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Entity</span><span class="token punctuation">(</span><span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Data for entity 2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 打印实体信息</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>entity1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>entity2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <p>在这个例子中，我们创建了一个<code>Entity</code>类，它使用UUID作为唯一标识符。我们在数据库中创建了几个实体实例，并打印了它们的信息。</p> </li></ol> 
<hr> 
<h3><a id="UUID_224"></a>案例：根据名称生成UUID</h3> 
<p>在某些情况下，我们需要根据特定的名称或标识生成UUID，而不是完全随机生成。这种类型的UUID被称为名称基UUID（Version 3或Version 5），它们通过散列名称与一个命名空间的组合来生成。以下是一个具体的案例，展示了如何根据名称生成UUID。</p> 
<ol><li> <p><strong>使用<code>UUID.nameUUIDFromBytes()</code>生成名称基UUID</strong></p> <p><code>UUID.nameUUIDFromBytes()</code>方法接受一个字节数组作为输入，并生成一个名称基UUID。通常，这个字节数组是由名称字符串转换而来。</p> <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NameBasedUUIDExample</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 假设我们要为一个特定的名称生成UUID</span>
        <span class="token class-name">String</span> name <span class="token operator">=</span> <span class="token string">"com.example.myapp"</span><span class="token punctuation">;</span>
        <span class="token comment">// 将名称转换为字节数组</span>
        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nameBytes <span class="token operator">=</span> name<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 生成名称基UUID</span>
        <span class="token class-name">UUID</span> nameBasedUUID <span class="token operator">=</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">nameUUIDFromBytes</span><span class="token punctuation">(</span>nameBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 打印生成的UUID</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Name-based UUID: "</span> <span class="token operator">+</span> nameBasedUUID<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <p>在这个例子中，我们根据给定的名称生成了一个名称基UUID，并将其打印出来。</p> </li><li> <p><strong>在文件系统中使用名称基UUID</strong></p> <p>名称基UUID常用于文件系统，例如，为文件生成唯一的名称。</p> <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FileSystemUUIDExample</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 生成名称基UUID</span>
        <span class="token class-name">UUID</span> uniqueFileName <span class="token operator">=</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">nameUUIDFromBytes</span><span class="token punctuation">(</span><span class="token string">"uniqueFileName"</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 创建一个基于UUID的文件名</span>
        <span class="token class-name">String</span> fileName <span class="token operator">=</span> <span class="token string">"data_"</span> <span class="token operator">+</span> uniqueFileName<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">".txt"</span><span class="token punctuation">;</span>
        <span class="token comment">// 假设我们使用这个文件名保存数据</span>
        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">FileWriter</span> writer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileWriter</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            writer<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"This is some unique data."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 打印生成的文件名</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Generated file with name: "</span> <span class="token operator">+</span> fileName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <p>在这个例子中，我们为一个文件生成了一个唯一的名称，并尝试将一些数据写入该文件。</p> </li><li> <p><strong>在网络协议中使用名称基UUID</strong></p> <p>名称基UUID也可以用于网络协议中，例如，生成一个唯一的会话标识符或API密钥。</p> <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NetworkProtocolUUIDExample</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 生成名称基UUID作为会话ID</span>
        <span class="token class-name">UUID</span> sessionId <span class="token operator">=</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">nameUUIDFromBytes</span><span class="token punctuation">(</span><span class="token string">"session-123"</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 打印生成的会话ID</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Session ID: "</span> <span class="token operator">+</span> sessionId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 会话ID可以被用于跟踪和识别网络会话</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <p>在这个例子中，我们生成了一个名称基UUID作为会话ID，并将其打印出来。这个会话ID可以用于在网络通信中跟踪和识别特定的会话。</p> </li></ol> 
<hr> 
<h3><a id="UUID_295"></a>UUID的存储和表示</h3> 
<p>UUID作为一种128位的标识符，需要以一种可靠和一致的方式进行存储和表示。在Java中，UUID通常以字符串的形式表示，但在存储到数据库或网络传输时，需要考虑其编码和解码的过程。</p> 
<ol><li> <p><strong>UUID的字符串表示形式</strong></p> <p>UUID的标准字符串表示形式是由32个十六进制数字组成的，以连字符分为五组，形式为<code>8-4-4-4-12</code>。Java的<code>UUID</code>类提供了<code>toString()</code>方法来获取UUID的字符串表示。</p> <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UUIDStringRepresentation</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">UUID</span> uuid <span class="token operator">=</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 获取UUID的字符串表示</span>
        <span class="token class-name">String</span> uuidString <span class="token operator">=</span> uuid<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"UUID String Representation: "</span> <span class="token operator">+</span> uuidString<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <p>在这个例子中，我们生成了一个随机UUID并打印了其字符串表示形式。</p> </li><li> <p><strong>在数据库中存储UUID</strong></p> <p>UUID因其唯一性，常被用于数据库中的主键或唯一索引。大多数现代数据库系统都支持UUID作为数据类型，或者可以将其存储为字符串。</p> <pre><code class="prism language-java"><span class="token comment">// 假设我们有一个名为MyTable的数据库表，其中包含一个UUID类型的列</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DatabaseStorageExample</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">String</span> connectionString <span class="token operator">=</span> <span class="token string">"jdbc:mysql://localhost:3306/mydb"</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> username <span class="token operator">=</span> <span class="token string">"user"</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> password <span class="token operator">=</span> <span class="token string">"pass"</span><span class="token punctuation">;</span>
        <span class="token comment">// 连接到数据库并插入数据的代码省略...</span>
        <span class="token comment">// 假设我们有一个实体对象</span>
        <span class="token class-name">Entity</span> entity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Entity</span><span class="token punctuation">(</span><span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Some data"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 将实体存储到数据库中</span>
        <span class="token comment">// 插入代码省略...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Entity</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token class-name">UUID</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> data<span class="token punctuation">;</span>

    <span class="token comment">// 构造函数、getter和setter方法省略...</span>
<span class="token punctuation">}</span>
</code></pre> <p>在这个例子中，我们创建了一个<code>Entity</code>类，它使用UUID作为唯一标识符。我们将实体对象存储到数据库中，其中UUID作为主键。</p> </li><li> <p><strong>UUID在网络协议中的传输</strong></p> <p>UUID在网络协议中的传输需要进行编码，通常使用其字符串表示形式进行Base64编码或直接作为字符串传输。</p> <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UUIDNetworkTransmission</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">UUID</span> uuid <span class="token operator">=</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 将UUID转换为字符串</span>
        <span class="token class-name">String</span> uuidString <span class="token operator">=</span> uuid<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 对字符串进行Base64编码</span>
        <span class="token class-name">String</span> encodedString <span class="token operator">=</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encodeToString</span><span class="token punctuation">(</span>uuidString<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Base64 Encoded UUID: "</span> <span class="token operator">+</span> encodedString<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 通过网络传输编码后的字符串</span>
        <span class="token comment">// 网络传输代码省略...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <p>在这个例子中，我们将UUID转换为字符串，然后进行Base64编码，以便在网络协议中传输。</p> </li></ol> 
<hr> 
<h3><a id="UUIDWeb_368"></a>案例：UUID在Web应用中的使用</h3> 
<p>UUID在Web应用中有着广泛的应用，尤其是在生成会话ID、API密钥、订单号等需要唯一标识的场景。本节将通过案例展示UUID在Web应用中的几种典型用途。</p> 
<ol><li> <p><strong>生成会话ID</strong></p> <p>在Web应用中，为了跟踪用户的会话，通常会使用会话ID。由于UUID的唯一性，它非常适合用作会话ID。</p> <pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpSession</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServlet</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SessionIdExample</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{<!-- --></span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">HttpSession</span> session <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">UUID</span> sessionId <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">UUID</span><span class="token punctuation">)</span> session<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 将UUID会话ID添加到响应中</span>
        request<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"sessionId"</span><span class="token punctuation">,</span> sessionId<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <p>在这个例子中，我们在一个简单的Servlet中获取了会话ID，并将其作为属性添加到响应中。</p> </li><li> <p><strong>生成API密钥</strong></p> <p>API密钥是控制访问API的一种方式。使用UUID可以生成一个唯一的API密钥。</p> <pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">UUID</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ApiKeyGenerator</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">generateApiKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replaceAll</span><span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ApiClient</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">String</span> apiKey <span class="token operator">=</span> <span class="token class-name">ApiKeyGenerator</span><span class="token punctuation">.</span><span class="token function">generateApiKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Generated API Key: "</span> <span class="token operator">+</span> apiKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 使用apiKey进行API调用</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <p>在这个例子中，我们创建了一个<code>ApiKeyGenerator</code>类来生成不带连字符的UUID作为API密钥。</p> </li><li> <p><strong>生成订单号</strong></p> <p>订单号是电子商务网站中用来唯一标识每个订单的标识符。使用UUID可以确保每个订单号的唯一性。</p> <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderGenerator</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">UUID</span> <span class="token function">generateOrderUuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ECommerceExample</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">UUID</span> orderUuid <span class="token operator">=</span> <span class="token class-name">OrderGenerator</span><span class="token punctuation">.</span><span class="token function">generateOrderUuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 创建订单记录</span>
        <span class="token class-name">Order</span> order <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Order</span><span class="token punctuation">(</span>orderUuid<span class="token punctuation">,</span> <span class="token string">"Product1"</span><span class="token punctuation">,</span> <span class="token number">100.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 保存订单到数据库</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Order</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">private</span> <span class="token class-name">UUID</span> id<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">String</span> product<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">double</span> price<span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token class-name">Order</span><span class="token punctuation">(</span><span class="token class-name">UUID</span> id<span class="token punctuation">,</span> <span class="token class-name">String</span> product<span class="token punctuation">,</span> <span class="token keyword">double</span> price<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>product <span class="token operator">=</span> product<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>price <span class="token operator">=</span> price<span class="token punctuation">;</span>
            <span class="token comment">// 假设这里有一个将订单保存到数据库的方法</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Getter和Setter方法省略...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <p>在这个例子中，我们创建了一个<code>OrderGenerator</code>类来生成订单UUID，并在一个模拟的电子商务系统中使用它作为订单号。</p> </li></ol> 
<hr> 
<h3><a id="UUID_459"></a>UUID的性能考量</h3> 
<p>在考虑使用UUID时，性能是一个不可忽视的因素。虽然UUID提供了高度的唯一性，但其生成过程可能会对系统性能产生影响。本节将探讨UUID生成的性能特点，并提供一些优化建议。</p> 
<ol><li> <p><strong>分析UUID生成的性能开销</strong></p> <p>UUID的生成通常涉及随机数生成器或散列函数，这些操作可能会消耗CPU资源。在高并发场景下，频繁地生成UUID可能会成为性能瓶颈。</p> <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UUIDPerformance</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">long</span> start <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">nanoTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">long</span> end <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">nanoTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Time taken to generate 100,000 UUIDs: "</span> <span class="token operator">+</span> <span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" nanoseconds"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <p>在这个例子中，我们测量了生成100,000个随机UUID所需的时间。这个简单的基准测试可以帮助我们了解UUID生成的性能开销。</p> </li><li> <p><strong>优化UUID生成的性能</strong></p> <p>为了优化UUID的性能，可以采取以下措施：</p> 
  <ul><li><strong>重用UUID实例</strong>：在可能的情况下，尽量重用UUID实例，而不是频繁地生成新的UUID。</li><li><strong>使用缓存</strong>：对于不需要高度随机性的UUID，可以使用缓存来存储已生成的UUID，以减少生成新UUID的频率。</li><li><strong>选择合适的UUID版本</strong>：根据应用场景选择合适的UUID版本。例如，如果确定性唯一性足够，可以使用版本1的UUID，而不是随机性更高的版本4。</li></ul> <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OptimizedUUIDGeneration</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span>UUID<span class="token punctuation">&gt;</span></span> uuidCache <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>uuidCache<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                uuidCache<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Reusing UUID: "</span> <span class="token operator">+</span> uuidCache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                uuidCache<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 移除并返回缓存中的第一个UUID</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <p>在这个例子中，我们使用了一个简单的缓存来重用UUID实例，以减少<code>UUID.randomUUID()</code>的调用次数。</p> </li><li> <p><strong>比较不同UUID生成策略的性能</strong></p> <p>不同的UUID生成策略有不同的性能特点。例如，版本1的UUID基于时间，可能在某些情况下比版本4的随机UUID生成更快。</p> <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CompareUUIDStrategies</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">long</span> timeTakenVersion1 <span class="token operator">=</span> <span class="token function">measureTime</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token keyword">new</span> <span class="token class-name">UUID</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">long</span> timeTakenVersion4 <span class="token operator">=</span> <span class="token function">measureTime</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Time taken for version 1: "</span> <span class="token operator">+</span> timeTakenVersion1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Time taken for version 4: "</span> <span class="token operator">+</span> timeTakenVersion4<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">long</span> <span class="token function">measureTime</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span> runnable<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">long</span> start <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">nanoTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        runnable<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">nanoTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <p>在这个例子中，我们比较了生成版本1和版本4 UUID的性能。实际结果可能会因系统和JVM的不同而有所差异。</p> </li></ol> 
<p>以下是关于“JAVA生成UUID”的技术文章的第九小节“UUID的替代方案”部分的内容，包含了充足的案例源码说明：</p> 
<hr> 
<h3><a id="UUID_545"></a>UUID的替代方案</h3> 
<p>虽然UUID提供了一个强大且普遍认可的方法来生成唯一标识符，但在某些特定场景下，我们可能需要考虑替代方案。这些替代方案可能基于不同的需求，如性能优化、特定数据结构的需求或兼容性考虑。</p> 
<ol><li> <p><strong>简短的ID生成</strong></p> <p>在某些情况下，UUID的128位长度可能显得过于冗长。我们可以使用一些算法来生成更短的ID，同时仍然保持足够高的唯一性。</p> <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ShortIDGenerator</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">ID_LENGTH</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">MAX_VALUE</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">36</span><span class="token punctuation">,</span> <span class="token constant">ID_LENGTH</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">generateId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">SecureRandom</span> random <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SecureRandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> nextInt<span class="token punctuation">;</span>
        <span class="token class-name">StringBuilder</span> sb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token constant">ID_LENGTH</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>sb<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token constant">ID_LENGTH</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            nextInt <span class="token operator">=</span> random<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token constant">MAX_VALUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>nextInt<span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> sb<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ShortIDExample</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">String</span> shortId <span class="token operator">=</span> <span class="token class-name">ShortIDGenerator</span><span class="token punctuation">.</span><span class="token function">generateId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Short ID: "</span> <span class="token operator">+</span> shortId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <p>在这个例子中，我们创建了一个<code>ShortIDGenerator</code>类来生成一个基于36进制的短ID。</p> </li><li> <p><strong>基于时间的ID生成</strong></p> <p>对于需要有序性的ID，可以使用基于时间的ID生成策略，如Twitter的Snowflake算法。这种算法生成的ID既有序又唯一，并且可以压缩时间戳和工作机器ID，从而节省空间。</p> <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SnowflakeIdWorker</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">long</span> twepoch <span class="token operator">=</span> <span class="token number">1288834974657L</span><span class="token punctuation">;</span> <span class="token comment">// Twitter定义的起始时间戳</span>
    <span class="token keyword">private</span> <span class="token keyword">long</span> sequence <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 毫秒内序列</span>
    <span class="token keyword">private</span> <span class="token keyword">long</span> lastTimestamp <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1L</span><span class="token punctuation">;</span> <span class="token comment">// 上次生成ID的时间戳</span>

    <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">long</span> <span class="token function">nextId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">long</span> timestamp <span class="token operator">=</span> <span class="token function">timeGen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取时间戳</span>
        <span class="token comment">// 如果当前时间小于上一次ID生成的时间戳，说明系统时钟回退过</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>timestamp <span class="token operator">&lt;</span> lastTimestamp<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"Clock moved backwards. Refusing to generate id for %d milliseconds"</span><span class="token punctuation">,</span> lastTimestamp <span class="token operator">-</span> timestamp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 如果是同一时间生成的，则进行毫秒内序列</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>lastTimestamp <span class="token operator">==</span> timestamp<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            sequence <span class="token operator">=</span> <span class="token punctuation">(</span>sequence <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">// 这里3=0000 0011，即：0-3</span>
            <span class="token comment">// 毫秒内序列溢出</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>sequence <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                <span class="token function">waitUntilNextMillis</span><span class="token punctuation">(</span>timestamp<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
            sequence <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        lastTimestamp <span class="token operator">=</span> timestamp<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>timestamp <span class="token operator">-</span> twepoch<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">22</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>sequence <span class="token operator">&lt;&lt;</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>workerId <span class="token operator">&lt;&lt;</span> <span class="token number">12</span><span class="token punctuation">)</span> <span class="token operator">|</span> datacenterId<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token keyword">long</span> <span class="token function">timeGen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 等待下一个毫秒,直到获得新的时间戳</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">waitUntilNextMillis</span><span class="token punctuation">(</span><span class="token keyword">long</span> lastTimestamp<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">long</span> timestamp <span class="token operator">=</span> <span class="token function">timeGen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>timestamp <span class="token operator">&lt;=</span> lastTimestamp<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            timestamp <span class="token operator">=</span> <span class="token function">timeGen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SnowflakeExample</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">SnowflakeIdWorker</span> idWorker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SnowflakeIdWorker</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> id <span class="token operator">=</span> idWorker<span class="token punctuation">.</span><span class="token function">nextId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Snowflake ID: "</span> <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <p>在这个例子中，我们模拟了一个基于Snowflake算法的ID生成器，并生成了一个唯一的ID。</p> </li><li> <p><strong>自定义ID生成策略</strong></p> <p>根据应用的特定需求，可以设计自定义的ID生成策略。例如，可以结合数据库序列、哈希函数或其他业务逻辑来生成ID。</p> <pre><code class="prism language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomIdGenerator</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">AtomicInteger</span> counter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicInteger</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> prefix <span class="token operator">=</span> <span class="token string">"ID_"</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">generateCustomId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">int</span> currentCount <span class="token operator">=</span> counter<span class="token punctuation">.</span><span class="token function">incrementAndGet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> hash <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">toHexString</span><span class="token punctuation">(</span>currentCount<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> prefix <span class="token operator">+</span> hash<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomIDExample</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">String</span> customId <span class="token operator">=</span> <span class="token class-name">CustomIdGenerator</span><span class="token punctuation">.</span><span class="token function">generateCustomId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Custom ID: "</span> <span class="token operator">+</span> customId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <p>在这个例子中，我们创建了一个<code>CustomIdGenerator</code>类，它使用原子计数器和哈希函数来生成自定义的ID。</p> </li></ol>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/614aa71619cae44bc7b6d87c4eafd041/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">A*（A-star）算法 定义&#43;特性&#43;原理&#43;公式&#43;Python示例代码（带详细注释）</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/94f5708bd606104aeb39fab36c653ae1/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Stable Diffusion【ControlNet】：使用InstantID插件实现人物角色一致性</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程学习者.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
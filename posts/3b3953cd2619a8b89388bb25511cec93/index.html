<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>使用Java API操作HDFS - 编程学习者</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcxuexizhe.github.io/posts/3b3953cd2619a8b89388bb25511cec93/">
  <meta property="og:site_name" content="编程学习者">
  <meta property="og:title" content="使用Java API操作HDFS">
  <meta property="og:description" content="（1）实验原理 使用Java API操作HDFS的实验原理如下：
配置Hadoop环境：首先需要配置Hadoop的环境，包括设置Hadoop的安装路径、配置core-site.xml和hdfs-site.xml等文件，以便Java程序能够连接到HDFS。
引入Hadoop依赖：在Java项目中，需要引入Hadoop的相关依赖，包括hadoop-common、hadoop-hdfs等依赖，以便能够使用Hadoop提供的API。
创建Configuration对象：使用org.apache.hadoop.conf.Configuration类创建一个Configuration对象，该对象包含了Hadoop的配置信息。
创建FileSystem对象：使用org.apache.hadoop.fs.FileSystem类的静态方法get()，传入Configuration对象，创建一个FileSystem对象，该对象用于与HDFS进行交互。
执行HDFS操作：通过FileSystem对象，可以执行各种HDFS操作，如创建目录、上传文件、下载文件、删除文件、重命名文件等。具体操作可以使用FileSystem对象提供的方法，如create()、copyFromLocalFile()、copyToLocalFile()、delete()、rename()等。
关闭FileSystem对象：在操作完成后，需要调用FileSystem对象的close()方法关闭与HDFS的连接，释放资源。
通过以上步骤，就可以使用Java API操作HDFS，实现对HDFS文件系统的管理和操作。
（2）实验环境 要使用Java API操作HDFS，需要搭建以下实验环境：
安装Java Development Kit (JDK)：首先需要安装JDK，建议使用Java 8或更高版本。
安装Hadoop：在本地或远程服务器上安装Hadoop。可以从Hadoop官方网站下载最新版本的Hadoop，并按照官方文档进行安装和配置。
设置Hadoop环境变量：将Hadoop的安装路径添加到系统的环境变量中，以便Java程序能够找到Hadoop的相关依赖库和配置文件。
引入Hadoop依赖：在Java项目中，需要引入Hadoop的相关依赖，包括hadoop-common、hadoop-hdfs等依赖。可以使用Maven或Gradle等构建工具来管理依赖。
编写Java代码：使用Java编写代码，通过Hadoop提供的Java API来操作HDFS。在代码中需要配置Hadoop的相关参数，如HDFS的URL、配置文件路径等。
编译和运行Java程序：使用Java编译器将Java代码编译成字节码文件，然后使用Java虚拟机（JVM）运行编译后的字节码文件。
在实验环境搭建完成后，就可以使用Java API操作HDFS，实现对HDFS文件系统的管理和操作
（3）实验步骤 一.创建Maven项目 首先，打开IDEA，点击新建项目，在左侧中选择Maven，然后直接点击next
设置项目名称为HadoopDemo，点击Finish 点击右下角的 Enable Auto-Import(自动导入Jar包文件)，一个空的Maven项目就创建完毕啦
二、导入依赖 首先编辑pom.xml(Maven项目的核心文件)文件，添加如下内容，导入依赖（所需jar包）
代码显示
&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt; &lt;project xmlns=&#34;http://maven.apache.org/POM/4.0.0&#34; xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34; xsi:schemaLocation=&#34;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&#34;&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;org.example&lt;/groupId&gt; &lt;artifactId&gt;untitled&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;properties&gt; &lt;maven.compiler.source&gt;20&lt;/maven.compiler.source&gt; &lt;maven.compiler.target&gt;20&lt;/maven.compiler.target&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;/properties&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt; &lt;artifactId&gt;hadoop-common&lt;/artifactId&gt; &lt;version&gt;3.3.0&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt; &lt;artifactId&gt;hadoop-hdfs&lt;/artifactId&gt; &lt;version&gt;3.3.0&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt; &lt;artifactId&gt;hadoop-client&lt;/artifactId&gt; &lt;version&gt;3.3.0&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;4.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-11-02T15:55:44+08:00">
    <meta property="article:modified_time" content="2023-11-02T15:55:44+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程学习者" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程学习者</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">使用Java API操作HDFS</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-left:0;text-align:justify;"></p> 
<p></p> 
<ul><li style="text-align:justify;"> <h2>（1）实验原理</h2> </li></ul> 
<p style="margin-left:0;text-align:justify;">使用Java API操作HDFS的实验原理如下：</p> 
<p style="margin-left:0;text-align:justify;">配置Hadoop环境：首先需要配置Hadoop的环境，包括设置Hadoop的安装路径、配置core-site.xml和hdfs-site.xml等文件，以便Java程序能够连接到HDFS。</p> 
<p style="margin-left:0;text-align:justify;">引入Hadoop依赖：在Java项目中，需要引入Hadoop的相关依赖，包括hadoop-common、hadoop-hdfs等依赖，以便能够使用Hadoop提供的API。</p> 
<p style="margin-left:0;text-align:justify;">创建Configuration对象：使用org.apache.hadoop.conf.Configuration类创建一个Configuration对象，该对象包含了Hadoop的配置信息。</p> 
<p style="margin-left:0;text-align:justify;">创建FileSystem对象：使用org.apache.hadoop.fs.FileSystem类的静态方法get()，传入Configuration对象，创建一个FileSystem对象，该对象用于与HDFS进行交互。</p> 
<p style="margin-left:0;text-align:justify;">执行HDFS操作：通过FileSystem对象，可以执行各种HDFS操作，如创建目录、上传文件、下载文件、删除文件、重命名文件等。具体操作可以使用FileSystem对象提供的方法，如create()、copyFromLocalFile()、copyToLocalFile()、delete()、rename()等。</p> 
<p style="margin-left:0;text-align:justify;">关闭FileSystem对象：在操作完成后，需要调用FileSystem对象的close()方法关闭与HDFS的连接，释放资源。</p> 
<p style="margin-left:0;text-align:justify;">通过以上步骤，就可以使用Java API操作HDFS，实现对HDFS文件系统的管理和操作。</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<ul><li style="text-align:justify;"> <h2>（2）实验环境</h2> </li></ul> 
<p style="margin-left:0;text-align:justify;">要使用Java API操作HDFS，需要搭建以下实验环境：</p> 
<p style="margin-left:0;text-align:justify;">安装Java Development Kit (JDK)：首先需要安装JDK，建议使用Java 8或更高版本。</p> 
<p style="margin-left:0;text-align:justify;">安装Hadoop：在本地或远程服务器上安装Hadoop。可以从Hadoop官方网站下载最新版本的Hadoop，并按照官方文档进行安装和配置。</p> 
<p style="margin-left:0;text-align:justify;">设置Hadoop环境变量：将Hadoop的安装路径添加到系统的环境变量中，以便Java程序能够找到Hadoop的相关依赖库和配置文件。</p> 
<p style="margin-left:0;text-align:justify;">引入Hadoop依赖：在Java项目中，需要引入Hadoop的相关依赖，包括hadoop-common、hadoop-hdfs等依赖。可以使用Maven或Gradle等构建工具来管理依赖。</p> 
<p style="margin-left:0;text-align:justify;">编写Java代码：使用Java编写代码，通过Hadoop提供的Java API来操作HDFS。在代码中需要配置Hadoop的相关参数，如HDFS的URL、配置文件路径等。</p> 
<p style="margin-left:0;text-align:justify;">编译和运行Java程序：使用Java编译器将Java代码编译成字节码文件，然后使用Java虚拟机（JVM）运行编译后的字节码文件。</p> 
<p style="margin-left:0;text-align:justify;">在实验环境搭建完成后，就可以使用Java API操作HDFS，实现对HDFS文件系统的管理和操作</p> 
<p style="margin-left:0;text-align:justify;"></p> 
<h2 style="margin-left:0px;text-align:justify;">（3）实验步骤</h2> 
<h3 style="background-color:transparent;margin-left:0px;text-align:justify;">一.创建Maven项目</h3> 
<p style="margin-left:0;text-align:justify;"><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">首先，打开</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">IDEA</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">，点击新建项目，在左侧中选择</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">Maven</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">，然后直接点击</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">next</span></span></p> 
<p><img alt="" height="859" src="https://images2.imgbox.com/8f/be/3t5Uu9Pm_o.png" width="1200"></p> 
<p style="margin-left:0;text-align:justify;"></p> 
<p style="margin-left:0;text-align:justify;"><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">设置项目名称为</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">HadoopDemo</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">，点击</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">Finish </span></span></p> 
<p style="margin-left:0;text-align:justify;"><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">点击右下角的</span></span><span style="background-color:#ffffff;"><span style="color:#ed7976;"> Enable Auto-Import</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">(</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">自动导入</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">Jar</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">包文件</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">)</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">，一个空的</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">Maven</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">项目就创建完毕啦</span></span></p> 
<p><img alt="" height="925" src="https://images2.imgbox.com/00/58/edcqKsp9_o.png" width="1200"></p> 
<h3 style="background-color:transparent;margin-left:0px;text-align:justify;"><span style="background-color:#ffffff;"><strong><span style="color:#4f4f4f;">二、导入依赖</span></strong></span></h3> 
<p style="margin-left:0;"><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">首先编辑</span><span style="color:#ed7976;">pom.xml(Maven</span><span style="color:#ed7976;">项目的核心文件</span><span style="color:#ed7976;">)</span><span style="color:#4d4d4d;">文件，添加如下内容，导入依赖（所需</span><span style="color:#4d4d4d;">jar</span><span style="color:#4d4d4d;">包）</span></span></p> 
<p><img alt="" height="757" src="https://images2.imgbox.com/9b/15/quXopJ97_o.png" width="1200"></p> 
<p> <img alt="" height="766" src="https://images2.imgbox.com/33/43/uAhB8mBh_o.png" width="1200"></p> 
<p>代码显示</p> 
<pre><code class="language-java">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;groupId&gt;org.example&lt;/groupId&gt;
    &lt;artifactId&gt;untitled&lt;/artifactId&gt;
    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;

    &lt;properties&gt;
        &lt;maven.compiler.source&gt;20&lt;/maven.compiler.source&gt;
        &lt;maven.compiler.target&gt;20&lt;/maven.compiler.target&gt;
        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
    &lt;/properties&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;
            &lt;artifactId&gt;hadoop-common&lt;/artifactId&gt;
            &lt;version&gt;3.3.0&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;
            &lt;artifactId&gt;hadoop-hdfs&lt;/artifactId&gt;
            &lt;version&gt;3.3.0&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.apache.hadoop&lt;/groupId&gt;
            &lt;artifactId&gt;hadoop-client&lt;/artifactId&gt;
            &lt;version&gt;3.3.0&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;junit&lt;/groupId&gt;
            &lt;artifactId&gt;junit&lt;/artifactId&gt;
            &lt;version&gt;4.12&lt;/version&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/project&gt;</code></pre> 
<p style="margin-left:0;text-align:left;"><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">IDEA</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">会自动保存文件并且导入依赖包，点击右侧的</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">Maven</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">，展开</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">Dependencies</span></span><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">，可以看到四个依赖包以及导入进来了</span></span></p> 
<p><img alt="" height="870" src="https://images2.imgbox.com/f1/3d/8LoOxfar_o.png" width="1200"></p> 
<p style="margin-left:0;text-align:left;"></p> 
<h3 style="background-color:transparent;margin-left:0cm;"><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">三．在</span><span style="color:#4d4d4d;">windows</span><span style="color:#4d4d4d;">中配置</span><span style="color:#4d4d4d;">Hadoop</span><span style="color:#4d4d4d;">运行环境</span></span></h3> 
<p></p> 
<p style="margin-left:0cm;"><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">找到下载的</span><span style="color:#4d4d4d;">hadoop</span><span style="color:#4d4d4d;">安装包解压后，在</span><span style="color:#4d4d4d;">Hadoop</span><span style="color:#4d4d4d;">的安装路径的</span><span style="color:#4d4d4d;">bin</span><span style="color:#4d4d4d;">目录下添加</span><span style="color:#4d4d4d;">winutils.exe,winutils.pdb,Hadoop.dll </span><span style="color:#4d4d4d;">文件</span></span></p> 
<p style="margin-left:0cm;"><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">下载的Hadoop安装包想要的关注我找我要。</span></span></p> 
<p><img alt="" height="781" src="https://images2.imgbox.com/16/f8/cZisdB4d_o.png" width="1200"></p> 
<p style="margin-left:0cm;"></p> 
<p style="margin-left:0cm;"></p> 
<p style="margin-left:0cm;"></p> 
<h4 style="background-color:transparent;margin-left:0cm;"><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">四.配置环境</span></span></h4> 
<p><img alt="" height="340" src="https://images2.imgbox.com/4f/d0/wqIrOy33_o.png" width="1200"></p> 
<p style="margin-left:0cm;"></p> 
<p><img alt="" height="378" src="https://images2.imgbox.com/dc/20/gBGtV8Ec_o.png" width="1200"></p> 
<p><img alt="" height="715" src="https://images2.imgbox.com/12/5c/77sCiK46_o.png" width="1200"></p> 
<p style="margin-left:0;text-align:left;"><strong>配置成功显示</strong></p> 
<p><img alt="" height="466" src="https://images2.imgbox.com/60/9f/ouqCUyPJ_o.png" width="1200"></p> 
<h3 style="background-color:transparent;margin-left:0px;text-align:justify;"><span style="background-color:#ffffff;"><strong><span style="color:#4f4f4f;">三、初始化</span></strong></span></h3> 
<p style="margin-left:0cm;"><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">我们通过</span><span style="color:#4d4d4d;">junit</span><span style="color:#4d4d4d;">来进行测试，首先创建一个类，添加如下内容</span></span></p> 
<p><img alt="" height="424" src="https://images2.imgbox.com/a1/c4/BgUnLKfc_o.png" width="1200"></p> 
<p><img alt="" height="978" src="https://images2.imgbox.com/62/0f/XoYdUKZ1_o.png" width="1200"></p> 
<h3 style="background-color:transparent;margin-left:0px;text-align:justify;"><span style="background-color:#ffffff;"><strong><span style="color:#4f4f4f;">四、HDFS代码操作</span></strong></span></h3> 
<h4 style="margin-left:0cm;"><span style="background-color:#ffffff;"><strong><span style="color:#4d4d4d;">（</span></strong><strong><span style="color:#4d4d4d;">1</span></strong><strong><span style="color:#4d4d4d;">）上传文件到</span></strong><strong><span style="color:#4d4d4d;">HDFS</span></strong><strong><span style="color:#4d4d4d;">文件系统</span></strong></span></h4> 
<p><img alt="" height="853" src="https://images2.imgbox.com/7e/9b/H6Ioy830_o.png" width="1200"></p> 
<p style="margin-left:0;text-align:left;"></p> 
<p style="margin-left:0;text-align:left;"><strong>显示成功上传</strong></p> 
<p><img alt="" height="834" src="https://images2.imgbox.com/69/31/PIgUAxtE_o.png" width="1200"></p> 
<h4 style="margin-left:0px;text-align:left;"><strong> </strong><strong><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">（</span></span></strong><strong><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">2</span></span></strong><strong><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">）从</span></span></strong><strong><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">HDFS</span></span></strong><strong><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">下载文件到本地</span></span></strong></h4> 
<p style="margin-left:0;text-align:left;"><strong><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">把刚才传送到</span></span></strong><strong><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">HDFS</span></span></strong><strong><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">的</span></span></strong><strong><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">lol lineTxt</span></span></strong><strong><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">文件再传送到电脑上</span></span></strong></p> 
<p><img alt="" height="652" src="https://images2.imgbox.com/ee/63/Pd858TBn_o.png" width="1200"></p> 
<p style="margin-left:0;text-align:left;"></p> 
<p><img alt="" height="670" src="https://images2.imgbox.com/18/ba/a4h9lbPL_o.png" width="1200"></p> 
<h4 style="margin-left:0px;text-align:left;"><strong><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">（</span></span></strong><strong><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">3</span></span></strong><strong><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">）创建目录</span></span></strong></h4> 
<p><img alt="" height="267" src="https://images2.imgbox.com/e4/25/EPFaOdgR_o.png" width="865"></p> 
<p><img alt="" height="588" src="https://images2.imgbox.com/63/c1/S6n4JdVG_o.png" width="1200"></p> 
<h4 style="background-color:transparent;margin-left:0px;text-align:left;"><strong><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">（4）查看</span></span></strong><strong><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">HDFS</span></span></strong><strong><span style="background-color:#ffffff;"><span style="color:#4d4d4d;">目录中的文件信息</span></span></strong></h4> 
<p><img alt="" height="690" src="https://images2.imgbox.com/ba/de/7EGYo1sj_o.png" width="1200"></p> 
<p><img alt="" height="874" src="https://images2.imgbox.com/0b/a9/KjCXfOfG_o.png" width="1200"></p> 
<h3>全部代码如下</h3> 
<pre><code class="language-java">package cn.itcast.hdfsdemo;

import java.io.*;
import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.fs.*;
import org.junit.*;
    public class HDFS_CURD {

        // 可操作HDFS文件系统的对象
        FileSystem fs = null;

        @Before
        public void init() throws Exception {
            // 构造一个配置参数对象，设置一个参数：要访问的HDFS的UR
            Configuration conf = new Configuration();
            // 指定使用HDFS访问
            conf.set("fs.defaultFS", "hdfs://hadoop1:9000");
            // 进行客户端身份的设置(root为虚拟机的用户名，hadoop集群节点的其中一个都可以)
            System.setProperty("HADOOP_USER_NAME", "root");
            // 通过FileSystem的静态get()方法获取HDFS文件系统客户端对象
            fs = FileSystem.get(conf);
        }


        @Test
        public void testAddFileToHdfs() throws IOException {
            //指定本地文件系统上传的文件（静态）
            Path src = new Path("E:\\IDEAPractise\\upload\\lol line.txt");
            //指定将文件上传到 HDFS 的目录
            Path dst = new Path("/testFile");
            fs.copyFromLocalFile(src, dst);
            System.out.println("上传成功");
            //关闭资源
            fs.close();
        }

        //从HDFS下载文件到本地
        @Test
        public void testDownloadFileToLocal() throws IOException {
            //待下载的路径（HDFS）
               Path  src =  new Path("/testFile/lol line.txt");
               // 下载成功之后存放的路径(windows)
               Path dst  =  new Path("E:\\IDEAPractise\\downloadFile/lol.txt");
               //下载
            fs.copyToLocalFile(false,src,dst,true);
            System.out.println("下载成功");
        }

        //目录操作（创建目录）
        @Test
        public void testMkdirAndDeleteAndRename() throws IOException {
            fs.mkdirs(new Path("/a/b/c"));
            fs.mkdirs(new Path("/a2/b2/c2"));
            fs.rename(new Path("/a"), new Path("/a3"));
            fs.delete(new Path("/a2"),true);
            System.out.println("创建成功");
        }
        //查看目录中的文件信息
        @Test
        public void testListFiles() throws IOException {
            RemoteIterator&lt;LocatedFileStatus&gt; listFiles = fs.listFiles(new Path("/car"),true);
            while (listFiles.hasNext()) {
                LocatedFileStatus fileStatus = listFiles.next();
                System.out.println("文件名：" + fileStatus.getPath().getName());
                System.out.println("文件的副本数：" + fileStatus.getReplication());
                System.out.println("文件的权限：" + fileStatus.getReplication());
                System.out.println("文件的大小：" + fileStatus.getLen() + "字节");
                 BlockLocation[] blockLocations = fileStatus.getBlockLocations();
                 for (BlockLocation b1 : blockLocations){
                     String[] hosts = b1.getHosts();
                     System.out.println("文件的Block所在虚拟机的主机名：");
                     for(String host : hosts) {
                         System.out.println(host);
                     }
                 }
            }
            System.out.println("--------------------------------------------------------------");
    }
      }
</code></pre> 
<p></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7d4dc52566797b9d2c11f5b147bcea1b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【Mysql】WITH AS 语法详解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/507bf8b5489cdc3682e91a42030dd620/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">微信小程序完整项目实战(前端&#43;后端)</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程学习者.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
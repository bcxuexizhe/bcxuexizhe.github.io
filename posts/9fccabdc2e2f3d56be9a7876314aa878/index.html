<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【ESP32接入国产大模型之文心一言】 - 编程学习者</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcxuexizhe.github.io/posts/9fccabdc2e2f3d56be9a7876314aa878/">
  <meta property="og:site_name" content="编程学习者">
  <meta property="og:title" content="【ESP32接入国产大模型之文心一言】">
  <meta property="og:description" content="1. 怎样接入文心一言 视频讲解：
【ESP32接入国产大模型之文心一言】
【ESP32接入国产大模型之MiniMax】
【ESP32接入语言大模型之智谱清言】
【ESP32接入国产大模型之文心一言】
【ESP32接入语言大模型之通义千问】
下面是不标准测评，参考而已
模型响应时间内容质量免费token次数地址MiniMax3s8分500万https://www.minimaxi.com/智谱清言7s8分300万https://open.bigmodel.cn/文心一言10s9分500万https://cloud.baidu.com/doc/WENXINWORKSHOP/s/Nlks5zkzu通义千问8s8分800万https://tongyi.aliyun.com/qianwen/ 随着人工智能技术的不断发展，自然语言处理领域也得到了广泛的关注和应用。在这个领域中，文心一言作为一款强大的自然语言处理工具，具有许多重要的应用价值。本文将重点介绍如何通过ESP32接入国产大模型之文心一言api，以及其中的重点词汇或短语。
1.1 了解文心一言 文心一言是百度打造出来的人工智能大语言模型，具备跨模态、跨语言的深度语义理解与生成能力，文心一言有五大能力，文学创作、商业文案创作、数理逻辑推算、中文理解、多模态生成，其在搜索问答、内容创作生成、智能办公等众多领域都有更广阔的想象空间。文心一言企业服务由千帆大模型平台提供，包括推理服务及大模型微调等一系列开发和应用工具链。文心一言大模型现已升级至4.0，企业客户可通过百度智能云千帆大模型平台申请接入。
1.2 接入文心一言 API 列表
百度智能云千帆平台提供了丰富的API，保留对话Chat、续写Completions、向量Embeddings、插件应用、Prompt工程、大模型训练、管理及服务等API能力，详情请查看API列表。
大模型相关 对话Chat：支持创建chat，用于发起一次对话。续写Completions：支持创建completion，用于发起一次续写请求，不支持多轮会话等。向量Embeddings：支持Embeddings，用于根据输入内容生成对应的向量表示。自定义模型导入：支持HuggingFace Transformer架构的自定义模型导入，提供自定义模型导入相关API能力。图像Images：提供图像相关API能力。 插件应用：提供域内知识搜索增强插件API相关能力。Prompt工程：提供模版相关API能力。大模型训练：提供创建训练任务、任务运行、停止任务运行及获取任务运行详情等API能力。大模型管理：提供获取模型、模型版本详情及将训练任务发布为模型等API能力。大模型服务：提供创建服务、获取服务详情等API能力。 1.3 API 调用流程简介 API 的调用流程如下图所示。
创建一个千帆应用。根据实际需求创建千帆应用，创建成功后，获取AppID、API Key、Secret Key 等信息。API 授权。对应用的 AppID 进行授权。获取接口访问凭证 access_token 。根据第1步获取的 API Key 和 Secret Key ，调用获取access_token接口获取 access_token ，通过 access_token 鉴权调用者身份。调用API接口。例如调用ERNIE-Bot相关接口，详见API列表。 1.4 API 调用流程 1.4.1 步骤一. 创建千帆应用 （1）登录百度智能云千帆控制台。
请您注册并登录百度智能云千帆控制台 。
注意：为保障服务稳定运行，账户最好不处于欠费状态。
（2）创建千帆应用
进入控制台创建应用 。
（3）创建应用后，获取AppID、API Key、Secret Key。
1.4.2 步骤二. 服务授权 应用创建后，选择对应授权的公有云服务。
1.4.3 步骤三. 调用API接口 调用千帆提供的相关接口，如ERNIE-Bot等，详见API列表。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-18T21:30:24+08:00">
    <meta property="article:modified_time" content="2024-03-18T21:30:24+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程学习者" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程学习者</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【ESP32接入国产大模型之文心一言】</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <h2><a id="1__2"></a>1. 怎样接入文心一言</h2> 
<p>视频讲解：</p> 
<p></p> 
<div class="csdn-video-box"> 
 <iframe id="4zOgxQhB-1704373517751" frameborder="0" src="https://player.bilibili.com/player.html?aid=238157710" allowfullscreen="true" data-mediaembed="bilibili"></iframe> 
 <p>【ESP32接入国产大模型之文心一言】</p> 
</div> 
<p></p> 
<p><a href="https://vor2345.blog.csdn.net/article/details/136768206" rel="nofollow">【ESP32接入国产大模型之MiniMax】</a><br> <a href="https://vor2345.blog.csdn.net/article/details/135522961" rel="nofollow">【ESP32接入语言大模型之智谱清言】</a><br> <a href="https://vor2345.blog.csdn.net/article/details/135372118" rel="nofollow">【ESP32接入国产大模型之文心一言】</a><br> <a href="https://blog.csdn.net/vor234/article/details/135395143">【ESP32接入语言大模型之通义千问】</a></p> 
<p>下面是不标准测评，参考而已</p> 
<table><thead><tr><th>模型</th><th>响应时间</th><th>内容质量</th><th>免费token次数</th><th>地址</th></tr></thead><tbody><tr><td>MiniMax</td><td>3s</td><td>8分</td><td>500万</td><td><a href="https://www.minimaxi.com/" rel="nofollow">https://www.minimaxi.com/</a></td></tr><tr><td>智谱清言</td><td>7s</td><td>8分</td><td>300万</td><td><a href="https://open.bigmodel.cn/" rel="nofollow">https://open.bigmodel.cn/</a></td></tr><tr><td>文心一言</td><td>10s</td><td>9分</td><td>500万</td><td><a href="https://cloud.baidu.com/doc/WENXINWORKSHOP/s/Nlks5zkzu" rel="nofollow">https://cloud.baidu.com/doc/WENXINWORKSHOP/s/Nlks5zkzu</a></td></tr><tr><td>通义千问</td><td>8s</td><td>8分</td><td>800万</td><td><a href="https://tongyi.aliyun.com/qianwen/" rel="nofollow">https://tongyi.aliyun.com/qianwen/</a></td></tr></tbody></table> 
<p>随着人工智能技术的不断发展，自然语言处理领域也得到了广泛的关注和应用。在这个领域中，文心一言作为一款强大的自然语言处理工具，具有许多重要的应用价值。本文将重点介绍如何通过ESP32接入国产大模型之文心一言api，以及其中的重点词汇或短语。<br> <img src="https://images2.imgbox.com/b2/76/LsRv52Rd_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="11__25"></a>1.1 了解文心一言</h3> 
<p>文心一言是百度打造出来的人工智能大语言模型，具备跨模态、跨语言的深度语义理解与生成能力，文心一言有五大能力，文学创作、商业文案创作、数理逻辑推算、中文理解、多模态生成，其在搜索问答、内容创作生成、智能办公等众多领域都有更广阔的想象空间。文心一言企业服务由千帆大模型平台提供，包括推理服务及大模型微调等一系列开发和应用工具链。文心一言大模型现已升级至4.0，企业客户可通过百度智能云千帆大模型平台申请接入。</p> 
<h3><a id="12__28"></a>1.2 接入文心一言</h3> 
<p>API 列表<br> 百度智能云千帆平台提供了丰富的API，保留对话Chat、续写Completions、向量Embeddings、插件应用、Prompt工程、大模型训练、管理及服务等API能力，详情请查看<a href="https://cloud.baidu.com/doc/WENXINWORKSHOP/s/Nlks5zkzu" rel="nofollow">API列表</a>。</p> 
<ol><li>大模型相关</li></ol> 
<blockquote> 
 <ul><li>对话Chat：支持创建chat，用于发起一次对话。</li><li>续写Completions：支持创建completion，用于发起一次续写请求，不支持多轮会话等。</li><li>向量Embeddings：支持Embeddings，用于根据输入内容生成对应的向量表示。</li><li>自定义模型导入：支持HuggingFace Transformer架构的自定义模型导入，提供自定义模型导入相关API能力。</li><li>图像Images：提供图像相关API能力。</li></ul> 
</blockquote> 
<ol start="2"><li>插件应用：提供域内知识搜索增强插件API相关能力。</li><li>Prompt工程：提供模版相关API能力。</li><li>大模型训练：提供创建训练任务、任务运行、停止任务运行及获取任务运行详情等API能力。</li><li>大模型管理：提供获取模型、模型版本详情及将训练任务发布为模型等API能力。</li><li>大模型服务：提供创建服务、获取服务详情等API能力。</li></ol> 
<h3><a id="13_API__46"></a>1.3 API 调用流程简介</h3> 
<p>API 的调用流程如下图所示。</p> 
<p><img src="https://images2.imgbox.com/c4/42/fviOZwez_o.png" alt="image.png"></p> 
<ol><li>创建一个千帆应用。根据实际需求创建千帆应用，创建成功后，获取AppID、API Key、Secret Key 等信息。</li><li>API 授权。对应用的 AppID 进行授权。</li><li>获取接口访问凭证 access_token 。根据第1步获取的 API Key 和 Secret Key ，调用获取<a href="https://cloud.baidu.com/doc/WENXINWORKSHOP/s/Ilkkrb0i5" rel="nofollow">access_token</a>接口获取 access_token ，通过 access_token 鉴权调用者身份。</li><li>调用API接口。例如调用ERNIE-Bot相关接口，详见<a href="https://cloud.baidu.com/doc/WENXINWORKSHOP/s/Nlks5zkzu" rel="nofollow">API列表</a>。</li></ol> 
<h3><a id="14_API__56"></a>1.4 API 调用流程</h3> 
<h4><a id="141___57"></a>1.4.1 步骤一. 创建千帆应用</h4> 
<p>（1）登录百度智能云千帆控制台。</p> 
<p>请您注册并登录<a href="https://console.bce.baidu.com/qianfan/ais/console/applicationConsole/application" rel="nofollow">百度智能云千帆控制台</a> 。</p> 
<p><img src="https://images2.imgbox.com/32/f4/w2UCK8Qm_o.png" alt="在这里插入图片描述"></p> 
<p>注意：为保障服务稳定运行，账户最好不处于欠费状态。</p> 
<p>（2）创建千帆应用</p> 
<p>进入<a href="https://console.bce.baidu.com/qianfan/ais/console/applicationConsole/application/create" rel="nofollow">控制台创建应用</a> 。</p> 
<p><img src="https://images2.imgbox.com/28/c2/E3YZbJpS_o.png" alt="在这里插入图片描述"></p> 
<p>（3）创建应用后，获取AppID、API Key、Secret Key。</p> 
<p><img src="https://images2.imgbox.com/e2/98/LwgTPj7f_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="142___77"></a>1.4.2 步骤二. 服务授权</h4> 
<p>应用创建后，选择对应授权的公有云服务。<br> <img src="https://images2.imgbox.com/b8/99/51GPWEI2_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="143__API_81"></a>1.4.3 步骤三. 调用API接口</h4> 
<p>调用千帆提供的相关接口，如ERNIE-Bot等，详见<a href="https://cloud.baidu.com/doc/WENXINWORKSHOP/s/Nlks5zkzu" rel="nofollow">API列表</a>。</p> 
<ol><li>ERNIE-Bot<br> 我们选择ERNIE-Bot：ERNIE-Bot是百度自行研发的大语言模型，覆盖海量中文数据，具有更强的对话问答、内容创作生成等能力。</li></ol> 
<p><img src="https://images2.imgbox.com/06/33/dtS2viwI_o.png" alt="在这里插入图片描述"></p> 
<ol start="2"><li> <p>在线调试<br> 百度智能云千帆提供了 API在线调试平台-示例代码 ，用于帮助开发者调试接口，平台集成快速检索、查看开发文档、查看在线调用的请求内容和返回结果、复制和下载示例代码等功能，简单易用，更多内容请查看API在线调试介绍。<br> <img src="https://images2.imgbox.com/38/59/h9ZLU0xP_o.png" alt="在这里插入图片描述"></p> </li><li> <p>获取AccessToken</p> </li></ol> 
<p>应用列表选择自己创建的《ESP32语音聊天助手》，采用C#示例代码，<br> <img src="https://images2.imgbox.com/6b/44/chTAlk1Z_o.png" alt="在这里插入图片描述"><br> 然后点击调试，复制获取的AccessToken：<code>24.7cc213f615669e6191cf3f65fad26ed2.2592000.1706881758.282335-46332156</code><br> <img src="https://images2.imgbox.com/37/27/hmSEdzs9_o.png" alt="在这里插入图片描述"><br> 1处粘贴上面的AccessToken，在2处中括号中输入</p> 
<blockquote> 
 <p>“role”:“user”,“content”:“介绍一下你自己”</p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/b5/8f/g5J5yWGO_o.png" alt="在这里插入图片描述"><br> 调试结果如下<br> <img src="https://images2.imgbox.com/dc/77/lVK87LVa_o.png" alt="在这里插入图片描述"><br> 查看C#代码需要三部分代码<br> <img src="https://images2.imgbox.com/60/ce/lUvCF5P0_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-c"><span class="token string">"https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions?access_token=24.7cc213f615669e6191cf3f65fad26ed2.2592000.1706881758.282335-46332156"</span>
<span class="token string">"Content-Type"</span><span class="token punctuation">,</span> <span class="token string">"application/json"</span>
<span class="token string">"{"</span><span class="token string">"messages"</span><span class="token string">":[{"</span><span class="token string">"role"</span><span class="token string">":"</span><span class="token string">"user"</span><span class="token string">","</span><span class="token string">"content"</span><span class="token string">":"</span><span class="token string">"介绍一下你自己"</span><span class="token string">"},{"</span><span class="token string">"role"</span><span class="token string">":"</span><span class="token string">"assistant"</span><span class="token string">","</span><span class="token string">"content"</span><span class="token string">":"</span><span class="token string">"您好，我是文心一言，英文名是ERNIE Bot。我能够与人对话互动，回答问题，协助创作，高效便捷地帮助人们获取信息、知识和灵感。"</span><span class="token string">"}],"</span><span class="token string">"disable_search"</span><span class="token string">":false,"</span><span class="token string">"enable_citation"</span><span class="token string">":false}"</span>

</code></pre> 
<h2><a id="2__114"></a>2. 先决条件</h2> 
<p>在继续此项目之前，请确保检查以下先决条件。</p> 
<p>我们将使用 Arduino IDE 对 ESP32/ESP8266 开发板进行编程，因此在继续本教程之前，请确保已在 Arduino IDE 中安装这些开发板。</p> 
<h3><a id="21__118"></a>2.1 环境配置</h3> 
<ol><li>Arduino IDE：下载并安装 Arduino IDE；</li><li>ESP32 开发板库：在 Arduino IDE 中添加 ESP32 支持；<br> 参考博客：<a href="https://vor2345.blog.csdn.net/article/details/133853534" rel="nofollow">【esp32c3配置arduino IDE教程】</a><br> 为安装过程留出一些时间，具体时间可能因您的互联网连接而异。</li></ol> 
<h3><a id="22__124"></a>2.2 所需零件</h3> 
<p>要学习本教程，您需要1个 ESP32 开发板（<strong>推荐硬件，请不要使用esp8266，问就是不行</strong>）。</p> 
<ul><li>1 x ESP32（<a href="https://makeradvisor.com/esp32-development-boards-review-comparison/" rel="nofollow">阅读最佳 ESP32开发板</a>)</li></ul> 
<p><img src="https://images2.imgbox.com/18/8b/H1Kv2LzM_o.png" alt="在这里插入图片描述"><br> 简约版需要设置CDC下载，经典版直接下载<br> <img src="https://images2.imgbox.com/4b/ad/cYQXRRn0_o.jpg" alt="在这里插入图片描述"></p> 
<h2><a id="3__132"></a>3. 核心代码</h2> 
<p>esp32 Arduino代码如下</p> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;WiFi.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;HTTPClient.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ArduinoJson.h&gt;</span></span>

<span class="token comment">// 1. Replace with your network credentials</span>
<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> ssid <span class="token operator">=</span> <span class="token string">"J09 502"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> password <span class="token operator">=</span> <span class="token string">"qwertyuiop111"</span><span class="token punctuation">;</span>

<span class="token comment">// Replace with your OpenAI API key</span>
<span class="token comment">// const char* apiKey = "1CeoUoYgnfc6s5liNR2uoQrk";</span>
<span class="token comment">// const char* secret_Key = "G3n9aHVerzGqr0EWsLnca0fVkiXI9BVz";</span>
<span class="token comment">//const char* access_token = "24.01bb97173188a1a22d6a6991918f6508.2592000.1706880634.282335-46332156";</span>
<span class="token comment">// Send request to OpenAI API</span>
String inputText <span class="token operator">=</span> <span class="token string">"你好，文心一言"</span><span class="token punctuation">;</span>
<span class="token comment">// 2. Replace with your access_token</span>
String apiUrl <span class="token operator">=</span> <span class="token string">"https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions?access_token=24.23087285c9ab53cbfd7aad5c032ae371.2592000.1706878581.282335-46332156"</span><span class="token punctuation">;</span>

String answer<span class="token punctuation">;</span>
String <span class="token function">getGPTAnswer</span><span class="token punctuation">(</span>String inputText<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  HTTPClient http<span class="token punctuation">;</span>
  http<span class="token punctuation">.</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  http<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span>apiUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
  http<span class="token punctuation">.</span><span class="token function">addHeader</span><span class="token punctuation">(</span><span class="token string">"Content-Type"</span><span class="token punctuation">,</span> <span class="token string">"application/json"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// http.addHeader("access_token", String(access_token));</span>
  String payload <span class="token operator">=</span> <span class="token string">"{\"messages\":[{\"role\": \"user\",\"content\": \""</span> <span class="token operator">+</span> inputText <span class="token operator">+</span> <span class="token string">"\"}],\"disable_search\": false,\"enable_citation\": false}"</span><span class="token punctuation">;</span>
  <span class="token keyword">int</span> httpResponseCode <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">POST</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>httpResponseCode <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    String response <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    http<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Parse JSON response</span>
    DynamicJsonDocument <span class="token function">jsonDoc</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">deserializeJson</span><span class="token punctuation">(</span>jsonDoc<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    String outputText <span class="token operator">=</span> jsonDoc<span class="token punctuation">[</span><span class="token string">"result"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> outputText<span class="token punctuation">;</span>
    <span class="token comment">// Serial.println(outputText);</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>
    http<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Serial<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Error %i \n"</span><span class="token punctuation">,</span> httpResponseCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">"&lt;error&gt;"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// Initialize Serial</span>
  Serial<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token number">115200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Connect to Wi-Fi network</span>
  WiFi<span class="token punctuation">.</span><span class="token function">mode</span><span class="token punctuation">(</span>WIFI_STA<span class="token punctuation">)</span><span class="token punctuation">;</span>
  WiFi<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span>ssid<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
  Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Connecting to WiFi .."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>WiFi<span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> WL_CONNECTED<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    Serial<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token char">'.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">delay</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>WiFi<span class="token punctuation">.</span><span class="token function">localIP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  answer <span class="token operator">=</span> <span class="token function">getGPTAnswer</span><span class="token punctuation">(</span>inputText<span class="token punctuation">)</span><span class="token punctuation">;</span>
  Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Answer: "</span> <span class="token operator">+</span> answer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Enter a prompt:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
  <span class="token comment">// do nothing</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>Serial<span class="token punctuation">.</span><span class="token function">available</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    inputText <span class="token operator">=</span> Serial<span class="token punctuation">.</span><span class="token function">readStringUntil</span><span class="token punctuation">(</span><span class="token char">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// inputText.trim();</span>
    Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"\n Input:"</span><span class="token operator">+</span>inputText<span class="token punctuation">)</span><span class="token punctuation">;</span>

    answer <span class="token operator">=</span> <span class="token function">getGPTAnswer</span><span class="token punctuation">(</span>inputText<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Answer: "</span> <span class="token operator">+</span> answer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Serial<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Enter a prompt:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// delay(2);</span>
<span class="token punctuation">}</span>

</code></pre> 
<p>这段代码是一个基于Arduino平台（可能是ESP32或ESP8266）的示例，它通过WiFi连接到指定的无线网络，并利用HTTPClient库向百度文心一言API发送POST请求以获取AI生成的回答。以下是详细的解释：</p> 
<ol><li>导入必要的库：</li></ol> 
<pre><code class="prism language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;WiFi.h&gt;</span><span class="token expression">：用于处理Wi<span class="token operator">-</span>Fi连接功能。</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;HTTPClient.h&gt;</span><span class="token expression">：用于发送HTTP请求。</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;ArduinoJson.h&gt;</span><span class="token expression">：用于解析从服务器返回的JSON格式数据。</span></span>
</code></pre> 
<ol start="2"><li>第一处修改定义Wi-Fi网络凭证：</li></ol> 
<pre><code class="prism language-c"><span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> ssid <span class="token operator">=</span> <span class="token string">"J09 502"</span><span class="token punctuation">;</span>：Wi<span class="token operator">-</span>Fi网络名。
<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> password <span class="token operator">=</span> <span class="token string">"qwertyuiop111"</span><span class="token punctuation">;</span>：Wi<span class="token operator">-</span>Fi网络密码。
</code></pre> 
<ol start="3"><li>第二处修改定义要调用的API地址：</li></ol> 
<pre><code class="prism language-c">String apiUrl <span class="token operator">=</span> <span class="token string">"https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions?access_token=24.23087285c9ab53cbfd7aad5c032ae371.2592000.1706878581.282335-46332156"</span><span class="token punctuation">;</span>
</code></pre> 
<ol start="4"><li>定义输入文本和函数 getGPTAnswer(String inputText)：</li></ol> 
<ul><li>输入文本是固定的问候语"你好，文心一言"，在实际应用中可以根据需要修改。</li><li>函数 getGPTAnswer() 负责执行以下操作：<br> 初始化HTTPClient对象并设置目标URL。设置Content-Type头信息，构造请求体payload，将用户输入的内容添加到JSON结构中。发送POST请求并检查HTTP响应码。如果响应码为200，则读取并解析返回的JSON数据，提取出结果字段作为回答。若非200，则返回错误字符串 “”。</li></ul> 
<ol start="5"><li>setup() 函数：</li></ol> 
<ul><li>初始化串口通信， 连接到指定的Wi-Fi网络。</li><li>连接成功后，获取一个初始的回答并打印出来，然后提示用户输入新的问题。</li></ul> 
<ol start="6"><li>loop() 函数：</li></ol> 
<ul><li>检查串口是否有可用的数据输入。</li><li>如果有新输入，读取一行内容，调用 getGPTAnswer() 函数获取AI回答，并将对话过程输出到串口。</li></ul> 
<blockquote> 
 <p>注意：虽然代码中有OpenAI API相关注释，但实际上该代码是针对百度文心一言API编写的。如果你想要与OpenAI<br> API交互，你需要使用OpenAI提供的API URL、access token及相应的JSON结构进行请求。</p> 
</blockquote> 
<h2><a id="4__253"></a>4. 上传验证</h2> 
<p>打开串口监视器，<mark>注意右下角选择换行符，选择115200波特率</mark>，输入你想问的问题，他就可以回答你</p> 
<h3><a id="41__256"></a>4.1 测试对话</h3> 
<p><img src="https://images2.imgbox.com/89/2c/GtBL3586_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="42__258"></a>4.2 报错</h3> 
<p>如果返回error ，大家对照列表查询错误代码，结合提示排查解决<br> <img src="https://images2.imgbox.com/f7/16/vpW9fSFL_o.png" alt="在这里插入图片描述"></p> 
<h2><a id="5__262"></a>5. 总结</h2> 
<p>🥳🥳🥳现在，我们在本教程中，您学习了如何使用ESP32接入国产大模型之文心一言。🛹🛹🛹从而实现对外部世界进行感知，充分认识这个有机与无机的环境，后期会持续分享esp32跑freertos实用案列🥳🥳🥳科学地合理地进行创作和发挥效益，然后为人类社会发展贡献一点微薄之力。🤣🤣🤣<br> 如果你有任何问题，可以通过下面的二维码加入鹏鹏小分队，期待与你思维的碰撞😘😘😘</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/f34836ae25627386458ae2c8ce8d9a09/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">头歌｜HBase的安装与简单操作</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/569796e09b6197e1d7c0b90f00c7f309/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">在虚拟机中进入hive出现ConnectException拒绝连接</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程学习者.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
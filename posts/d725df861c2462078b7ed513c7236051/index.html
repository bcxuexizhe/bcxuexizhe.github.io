<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>在Windows环境下安装GPU版的PyTorch - 编程学习者</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcxuexizhe.github.io/posts/d725df861c2462078b7ed513c7236051/">
  <meta property="og:site_name" content="编程学习者">
  <meta property="og:title" content="在Windows环境下安装GPU版的PyTorch">
  <meta property="og:description" content="Windows环境下安装GPU版的PyTorch，是PyTorch深度学习的第一个门槛。本文详解GPU版的PyTorch安装步骤。
2.3.1 确认显卡是否支持CUDA 在深度学习中，我们经常要对图像数据进行处理和计算，而处理器CPU因为需要处理的事情多，并不能满足我们对图像处理和计算速度的要求，显卡GPU就是用来帮助CPU解决这个问题的，GPU特别擅长处理图像数据。
为什么GPU特别擅长处理图像数据呢？这是因为图像上的每一个像素点都有被处理的需要，而且每个像素点处理的过程和方式都十分相似，GPU就是用很多简单的计算单元来完成大量的计算任务，类似于纯粹的人海战术。GPU不仅可以在图像处理领域大显身手，它还被用在科学计算、密码破解、数值分析、海量数据处理（比如排序、Map-Reduce）、金融分析等需要大规模并行计算的领域。
而CUDA（Compute Unified Device Architecture）是显卡厂商NVIDIA推出的只能用于自家GPU的并行计算架构，只有安装这个软件，才能够进行复杂的并行计算。该架构使GPU能够解决复杂的计算问题。它包含CUDA指令集架构（Instruction Set Architecture，ISA）以及GPU内部的并行计算引擎，安装CUDA之后，可以加快GPU的运算和处理速度，主流的深度学习框架也都是基于CUDA进行GPU并行加速的。
想要使用GPU加速，则需要安装CUDA，首先需要自己的计算机显卡支持CUDA的安装，也就是查看自己的计算机有没有NVIDA的独立显卡。在NVIDA官网列表（https://developer.nvidia.com/cuda-gpus）中可以查看自己的显卡型号是否包括在NVIDA列表中。
在计算机桌面上右击，在弹出的菜单中如果能找到NVIDIA控制面板，如图2-9所示，则说明该计算机配有GPU。
打开NVIDIA控制面板窗口，可以查看NVIDIA的一些信息，包括显卡的驱动版本，通过单击“帮助”菜单，并选择“系统信息”选项，查看系统信息获取支持的CUDA版本。如图2-10所示，选择“组件”，在3D设置模块找到NVCUDA64.DLL，在该行可以看到该NVCUDA的版本，可以看到图中显示的版本是 11.8。
2.3.2 安装CUDA 我们已经知道，CUDA是显卡厂商NVIDIA推出的通用并行计算架构，能利用英伟达GPU的并行计算引擎。目前已经确认系统已有支持CUDA的显卡，这时可以到NVIDIA网站 （https://developer.nvidia.com/cuda-toolkit-archive）下载CUDA，如图2-11所示。注意，安装CUDA Driver时，需要与Nvidia GPU Driver的版本驱动一致，CUDA才能找到显卡。
根据实际情况选择合适的版本，比如计算机操作系统是Windows 10，这里下载CUDA 11.8.0的本地安装包，如图2-12所示。
2.3.3 安装cuDNN 接下来下载与CUDA对应版本的cuDNN，cuDNN是用于深度神经网络的GPU加速库，下载地址为https://developer.nvidia.com/rdp/cudnn-archive，页面如图2-13所示。
下载cuDNN，需要注册英伟达开发者计划的会员账号才能下载，如图2-14所示，读者请自行注册账户，加入会员。
进入下载页面后，注意不要选择错误的版本，一定要找到对应CUDA的版本号。另外，如果使用的是Windows 64位的操作系统，那么需要对应下载x86版本的cuDNN。
cuDNN就是个压缩包，解压会生成bin、lib、include三个目录（见图2-15），里面的文件复制到CUDA安装目录（这里是C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v10.0目录）下对应的目录即可。注意，不是替换文件夹，而是将文件放入对应的文件夹中。
接下来安装Visual Studio 2015、2017、2019和 2022支持库，这个支持库务必安装，否则后面安装PyTorch支持库会出现各种“坑”。支持库不大，有十多MB，安装完成后重启系统。其下载地址为https://docs.microsoft.com/zh-CN/cpp/windows/latest-supported-vc-redist?view=msvc-160，下载页面如图2-16所示。
2.3.4 安装GPU版PyTorch 安装GPU版本的PyTorch稍微复杂，前提是需要安装CUDA、cuDNN并行计算框架，然后安装PyTorch。PyTorch官网（地址为https://pytorch.org）给出了匹配的版本号及安装命令，如图2-17所示。
运行命令（Run this command）字段中的命令如下：
pip3 install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
后面安装是否成功，就请读者自行验证了。
《PyTorch深度学习与企业级项目实战（人工智能技术丛书）》(宋立桓，宋立林)【摘要 书评 试读】- 京东图书 (jd.com)
本文节选自《PyTorch深度学习与企业级项目实战》，获出版社和作者授权发布。
【赠书活动第5期】《PyTorch深度学习与企业级项目实战》-CSDN博客">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-22T09:15:04+08:00">
    <meta property="article:modified_time" content="2024-05-22T09:15:04+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程学习者" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程学习者</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">在Windows环境下安装GPU版的PyTorch</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p style="margin-left:0px;text-align:justify;"><a name="_Hlk88240800"></a><a name="_Toc146543016"></a><a name="_Toc152675431"></a><a name="_Toc155865842"></a>Windows环境下安装GPU版的PyTorch，是PyTorch深度学习的第一个门槛。本文详解GPU版的PyTorch安装步骤。</p> 
<h4 style="margin-left:0;text-align:justify;">2.3.1  确认显卡是否支持CUDA</h4> 
<p style="margin-left:0;text-align:justify;">在深度学习中，我们经常要对图像数据进行处理和计算，而处理器CPU因为需要处理的事情多，并不能满足我们对图像处理和计算速度的要求，显卡GPU就是用来帮助CPU解决这个问题的，GPU特别擅长处理图像数据。</p> 
<p style="margin-left:0;text-align:justify;">为什么GPU特别擅长处理图像数据呢？这是因为图像上的每一个像素点都有被处理的需要，而且每个像素点处理的过程和方式都十分相似，GPU就是用很多简单的计算单元来完成大量的计算任务，类似于纯粹的人海战术。GPU不仅可以在图像处理领域大显身手，它还被用在科学计算、密码破解、数值分析、海量数据处理（比如排序、Map-Reduce）、金融分析等需要大规模并行计算的领域。</p> 
<p style="margin-left:0;text-align:justify;">而CUDA（Compute Unified Device Architecture）是显卡厂商NVIDIA推出的只能用于自家GPU的并行计算架构，只有安装这个软件，才能够进行复杂的并行计算。该架构使GPU能够解决复杂的计算问题。它包含CUDA指令集架构（Instruction Set Architecture，ISA）以及GPU内部的并行计算引擎，安装CUDA之后，可以加快GPU的运算和处理速度，主流的深度学习框架也都是基于CUDA进行GPU并行加速的。</p> 
<p style="margin-left:0;text-align:justify;">想要使用GPU加速，则需要安装CUDA，首先需要自己的计算机显卡支持CUDA的安装，也就是查看自己的计算机有没有NVIDA的独立显卡。在NVIDA官网列表（<a href="https://developer.nvidia.com/cuda-gpus" rel="nofollow" title="https://developer.nvidia.com/cuda-gpus">https://developer.nvidia.com/cuda-gpus</a>）中可以查看自己的显卡型号是否包括在NVIDA列表中。</p> 
<p style="margin-left:0;text-align:justify;">在计算机桌面上右击，在弹出的菜单中如果能找到NVIDIA控制面板，如图2-9所示，则说明该计算机配有GPU。</p> 
<p style="margin-left:0;text-align:center;"><img alt="" height="312" src="https://images2.imgbox.com/11/8c/wCRWmz4y_o.png" width="706"></p> 
<p style="margin-left:0;text-align:justify;">打开NVIDIA控制面板窗口，可以查看NVIDIA的一些信息，包括显卡的驱动版本，通过单击“帮助”菜单，并选择“系统信息”选项，查看系统信息获取支持的CUDA版本。如图2-10所示，选择“组件”，在3D设置模块找到NVCUDA64.DLL，在该行可以看到该NVCUDA的版本，<u><span style="color:#008080;">可以看到图中显示的</span></u><u><span style="color:#008080;">版本是</span></u> 11.8。</p> 
<p style="margin-left:0;text-align:center;"><img alt="" height="383" src="https://images2.imgbox.com/f2/a3/En2mmagI_o.png" width="725"></p> 
<h4 style="margin-left:0;text-align:justify;"><a name="_Toc146543017"></a><a name="_Toc152675432"></a><a name="_Toc155865843">2</a>.3.2  安装CUDA</h4> 
<p style="margin-left:0;text-align:justify;">我们已经知道，CUDA是显卡厂商NVIDIA推出的通用并行计算架构，能利用英伟达GPU的并行计算引擎。目前已经确认系统已有支持CUDA的显卡，这时<u><span style="color:#008080;">可以</span></u>到NVIDIA网站 （<a href="https://developer.nvidia.com/cuda-toolkit-archive" rel="nofollow" title="https://developer.nvidia.com/cuda-toolkit-archive">https://developer.nvidia.com/cuda-toolkit-archive</a>）下载CUDA，如图2-11所示。注意，安装CUDA Driver时，需要与Nvidia GPU Driver的版本驱动一致，CUDA才能找到显卡。</p> 
<p style="margin-left:0;text-align:center;"><img alt="" height="362" src="https://images2.imgbox.com/c7/36/pcuNOMUk_o.png" width="721"></p> 
<p style="margin-left:0;text-align:justify;">根据实际情况选择合适的版本，比如计算机操作系统是Windows 10，这里下载CUDA 11.8.0的本地安装包，如图2-12所示。</p> 
<p style="margin-left:0;text-align:center;"><img alt="" height="468" src="https://images2.imgbox.com/0e/4d/E5T9f2Ra_o.png" width="713"></p> 
<h4 style="margin-left:0;text-align:justify;"><a name="_Hlk35770973"></a><a name="_Toc146543018"></a><a name="_Toc152675433"></a><a name="_Toc155865844">2</a>.3.3  安装cuDNN</h4> 
<p style="margin-left:0;text-align:justify;">接下来下载与CUDA对应版本的cuDNN，cuDNN是用于深度神经网络的GPU加速库，下载地址为https://developer.nvidia.com/rdp/cudnn-archive，页面如图2-13所示。</p> 
<p style="margin-left:0;text-align:center;"><img alt="" height="325" src="https://images2.imgbox.com/ce/26/rv4popZV_o.png" width="716"></p> 
<p style="margin-left:0;text-align:justify;">下载cuDNN，需要注册英伟达开发者计划的会员账号才能下载，如图2-14所示，读者请自行注册账户，加入会员。</p> 
<p style="margin-left:0;text-align:justify;">进入下载页面后，注意不要选择错误的版本，一定要找到对应CUDA的版本号。另外，如果使用的是Windows 64位的操作系统，那么需要对应下载x86版本的cuDNN。</p> 
<p style="margin-left:0;text-align:justify;">cuDNN就是个压缩包，解压会生成bin、lib、include三个目录（见图2-15），里面的文件复制到CUDA安装目录（这里是C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v10.0目录）下对应的目录即可。注意，不是替换文件夹，而是将文件放入对应的文件夹中。</p> 
<p style="margin-left:0;text-align:center;"><img alt="" height="453" src="https://images2.imgbox.com/a4/c2/upNMqRb8_o.png" width="731"></p> 
<p style="margin-left:0;text-align:left;">接下来安装Visual Studio 2015、2017、2019和 2022支持库，这个支持库务必安装，否则后面安装PyTorch支持库会出现各种“坑”。支持库不大，有十多MB，安装完成后重启系统。其下载地址为https://docs.microsoft.com/zh-CN/cpp/windows/latest-supported-vc-redist?view=msvc-160，下载页面如图2-16所示。</p> 
<p style="margin-left:0;text-align:center;"><img alt="" height="402" src="https://images2.imgbox.com/0d/e0/lqismaEz_o.png" width="711"></p> 
<h4 style="margin-left:0;text-align:justify;"><a name="_Toc146543019"></a><a name="_Toc152675434"></a><a name="_Toc155865845">2</a>.3.4  安装GPU版PyTorch</h4> 
<p style="margin-left:0;text-align:justify;">安装GPU版本的PyTorch稍微复杂，前提是需要安装CUDA、cuDNN并行计算框架，然后安装PyTorch。PyTorch官网（地址为https://pytorch.org）给出了匹配的版本号及安装命令，如图2-17所示。</p> 
<p style="margin-left:0;text-align:center;"><img alt="" height="257" src="https://images2.imgbox.com/08/df/Y6c7vORm_o.png" width="720"></p> 
<p style="margin-left:0;text-align:justify;">运行命令（Run this command）字段中的命令如下：</p> 
<p style="margin-left:0;"><span style="color:#000000;">pip3 install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118</span></p> 
<p style="margin-left:0;">后面安装是否成功，就请读者自行验证了。</p> 
<p><a href="https://item.jd.com/14517444.html" rel="nofollow" title="《PyTorch深度学习与企业级项目实战（人工智能技术丛书）》(宋立桓，宋立林)【摘要 书评 试读】- 京东图书 (jd.com)">《PyTorch深度学习与企业级项目实战（人工智能技术丛书）》(宋立桓，宋立林)【摘要 书评 试读】- 京东图书 (jd.com)</a></p> 
<p>本文节选自《PyTorch深度学习与企业级项目实战》，获出版社和作者授权发布。</p> 
<p><a href="https://blog.csdn.net/brucexia/article/details/138782385" title="【赠书活动第5期】《PyTorch深度学习与企业级项目实战》-CSDN博客">【赠书活动第5期】《PyTorch深度学习与企业级项目实战》-CSDN博客</a></p> 
<p style="text-align:center;"><img alt="" src="https://images2.imgbox.com/b5/07/Tog0N2tf_o.jpg"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/26c6110cd8c49c6a55abaaf2a747227c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">物体检测算法-R-CNN，SSD，YOLO</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/3f6f9fcf1e3417c9a884f1816c6a567f/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">在家庭影院音频中应用的D类音频放大器</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程学习者.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
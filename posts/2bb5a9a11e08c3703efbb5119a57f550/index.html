<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>C# 结合 JavaScript 对 Web 控件进行数据输入验证 - 编程学习者</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcxuexizhe.github.io/posts/2bb5a9a11e08c3703efbb5119a57f550/">
  <meta property="og:site_name" content="编程学习者">
  <meta property="og:title" content="C# 结合 JavaScript 对 Web 控件进行数据输入验证">
  <meta property="og:description" content="目录
关于数据验证
范例运行环境
验证设计
JavaScript 方法
设计
实现
调用示例
C# 方法
设计
实现
调用示例
小结
关于数据验证 在 Web 应用的录入界面，数据验证是一项重要的实现功能，数据验证是指确认 Web 控件输入或选择的数据，是否满足数据表数据约束，是否满足应用程序所需要数据约束规则。建立数据库约束可以满足数据验证的应用，但在实际的应用中，我们建议还是在更新信息到数据库前，在应用中执行数据验证，这样可减少错误录入，减少应用程序与数据库之间频繁通信造成的服务器压力。通过有效的数据验证，可以确认写入数据表中的数据是有效且符合预期的。本文我们将介绍如何通过C# 后端及JavaScript 前端对 Web 控件进行数据输入有效性的验证。
范例运行环境 操作系统： Windows Server 2019 DataCenter
.net版本： .netFramework4.7.1 或以上
开发工具：VS2019 C#
验证设计 通过对 Web 服务器控件捆绑自定义属性 checkSchema=&#34;&#34; 和 cName=&#34;&#34;，将自定义的校验类型和中文提示进行赋值，即可完成验证的设置，可实现的校验类型如下图所示：
多个数据校验类型请用“|”进行分隔，如下设计举例：
示例 1：不能为空且必须为日期型数据
&lt;asp:TextBox id=&#34;x1&#34; checkSchema=&#34;notnull|date&#34; cName=&#34;出生日期&#34; runat=&#34;server&#34; /&gt; 示例 2：必须为身份证号
&lt;asp:TextBox id=&#34;x1&#34; checkSchema=&#34;idcard&#34; runat=&#34;server&#34; /&gt; 示例3：必须输入4位的一个整型数 &lt;asp:TextBox id=&#34;x1&#34; checkSchema=&#34;mustlen4|int&#34; runat=&#34;server&#34; /&gt; JavaScript 方法 设计 在前端客户端，使用 JavaScript 方法 simplecheck 进行数据验证，验证通过反回 true，否则为 false，其参数说明如下表：">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-16T11:28:12+08:00">
    <meta property="article:modified_time" content="2024-05-16T11:28:12+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程学习者" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程学习者</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">C# 结合 JavaScript 对 Web 控件进行数据输入验证</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <p id="main-toc"></p> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="%E5%85%B3%E4%BA%8E%E6%95%B0%E6%8D%AE%E6%84%9F%E5%BA%94-toc" style="margin-left:40px;"><a href="#%E5%85%B3%E4%BA%8E%E6%95%B0%E6%8D%AE%E6%84%9F%E5%BA%94" rel="nofollow">关于数据验证</a></p> 
<p id="ListControl%20%E7%B1%BB%E7%B1%BB%E5%9E%8B%E6%8E%A7%E4%BB%B6-toc" style="margin-left:40px;"><a href="#%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83" rel="nofollow">范例运行环境</a></p> 
<p id="%E9%AA%8C%E8%AF%81%E8%AE%BE%E8%AE%A1-toc" style="margin-left:40px;"><a href="#%E9%AA%8C%E8%AF%81%E8%AE%BE%E8%AE%A1" rel="nofollow">验证设计</a></p> 
<p id="%E6%95%B0%E6%8D%AE%E6%84%9F%E5%BA%94%E9%80%9A%E7%94%A8%E6%96%B9%E6%B3%95-toc" style="margin-left:40px;"><a href="#%E6%95%B0%E6%8D%AE%E6%84%9F%E5%BA%94%E9%80%9A%E7%94%A8%E6%96%B9%E6%B3%95" rel="nofollow">JavaScript 方法</a></p> 
<p id="%E8%AE%BE%E8%AE%A1-toc" style="margin-left:80px;"><a href="#%E8%AE%BE%E8%AE%A1" rel="nofollow">设计</a></p> 
<p id="%E5%AE%9E%E7%8E%B0-toc" style="margin-left:80px;"><a href="#%E5%AE%9E%E7%8E%B0" rel="nofollow">实现</a></p> 
<p id="%E8%B0%83%E7%94%A8%E7%A4%BA%E4%BE%8B-toc" style="margin-left:80px;"><a href="#%E8%B0%83%E7%94%A8%E7%A4%BA%E4%BE%8B" rel="nofollow">调用示例</a></p> 
<p id="%E6%95%B0%E6%8D%AE%E6%84%9F%E5%BA%94%E9%80%9A%E7%94%A8%E6%96%B9%E6%B3%95-toc" style="margin-left:40px;"><a href="#%E6%95%B0%E6%8D%AE%E6%84%9F%E5%BA%94%E9%80%9A%E7%94%A8%E6%96%B9%E6%B3%95" rel="nofollow">C# 方法</a></p> 
<p id="%E8%AE%BE%E8%AE%A1-toc" style="margin-left:80px;"><a href="#%E8%AE%BE%E8%AE%A1" rel="nofollow">设计</a></p> 
<p id="%E5%AE%9E%E7%8E%B0-toc" style="margin-left:80px;"><a href="#%E5%AE%9E%E7%8E%B0" rel="nofollow">实现</a></p> 
<p id="%E8%B0%83%E7%94%A8%E7%A4%BA%E4%BE%8B-toc" style="margin-left:80px;"><a href="#%E8%B0%83%E7%94%A8%E7%A4%BA%E4%BE%8B" rel="nofollow">调用示例</a></p> 
<p id="%E5%B0%8F%E7%BB%93-toc" style="margin-left:40px;"><a href="#%E5%B0%8F%E7%BB%93" rel="nofollow">小结</a></p> 
<hr id="hr-toc"> 
<p></p> 
<h3>关于数据验证</h3> 
<p>在 Web 应用的录入界面，数据验证是一项重要的实现功能，数据验证是指确认 Web 控件输入或选择的数据，是否满足数据表数据约束，是否满足应用程序所需要数据约束规则。建立数据库约束可以满足数据验证的应用，但在实际的应用中，我们建议还是在更新信息到数据库前，在应用中执行数据验证，这样可减少错误录入，减少应用程序与数据库之间频繁通信造成的服务器压力。通过有效的数据验证，可以确认写入数据表中的数据是有效且符合预期的。本文我们将介绍如何通过C# 后端及JavaScript 前端对 Web 控件进行数据输入有效性的验证。</p> 
<h3 id="ListControl%20%E7%B1%BB%E7%B1%BB%E5%9E%8B%E6%8E%A7%E4%BB%B6"></h3> 
<h3 id="%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83">范例运行环境</h3> 
<p>操作系统： Windows Server 2019 DataCenter</p> 
<p>.net版本： .netFramework4.7.1 或以上</p> 
<p>开发工具：VS2019  C#</p> 
<h3 id="%E9%AA%8C%E8%AF%81%E8%AE%BE%E8%AE%A1">验证设计</h3> 
<p>通过对 Web 服务器控件捆绑自定义属性 checkSchema="" 和 cName=""，将自定义的校验类型和中文提示进行赋值，即可完成验证的设置，可实现的校验类型如下图所示：</p> 
<p><img alt="" height="1200" src="https://images2.imgbox.com/8f/07/qpZdxFVA_o.png" width="1200"></p> 
<p>多个数据校验类型请用“|”进行分隔，如下设计举例：</p> 
<p>示例 1：不能为空且必须为日期型数据</p> 
<pre><code class="language-html">&lt;asp:TextBox id="x1" checkSchema="notnull|date" cName="出生日期"  runat="server"  /&gt;</code></pre> 
<p>示例 2：必须为身份证号</p> 
<pre><code class="language-html">&lt;asp:TextBox id="x1" checkSchema="idcard"  runat="server"  /&gt;</code></pre> 
<p>示例3：必须输入4位的一个整型数 </p> 
<pre><code class="language-html">&lt;asp:TextBox id="x1" checkSchema="mustlen4|int"  runat="server"  /&gt;</code></pre> 
<h3 id="%E6%95%B0%E6%8D%AE%E6%84%9F%E5%BA%94%E9%80%9A%E7%94%A8%E6%96%B9%E6%B3%95">JavaScript 方法</h3> 
<h4 id="%E8%AE%BE%E8%AE%A1">设计</h4> 
<p>在前端客户端，使用 JavaScript 方法 simplecheck 进行数据验证，验证通过反回 true，否则为 false，其参数说明如下表：</p> 
<table align="center" border="1" cellpadding="1" cellspacing="1"><thead><tr><th>序号</th><th>参数名</th><th style="width:123px;">类型</th><th style="width:441px;">说明</th></tr></thead><tbody><tr><th>1</th><td>chkobj</td><td style="width:123px;">dom元素对象</td><td style="width:441px;">如传递一个 input type="text" 的对象</td></tr><tr><th>2</th><td>_chkvalue</td><td style="width:123px;">字符串值</td><td style="width:441px;">dom元素对象的值，如 value 属性值</td></tr><tr><th>3</th><td>allowAlert</td><td style="width:123px;">布尔值</td><td style="width:441px;"> <p>当验证错误时是否允许弹出alert提示框，true为允许</p> </td></tr><tr><th>4</th><td>etip</td><td style="width:123px;">字符串值</td><td style="width:441px;"> <p>附加的前缀提示信息，后缀为方法提供的定义的错误提示信息</p> </td></tr></tbody></table> 
<h4 id="%E5%AE%9E%E7%8E%B0">实现</h4> 
<p>simplecheck 方法完整代码如下：</p> 
<pre><code class="language-cs">function simplecheck(chkobj, _chkvalue, allowAlert,etip) {
        check_result = true; check_errid = ''; check_errmsg = '';var _checkSchema = chkobj.getAttribute('checkSchema');var _cName = chkobj.getAttribute('cName');
        if (_checkSchema.indexOf('ctrim') != -1) { _chkvalue = ctrim(_chkvalue); } var _objlength = _chkvalue.length; if (_checkSchema.indexOf('abslen') != -1) { _objlength = PositionLen(_chkvalue); }
        var _schemaList = _checkSchema.split('|'); var _reqeustnotnull = false;
        for (var k = 0; k &lt; _schemaList.length; k++) { if (_schemaList[k].toLowerCase() == 'notnull') { _reqeustnotnull = true; } }
        if ((!_reqeustnotnull) &amp;&amp; (_chkvalue == '')) { return check_result; }
        for (var j = 0; j &lt; _schemaList.length; j++) {
            var curSchema = _schemaList[j].toLowerCase(); check_errid = curSchema; var curErrmsg = ''; switch (true) { case curSchema == 'notnull': check_result = isNotNull(_chkvalue); curErrmsg = _cName + '需要填写内容！'; break; case curSchema == 'number': check_result = isNumber(_chkvalue); curErrmsg = _cName + ' 输入的数值不合理，请核对！'; break; case curSchema == 'bnumber': check_result = isBNumber(_chkvalue); curErrmsg = _cName + ' 输入的数值应为&gt;=0的正数，请核对！'; break; case curSchema == 'snumber': check_result = isSNumber(_chkvalue); curErrmsg = _cName + ' 输入的数值应为&lt;0的负数，请核对！'; break; case curSchema == 'date': check_result = isDate(_chkvalue, _cName); check_errid = 'date'; check_errmsg = (check_result ? '' : _cName + ' 输入的日期不合理，请核对！'); curErrmsg = ''; break; case curSchema.indexOf('minlen') != -1: var _slen = parseInt(curSchema.substr('minlen'.length, curSchema.length - 'minlen'.length), 10); if (isNaN(_slen)) { check_result = false; curErrmsg = _cName + ' 输入的最小位数参数不合理，请与软件供应商联系！'; } else { check_result = (_objlength &lt; _slen ? false : true); curErrmsg = _cName + ' 的内容要求最小输入' + _slen + '位，请核对！'; } break; case curSchema.indexOf('maxlen') != -1: var _slen = parseInt(curSchema.substr('maxlen'.length, curSchema.length - 'maxlen'.length), 10); if (isNaN(_slen)) { check_result = false; curErrmsg = _cName + ' 输入的最大位数参数不合理，请与软件供应商联系！'; } else { check_result = (_objlength &gt; _slen ? false : true); curErrmsg = _cName + ' 最大允许输入' + _slen + '位，请核对！'; } break; case curSchema.indexOf('mustlen') != -1: var _slen = parseInt(curSchema.substr('mustlen'.length, curSchema.length - 'mustlen'.length), 10); if (isNaN(_slen)) { check_result = false; curErrmsg = _cName + ' 输入的限制位数参数不合理，请与软件供应商联系！'; } else { check_result = (_objlength != _slen ? false : true); curErrmsg = _cName + ' 的内容输入长度只能是' + _slen + '位，请核对！'; } break; case curSchema == 'time': check_result = validRegs(_chkvalue, /^\d{1,2}:\d{1,2}:\d{1,2}$/); curErrmsg = _cName + ' 输入的时间不合理，请核对。'; break; case curSchema == 'alpha': check_result = isAlpha(_chkvalue); curErrmsg = _cName + ' 只能输入的数字、字母和下划线，请核对。'; break; case curSchema == 'mail': check_result = validRegs(_chkvalue, /^([a-zA-Z0-9._-])+@([a-zA-Z0-9_-])+(\.[a-zA-Z0-9_-])+/); curErrmsg = _cName + ' 输入的邮件地址不合理，请核对。'; break; case curSchema == 'phone': check_result = validRegs(_chkvalue, /([a-zA-Z0-9\.-\u4e00-\u9fa5]{8,})$/); curErrmsg = _cName + ' 输入的电话号码不合理，请核对。'; break; case curSchema == 'mobile': check_result = validRegs(_chkvalue, /^1(3[0-9]|5[012356789]|8[056789])\d{8}$/); curErrmsg = _cName + ' 输入的手机号码不合理，请核对。'; break; case curSchema == 'money': check_result = validRegs(_chkvalue, /^\d+(\.\d+)?$/); curErrmsg = _cName + ' 输入的内容不符合货币类型的要求，请核对。'; break; case curSchema == 'zip': check_result = validRegs(_chkvalue, /^[1-9]\d{5}$/); curErrmsg = _cName + ' 输入的邮政编码不合理，请核对。'; break; case curSchema == 'int': check_result = validRegs(_chkvalue, /^[-\+]?\d+$/); curErrmsg = _cName + ' 需要输入一个整数，请核对。'; break; case curSchema == 'en': check_result = validRegs(_chkvalue, /^[A-Za-z]+$/); curErrmsg = _cName + ' 只能输入英文大小写字母，请核对。'; break; case curSchema == 'cn': check_result = validRegs(_chkvalue, /^[\u0391-\uFFE5]+$/); curErrmsg = _cName + ' 只能输入中文，请核对。'; break; case curSchema == 'url': check_result = validRegs(_chkvalue, /([\w-]+\.)+[\w-]+(\/[\w- .\/?%&amp;=]*)?/); curErrmsg = _cName + ' 输入的网址不合理，请核对。'; break; case curSchema == 'idcard18': rv_result = checkIdcard(_chkvalue); check_result = (rv_result == '' ? true : false); curErrmsg = _cName + rv_result; break; case curSchema == 'idcard15': rv_result = checkIdcard(_chkvalue); check_result = (rv_result == '' ? true : false); curErrmsg = _cName + rv_result; break; case curSchema == 'idcard': rv_result = checkIdcard(_chkvalue); check_result = (rv_result == '' ? true : false); curErrmsg = _cName + rv_result; break; } if (!check_result) {
                if (curErrmsg != '') { check_errmsg = etip + curErrmsg; } if ((curErrmsg != '') &amp;&amp; (allowAlert)) {  alert(etip + curErrmsg); return check_result; }
            }
        }
        return check_result;
    }</code></pre> 
<p>验证函数完整代码如下：</p> 
<pre><code class="language-cs">    function checkIdcard(idcard) {
        var _idcard = idcard;  var Errors = new Array('', '身份证号码位数不对!', '身份证号码出生日期超出范围或含有非法字符!', '身份证号码校验错误!', '身份证地区非法!', '');
        if (_idcard == '') { return Errors[5]; }
        var area = { 11: '北京', 12: '天津', 13: '河北', 14: '山西', 15: '内蒙古', 21: '辽宁', 22: '吉林', 23: '黑龙江', 31: '上海', 32: '江苏', 33: '浙江', 34: '安徽', 35: '福建', 36: '江西', 37: '山东', 41: '河南', 42: '湖北', 43: '湖南', 44: '广东', 45: '广西', 46: '海南', 50: '重庆', 51: '四川', 52: '贵州', 53: '云南', 54: '西藏', 61: '陕西', 62: '甘肃', 63: '青海', 64: '宁夏', 65: '新疆', 71: '台湾', 81: '香港', 82: '澳门', 91: '国外' }
        var _idcard, Y, JYM; var S, M; var idcard_array = new Array(); idcard_array = _idcard.split('');
        if (area[parseInt(_idcard.substr(0, 2))] == null) { return Errors[4]; }
        switch (_idcard.length) {
            case 15: if ((parseInt(_idcard.substr(6, 2)) + 1900) % 4 == 0 || ((parseInt(_idcard.substr(6, 2)) + 1900) % 100 == 0 &amp;&amp; (parseInt(_idcard.substr(6, 2)) + 1900) % 4 == 0)) {
                    ereg = /^[1-9][0-9]{5}[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|[1-2][0-9]))[0-9]{3}$/;
                } else {
                    ereg = /^[1-9][0-9]{5}[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|1[0-9]|2[0-8]))[0-9]{3}$/;
                }
                if (ereg.test(_idcard)) {
                    var iS = 0; var iW = new Array; iW[0] = 7; iW[1] = 9; iW[2] = 10; iW[3] = 5; iW[4] = 8; iW[5] = 4; iW[6] = 2; iW[7] = 1; iW[8] = 6; iW[9] = 3; iW[10] = 7; iW[11] = 9; iW[12] = 10; iW[13] = 5; iW[14] = 8; iW[15] = 4; iW[16] = 2;
                    var LastCode = '10X98765432'; var perIDNew; perIDNew = _idcard.substr(0, 6); perIDNew += '19'; perIDNew += _idcard.substr(6, 9);
                    for (var i = 0; i &lt; 17; i++) { iS += parseInt(perIDNew.substr(i, 1)) * iW[i]; }
                    var iY = iS % 11; perIDNew += LastCode.substr(iY, 1);
                    return Errors[0];
                } else {
                    return Errors[2];
                }
                break;
            case 18: if (parseInt(_idcard.substr(6, 4)) % 4 == 0 || (parseInt(_idcard.substr(6, 4)) % 100 == 0 &amp;&amp; parseInt(_idcard.substr(6, 4)) % 4 == 0)) {
                    ereg = _idcard.substr(6, 2) == '19' ? /^[1-9][0-9]{5}19[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|[1-2][0-9]))[0-9]{3}[0-9Xx]$/ : /^[1-9][0-9]{5}20[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|[1-2][0-9]))[0-9]{3}[0-9Xx]$/;
                } else {
                    ereg = _idcard.substr(6, 2) == '19' ? /^[1-9][0-9]{5}19[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|1[0-9]|2[0-8]))[0-9]{3}[0-9Xx]$/ : /^[1-9][0-9]{5}20[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|1[0-9]|2[0-8]))[0-9]{3}[0-9Xx]$/;
                }
                if (ereg.test(_idcard)) {
                    S = (parseInt(idcard_array[0]) + parseInt(idcard_array[10])) * 7 + (parseInt(idcard_array[1]) + parseInt(idcard_array[11])) * 9 + (parseInt(idcard_array[2]) + parseInt(idcard_array[12])) * 10 + (parseInt(idcard_array[3]) + parseInt(idcard_array[13])) * 5 + (parseInt(idcard_array[4]) + parseInt(idcard_array[14])) * 8 + (parseInt(idcard_array[5]) + parseInt(idcard_array[15])) * 4 + (parseInt(idcard_array[6]) + parseInt(idcard_array[16])) * 2 + parseInt(idcard_array[7]) * 1 + parseInt(idcard_array[8]) * 6 + parseInt(idcard_array[9]) * 3;
                    Y = S % 11; M = 'F'; JYM = '10X98765432'; M = JYM.substr(Y, 1); if (M == idcard_array[17]) return Errors[0]; else { return Errors[3]; } 
                } else { return Errors[2]; } break; default: return Errors[1]; break;
        } 
    }
    function getid(id) { alert(checkIdcard(id)) }
    function per18To15(perIDSrc) { rstr = ''; for (var i = 0; i &lt; 17; i++) { if ((i == 6) || (i == 7)) { continue; } rstr += perIDSrc.charAt(i); } return rstr; }
    function per15To18(perIDSrc) {
        var iS = 0; var iW = new Array;
        iW[0] = 7; iW[1] = 9; iW[2] = 10; iW[3] = 5; iW[4] = 8; iW[5] = 4; iW[6] = 2; iW[7] = 1; iW[8] = 6; iW[9] = 3; iW[10] = 7; iW[11] = 9; iW[12] = 10; iW[13] = 5; iW[14] = 8; iW[15] = 4; iW[16] = 2;
        var LastCode = '10X98765432'; var perIDNew; perIDNew = perIDSrc.substr(0, 6); perIDNew += '19'; perIDNew += perIDSrc.substr(6, 9);
        for (var i = 0; i &lt; 17; i++) { iS += parseInt(perIDNew.substr(i, 1)) * iW[i]; }
        var iY = iS % 11; perIDNew += LastCode.substr(iY, 1); return perIDNew;
    }
    var aCity = { 11: '北京', 12: '天津', 13: '河北', 14: '山西', 15: '内蒙古', 21: '辽宁', 22: '吉林', 23: '黑龙江', 31: '上海', 32: '江苏', 33: '浙江', 34: '安徽', 35: '福建', 36: '江西', 37: '山东', 41: '河南', 42: '湖北', 43: '湖南', 44: '广东', 45: '广西', 46: '海南', 50: '重庆', 51: '四川', 52: '贵州', 53: '云南', 54: '西藏', 61: '陕西', 62: '甘肃', 63: '青海', 64: '宁夏', 65: '新疆', 71: '台湾', 81: '香港', 82: '澳门', 91: '国外' }
    function cidInfo(sId) {
        var iSum = 0; var info = '';
        if (!/^\d{17}(\d|x)$/i.test(sId))
            return false; sId = sId.replace(/x$/i, 'a');
        if (aCity[parseInt(sId.substr(0, 2))] == null) return 'Error:非法地区'; sBirthday = sId.substr(6, 4) + '-' + Number(sId.substr(10, 2)) + '-' + Number(sId.substr(12, 2));
        var d = new Date(sBirthday.replace(/-/g, '/'))
        if (sBirthday != (d.getFullYear() + '-' + (d.getMonth() + 1) + '-' + d.getDate()))
            return 'Error:非法生日';
        for (var i = 17; i &gt;= 0; i--) iSum += (Math.pow(2, i) % 11) * parseInt(sId.charAt(17 - i), 11)
        if (iSum % 11 != 1) return 'Error:非法证号';
        return aCity[parseInt(sId.substr(0, 2))] + ',' + sBirthday + ',' + (sId.substr(16, 1) % 2 ? '男' : '女')
    }
function PositionLen(s){var i,str1,str2,str3,nLen;	str1 =s;nLen = 0;for(i=1;i&lt;=str1.length;i++){str2=str1.substring(i-1,i);str3=escape(str2);if(str3.length&gt;3){	nLen = nLen + 2;}else{nLen = nLen + 1;}	}
return nLen;}
function isNotNull(str){return (str==''?false:true);}
function isNumber(str){if(str==''){return true;}return (isNaN(str)?false:true);}
function isNumber(str){if(str==''){return true;}return (isNaN(str)?false:true);}
function isBNumber(str){if(str==''){return true;}return (!isNaN(str)?parseInt(str,10)&gt;=0?true:false:false);}
function isSNumber(str){if(str==''){return true;}return (!isNaN(str)?parseInt(str,10)&lt;0?true:false:false);}
function isAlpha(_str){return (_str.replace(/\w/g,'').length == 0);}
function isAN(_str){var reg = /^(([a-z]+[0-9]+)|([0-9]+[a-z]+))[a-z0-9]*$/i;return reg.test(_str);}
function validRegs(_value,_Regs){return _Regs.test(_value); }
function isVisibled(obj){   if( (obj.style.display=='none')||( (obj.offsetHeight==0)&amp;&amp;(obj.offsetWidth==0) ) )       return false; if(obj.currentStyle){if(obj.currentStyle['display']=='none') return false;}  return true;}
function isFocused(obj){   if( (obj.disabled==false)&amp;&amp;(isVisibled(obj)) )       return true;   return false;}
function isDate(str,cname,notip){if(str==''){return true;}
str=str.replace(/\//g,'-');
dt=str.split(' ');if(dt.length&gt;2){if(!notip) alert(cname+'日期输入不正确！可能包括非法的日期组成部分。');return false;	} dt1=dt[0].split('-');if(dt1.length!=3){if(!notip) 	alert(cname+'日期输入不正确！日期部分应为YYYY-MM-DD。');return false;}dt1n=(dt1[0]+dt1[1]+dt1[2]).split('');for(var i=0;i&lt;dt1.length;i++){if((isNaN(dt1[i])||(ctrim(dt1[i])==''))){if(!notip) 	alert(cname+'字符：'+dt1[i]+'，年月日部分必须输入数字！');	return false;}	}_year=parseInt(dt1[0],10);	_month=parseInt(dt1[1],10);	_day=parseInt(dt1[2],10);if((_year&lt;1000)||(_year&gt;9999)||(_month&lt;1)||(_month&gt;12)||(_day&lt;1)||(_day&gt;31)){if(!notip) alert(cname+'年月日部分输入的数字不合理，请核对！');return false;	}v_date31=new Array;v_date31[0]=4;v_date31[1]=6;v_date31[2]=9;v_date31[3]=11;if((getArrayIndex(v_date31,_month)!=-1)&amp;&amp;(_day&gt;30)){if(!notip) alert(cname+'月份：'+_month+'，天数输入范围不合理！');	return false;}if(_month==2){	if(((_year%4==0)&amp;&amp;(_year%100!=0))||(_year%400==0)){	if(_day&gt;29){if(!notip) alert(cname+'月份：'+_month+'，天数输入范围不合理！');return false;	}}else{	if(_day&gt;28){if(!notip) alert(cname+'月份：'+_month+'，天数输入范围不合理！');return false;	}}	}	return true;   }
function getArrayIndex(xArray,find){_rs=-1;for(var j=0;j&lt;xArray.length;j++){if(xArray[j]==find){_rs=j;	break; 	}}	return _rs;	}
function ctrim(ename){ if(ename==undefined) return '';	return (ename.replace(/(^\s*)|(\s*$)/g, '')).replace(/^[\s　\t]+|[\s　\t]+$/, '');}
</code></pre> 
<h4 id="%E8%B0%83%E7%94%A8%E7%A4%BA%E4%BE%8B">调用示例</h4> 
<p>假设对 id 为 x1 的输入框元素进行身份证号验证，代码如下：</p> 
<pre><code class="language-javascript">if(simplecheck(document.getElementById('x1'),document.getElementById('x1').value, true,"您输入的")==false){
    return false;
}</code></pre> 
<p></p> 
<h3>C# 方法</h3> 
<h4>设计</h4> 
<p>客户端检验一般属于弱检验，为保证数据的安全合法性，还需要在后端服务端进行二次检验，使用 C# 方法 checkSchemaServerValid 进行数据验证，验证通过返回空字符串信息，否则返回错误提示信息，其参数说明如下表：</p> 
<table align="center" border="1" cellpadding="1" cellspacing="1"><thead><tr><th>序号</th><th>参数名</th><th style="width:123px;">类型</th><th style="width:441px;">说明</th></tr></thead><tbody><tr><th>1</th><td>value</td><td style="width:123px;">string</td><td style="width:441px;">要校验的数据值</td></tr><tr><th>2</th><td>_checkSchema</td><td style="width:123px;">string</td><td style="width:441px;">传递校验方案，即传递 Web 控件的自定义 checkSchema 属性值</td></tr><tr><th>3</th><td>_cName</td><td style="width:123px;">string</td><td style="width:441px;"> <p>中文说明，即传递 web 控件的自定义 cName 属性值</p> </td></tr></tbody></table> 
<h4>实现</h4> 
<p>simplecheck 方法完整代码如下：</p> 
<pre><code class="language-cs">        public string  checkSchemaServerValid(string value,string _checkSchema,string _cName)
        {
            serverValidErrorType = "";
            string check_errmsg = "";
            _checkSchema=_checkSchema.ToLower();
            if (_checkSchema.IndexOf("ctrim") != -1) { value = value.Trim(); }
            int _objlength = value.Length;

            if (_checkSchema.IndexOf("notnull") == -1 &amp;&amp; _objlength == 0) { return check_errmsg; }

            string[] _schemaList = _checkSchema.Split('|');
            for (var j = 0; j &lt; _schemaList.Length; j++) {
                string curSchema = _schemaList[j]; 
                string curErrmsg="";
                 if(curSchema=="notnull") { 
                        curErrmsg = isNotNull(value)?"":_cName + "需要填写内容！";
                 }else if(curSchema=="number") {
                        curErrmsg =IsNumeric(value)?"":_cName + " 输入的数值不合理，请核对！"; 
                 }else if(curSchema=="bnumber") {
                        curErrmsg = IsBNumeric(value)?"":_cName +" 输入的数值应为&gt;=0的正数，请核对！";                  
                 }else if(curSchema=="snumber") {
                        curErrmsg = IsSNumeric(value)?"":_cName + " 输入的数值应为&lt;0的负数，请核对！"; 
                 }else if(curSchema=="date") {
                        curErrmsg = IsDate(value)?"": _cName + " 输入的日期不合理，请核对！";  
                 }else if(curSchema.IndexOf("minlen")!=-1) {
                        int _slen =int.Parse(curSchema.Substring("minlen".Length, curSchema.Length - "minlen".Length));
                         curErrmsg= value.Length&gt;= _slen ? "": _cName + " 的内容要求最小输入" + _slen.ToString() + "位，请核对！";
                 }else if(curSchema.IndexOf("maxlen")!=-1) {
                        int _mlen =int.Parse(curSchema.Substring("maxlen".Length, curSchema.Length - "maxlen".Length));
                         curErrmsg= value.Length&lt;= _mlen ? "": _cName + " 的内容要求最大输入" + _mlen.ToString() + "位，请核对！";
                 }else if(curSchema.IndexOf("mustlen")!=-1) {
                        int _mlen =int.Parse(curSchema.Substring("mustlen".Length, curSchema.Length - "mustlen".Length));
                         curErrmsg= value.Length== _mlen ? "": _cName + " 的内容输入长度只能是" + _mlen.ToString() + "位，请核对！";
                 }else if(curSchema=="time"){
                        curErrmsg = IsDate(value)?"": _cName + " 输入的时间不合理，请核对！";  
                 }else if(curSchema=="alpha"){
                        curErrmsg =IsAlpha(value)?"": _cName + " 只能输入的数字、字母和下划线，请核对。";
                 }else if(curSchema=="mail"){
                     curErrmsg =IsEmail(value)?"": _cName + " 输入的邮件地址不合理，请核对。"; 
                 }else if(curSchema=="phone"){
                     curErrmsg =IsPhone(value)?"": _cName + " 输入的电话号码不合理，请核对。";
                 }else if(curSchema=="mobile"){
                     curErrmsg =IsMobilePhone(value)?"":_cName + " 输入的手机号码不合理，请核对。";
                 }else if(curSchema=="money"){
                     curErrmsg =IsNumeric(value)?"": _cName + " 输入的内容不符合货币类型的要求，请核对。";
                 }else if(curSchema=="zip"){
                     curErrmsg =IsZip(value)?"": _cName + " 输入的邮政编码不合理，请核对。";
                 }else if(curSchema=="int"){
                     curErrmsg =IsInt(value)?"": _cName + " 需要输入一个整数，请核对。";
                 }else if(curSchema=="en"){
                     curErrmsg =IsEnglish(value)?"":_cName + " 只能输入英文大小写字母，请核对。";
                 }else if(curSchema=="cn"){
                     curErrmsg =IsChineseCh(value)?"": _cName + " 只能输入中文，请核对。";
                 }else if(curSchema=="url"){
                     curErrmsg =IsURL(value)?"":_cName + " 输入的网址不合理，请核对。";
                 }else if(curSchema=="idcard"){
                     curErrmsg =CheckIDCard(value)?"": _cName + " 请输入合理的15或18位号码。";
                 }else if(curSchema=="idcard18"){
                     curErrmsg =CheckIDCard18(value)?"": _cName + " 请输入合理的18位号码。";
                 }else if(curSchema=="idcard15"){
                     curErrmsg =CheckIDCard(value)?"": _cName + " 请输入合理的15位号码。";
                 }else if (curSchema == "an"){
                     curErrmsg = IsAN(value) ? "" : _cName + " 必须包含数字和字母。";
                 }  
                 check_errmsg = curErrmsg; 
                 if(check_errmsg!=""){
                     serverValidErrorType = curSchema;
                     break;
                 }
                }
           return check_errmsg;
            
        }
</code></pre> 
<p>C#验证函数完整代码如下：</p> 
<pre><code class="language-cs">                    public bool CheckIDCard(string idNumber)
                    {
                        if (idNumber.Length == 18)
                        {
                            bool check = CheckIDCard18(idNumber);
                            return check;
                        }
                        else if (idNumber.Length == 15)
                        {
                            bool check = CheckIDCard15(idNumber);
                            return check;
                        }
                        else
                        {
                            return false;
                        }
                    }
                    /// &lt;summary&gt;  
                    /// 18位身份证号码验证  
                    /// &lt;/summary&gt;  
                    public bool CheckIDCard18(string idNumber)
                    {
                        if (idNumber.Length != 18)
                        {
                            return false;
                        }
                        long n = 0;
                        if (long.TryParse(idNumber.Remove(17), out n) == false
                            || n &lt; Math.Pow(10, 16) || long.TryParse(idNumber.Replace('x', '0').Replace('X', '0'), out n) == false)
                        {
                            return false;//数字验证  
                        }
                        string address = "11x22x35x44x53x12x23x36x45x54x13x31x37x46x61x14x32x41x50x62x15x33x42x51x63x21x34x43x52x64x65x71x81x82x91";
                        if (address.IndexOf(idNumber.Remove(2)) == -1)
                        {
                            return false;//省份验证  
                        }
                        string birth = idNumber.Substring(6, 8).Insert(6, "-").Insert(4, "-");
                        DateTime time = new DateTime();
                        if (DateTime.TryParse(birth, out time) == false)
                        {
                            return false;//生日验证  
                        }
                        string[] arrVarifyCode = ("1,0,x,9,8,7,6,5,4,3,2").Split(',');
                        string[] Wi = ("7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2").Split(',');
                        char[] Ai = idNumber.Remove(17).ToCharArray();
                        int sum = 0;
                        for (int i = 0; i &lt; 17; i++)
                        {
                            sum += int.Parse(Wi[i]) * int.Parse(Ai[i].ToString());
                        }
                        int y = -1;
                        Math.DivRem(sum, 11, out y);
                        if (arrVarifyCode[y] != idNumber.Substring(17, 1).ToLower())
                        {
                            return false;//校验码验证  
                        }
                        return true;//符合GB11643-1999标准  
                    }
                    public bool CheckIDCard15(string idNumber)
                    {
                        if (idNumber.Length != 15)
                        {
                            return false;
                        }
                        long n = 0;
                        if (long.TryParse(idNumber, out n) == false || n &lt; Math.Pow(10, 14))
                        {
                            return false;//数字验证  
                        }
                        string address = "11x22x35x44x53x12x23x36x45x54x13x31x37x46x61x14x32x41x50x62x15x33x42x51x63x21x34x43x52x64x65x71x81x82x91";
                        if (address.IndexOf(idNumber.Remove(2)) == -1)
                        {
                            return false;//省份验证  
                        }
                        string birth = idNumber.Substring(6, 6).Insert(4, "-").Insert(2, "-");
                        DateTime time = new DateTime();
                        if (DateTime.TryParse(birth, out time) == false)
                        {
                            return false;//生日验证  
                        }
                        return true;
                    }   
        public bool isNotNull(string value){
            return value.Length==0?false:true;
        }
        public bool IsNumeric(string value)
        {
                 return Regex.IsMatch(value, @"^[+-]?\d*[.]?\d*$");
        }
        public bool IsBNumeric(string value)
        {
                 if(Regex.IsMatch(value, @"^[+-]?\d*[.]?\d*$")==true){
                     return float.Parse(value)&gt;=0?true:false;
                 }
            return false;
        }
        public bool IsSNumeric(string value)
        {
                 if(Regex.IsMatch(value, @"^[+-]?\d*[.]?\d*$")==true){
                     return float.Parse(value)&lt;0?true:false;
                 }
            return false;
        }
        public bool IsInt(string value)
        {
                 return Regex.IsMatch(value, @"^[+-]?\d*$");
        }
        public bool IsUnsign(string value)
        {
                 return Regex.IsMatch(value, @"^\d*[.]?\d*$");
        }
         public  bool isTel(string strInput)
        {
                return Regex.IsMatch(strInput, @"\d{3}-\d{8}|\d{4}-\d{7}");
        }
        public bool IsDate(string value)
        {
            try
            {
                DateTime.Parse(value);
                return true;
            }
            catch
            {
                return false;
            }
        }
        public bool IsAlpha(string value){
            return Regex.IsMatch(value, @"^\w+$");
        }
        public bool IsEmail(string value){
            return Regex.IsMatch(value,@"^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$");
        }
         /// 匹配3位或4位区号的电话号码，其中区号可以用小括号括起   /// 也可以不用，区号与本地号间可以用连字号或空格间隔， /// 也可以没有间隔
          public  bool IsPhone(string input)
          {
              string pattern = "^\\(0\\d{2}\\)[- ]?\\d{8}$|^0\\d{2}[- ]?\\d{8}$|^\\(0\\d{3}\\)[- ]?\\d{7}$|^0\\d{3}[- ]?\\d{7}$";
              Regex regex = new Regex(pattern);
              return regex.IsMatch(input);
          }
          public  bool IsMobilePhone(string input)
          {
              Regex regex = new Regex("^13\\d{9}$");
              return regex.IsMatch(input);
  
         }
        public bool IsZip(string value){

            return Regex.IsMatch(value, @"^\d{6}$");
        }
        public bool IsEnglish(string input)
         {
             Regex regex = new Regex("^[A-Za-z]+$");
             return regex.IsMatch(input);
         }         
        public bool IsChineseCh(string input)
          {
              Regex regex = new Regex("^[\u4e00-\u9fa5]+$");
              return regex.IsMatch(input);
          }
        public  bool IsURL(string input)
         {
             string pattern = @"^[a-zA-Z]+://(\w+(-\w+)*)(\.(\w+(-\w+)*))*(\?\S*)?$";
             Regex regex = new Regex(pattern);
            return regex.IsMatch(input);
         }
                    public bool CheckIDCard(string idNumber)
                    {
                        if (idNumber.Length == 18)
                        {
                            bool check = CheckIDCard18(idNumber);
                            return check;
                        }
                        else if (idNumber.Length == 15)
                        {
                            bool check = CheckIDCard15(idNumber);
                            return check;
                        }
                        else
                        {
                            return false;
                        }
                    }
                    /// &lt;summary&gt;  
                    /// 18位身份证号码验证  
                    /// &lt;/summary&gt;  
                    public bool CheckIDCard18(string idNumber)
                    {
                        if (idNumber.Length != 18)
                        {
                            return false;
                        }
                        long n = 0;
                        if (long.TryParse(idNumber.Remove(17), out n) == false
                            || n &lt; Math.Pow(10, 16) || long.TryParse(idNumber.Replace('x', '0').Replace('X', '0'), out n) == false)
                        {
                            return false;//数字验证  
                        }
                        string address = "11x22x35x44x53x12x23x36x45x54x13x31x37x46x61x14x32x41x50x62x15x33x42x51x63x21x34x43x52x64x65x71x81x82x91";
                        if (address.IndexOf(idNumber.Remove(2)) == -1)
                        {
                            return false;//省份验证  
                        }
                        string birth = idNumber.Substring(6, 8).Insert(6, "-").Insert(4, "-");
                        DateTime time = new DateTime();
                        if (DateTime.TryParse(birth, out time) == false)
                        {
                            return false;//生日验证  
                        }
                        string[] arrVarifyCode = ("1,0,x,9,8,7,6,5,4,3,2").Split(',');
                        string[] Wi = ("7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2").Split(',');
                        char[] Ai = idNumber.Remove(17).ToCharArray();
                        int sum = 0;
                        for (int i = 0; i &lt; 17; i++)
                        {
                            sum += int.Parse(Wi[i]) * int.Parse(Ai[i].ToString());
                        }
                        int y = -1;
                        Math.DivRem(sum, 11, out y);
                        if (arrVarifyCode[y] != idNumber.Substring(17, 1).ToLower())
                        {
                            return false;//校验码验证  
                        }
                        return true;//符合GB11643-1999标准  
                    }
                    public bool CheckIDCard15(string idNumber)
                    {
                        if (idNumber.Length != 15)
                        {
                            return false;
                        }
                        long n = 0;
                        if (long.TryParse(idNumber, out n) == false || n &lt; Math.Pow(10, 14))
                        {
                            return false;//数字验证  
                        }
                        string address = "11x22x35x44x53x12x23x36x45x54x13x31x37x46x61x14x32x41x50x62x15x33x42x51x63x21x34x43x52x64x65x71x81x82x91";
                        if (address.IndexOf(idNumber.Remove(2)) == -1)
                        {
                            return false;//省份验证  
                        }
                        string birth = idNumber.Substring(6, 6).Insert(4, "-").Insert(2, "-");
                        DateTime time = new DateTime();
                        if (DateTime.TryParse(birth, out time) == false)
                        {
                            return false;//生日验证  
                        }
                        return true;
                    }   

</code></pre> 
<h4>调用示例</h4> 
<p>假设对 id 为 x1 的输入框元素进行身份证号验证，代码如下：</p> 
<pre><code class="language-javascript">string rv=checkSchemaServerValid(x1.Text,x1.Attributes["checkSchema"],"身份证号");
if(rv!=""){
    Response.Write(rv);
}else{
    Response.Write("校验通过");
}</code></pre> 
<p></p> 
<h3 id="%E5%B0%8F%E7%BB%93">小结</h3> 
<p>本方法提供了一些基础的且实用的验证类型方法，我们在实际的应用中，可以通过扩展自定义 checkSchema 属性中提供的验证类型以满足自己的应用。</p> 
<p>如何遍历界面需要校验输入字段，可通过 JavaScript 进行控制，这里不再赘述。</p> 
<p>感谢您的阅读，希望本文能够对您有所帮助。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/0e31953c30bcb88a7d20b0b5415a01ce/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">VScode代码片段自动转图标</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f1640b3205a35708dea85224e534805b/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Android14 SystemUI修复进入桌面后虚拟按键图标从黑色过渡到白色</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程学习者.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>如何在树莓派 Raspberry Pi中本地部署一个web站点并实现无公网IP远程访问 - 编程学习者</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcxuexizhe.github.io/posts/060aafbfb1e4670c66ca7378c32d61b2/">
  <meta property="og:site_name" content="编程学习者">
  <meta property="og:title" content="如何在树莓派 Raspberry Pi中本地部署一个web站点并实现无公网IP远程访问">
  <meta property="og:description" content="文章目录 前言1. 安装 Raspberry Pi OS2. 测试 web 站点3. 安装静态样例站点4. 将web站点发布到公网4.1 安装 Cpolar4.2 cpolar进行token认证4.3 生成cpolar随机域名网址4.4 生成cpolar二级子域名4.5 将参数保存到cpolar配置文件中4.6 测试修改后配置文件4.7 配置cpolar服务开机自启动 前言 本文主要介绍如何在树莓派 Raspberry Pi中搭建一个简单的web网站并结合cpolar内网穿透工具实现将本地站点发布至公网，使用生成的公网链接轻松访问本地搭建的网站。
1. 安装 Raspberry Pi OS 下载适用于您的操作系统的树莓派镜像工具。它支持大多数操作系统（Windows、Mac 和 Linux）。
https://www.raspberrypi.org/downloads/
运行并安装树莓派镜像工具选择 Raspberry Pi OS -&gt; Raspberry Pi OS (32-bit)将 SD 卡插入计算机点击 Write 按钮 设置 Apache Web 服务器
Apache 是一种流行的 Web 服务器应用程序，您可以将其安装在 Raspberry Pi 上以允许它为网页提供服务。
Apache 本身可以通过 HTTP 提供 HTML 文件。通过附加模块，它可以使用 PHP 等脚本语言提供动态网页。
sudo apt-get install apache2 -y sudo service apache2 restart 2.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-09T17:50:59+08:00">
    <meta property="article:modified_time" content="2024-05-09T17:50:59+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程学习者" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程学习者</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">如何在树莓派 Raspberry Pi中本地部署一个web站点并实现无公网IP远程访问</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#_2" rel="nofollow">前言</a></li><li><a href="#1__Raspberry_Pi_OS_6" rel="nofollow">1. 安装 Raspberry Pi OS</a></li><li><a href="#2__web__30" rel="nofollow">2. 测试 web 站点</a></li><li><a href="#3__43" rel="nofollow">3. 安装静态样例站点</a></li><li><a href="#4_web_68" rel="nofollow">4. 将web站点发布到公网</a></li><li><ul><li><a href="#41__Cpolar_72" rel="nofollow">4.1 安装 Cpolar</a></li><li><a href="#42_cpolartoken_108" rel="nofollow">4.2 cpolar进行token认证</a></li><li><a href="#43_cpolar_117" rel="nofollow">4.3 生成cpolar随机域名网址</a></li><li><a href="#44_cpolar_143" rel="nofollow">4.4 生成cpolar二级子域名</a></li><li><a href="#45_cpolar_169" rel="nofollow">4.5 将参数保存到cpolar配置文件中</a></li><li><a href="#46__221" rel="nofollow">4.6 测试修改后配置文件</a></li><li><a href="#47_cpolar_239" rel="nofollow">4.7 配置cpolar服务开机自启动</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_2"></a>前言</h3> 
<p>本文主要介绍如何在树莓派 Raspberry Pi中搭建一个简单的web网站并结合cpolar内网穿透工具实现将本地站点发布至公网，使用生成的公网链接轻松访问本地搭建的网站。</p> 
<h3><a id="1__Raspberry_Pi_OS_6"></a>1. 安装 Raspberry Pi OS</h3> 
<p>下载适用于您的操作系统的树莓派镜像工具。它支持大多数操作系统（Windows、Mac 和 Linux）。</p> 
<p><a href="https://link.zhihu.com/?target=https%3A//www.raspberrypi.org/downloads/" rel="nofollow">https://www.raspberrypi.org/downloads/</a></p> 
<ul><li>运行并安装树莓派镜像工具</li><li>选择 Raspberry Pi OS -&gt; Raspberry Pi OS (32-bit)</li><li>将 SD 卡插入计算机</li><li>点击 Write 按钮</li></ul> 
<p><img src="https://images2.imgbox.com/eb/ab/jjwK41cT_o.jpg" alt="img"></p> 
<p><strong>设置 Apache Web 服务器</strong></p> 
<p>Apache 是一种流行的 Web 服务器应用程序，您可以将其安装在 Raspberry Pi 上以允许它为网页提供服务。</p> 
<p>Apache 本身可以通过 HTTP 提供 HTML 文件。通过附加模块，它可以使用 PHP 等脚本语言提供动态网页。</p> 
<pre><code>sudo apt-get install apache2 -y
sudo service apache2 restart
</code></pre> 
<h3><a id="2__web__30"></a>2. 测试 web 站点</h3> 
<p>默认情况下，Apache 将测试 HTML 文件放在 web 文件夹中，您可以从您的 Pi 或网络上的另一台计算机查看该页面。</p> 
<p>在 Raspberry Pi 上打开 Apache 默认网页：</p> 
<ul><li>通过从菜单中选择 Internet &gt; Chromium Web 浏览器打开 Chromium。</li><li>输入地址 http://localhost</li></ul> 
<p>您应该在浏览器窗口中看到：</p> 
<p><img src="https://images2.imgbox.com/e6/d4/X03StcLD_o.jpg" alt="img"></p> 
<h3><a id="3__43"></a>3. 安装静态样例站点</h3> 
<p>为了让站点的内容更有意义，我们部署一个简单的静态演示站点–冥想放松站点。</p> 
<pre><code>cd /var/www/html/
sudo rm *
sudo wget https://www.cpolar.com/static/downloads/meditation-app-master.tar.gz
sudo tar xzf meditation-app-master.tar.gz
sudo mv meditation-app-master/* .
sudo rm -rf meditation-app-master meditation-app-master.tar.gz
</code></pre> 
<p>重新在浏览器打开，并刷新站点：http://localhost</p> 
<p><img src="https://images2.imgbox.com/68/92/Gg97GAzi_o.jpg" alt="img"></p> 
<p>这是一个用于冥想的小工具站点，可以用它帮助自己工作之余放松2-10分钟。</p> 
<p>它可以选择不同冥想情景及放松时间（2-5-10分钟）。</p> 
<h3><a id="4_web_68"></a>4. 将web站点发布到公网</h3> 
<p>目前，这个站点只能在局域网站可以被访问，公网用户是访问不到的。要想所有人访问你创建的漂亮站点，我们需要做如下工作。</p> 
<h4><a id="41__Cpolar_72"></a>4.1 安装 Cpolar</h4> 
<p>cpolar是一款内网穿透工具，可以将您的内网站点暴露到公网上，使所有人可以访问到你的站点。</p> 
<p>cpolar官网地址：<a href="https://www.cpolar.com/" rel="nofollow">https://www.cpolar.com/</a></p> 
<ul><li>cpolar一键安装脚本：（国内用户）</li></ul> 
<pre><code>curl -L https://www.cpolar.com/static/downloads/install-release-cpolar.sh | sudo bash
</code></pre> 
<ul><li>或短链接安装方式：(国外用户)</li></ul> 
<pre><code>curl -sL https://git.io/cpolar | sudo bash
</code></pre> 
<ul><li>查看cpolar版本信息</li></ul> 
<pre><code>cpolar version
</code></pre> 
<p>如果正常显示，则安装成功，如图：</p> 
<p><img src="https://images2.imgbox.com/f9/14/ofp1h2kF_o.jpg" alt="img"></p> 
<h4><a id="42_cpolartoken_108"></a>4.2 cpolar进行token认证</h4> 
<p>如果您还没有cpolar账号，请去<a href="https://link.zhihu.com/?target=https%3A//www.cpolar.com/" rel="nofollow">cpolar官网</a>注册并登录后台获取认证token</p> 
<pre><code>cpolar authtoken xxxxxxxxxxxxxxxxxx
</code></pre> 
<h4><a id="43_cpolar_117"></a>4.3 生成cpolar随机域名网址</h4> 
<pre><code>cpolar http -region=cn_vip 80
</code></pre> 
<p><img src="https://images2.imgbox.com/f4/83/fdkEbbxk_o.jpg" alt="img"></p> 
<p>上图显示，cpolar将内网站点，发布到了一个随机域名网址：https://711d7522.vip.cpolar.cn</p> 
<ul><li>我们打开浏览器试一下：https://711d7522.vip.cpolar.cn</li></ul> 
<p><img src="https://images2.imgbox.com/7d/bd/2kI1uqPg_o.jpg" alt="img"></p> 
<p>现在，我们已经发布了内网的web站点到公网，任何人都可以访问到它。</p> 
<p>回到终端窗口，按<code>CTRL+C</code>键，退出cpolar</p> 
<p>此时，公网地址不再能被访问。</p> 
<h4><a id="44_cpolar_143"></a>4.4 生成cpolar二级子域名</h4> 
<p>虽然已经发布到公网，但域名是随机变化的，只适合临时测试使用。如果要长期使用，我们要配置二级子域名。</p> 
<p>操作步骤：</p> 
<ul><li>升级到cpolar基础套餐</li><li>登录到cpolar后台–&gt;预留–&gt;保留二级子域名，例如添加<code>dev9</code>，地区选择<code>VIP China</code>地区</li></ul> 
<p>在前台终端测试域名</p> 
<pre><code>cpolar http -subdomain=dev9 -region=cn_vip 80
</code></pre> 
<p>如果显示正常，则说明我们已经配置好了。</p> 
<p><img src="https://images2.imgbox.com/ca/1d/LShzm4zX_o.jpg" alt="img"></p> 
<p>用新的域名在浏览器里访问：</p> 
<p>正常则说明我们的固定二级子域名配置好了。</p> 
<h4><a id="45_cpolar_169"></a>4.5 将参数保存到cpolar配置文件中</h4> 
<p>刚刚我们在前台运行cpolar程序，关掉后，域名消失，现在我们将参数保存到配置文件中。以支持开机后台自启动运行。</p> 
<ul><li>编辑配置文件</li></ul> 
<pre><code>nano /usr/local/etc/cpolar/cpolar.yml
</code></pre> 
<p>如图：</p> 
<p><img src="https://images2.imgbox.com/b4/29/RzXA5H6C_o.jpg" alt="img"></p> 
<p>上图为样例配置文件，它会配置两个默认隧道：一个ssh隧道和一个website隧道。</p> 
<p>参数说明：</p> 
<pre><code>authtoken: xxxxxxxxxxxx #认证token

tunnels:
  ssh:              #隧道名称，表示ssh，名称可以自定义
    addr: 22        #端口号为22
    proto: tcp      #协议tcp
    region: cn_vip  #地区，cn_vip，可选:us,hk,cn,cn_vip
  website:          #隧道名称，用户可以自定义，但多隧道时，不可重复
    addr: 8080      #本地Web站点端口
    proto: http     #协议http
    region: cn_vip  #地区，cn_vip,可选：us,hk,cn,cn_vip
</code></pre> 
<p>本例中，我们需要修改如下内容：</p> 
<ul><li>将website隧道的默认<code>8080</code>端口修改为<code>80</code></li><li>添加一行 <code>subdomain: "你的二级子域名"</code></li></ul> 
<p>修改后的效果如图：</p> 
<p><img src="https://images2.imgbox.com/8b/76/Bpr74ntS_o.jpg" alt="img"></p> 
<p><strong>注意：</strong> 配置文件是<code>yaml</code>格式的，缩进敏感，而且不能有<code>TAB键</code>。</p> 
<p>然后按<code>CTRL+X</code>,退出，提示你是否保存，回答<code>Y</code>，确认保存文件路径，<code>回车</code></p> 
<h4><a id="46__221"></a>4.6 测试修改后配置文件</h4> 
<p>在前台启动所有隧道测试</p> 
<pre><code>cpolar start-all
</code></pre> 
<p><img src="https://images2.imgbox.com/a8/b5/BRwrJ70W_o.jpg" alt="img"></p> 
<p>如上图显示，则为正常，按CTRL+C退出</p> 
<p>如果报错，会提示配置文件某行有错误，请重新修改。直到类似上图正确输出。</p> 
<h4><a id="47_cpolar_239"></a>4.7 配置cpolar服务开机自启动</h4> 
<ul><li>配置cpolar开机自启动</li></ul> 
<pre><code>sudo systemctl enable cpolar
</code></pre> 
<ul><li>守护进程方式，启动cpolar</li></ul> 
<pre><code>sudo systemctl start cpolar
</code></pre> 
<ul><li>查看cpolar守护进程状态</li></ul> 
<pre><code>sudo systemctl status cpolar
</code></pre> 
<p>如图说明，启动状态成功</p> 
<p><img src="https://images2.imgbox.com/d9/92/dUNLF2Ab_o.jpg" alt="img"></p> 
<ul><li>重新启动</li></ul> 
<pre><code>sudo reboot
</code></pre> 
<p>重启后，检查cpolar隧道是否仍在线</p> 
<p>访问后台–&gt;状态 <a href="https://link.zhihu.com/?target=https%3A//dashboard.cpolar.com/status" rel="nofollow">https://dashboard.cpolar.com/status</a></p> 
<p>如图说明配置成功</p> 
<p><img src="https://images2.imgbox.com/9e/ec/u26zDAhb_o.jpg" alt="img"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/2411d30e81bc8e0cf2a7ec4354159eec/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【粉丝福利 | 第6期】K邻算法：在风险传导中的创新应用与实践价值</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/61029032429313b03016e43f55504499/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">用20行python写一个最简单的网站</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程学习者.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
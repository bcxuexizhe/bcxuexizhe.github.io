<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【python的魅力】：教你如何用几行代码实现文本语音识别 - 编程学习者</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcxuexizhe.github.io/posts/f87498d8b81166758e52ddcc80b74433/">
  <meta property="og:site_name" content="编程学习者">
  <meta property="og:title" content="【python的魅力】：教你如何用几行代码实现文本语音识别">
  <meta property="og:description" content="文章目录 引言一、运行效果二、文本转换为语音2.1 使用pyttsx32.2 使用SAPI实现文本转换语音2.3 使用 SpeechLib实现文本转换语音 三、语音转换为文本3.1 使用 PocketSphinx实现语音转换文本 引言 语音识别技术，也被称为自动语音识别，目标是以电脑自动将人类的语音内容转换为相应的文字和文字转换为语音。
一、运行效果 Python语音识别
二、文本转换为语音 2.1 使用pyttsx3 pyttsx3 是一个流行的 Python 第三方库，用于实现文本到语音（TTS）的转换。这个库支持多种操作系统，包括 Windows、Linux 和 macOS，并且可以在没有互联网连接的情况下工作，因为它使用的是计算机上安装的本地语音引擎。
主要特点：
跨平台：可以在不同的操作系统上运行。离线工作：不依赖于互联网连接。多种语音和语言：支持多种语音和语言选项。自定义设置：允许用户调整语速、音量和语调等参数。简单易用：具有直观的 API，易于集成和使用。 安装：
pip install pyttsx3 -i https://pypi.tuna.tsinghua.edu.cn/simple some-package
【示例】：使用 pyttsx3 实现文本转换语音
import pyttsx3 as pyttsx engine = pyttsx.init() # 初始化引擎 engine.say(&#39;独断万古荒天帝, 唯负罪州火桑女&#39;) # 添加文本到语音队列 engine.runAndWait() # 开始语音输出 2.2 使用SAPI实现文本转换语音 在 python 中，你也可以使用 SAPI 来做文本到语音的转换。
在Python中，win32com库是一个用于与Windows操作系统中的COM（Component Object Model）组件进行交互的模块。win32com.client模块提供了一种使用COM自动化的Python接口。通过win32com.client.Dispatch方法，可以访问和控制支持COM自动化的任何Windows应用程序或服务。
对于SAPI（Speech Application Programming Interface），可以通过win32com库来访问其功能，从而实现文本到语音（TTS）和语音识别。
【示例】：使用 SAPI 实现文本转换语音">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-04T20:56:32+08:00">
    <meta property="article:modified_time" content="2024-05-04T20:56:32+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程学习者" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程学习者</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【python的魅力】：教你如何用几行代码实现文本语音识别</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#_1" rel="nofollow">引言</a></li><li><ul><li><a href="#_3" rel="nofollow">一、运行效果</a></li><li><a href="#_7" rel="nofollow">二、文本转换为语音</a></li><li><ul><li><a href="#21_pyttsx3_8" rel="nofollow">2.1 使用pyttsx3</a></li><li><a href="#22_SAPI_32" rel="nofollow">2.2 使用SAPI实现文本转换语音</a></li><li><a href="#23__SpeechLib_48" rel="nofollow">2.3 使用 SpeechLib实现文本转换语音</a></li></ul> 
    </li><li><a href="#_78" rel="nofollow">三、语音转换为文本</a></li><li><ul><li><a href="#31__PocketSphinx_79" rel="nofollow">3.1 使用 PocketSphinx实现语音转换文本</a></li></ul> 
   </li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_1"></a>引言</h3> 
<p>语音识别技术，也被称为自动语音识别，目标是以电脑自动将人类的语音内容转换为相应的文字和文字转换为语音。</p> 
<h4><a id="_3"></a>一、运行效果</h4> 
<p></p> 
<div class="csdn-video-box"> 
 <iframe id="FGR9BHX5-1714827346314" frameborder="0" src="https://live.csdn.net/v/embed/384346" allowfullscreen="true" data-mediaembed="csdn"></iframe> 
 <p>Python语音识别</p> 
</div> 
<p></p> 
<h4><a id="_7"></a>二、文本转换为语音</h4> 
<h5><a id="21_pyttsx3_8"></a>2.1 使用pyttsx3</h5> 
<p>pyttsx3 是一个流行的 Python 第三方库，用于实现文本到语音（TTS）的转换。这个库支持多种操作系统，包括 Windows、Linux 和 macOS，并且可以在没有互联网连接的情况下工作，因为它使用的是计算机上安装的本地语音引擎。</p> 
<p><strong>主要特点</strong>：</p> 
<blockquote> 
 <ul><li><strong>跨平台</strong>：可以在不同的操作系统上运行。</li><li><strong>离线工作</strong>：不依赖于互联网连接。</li><li><strong>多种语音和语言</strong>：支持多种语音和语言选项。</li><li><strong>自定义设置</strong>：允许用户调整语速、音量和语调等参数。</li><li><strong>简单易用</strong>：具有直观的 API，易于集成和使用。</li></ul> 
</blockquote> 
<p><strong>安装</strong>：</p> 
<blockquote> 
 <p><code>pip install pyttsx3 -i https://pypi.tuna.tsinghua.edu.cn/simple some-package</code></p> 
</blockquote> 
<p><strong>【示例】</strong>：使用 pyttsx3 实现文本转换语音</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> pyttsx3 <span class="token keyword">as</span> pyttsx

engine <span class="token operator">=</span> pyttsx<span class="token punctuation">.</span>init<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 初始化引擎</span>
engine<span class="token punctuation">.</span>say<span class="token punctuation">(</span><span class="token string">'独断万古荒天帝, 唯负罪州火桑女'</span><span class="token punctuation">)</span>  <span class="token comment"># 添加文本到语音队列</span>
engine<span class="token punctuation">.</span>runAndWait<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 开始语音输出</span>
</code></pre> 
<h5><a id="22_SAPI_32"></a>2.2 使用SAPI实现文本转换语音</h5> 
<p>在 python 中，你也可以使用 SAPI 来做文本到语音的转换。<br> 在Python中，win32com库是一个用于与Windows操作系统中的COM（Component Object Model）组件进行交互的模块。win32com.client模块提供了一种使用COM自动化的Python接口。通过win32com.client.Dispatch方法，可以访问和控制支持COM自动化的任何Windows应用程序或服务。<br> 对于SAPI（Speech Application Programming Interface），可以通过win32com库来访问其功能，从而实现文本到语音（TTS）和语音识别。</p> 
<p><strong>【示例】</strong>：使用 SAPI 实现文本转换语音</p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> win32com<span class="token punctuation">.</span>client <span class="token keyword">import</span> Dispatch

msg <span class="token operator">=</span> <span class="token string">"独断万古荒天帝, 唯负罪州火桑女"</span>
speaker <span class="token operator">=</span> Dispatch<span class="token punctuation">(</span><span class="token string">'SAPI.SpVoice'</span><span class="token punctuation">)</span>  <span class="token comment"># 创建SAPI的语音引擎实例</span>
speaker<span class="token punctuation">.</span>Speak<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>  <span class="token comment"># 将文本转换为语音并朗读</span>
<span class="token keyword">del</span> speaker  <span class="token comment"># 删除 speaker 对象，释放与之关联的资源。</span>
</code></pre> 
<h5><a id="23__SpeechLib_48"></a>2.3 使用 SpeechLib实现文本转换语音</h5> 
<p>SpeechLib 是微软提供的一个用于语音功能的 COM 库，它允许开发者在 Windows 平台上进行文本到语音（TTS）和语音识别的开发。通过 SpeechLib，您可以控制语音引擎的多种属性，比如语速、音量、语调以及使用的语音库。<br> 使用 SpeechLib，可以从文本文件中获取输入，再将其转换为语音。</p> 
<p>使用使用 SpeechLib需要安装第三方库：comtypes</p> 
<p><strong>安装命令</strong>：</p> 
<blockquote> 
 <p><code>pip install comtypes -i https://pypi.tuna.tsinghua.edu.cn/simple some-package</code></p> 
</blockquote> 
<p><strong>【示例】</strong>：使用 SpeechLib 实现文本转换语音<br> <strong>demo文件</strong>：<br> <img src="https://images2.imgbox.com/f7/81/huzRUdx9_o.png" alt="在这里插入图片描述"></p> 
<pre><code class="prism language-python"><span class="token keyword">from</span> comtypes<span class="token punctuation">.</span>client <span class="token keyword">import</span> CreateObject
<span class="token keyword">from</span> comtypes<span class="token punctuation">.</span>gen <span class="token keyword">import</span> SpeechLib  <span class="token comment"># 导入 SpeechLib</span>
engine <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">"SAPI.SpVoice"</span><span class="token punctuation">)</span>  <span class="token comment"># 创建 SAPI.SpVoice 对象的实例</span>
stream <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">"SAPI.SpFileStream"</span><span class="token punctuation">)</span>  <span class="token comment"># 创建 SAPI.SpFileStream 对象的实例</span>
infile <span class="token operator">=</span> <span class="token string">'demo.txt'</span>
outfile <span class="token operator">=</span> <span class="token string">'demo_audio.wav'</span>
stream<span class="token punctuation">.</span>Open<span class="token punctuation">(</span>outfile<span class="token punctuation">,</span> SpeechLib<span class="token punctuation">.</span>SSFMCreateForWrite<span class="token punctuation">)</span>  <span class="token comment"># 输出文件，准备写入音频数据</span>
engine<span class="token punctuation">.</span>AudioOutputStream <span class="token operator">=</span> stream  <span class="token comment"># 音频输出流设置为 stream 对象</span>
f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'demo'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>  <span class="token comment"># 打开输入文本文件</span>
TheText <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 读取文件</span>
f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 关闭文件</span>
engine<span class="token punctuation">.</span>speak<span class="token punctuation">(</span>TheText<span class="token punctuation">)</span>  <span class="token comment"># 使用语音引擎将文本转换为语音并输出。</span>
stream<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 关闭音频流，完成音频文件的写入</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/7e/5f/luxi2Ajj_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="_78"></a>三、语音转换为文本</h4> 
<h5><a id="31__PocketSphinx_79"></a>3.1 使用 PocketSphinx实现语音转换文本</h5> 
<p>PocketSphinx 是一个轻量级的语音识别库，它是 CMU Sphinx 开源语音识别系统的一个子集。CMU Sphinx 由卡内基梅隆大学开发，是一个功能强大且灵活的语音识别系统。PocketSphinx 特别适用于嵌入式系统和移动设备，因为它的体积小、速度快，同时提供了相对较高的识别准确率。</p> 
<p><strong>PocketSphinx 的主要特点包括</strong>：</p> 
<blockquote> 
 <ul><li><strong>轻量级</strong>：适用于资源受限的环境，如移动设备和嵌入式系统。</li><li><strong>实时性能</strong>：能够实现实时的语音识别。</li><li><strong>易于使用</strong>：提供了简单的 API，方便开发者快速集成和使用。</li><li><strong>可定制</strong>：允许开发者根据需要定制语言模型和声学模型。</li></ul> 
</blockquote> 
<p>所需的第三方模块：<strong>PocketSphinx</strong>和<strong>SpeechRecognition</strong><br> <strong>安装命令</strong>：</p> 
<blockquote> 
 <p><code>pip install PocketSphinx -i https://pypi.tuna.tsinghua.edu.cn/simple some-package</code><br> <code>pip install SpeechRecognition -i https://pypi.tuna.tsinghua.edu.cn/simple some-package</code></p> 
</blockquote> 
<p><strong>【示例】</strong>：使用 PocketSphinx 实现语音转换文本</p> 
<pre><code class="prism language-python"><span class="token keyword">import</span> speech_recognition <span class="token keyword">as</span> sr

audio_file <span class="token operator">=</span> <span class="token string">'demo_audio.wav'</span>
r <span class="token operator">=</span> sr<span class="token punctuation">.</span>Recognizer<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">with</span> sr<span class="token punctuation">.</span>AudioFile<span class="token punctuation">(</span>audio_file<span class="token punctuation">)</span> <span class="token keyword">as</span> source<span class="token punctuation">:</span>
    audio <span class="token operator">=</span> r<span class="token punctuation">.</span>record<span class="token punctuation">(</span>source<span class="token punctuation">)</span>
<span class="token keyword">try</span><span class="token punctuation">:</span>
    <span class="token comment"># print('文本内容：',r.recognize_sphinx(audio,language="zh_CN"))</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'文本内容：'</span><span class="token punctuation">,</span> r<span class="token punctuation">.</span>recognize_sphinx<span class="token punctuation">(</span>audio<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
</code></pre> 
<p>如果在使用PocketSphinx时遇到问题，比如初始化失败，需要检查：</p> 
<ul><li>是否已经正确安装了pocketsphinx。</li><li>是否有合适的语言模型和字典可供使用。</li><li>是否有足够的权限访问所需的文件。</li><li>系统是否满足PocketSphinx的运行要求。</li></ul> 
<p>安装完 speech_recognition 之后是不支持中文的，需要在 Sphinx 语音识别工具包里面下载对应的普通话升学和语言模型 。<br> 下载链接：</p> 
<blockquote> 
 <p><code>https://sourceforge.net/projects/cmusphinx/files/Acoustic%20and%20Language%20Models/</code><br> 将下载好的普通话升学和语言模型放到安装 Python\Lib\site-packages\speech_recognition\pocketsphinx-data目录下</p> 
</blockquote>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/3181b037997c72d557f46feb5326df9b/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【数据结构】第四讲：双向链表</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e13cd9cd03d9efc125296f4d206cea9d/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C语言之数据结构之栈和队列的运用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程学习者.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
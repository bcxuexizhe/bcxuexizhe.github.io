<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【c&#43;&#43;】探究C&#43;&#43;中的list：精彩的接口与仿真实现解密 - 编程学习者</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcxuexizhe.github.io/posts/7cc1874530cb438b624ec604106146e1/">
  <meta property="og:site_name" content="编程学习者">
  <meta property="og:title" content="【c&#43;&#43;】探究C&#43;&#43;中的list：精彩的接口与仿真实现解密">
  <meta property="og:description" content="🔥个人主页：Quitecoder
🔥专栏：c&#43;&#43;笔记仓
朋友们大家好，本篇文章来到list有关部分，这一部分函数与前面的类似，我们简单讲解，重难点在模拟实现时的迭代器有关实现
目录 `1.List介绍``2.接口函数``operations` `3.模拟实现``3.1基本框架``3.2 list的基本函数``3.3迭代器的封装和实现``&#43;&#43;等重载函数的实现``与list的关联` `3.4list函数完善``3.5迭代器进一步完善``const迭代器``合并两种迭代器` 1.List介绍 list是可以在常数范围内在任意位置进行插入和删除的序列式容器，并且该容器可以前后双向迭代list的底层是双向链表结构，双向链表中每个元素存储在互不相关的独立节点中，在节点中通过指针指向其前一个元素和后一个元素list与forward_list非常相似：最主要的不同在于forward_list是单链表，只能朝前迭代，已让其更简单高效与其他的序列式容器相比(array，vector，deque)，list通常在任意位置进行插入、移除元素的执行效率更好与其他序列式容器相比，list和forward_list最大的缺陷是不支持任意位置的随机访问，比如：要访问list的第6个元素，必须从已知的位置(比如头部或者尾部)迭代到该位置，在这段位置上迭代需要线性的时间开销；list还需要一些额外的空间，以保存每个节点的相关联信息(对于存储类型较小元素的大list来说这可能是一个重要的因素） 所以list本质就是我们的双向循环链表，我们接下来看它的接口函数
2.接口函数 构造函数
这里的构造函数与vector类似
Default constructor (构造一个空的 std::list): std::list&lt;int&gt; myList1; // 创建一个空的整型链表 Fill constructor (构造一个有特定数量元素且每个元素都有相同初始值的 std::list): std::list&lt;int&gt; myList2(5, 10); // 创建一个有5个元素的链表，每个元素都初始化为10 Range constructor (从另一个迭代器定义范围的容器中构建 std::list): std::vector&lt;int&gt; myVector{1, 2, 3, 4, 5}; std::list&lt;int&gt; myList3(myVector.begin(), myVector.end()); // 使用vector的范围来初始化链表 Copy constructor (使用另一个 std::list 来构造一个新的 std::list, 是副本): std::list&lt;int&gt; myOriginalList{1, 2, 3, 4, 5}; std::list&lt;int&gt; myList4(myOriginalList); // 使用另一个list来初始化这个新的list 每个构造函数都有它们独特的用途，可以根据具体需要选择合适的构造函数进行对象的创建和初始化。
默认构造函数创建一个没有任何元素的空链表。填充构造函数允许创建一个包含特定数量相同值的元素的链表。范围构造函数可以从任何提供迭代器接口的其他容器复制元素。拷贝构造函数创建了一个当前list的副本。 填充构造函数前面的explicit关键字表明这个构造函数不能用于隐式转换或复制初始化，它需要直接调用来构造对象。其他构造函数则根据是否带有explicit关键字来决定是否能用于隐式转换或复制初始化
迭代器
迭代器用来遍历链表，下面是迭代器的简单使用
list&lt;int&gt; lt = { 10,20,30,40,50 }; list&lt;int&gt;::iterator i1 = lt.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-04-29T15:00:45+08:00">
    <meta property="article:modified_time" content="2024-04-29T15:00:45+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程学习者" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程学习者</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【c&#43;&#43;】探究C&#43;&#43;中的list：精彩的接口与仿真实现解密</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atelier-sulphurpool-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p><img src="https://images2.imgbox.com/68/a8/FKJ4QHnr_o.png" alt="Alt" width="300" height="170"></p> 
<p><font color="peru" size="4"><b>🔥个人主页</b>：<a href="https://blog.csdn.net/arf_dog?type=blog"><font color="#33CCCC" size="4"><b>Quitecoder</b></font></a></font></p> 
<p><font color="peru" size="4">🔥<strong>专栏</strong></font>：<a href="https://blog.csdn.net/arf_dog/category_12614029.html?spm=1001.2014.3001.5482"><font color="#33CCCC" size="4"><b>c++笔记仓</b></font></a></p> 
<p><img src="https://images2.imgbox.com/e6/98/HG0dhF3N_o.gif" alt="Alt"></p> 
<blockquote> 
 <p><strong>朋友们大家好，本篇文章来到list有关部分，这一部分函数与前面的类似，我们简单讲解，重难点在模拟实现时的迭代器有关实现</strong></p> 
</blockquote> 
<p></p> 
<div class="toc"> 
 <h4>目录</h4> 
 <ul><li>`1.List介绍`</li><li>`2.接口函数`</li><li><ul><li>`operations`</li></ul> 
  </li><li>`3.模拟实现`</li><li><ul><li>`3.1基本框架`</li><li>`3.2 list的基本函数`</li><li>`3.3迭代器的封装和实现`</li><li><ul><li>`++等重载函数的实现`</li><li>`与list的关联`</li></ul> 
   </li><li>`3.4list函数完善`</li><li>`3.5迭代器进一步完善`</li><li><ul><li>`const迭代器`</li><li>`合并两种迭代器`</li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="1List_15"></a><code>1.List介绍</code></h2> 
<p><img src="https://images2.imgbox.com/38/d5/TTgAH5H9_o.png" alt="在这里插入图片描述"></p> 
<ol><li>list是可以在常数范围内在任意位置进行插入和删除的序列式容器，并且该容器可以<strong>前后双向迭代</strong></li><li>list的底层是<strong>双向链表结构</strong>，双向链表中每个元素存储在互不相关的独立节点中，<strong>在节点中通过指针指向其前一个元素和后一个元素</strong></li><li>list与forward_list非常相似：最主要的不同在于forward_list是单链表，只能朝前迭代，已让其更简单高效</li><li>与其他的序列式容器相比(array，vector，deque)，<strong>list通常在任意位置进行插入、移除元素的执行效率更好</strong></li><li>与其他序列式容器相比，list和forward_list最大的缺陷是不支持任意位置的随机访问，比如：要访问list的第6个元素，必须从已知的位置(比如头部或者尾部)迭代到该位置，在这段位置上迭代<strong>需要线性的时间开销</strong>；list还需要一些额外的空间，以保存每个节点的相关联信息(对于存储类型较小元素的大list来说这可能是一个重要的因素）</li></ol> 
<blockquote> 
 <p>所以list本质就是我们的<strong>双向循环链表</strong>，我们接下来看它的接口函数</p> 
</blockquote> 
<h2><a id="2_28"></a><code>2.接口函数</code></h2> 
<p><strong>构造函数</strong><br> <img src="https://images2.imgbox.com/4f/ea/fOmqkHhI_o.png" alt="在这里插入图片描述"><br> 这里的构造函数与vector类似</p> 
<ol><li><strong>Default constructor</strong> (构造一个空的 <code>std::list</code>):</li></ol> 
<pre><code class="prism language-cpp">std<span class="token double-colon punctuation">::</span>list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> myList1<span class="token punctuation">;</span>  <span class="token comment">// 创建一个空的整型链表</span>
</code></pre> 
<ol start="2"><li><strong>Fill constructor</strong> (构造一个有特定数量元素且每个元素都有相同初始值的 <code>std::list</code>):</li></ol> 
<pre><code class="prism language-cpp">std<span class="token double-colon punctuation">::</span>list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> <span class="token function">myList2</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建一个有5个元素的链表，每个元素都初始化为10</span>
</code></pre> 
<ol start="3"><li><strong>Range constructor</strong> (从另一个迭代器定义范围的容器中构建 <code>std::list</code>):</li></ol> 
<pre><code class="prism language-cpp">std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> myVector<span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
std<span class="token double-colon punctuation">::</span>list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> <span class="token function">myList3</span><span class="token punctuation">(</span>myVector<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> myVector<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 使用vector的范围来初始化链表</span>
</code></pre> 
<ol start="4"><li><strong>Copy constructor</strong> (使用另一个 <code>std::list</code> 来构造一个新的 <code>std::list</code>, 是副本):</li></ol> 
<pre><code class="prism language-cpp">std<span class="token double-colon punctuation">::</span>list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> myOriginalList<span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
std<span class="token double-colon punctuation">::</span>list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> <span class="token function">myList4</span><span class="token punctuation">(</span>myOriginalList<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 使用另一个list来初始化这个新的list</span>
</code></pre> 
<p>每个构造函数都有它们独特的用途，可以根据具体需要选择合适的构造函数进行对象的创建和初始化。</p> 
<ul><li>默认构造函数创建一个没有任何元素的空链表。</li><li>填充构造函数允许创建一个包含特定数量相同值的元素的链表。</li><li>范围构造函数可以从任何提供迭代器接口的其他容器复制元素。</li><li>拷贝构造函数创建了一个当前<code>list</code>的副本。</li></ul> 
<blockquote> 
 <p><strong>填充构造函数前面的<code>explicit</code>关键字表明这个构造函数不能用于隐式转换或复制初始化，它需要直接调用来构造对象。其他构造函数则根据是否带有<code>explicit</code>关键字来决定是否能用于隐式转换或复制初始化</strong></p> 
</blockquote> 
<p><strong>迭代器</strong></p> 
<p><img src="https://images2.imgbox.com/cd/d3/PdTTulBW_o.png" alt="在这里插入图片描述"><br> <strong>迭代器用来遍历链表</strong>，下面是迭代器的简单使用</p> 
<pre><code class="prism language-cpp">list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> lt <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token number">10</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">50</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>iterator i1 <span class="token operator">=</span> lt<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>i1 <span class="token operator">!=</span> lt<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>i1 <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
	i1<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> e <span class="token operator">:</span> lt<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	cout <span class="token operator">&lt;&lt;</span> e <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
</code></pre> 
<p><strong>容量操作</strong></p> 
<p><img src="https://images2.imgbox.com/01/e1/AEePEzed_o.png" alt="在这里插入图片描述"></p> 
<ul><li>empty检测list是否为空，是返回true，否则返回false</li><li>size返回有效元素个数的值</li></ul> 
<p><strong>元素访问</strong></p> 
<p><img src="https://images2.imgbox.com/6d/1f/GXHd3EXs_o.png" alt="在这里插入图片描述"></p> 
<ul><li>front返回list的第一个节点值的引用</li><li>back返回list的最后一个节点值的引用</li></ul> 
<p><strong>内容操作</strong><br> <img src="https://images2.imgbox.com/aa/5d/rAxamf9e_o.png" alt="在这里插入图片描述"><br> 这里大多数函数我们在前面都讲解过，包括头插头删尾插尾删之类的</p> 
<p><strong>insert在这里不会出现迭代器失效</strong></p> 
<blockquote> 
 <p><strong>迭代器失效即迭代器所指向的节点的无效，即该节点被删除了。因为list的底层结构为带头结点的双向循环链表，因此在list中进行插入时是不会导致list的迭代器失效的，只有在删除时才会失效，并且失效的只是指向被删除节点的迭代器，其他迭代器不会受到影响</strong></p> 
</blockquote> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">TestListIterator1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> <span class="token function">l</span><span class="token punctuation">(</span>array<span class="token punctuation">,</span> array <span class="token operator">+</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">auto</span> it <span class="token operator">=</span> l<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>it <span class="token operator">!=</span> l<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		l<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token operator">++</span>it<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>erase()函数执行后，it所指向的节点已被删除，因此it无效，在下一次使用it时，必须先给其赋值</strong></p> 
<p>修改：</p> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">TestListIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
	<span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
	list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> <span class="token function">l</span><span class="token punctuation">(</span>array<span class="token punctuation">,</span> array <span class="token operator">+</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">auto</span> it <span class="token operator">=</span> l<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">while</span> <span class="token punctuation">(</span>it <span class="token operator">!=</span> l<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{<!-- --></span>
		l<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>it<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// it = l.erase(it);</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<pre><code class="prism language-cpp">l<span class="token punctuation">.</span><span class="token function">erase</span><span class="token punctuation">(</span>it<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>这一行做了以下几件事情：</p> 
<ol><li><code>it++</code> 表达式返回 <code>it</code> 的当前值（我们来称它为“旧迭代器”），然后将 <code>it</code> 自增，指向下一个元素（现在 <code>it</code> 指向“新迭代器”）。</li><li><code>l.erase(旧迭代器)</code> 调用删除了旧迭代器当前指向的元素，并使这个旧迭代器失效。</li><li>因为 <code>it</code> 已经自增，它现在指向原来被删除元素的下一个元素，因此循环可以继续。</li></ol> 
<p>请注意对于 <code>std::list</code>，这个行为是有效的，因为 <code>erase</code> 不会影响除了被删除元素之外的任何迭代器。但如果是其他类型的容器，如 <code>std::vector</code> 或 <code>std::deque</code> 中使用相同的技巧就可能会出问题，<strong>因为这些容器的 <code>erase</code> 操作可能会导致所有指向被删除元素之后元素的迭代器全部失效</strong>。因此，应谨慎地使用这种技术，并且要确认你了解容器的迭代器失效规则。</p> 
<h3><a id="operations_154"></a><code>operations</code></h3> 
<p><img src="https://images2.imgbox.com/3f/64/QmwVK83g_o.png" alt="在这里插入图片描述"><br> <code>std::list</code> 提供了一些有用的成员函数，允许执行各种操作，如元素的合并、移除、排序和倒序。下面是这些函数的简要说明和使用示例：</p> 
<ol><li><strong>splice</strong>: 将元素从一个列表<mark>转移</mark>到另一个列表，可以转移整个列表、一个单独的元素或一个元素范围。<strong>不会执行任何元素的复制或者移动操作，只是在内部节点之间调整指针。</strong></li></ol> 
<pre><code class="prism language-cpp">std<span class="token double-colon punctuation">::</span>list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> list1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
std<span class="token double-colon punctuation">::</span>list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> list2 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
list1<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>list1<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> list2<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 把list2的所有元素移动到list1的末尾</span>
</code></pre> 
<ol start="2"><li><strong>remove</strong>: 从列表中移除所有具有特定值的元素。</li></ol> 
<pre><code class="prism language-cpp">std<span class="token double-colon punctuation">::</span>list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> myList <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
myList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 移除所有值为3的元素</span>
</code></pre> 
<ol start="3"><li><strong>remove_if</strong>: 根据一个判断条件移除元素。</li></ol> 
<pre><code class="prism language-cpp">std<span class="token double-colon punctuation">::</span>list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> myList <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
myList<span class="token punctuation">.</span><span class="token function">remove_if</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span> <span class="token keyword">return</span> n <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 移除myList中所有偶数元素</span>
</code></pre> 
<ol start="4"><li><strong>unique</strong>: 移除连续并且重复的元素，只保留唯一的元素。</li></ol> 
<pre><code class="prism language-cpp">std<span class="token double-colon punctuation">::</span>list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> myList <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
myList<span class="token punctuation">.</span><span class="token function">unique</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 移除相邻重复的元素，列表变为1, 2, 3, 4, 5</span>
</code></pre> 
<ol start="5"><li><strong>merge</strong>: 合并两个已排序的列表，并确保结果列表也是排序的。</li></ol> 
<pre><code class="prism language-cpp">std<span class="token double-colon punctuation">::</span>list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> list1 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
std<span class="token double-colon punctuation">::</span>list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> list2 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
list1<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span>list2<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 合并两个列表为1, 2, 3, 4, 5, 6</span>
</code></pre> 
<ol start="6"><li><strong>sort</strong>: 对列表中的元素进行排序。它接受一个比较函数作为参数（可选）。</li></ol> 
<pre><code class="prism language-cpp">std<span class="token double-colon punctuation">::</span>list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> myList <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
myList<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 排序列表为1, 2, 3, 4, 5</span>
</code></pre> 
<ol start="7"><li><strong>reverse</strong>: 反转列表中元素的顺序。</li></ol> 
<pre><code class="prism language-cpp">std<span class="token double-colon punctuation">::</span>list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> myList <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
myList<span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 反转后列表为5, 4, 3, 2, 1</span>
</code></pre> 
<p>这些操作与 <code>std::list</code> 的双向链表特性和内部实现密切相关。例如，<code>splice</code> 不产生元素复制，因为链表中的节点可以简单地重新链接。对于排序操作，<code>std::list</code> 提供了特定的成员函数 <code>sort</code> 以优化排序算法，因为链表不支持随机访问，标准的排序算法（如 <code>std::sort</code>）不适用。</p> 
<h2><a id="3_212"></a><code>3.模拟实现</code></h2> 
<h3><a id="31_214"></a><code>3.1基本框架</code></h3> 
<pre><code class="prism language-cpp"><span class="token keyword">namespace</span> own <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
    <span class="token keyword">struct</span> <span class="token class-name">ListNode</span>
    <span class="token punctuation">{<!-- --></span>
        ListNode<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">*</span> _next<span class="token punctuation">;</span>
        ListNode<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">*</span> _prev<span class="token punctuation">;</span>
        T _data<span class="token punctuation">;</span>

        <span class="token function">ListNode</span><span class="token punctuation">(</span><span class="token keyword">const</span> T<span class="token operator">&amp;</span>x<span class="token operator">=</span><span class="token function">T</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token operator">:</span><span class="token function">_next</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
            <span class="token punctuation">,</span> <span class="token function">_prev</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span>
            <span class="token punctuation">,</span> <span class="token function">_data</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
    <span class="token keyword">class</span> <span class="token class-name">list</span> 
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">typedef</span> ListNode<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> Node<span class="token punctuation">;</span>
    <span class="token keyword">private</span><span class="token operator">:</span>
        Node<span class="token operator">*</span> _head<span class="token punctuation">;</span>
        size_t _size<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>这段代码实现了一个简单双向链表的基础结构。让我们分两部分来解释这个代码：</p> 
<ol><li> <p><code>namespace own</code>：<strong>命名空间 <code>own</code> 用于封装代码，避免与其他库中的同名类型或函数冲突。在这个命名空间中，定义了模板类 <code>ListNode</code> 和模板类 <code>list</code></strong>。</p> </li><li> <p>模板类 <code>ListNode</code> 的定义：</p> <pre><code class="prism language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
<span class="token keyword">struct</span> <span class="token class-name">ListNode</span> <span class="token punctuation">{<!-- --></span>
    ListNode<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">*</span> _next<span class="token punctuation">;</span>
    ListNode<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">*</span> _prev<span class="token punctuation">;</span>
    T _data<span class="token punctuation">;</span>

    <span class="token function">ListNode</span><span class="token punctuation">(</span><span class="token keyword">const</span> T<span class="token operator">&amp;</span> x<span class="token operator">=</span><span class="token function">T</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token operator">:</span> <span class="token function">_next</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">_prev</span><span class="token punctuation">(</span><span class="token keyword">nullptr</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">_data</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <p>这是一个结构体模板，它定义了双向链表的一个节点。每个 <code>ListNode</code> 包含三个成员：</p> 
  <ul><li><code>_next</code> 指向下一个 <code>ListNode</code> 的指针</li><li><code>_prev</code> 指向前一个 <code>ListNode</code> 的指针</li><li><code>_data</code> 存储节点的数据，其类型为模板参数 <code>T</code></li></ul> <p><code>ListNode</code> 还有一个<strong>构造函数</strong>，它接受一个 <code>const T&amp;</code> 类型的参数，如果构造函数没有提供参数，则会使用 <code>T</code> 类型的默认构造函数来初始化 <code>_data</code>。构造函数还将 <code>_next</code> 和 <code>_prev</code> 初始化为 <code>nullptr</code>，表示链表的下一个和前一个节点分别不存在</p> </li><li> <p>模板类 <code>list</code> 的定义：</p> <pre><code class="prism language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
<span class="token keyword">class</span> <span class="token class-name">list</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">typedef</span> ListNode<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> Node<span class="token punctuation">;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    Node<span class="token operator">*</span> _head<span class="token punctuation">;</span>
    size_t _size<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <p>这个类表示双向链表本身：</p> 
  <ul><li>类型定义 <code>typedef ListNode&lt;T&gt; Node</code> 是为了简化代码，使得在类 <code>list</code> 中可以直接使用 <code>Node</code> 来指代 <code>ListNode&lt;T&gt;</code>。</li><li><code>_head</code> 是一个指向链表头部节点的指针。</li><li><code>_size</code> 是一个 <code>size_t</code> 类型的值，用来存储链表的长度（即节点个数）。</li></ul> </li></ol> 
<h3><a id="32_list_279"></a><code>3.2 list的基本函数</code></h3> 
<p><mark><strong><big><font color="blue"> 🔥list()<big></big></font><strong></strong></big></strong></mark></p> 
<pre><code class="prism language-cpp"><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    _head <span class="token operator">=</span> <span class="token keyword">new</span> Node<span class="token punctuation">;</span>
    _head<span class="token operator">-&gt;</span>_next <span class="token operator">=</span> _head<span class="token punctuation">;</span>
    _head<span class="token operator">-&gt;</span>_prev <span class="token operator">=</span> _head<span class="token punctuation">;</span>
    _size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<blockquote> 
 <p><strong>带头双向循环链表，我们初始化时让它的头结点的前一个指针和后一个指针指向自身</strong></p> 
</blockquote> 
<p><mark><strong><big><font color="blue"> 🔥尾插push_back()<big></big></font><strong></strong></big></strong></mark></p> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">push_back</span><span class="token punctuation">(</span><span class="token keyword">const</span> T<span class="token operator">&amp;</span> x<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    Node<span class="token operator">*</span> newnode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Node</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Node<span class="token operator">*</span> tail <span class="token operator">=</span> _head<span class="token operator">-&gt;</span>_prev<span class="token punctuation">;</span>
    tail<span class="token operator">-&gt;</span>_next <span class="token operator">=</span> newnode<span class="token punctuation">;</span>
    newnode<span class="token operator">-&gt;</span>_prev <span class="token operator">=</span> tail<span class="token punctuation">;</span>
    newnode<span class="token operator">-&gt;</span>_next <span class="token operator">=</span> _head<span class="token punctuation">;</span>
    _head<span class="token operator">-&gt;</span>_prev <span class="token operator">=</span> newnode<span class="token punctuation">;</span>
    _size<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/d4/0f/Kyd1VUSp_o.png" alt="在这里插入图片描述"></p> 
<ul><li><strong>获取尾节点，即head的上一个位置</strong></li><li><strong>更新四个指针即可</strong></li></ul> 
<blockquote> 
 <p><strong>那我们完成了尾插工作，接下来如何实现下面的遍历呢？</strong></p> 
</blockquote> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> lt<span class="token punctuation">;</span>
    lt<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lt<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lt<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lt<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lt<span class="token punctuation">.</span><span class="token function">push_front</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>iterator it <span class="token operator">=</span> lt<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>it <span class="token operator">!=</span> lt<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>it <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
        <span class="token operator">++</span>it<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>这部分来到本篇的重点，迭代器的封装和实现</strong></p> 
<h3><a id="33_334"></a><code>3.3迭代器的封装和实现</code></h3> 
<blockquote> 
 <p><strong>我们思考一下，这里原生指针能否代替迭代器？</strong></p> 
</blockquote> 
<p><img src="https://images2.imgbox.com/d5/5c/MQF4Zqp5_o.png" alt="在这里插入图片描述"><br> 我这里的指针，<mark>只能是Node*</mark>，<mark>Node*++不会加到下一个节点，这里的++需要我们自己重载实现</mark>，解引用也取不到当前节点的位置，这些函数都需要我们自己重载实现，所以，我们需要对迭代器进行<strong>封装</strong></p> 
<pre><code class="prism language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
<span class="token keyword">struct</span> <span class="token class-name">ListIterator</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">typedef</span> ListNode<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> Node<span class="token punctuation">;</span>
    Node<span class="token operator">*</span> _node<span class="token punctuation">;</span>
    <span class="token function">ListIterator</span><span class="token punctuation">(</span>Node<span class="token operator">*</span> node<span class="token punctuation">)</span>
        <span class="token operator">:</span><span class="token function">_node</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p>注意，我们迭代器实在list类域访问的:</p> 
<pre><code class="prism language-cpp">list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>iterator it <span class="token operator">=</span> lt<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>这里我们就需要在list类里面<strong>进行嵌套</strong></p> 
<pre><code class="prism language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
<span class="token keyword">class</span> <span class="token class-name">list</span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token comment">// 这是一个嵌套类型的别名定义。</span>
    <span class="token keyword">typedef</span> ListIterator<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> iterator<span class="token punctuation">;</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p><code>list&lt;int&gt;::iterator it = lt.begin();</code> 这一行涉及到了所谓的<strong>嵌套类型</strong>或者<strong>内嵌类型</strong>。</p> 
<p>在C++中，当一个类型（比如 <code>ListIterator&lt;T&gt;</code>）是在另一个类型的作用域内部定义的（比如 <code>list&lt;T&gt;</code>）时，这个类型被称为<strong>嵌套类型</strong>。嵌套类型通常用于与外部类型紧密相关联的概念，例如迭代器、节点或其他辅助类。</p> 
<p>在 <code>list</code> 类中定义了 <code>iterator</code> 类型作为 <code>ListIterator&lt;T&gt;</code> 类型的别名：</p> 
<pre><code class="prism language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
<span class="token keyword">class</span> <span class="token class-name">list</span> <span class="token punctuation">{<!-- --></span>
<span class="token keyword">public</span><span class="token operator">:</span>  
    <span class="token keyword">typedef</span> ListIterator<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> iterator<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p>这里的 <code>iterator</code> 是 <code>list</code> 类的嵌套类型的别名，所以当我们在类外部引用它时，我们需要使用类的名称（在这个例子中是 <code>list&lt;int&gt;</code>），后跟两个冒号来限定作用域，然后是别名 <code>iterator</code>。<mark>因此 <code>list&lt;int&gt;::iterator</code> 指的是 <code>ListIterator&lt;int&gt;</code></mark>，<strong>它是链接到特定的 <code>list</code> 实例化类型的迭代器类型</strong></p> 
<blockquote> 
 <p>要点是，<strong>内嵌类型</strong>通常在类定义内部，并且与该类紧密关联。当我们在类外部谈到这些类型时，需要使用类的名称来限定这些类型，就像我们引用 <code>list&lt;int&gt;::iterator</code> 一样。这种设计方式提供了良好的封装和组织结构，在集合和容器类（如 <code>list</code>）中是一种常见做法</p> 
</blockquote> 
<p>迭代器就是一个节点的指针，我们这个类的成员就是<code>_node（节点指针）</code></p> 
<pre><code class="prism language-cpp"> <span class="token keyword">typedef</span> ListNode<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> Node<span class="token punctuation">;</span>
    Node<span class="token operator">*</span> _node<span class="token punctuation">;</span>
    <span class="token function">ListIterator</span><span class="token punctuation">(</span>Node<span class="token operator">*</span> node<span class="token punctuation">)</span>
        <span class="token operator">:</span><span class="token function">_node</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
</code></pre> 
<p><mark>这里用一个节点的指针就可以对迭代器进行初始化</mark></p> 
<h4><a id="_402"></a><code>++等重载函数的实现</code></h4> 
<p>这个封装类的关键就是对这进行重载函数</p> 
<p><mark><strong><big><font color="blue"> 🔥operator++()与operator- -()<big></big></font><strong></strong></big></strong></mark></p> 
<p>这里++加到下一个节点，改变节点指针：</p> 
<p><mark>前置++</mark></p> 
<pre><code class="prism language-cpp"><span class="token keyword">typedef</span> ListIterator<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> Self
Self<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">++</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    _node <span class="token operator">=</span> _node<span class="token operator">-&gt;</span>_next<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><mark>后置++</mark></p> 
<pre><code class="prism language-cpp">Self <span class="token keyword">operator</span><span class="token operator">++</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    Self <span class="token function">tmp</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    _node <span class="token operator">=</span> _node<span class="token operator">-&gt;</span>_next<span class="token punctuation">;</span>
    <span class="token keyword">return</span> tmp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>先<strong>拷贝构造</strong>一份，返回++之前的值</p> 
<blockquote> 
 <p><strong>这里迭代器我们没有写拷贝构造，调用默认的拷贝构造进行浅拷贝，这里的浅拷贝是可以的，因为我的期望就是两个指针都只向同一个节点</strong></p> 
</blockquote> 
<pre><code class="prism language-cpp">Self<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">--</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    _node <span class="token operator">=</span> _node<span class="token operator">-&gt;</span>_prev<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

Self <span class="token keyword">operator</span><span class="token operator">--</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    Self <span class="token function">tmp</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    _node <span class="token operator">=</span> _node<span class="token operator">-&gt;</span>_prev<span class="token punctuation">;</span>

    <span class="token keyword">return</span> tmp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><mark><strong><big><font color="blue"> 🔥operator*()<big></big></font><strong></strong></big></strong></mark></p> 
<p>这里解引用<strong>得到节点的值</strong>，需要我们自己手动重载实现：</p> 
<pre><code class="prism language-cpp">T<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> _node<span class="token operator">-&gt;</span>_data<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><mark>这里返回的是引用值，是对原数据可直接修改的</mark></p> 
<p><mark><strong><big><font color="blue"> 🔥operator!=()<big></big></font><strong></strong></big></strong></mark></p> 
<p>我们在循环中还有判断两个迭代器不相等，<mark>本质就是两个节点指针不相等</mark></p> 
<pre><code class="prism language-cpp"><span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Self<span class="token operator">&amp;</span> it<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> _node <span class="token operator">!=</span> it<span class="token punctuation">.</span>_node<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<blockquote> 
 <p><strong>基本完成类的封装后，我们需要把它和list连起来</strong></p> 
</blockquote> 
<h4><a id="list_475"></a><code>与list的关联</code></h4> 
<p><img src="https://images2.imgbox.com/3a/6e/5GrxokuD_o.png" alt="在这里插入图片描述"><br> <mark>这里begin和end只能由list提供</mark></p> 
<pre><code class="prism language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
<span class="token keyword">class</span> <span class="token class-name">list</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">typedef</span> ListNode<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> Node<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">typedef</span> ListIterator<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> iterator<span class="token punctuation">;</span>

    iterator <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token function">iterator</span><span class="token punctuation">(</span>_head<span class="token operator">-&gt;</span>_next<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//匿名对象</span>
    <span class="token punctuation">}</span>
    iterator <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token function">iterator</span><span class="token punctuation">(</span>_head<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//最后一个位置的下一个位置</span>
    <span class="token punctuation">}</span>
    <span class="token char">''</span><span class="token char">''</span><span class="token char">''</span><span class="token char">''</span><span class="token char">''</span><span class="token char">''</span><span class="token char">''</span><span class="token char">''</span><span class="token char">''</span><span class="token char">''</span><span class="token char">''</span><span class="token char">''</span><span class="token char">''</span><span class="token char">''</span><span class="token char">''</span><span class="token char">''</span><span class="token char">''</span><span class="token char">''</span>
    <span class="token comment">//其他函数</span>
    <span class="token keyword">private</span><span class="token operator">:</span>
    Node<span class="token operator">*</span> _head<span class="token punctuation">;</span>
    size_t _size<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p>begin返回第一个数据的<mark>迭代器</mark>，<strong>end返回最后一个数据的下一个位置</strong></p> 
<p>测试代码：</p> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> lt<span class="token punctuation">;</span>
    lt<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lt<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lt<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lt<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>iterator it <span class="token operator">=</span> lt<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>it <span class="token operator">!=</span> lt<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>it <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
        <span class="token operator">++</span>it<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    cout <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/48/c6/ficIsOyu_o.png" alt="在这里插入图片描述"></p> 
<blockquote> 
 <p><strong>由于我的外部代码使用了iterator别名，这里<code>typedef ListIterator&lt;T&gt; iterator;</code>必须放在public下</strong></p> 
</blockquote> 
<h3><a id="34list_526"></a><code>3.4list函数完善</code></h3> 
<p>有了迭代器，我们就可以完善其他的list函数</p> 
<p><mark><strong><big><font color="blue"> 🔥insert()<big></big></font><strong></strong></big></strong></mark></p> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">insert</span><span class="token punctuation">(</span>iterator pos<span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">&amp;</span> val<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    Node<span class="token operator">*</span> cur <span class="token operator">=</span> pos<span class="token punctuation">.</span>_node<span class="token punctuation">;</span><span class="token comment">//拿到这个位置的节点</span>
    Node<span class="token operator">*</span> newnode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Node</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Node<span class="token operator">*</span> prev <span class="token operator">=</span> cur<span class="token operator">-&gt;</span>_prev<span class="token punctuation">;</span>
    prev<span class="token operator">-&gt;</span>_next <span class="token operator">=</span> newnode<span class="token punctuation">;</span>
    newnode<span class="token operator">-&gt;</span>_prev <span class="token operator">=</span> prev<span class="token punctuation">;</span>
    newnode<span class="token operator">-&gt;</span>_next <span class="token operator">=</span> cur<span class="token punctuation">;</span>
    cur<span class="token operator">-&gt;</span>_prev <span class="token operator">=</span> newnode<span class="token punctuation">;</span>
    _size<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><mark><strong><big><font color="blue"> 🔥erase()<big></big></font><strong></strong></big></strong></mark></p> 
<pre><code class="prism language-cpp">iterator <span class="token function">erase</span><span class="token punctuation">(</span>iterator pos<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    Node<span class="token operator">*</span> cur <span class="token operator">=</span> pos<span class="token punctuation">.</span>_node<span class="token punctuation">;</span>
    Node<span class="token operator">*</span> prev <span class="token operator">=</span> cur<span class="token operator">-&gt;</span>_prev<span class="token punctuation">;</span>
    Node<span class="token operator">*</span> next <span class="token operator">=</span> cur<span class="token operator">-&gt;</span>_next<span class="token punctuation">;</span>

    prev<span class="token operator">-&gt;</span>_next <span class="token operator">=</span> next<span class="token punctuation">;</span>
    next<span class="token operator">-&gt;</span>_prev <span class="token operator">=</span> prev<span class="token punctuation">;</span>
    <span class="token keyword">delete</span> cur<span class="token punctuation">;</span>
    <span class="token operator">--</span>_size<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">iterator</span><span class="token punctuation">(</span>next<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>erase删除返回的是<strong>下一个位置的迭代器</strong></p> 
<p><mark><strong><big><font color="blue"> 🔥头尾删插<big></big></font><strong></strong></big></strong></mark></p> 
<p>有了insert和erase，我们这几个函数就可以直接进行<strong>复用</strong></p> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">push_front</span><span class="token punctuation">(</span><span class="token keyword">const</span> T<span class="token operator">&amp;</span> x<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">insert</span><span class="token punctuation">(</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">push_back</span><span class="token punctuation">(</span><span class="token keyword">const</span> T<span class="token operator">&amp;</span> x<span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">insert</span><span class="token punctuation">(</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">erase</span><span class="token punctuation">(</span><span class="token operator">--</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">pop_front</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">erase</span><span class="token punctuation">(</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>与size相关函数：</p> 
<pre><code class="prism language-cpp">size_t <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> _size<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">bool</span> <span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> _size <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><mark><strong><big><font color="blue"> 🔥链表销毁<big></big></font><strong></strong></big></strong></mark></p> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    iterator it <span class="token operator">=</span> <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>it <span class="token operator">!=</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        it <span class="token operator">=</span> <span class="token function">erase</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">~</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">delete</span> _head<span class="token punctuation">;</span>
    _head <span class="token operator">=</span> <span class="token keyword">nullptr</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="35_616"></a><code>3.5迭代器进一步完善</code></h3> 
<p>对于下面的这种类</p> 
<pre><code class="prism language-cpp"> <span class="token keyword">struct</span> <span class="token class-name">A</span>
 <span class="token punctuation">{<!-- --></span>
     <span class="token keyword">int</span> _a1<span class="token punctuation">;</span>
     <span class="token keyword">int</span> _a2<span class="token punctuation">;</span>

     <span class="token function">A</span><span class="token punctuation">(</span><span class="token keyword">int</span> a1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">int</span> a2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span>
         <span class="token operator">:</span><span class="token function">_a1</span><span class="token punctuation">(</span>a1<span class="token punctuation">)</span>
         <span class="token punctuation">,</span> <span class="token function">_a2</span><span class="token punctuation">(</span>a2<span class="token punctuation">)</span>
     <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
 <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p>如果list存的是上面的自定义类型呢？</p> 
<p>插入有以下几种方法：</p> 
<pre><code class="prism language-cpp"><span class="token keyword">void</span> <span class="token function">test_list2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    list<span class="token operator">&lt;</span>A<span class="token operator">&gt;</span> lt<span class="token punctuation">;</span>
    A <span class="token function">aa1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    A aa2 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    lt<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>aa1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    lt<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>aa2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    lt<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token function">A</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lt<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    lt<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>
</code></pre> 
<p>上面代码使用不同方式来创建和插入 <code>A</code> 类型的对象到自定义的 <code>list</code> 容器中。下面是每种方式的详细说明以及它们所涉及的概念：</p> 
<ol><li> <p><strong>有名对象的直接插入</strong>:</p> <pre><code class="prism language-cpp">A <span class="token function">aa1</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
lt<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>aa1<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <p>这里，首先创建了一个命名对象 <code>aa1</code>，使用了 <code>A</code> 的构造函数 <code>A(int a1, int a2)</code> 并为其提供了两个参数。然后，你将 <code>aa1</code> 作为参数传递给 <code>lt.push_back()</code> 函数。在这种情况下，<code>aa1</code> 是有名对象（也就是说，它有一个名称），并且 <code>push_back</code> 函数接受到的是 <code>aa1</code> 的一个副本</p> </li><li> <p><strong>多参数隐式类型转换</strong>:</p> <pre><code class="prism language-cpp">A aa2 <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
lt<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>aa2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <p><code>aa2</code> 通过列表初始化的方式被创建。这里的列表初始化允许直接用花括号 <code>{}</code> 来初始化对象。C++11 引入的列表初始化特性可以用来初始化任何对象，包括具有构造函数的对象。创建了 <code>aa2</code> 有名对象并将其插入到列表中</p> </li><li> <p><strong>通过构造函数创建匿名对象并插入</strong>:</p> <pre><code class="prism language-cpp">lt<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token function">A</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <p><strong>在这里，没有给新创建的 <code>A</code> 对象一个名字，因此它是一个匿名对象（也称作临时对象）</strong>。这个匿名的 <code>A</code> 对象是通过调用它的构造函数来直接初始化的，并立即被传递到 <code>push_back</code> 函数中。</p> </li><li> <p><strong>通过隐式类型转换创建匿名对象并插入</strong>:</p> <pre><code class="prism language-cpp">lt<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token punctuation">{<!-- --></span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <p>与第三种方式类似，创隐式类型转换建了一个匿名的 <code>A</code> 对象，但这次是通过。初始化时没有使用相应类型的构造函数，而是依赖编译器生成的代码来创建一个具有给定初始化列表的对象，并将其传递给 <code>push_back</code> 函数。</p> </li></ol> 
<p>在所有这些情况中，实际插入到 <code>list</code> 容器中的都是 <code>A</code></p> 
<p>现在我们来进行遍历：</p> 
<pre><code class="prism language-cpp">list<span class="token operator">&lt;</span>A<span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span>iterator it <span class="token operator">=</span> lt<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>it <span class="token operator">!=</span> lt<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    cout<span class="token operator">&lt;&lt;</span><span class="token operator">*</span>it<span class="token operator">&lt;&lt;</span><span class="token string">" "</span><span class="token punctuation">;</span>
    <span class="token operator">++</span>it<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/9a/44/nlN8ZxE9_o.png" alt="在这里插入图片描述"><br> <strong>A是自定义类型，不支持留插入，我们解引用得到的_data是A的对象</strong></p> 
<p>这里数据是公有的，解引用得到的可以通过<code>.</code>访问符进行访问</p> 
<pre><code class="prism language-cpp">cout <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token operator">*</span>it<span class="token punctuation">)</span><span class="token punctuation">.</span>_a1 <span class="token operator">&lt;&lt;</span> <span class="token string">":"</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token operator">*</span>it<span class="token punctuation">)</span><span class="token punctuation">.</span>_a2 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
</code></pre> 
<p>这种访问方式相当于这种形式：</p> 
<pre><code class="prism language-cpp">A<span class="token operator">*</span> ptr <span class="token operator">=</span> <span class="token operator">&amp;</span>aa1<span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token operator">*</span>ptr<span class="token punctuation">)</span><span class="token punctuation">.</span>_a1<span class="token punctuation">;</span>
</code></pre> 
<p>这种指针访问行为十分复杂，<strong>我们可以重载一个函数使实现这种访问方式</strong>：</p> 
<pre><code class="prism language-cpp">ptr<span class="token operator">-&gt;</span>_a1<span class="token punctuation">;</span>
</code></pre> 
<p>在迭代器中重载<code>-&gt;</code>运算符</p> 
<pre><code class="prism language-cpp">T<span class="token operator">*</span> <span class="token keyword">operator</span><span class="token operator">-&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token operator">&amp;</span>_node<span class="token operator">-&gt;</span>_data<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>这里返回的是_data的地址</p> 
<p>我们就可以这样访问：</p> 
<pre><code class="prism language-cpp">cout <span class="token operator">&lt;&lt;</span> it<span class="token operator">-&gt;</span>_a1 <span class="token operator">&lt;&lt;</span> <span class="token string">":"</span> <span class="token operator">&lt;&lt;</span> it<span class="token operator">-&gt;</span>_a2 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
</code></pre> 
<p>实际上它的访问方式如下：</p> 
<pre><code class="prism language-cpp">cout <span class="token operator">&lt;&lt;</span> it<span class="token punctuation">.</span><span class="token keyword">operator</span><span class="token operator">-&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span>_a1 <span class="token operator">&lt;&lt;</span> <span class="token string">":"</span> <span class="token operator">&lt;&lt;</span> it<span class="token punctuation">.</span><span class="token keyword">operator</span><span class="token operator">-&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span>_a2 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
</code></pre> 
<p><font size="5" color="red">注意</font></p> 
<p><mark>这里隐藏了一个箭头，一个是重载，一个是原生指针的访问操作</mark></p> 
<p>实际上，并不需要在代码中写两次箭头。这是因为在 C++ 中，<code>operator-&gt;</code> 有一个特殊的规则</p> 
<blockquote> 
 <p><strong>当重载 <code>operator-&gt;</code>，不会直接返回成员的值，而是应该返回一个指针，这个指针指向的对象包含我们想要访问的成员。当使用 <code>-&gt;</code>运算符时，C++ 会自动和透明地调用重载的 <code>operator-&gt;</code> 并继续 “链式” 访问成员，而不需要程序员显示地添加多余的箭头。</strong></p> 
</blockquote> 
<p>这是如何工作的：</p> 
<ol><li>如果有一个用户自定义类型的对象（比如迭代器）<code>it</code>，并且我们调用 <code>it-&gt;member</code>，编译器会查找这个类型是否有 <code>operator-&gt;</code></li><li>如果这个类型有一个 <code>operator-&gt;</code> 的重载，编译器就调用 <code>it.operator-&gt;()</code></li><li><code>it.operator-&gt;()</code> 应该返回一个指向对象的指针，这个对象有一个我们尝试访问的 <code>member</code> 成员</li><li>编译器取得这个指针，并继续访问 <code>member</code></li></ol> 
<blockquote> 
 <p><strong>这个流程只需要一个 <code>-&gt;</code> 即可。编译器在背后处理了所有操作，直到访问到一个实际对象，然后这个对象的成员可以直接通过 <code>-&gt;</code> 运算符访问</strong></p> 
</blockquote> 
<p><mark>因此，我们不需要手动写成 <code>it-&gt;-&gt;member</code>；只需写 <code>it-&gt;member</code> 即可。编译器会自动将其 “转换” 为 <code>it.operator-&gt;()-&gt;member</code></mark></p> 
<p>在 <code>ListIterator</code> 示例里，<code>it-&gt;_a1</code> 意味着：</p> 
<ol><li>调用 <code>it.operator-&gt;()</code> 拿到 <code>ListNode</code> 中 <code>_data</code> 成员的地址（这是一个 <code>A</code> 类型的对象）。</li><li>使用返回的指针来访问 <code>A</code> 对象的 <code>_a1</code> 成员。</li></ol> 
<p><strong>整个过程对于编程者来说是透明的，不需要编写多个 <code>-&gt;</code>。这种处理方式使得重载 <code>-&gt;</code> 可以更自然地使用，就像处理普通的指针一样</strong>。</p> 
<h4><a id="const_763"></a><code>const迭代器</code></h4> 
<p>我们上面写的迭代器对于const对象是无法编译成功的，<strong>const不能调用非const成员函数</strong></p> 
<p><strong>对于const类迭代器，我们需要在list类里面重新增加重载</strong>：</p> 
<pre><code class="prism language-cpp"><span class="token keyword">typedef</span> ConstListIterator<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> const_iterator<span class="token punctuation">;</span>

const_iterator <span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> _head<span class="token operator">-&gt;</span>_next<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

const_iterator <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> _head<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p>使普通版本调用普通版本，const调用const版本</p> 
<p>这里的const迭代器<mark>不能</mark>是下面这种形式，而需单独创建版本：</p> 
<pre><code class="prism language-cpp"><span class="token keyword">const</span> iterator <span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> _head<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><mark>因为const迭代器的本质是迭代器指向的内容不能修改，而不是迭代器本身不能修改</mark></p> 
<p><strong><code>const iterator</code>这样定义是迭代器不能修改，内容还是可以修改的</strong></p> 
<p>那我们如何实现const迭代器呢？</p> 
<p>方法一：单独实现一个类，修改正常版本的迭代器</p> 
<pre><code class="prism language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
<span class="token keyword">struct</span> <span class="token class-name">ConstListIterator</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">typedef</span> ListNode<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> Node<span class="token punctuation">;</span>
    <span class="token keyword">typedef</span> ConstListIterator<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> Self<span class="token punctuation">;</span>
    Node<span class="token operator">*</span> _node<span class="token punctuation">;</span>
    <span class="token function">ListIterator</span><span class="token punctuation">(</span>Node<span class="token operator">*</span> node<span class="token punctuation">)</span>
        <span class="token operator">:</span><span class="token function">_node</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
    <span class="token keyword">const</span> T<span class="token operator">*</span> <span class="token keyword">operator</span><span class="token operator">-&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token operator">&amp;</span>_node<span class="token operator">-&gt;</span>_data<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> T<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> _node<span class="token operator">-&gt;</span>_data<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    Self<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">++</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        _node <span class="token operator">=</span> _node<span class="token operator">-&gt;</span>_next<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    Self <span class="token keyword">operator</span><span class="token operator">++</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        Self <span class="token function">tmp</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        _node <span class="token operator">=</span> _node<span class="token operator">-&gt;</span>_next<span class="token punctuation">;</span>
        <span class="token keyword">return</span> tmp<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    Self<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">--</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        _node <span class="token operator">=</span> _node<span class="token operator">-&gt;</span>_prev<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    Self <span class="token keyword">operator</span><span class="token operator">--</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        Self <span class="token function">tmp</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        _node <span class="token operator">=</span> _node<span class="token operator">-&gt;</span>_prev<span class="token punctuation">;</span>

        <span class="token keyword">return</span> tmp<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">!=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Self<span class="token operator">&amp;</span> it<span class="token punctuation">)</span>
    <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> _node <span class="token operator">!=</span> it<span class="token punctuation">.</span>_node<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p>我们目的是不修改指向的值，只需要在这两个函数前面加上const即可：</p> 
<pre><code class="prism language-cpp"><span class="token keyword">const</span> T<span class="token operator">*</span> <span class="token keyword">operator</span><span class="token operator">-&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> <span class="token operator">&amp;</span>_node<span class="token operator">-&gt;</span>_data<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> T<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{<!-- --></span>
    <span class="token keyword">return</span> _node<span class="token operator">-&gt;</span>_data<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/92/9b/ipSJqiXt_o.png" alt="在这里插入图片描述"><br> <strong>我们这两个类只有这两个函数不同，那么能不能将他们两个合并呢？</strong></p> 
<h4><a id="_865"></a><code>合并两种迭代器</code></h4> 
<p><strong>这里仅是两种返回类型不同，这里我们利用模版来对这里内容进行合并</strong></p> 
<pre><code class="prism language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">Ref</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">Ptr</span><span class="token operator">&gt;</span>
	<span class="token keyword">struct</span> <span class="token class-name">ListIterator</span>
	<span class="token punctuation">{<!-- --></span>
		<span class="token keyword">typedef</span> ListNode<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> Node<span class="token punctuation">;</span>
		<span class="token keyword">typedef</span> ListIterator<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> Ref<span class="token punctuation">,</span> Ptr<span class="token operator">&gt;</span> Self<span class="token punctuation">;</span>
		Node<span class="token operator">*</span> _node<span class="token punctuation">;</span>
		<span class="token function">ListIterator</span><span class="token punctuation">(</span>Node<span class="token operator">*</span> node<span class="token punctuation">)</span>
			<span class="token operator">:</span><span class="token function">_node</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span><span class="token punctuation">}</span>
		<span class="token comment">// *it</span>
		<span class="token comment">//T&amp; operator*()</span>
		Ref <span class="token keyword">operator</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> _node<span class="token operator">-&gt;</span>_data<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token comment">// it-&gt;</span>
		<span class="token comment">//T* operator-&gt;()</span>
		Ptr <span class="token keyword">operator</span><span class="token operator">-&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">{<!-- --></span>
			<span class="token keyword">return</span> <span class="token operator">&amp;</span>_node<span class="token operator">-&gt;</span>_data<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p><strong>我们只提取不同的部分，其他部分与原来相同</strong></p> 
<p>Ref代表引用，Ptr代表指针</p> 
<p>让我们来看一下这个合并后的迭代器的模板参数：</p> 
<ul><li><code>T</code>：<strong>列表节点存储的数据类型</strong></li><li><code>Ref</code>：<strong>通过迭代器访问数据时的返回类型，可以是<code>T&amp;</code>或者<code>const T&amp;</code>。</strong></li><li><code>Ptr</code>：<strong>通过迭代器访问数据的指针类型，可以是<code>T*</code>或者<code>const T*</code>。</strong></li></ul> 
<p>这样，我们可以创建一个常量迭代器，为<code>Ref</code>和<code>Ptr</code>参数指定常量类型，例如：</p> 
<pre><code class="prism language-cpp">ListIterator<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">*</span><span class="token operator">&gt;</span> const_iterator<span class="token punctuation">;</span>
</code></pre> 
<p>对于非常量迭代器，就简单地传递非常量类型的引用和指针：</p> 
<pre><code class="prism language-cpp">ListIterator<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> T<span class="token operator">&amp;</span><span class="token punctuation">,</span> T<span class="token operator">*</span><span class="token operator">&gt;</span> iterator<span class="token punctuation">;</span>
</code></pre> 
<p>在<code>list</code>类中，我们需要相应地声明两种类型的迭代器：</p> 
<pre><code class="prism language-cpp"><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token class-name">T</span><span class="token operator">&gt;</span>
<span class="token keyword">class</span> <span class="token class-name">list</span> <span class="token punctuation">{<!-- --></span>
    <span class="token comment">// ... 省略其他代码 ...</span>

<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">typedef</span> ListIterator<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> T<span class="token operator">&amp;</span><span class="token punctuation">,</span> T<span class="token operator">*</span><span class="token operator">&gt;</span> iterator<span class="token punctuation">;</span>
    <span class="token keyword">typedef</span> ListIterator<span class="token operator">&lt;</span>T<span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">&amp;</span><span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">*</span><span class="token operator">&gt;</span> const_iterator<span class="token punctuation">;</span>

    <span class="token comment">// ... 省略其他代码 ...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> 
<p><strong><code>list</code>类中的其他成员函数像<code>begin</code>、<code>end</code>需要按照是否接收常量类型来适配这两种迭代器。</strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c0ee35fe225f055c650e8373f77b753e/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【赠书第22期】AI绘画全面精通</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/e70e5d33ac819c8904da3cc4fe2e71c5/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Android 开发 OCR 拍照 &#43; ML Kit 识别文字 巨详细全部代码教程</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程学习者.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
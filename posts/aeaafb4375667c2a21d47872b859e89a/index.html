<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>合成孔径雷达(SAR)RD算法点目标成像与分析Matlab仿真 - 编程学习者</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcxuexizhe.github.io/posts/aeaafb4375667c2a21d47872b859e89a/">
  <meta property="og:site_name" content="编程学习者">
  <meta property="og:title" content="合成孔径雷达(SAR)RD算法点目标成像与分析Matlab仿真">
  <meta property="og:description" content="文章目录 一、概述二、仿真思路1.概述2.高分3号简介与基本参数 三、回波生成1.卫星运行速度计算2.几何3.信号参数与时间轴生成(1)信号参数(2)时间轴生成 4.点目标回波生成(1)点目标坐标设置(2)回波生成 四、低斜视角处理1.距离压缩2.方位向傅里叶变换3.距离徙动校正4.方位压缩5.升采样(1)总体步骤(2)升采样(频域补零)(3)剖面 五、大斜视角处理1.距离压缩-&gt;二次距离压缩(改进)2.方位向傅里叶变换3.距离徙动校正-&gt;引入新的徙动量(改进)3.方位压缩-&gt;引入新的滤波器(改进)4.升采样结果 六、完整代码1.低斜视角处理2.大斜视角处理 一、概述 本文旨在基于Ian G. Cumming的《合成孔径雷达成像算法与实现》中第六章的距离多普勒算法进行Matlab仿真，信号参数基于高分3号SAR卫星参数。本文将从基本的回波生成概念开始梳理，包含基本的原理讲解与代码讲解，以及一些绘制的插图。在数据处理方法上，从基于低斜视角的数据处理开始，扩展到高斜视角的数据处理。
需要注意的是，本文不会像百科全书一样列举所有需要的知识，因此至少要完成了书本的前4章学习，了解基本的知识点。
另外：作者也是SAR成像的初学者，代码和讲解当中也有许多瑕疵的存在，仅供读者参考
二、仿真思路 1.概述 所谓点目标仿真，就是在一个假设的场景内，对三个“点”发出的回波信号进行模拟计算，而这三个点的位置和它本身的几何形状会影响回波信号的包络与相位，我们收到回波后即可进行数据处理，将其成像出来。
基本的仿真包括两个阶段：
回波生成
距离向包络Wr方位向包络Wa相位Phase 数据处理
基于小斜视角的数据处理改进后可用于处理大斜视角(可以认为是升级版)，但是同样的，处理大斜视角的算法无法再应用于处理小斜视角小斜视角的步骤如下图:
勘误：图中的256与320应分别为Naz与Nrg，下文再解释。 那么对于点目标仿真，我们需要在回波生成时，针对不同的点目标计算R0、Rη和波束中心穿越时刻Rηc；而在数据处理时，只能使用原点或某个点的参数，进行数据处理-&gt;也就是说在数据处理阶段只能使用一个点的R0或者Rηc。
这也就是RD算法的局限性所在，原点或近距点的成像效果较好，而远距点的成像效果就差一些。
2.高分3号简介与基本参数 高分三号卫星是中国高分专项工程的一颗遥感卫星，为1米分辨率雷达遥感卫星，也是中国首颗分辨率达到1米的C频段多极化合成孔径雷达（SAR）成像卫星，由中国航天科技集团公司研制。
已知的基本参数如下：
%% GF3系统参数 % 几何参数 H = 755e3; % 轨道高度 % 天线参数 La = 15; % 天线尺寸 % 姿态参数（针对坐标原点的点A） phi = 20*pi/180; % 俯仰角-20° - &#43;20° incidence= 20.5*pi/180; % 入射角 % 信号参数 c =3e8;%光速 f0 = 5.4e9;%雷达工作频率 Tr = 40e-6; % 距离向周期 Br = 3*5.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-12-10T18:30:50+08:00">
    <meta property="article:modified_time" content="2023-12-10T18:30:50+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程学习者" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程学习者</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">合成孔径雷达(SAR)RD算法点目标成像与分析Matlab仿真</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#_3" rel="nofollow">一、概述</a></li><li><a href="#_8" rel="nofollow">二、仿真思路</a></li><li><ul><li><a href="#1_9" rel="nofollow">1.概述</a></li><li><a href="#23_26" rel="nofollow">2.高分3号简介与基本参数</a></li></ul> 
   </li><li><a href="#_47" rel="nofollow">三、回波生成</a></li><li><ul><li><a href="#1_48" rel="nofollow">1.卫星运行速度计算</a></li><li><a href="#2_63" rel="nofollow">2.几何</a></li><li><a href="#3_87" rel="nofollow">3.信号参数与时间轴生成</a></li><li><ul><li><a href="#1_88" rel="nofollow">(1)信号参数</a></li><li><a href="#2_128" rel="nofollow">(2)时间轴生成</a></li></ul> 
    </li><li><a href="#4_160" rel="nofollow">4.点目标回波生成</a></li><li><ul><li><a href="#1_161" rel="nofollow">(1)点目标坐标设置</a></li><li><a href="#2_178" rel="nofollow">(2)回波生成</a></li></ul> 
   </li></ul> 
   </li><li><a href="#_226" rel="nofollow">四、低斜视角处理</a></li><li><ul><li><a href="#1_228" rel="nofollow">1.距离压缩</a></li><li><a href="#2_246" rel="nofollow">2.方位向傅里叶变换</a></li><li><a href="#3_258" rel="nofollow">3.距离徙动校正</a></li><li><a href="#4_279" rel="nofollow">4.方位压缩</a></li><li><a href="#5_297" rel="nofollow">5.升采样</a></li><li><ul><li><a href="#1_298" rel="nofollow">(1)总体步骤</a></li><li><a href="#2_331" rel="nofollow">(2)升采样(频域补零)</a></li><li><a href="#3_357" rel="nofollow">(3)剖面</a></li></ul> 
   </li></ul> 
   </li><li><a href="#_365" rel="nofollow">五、大斜视角处理</a></li><li><ul><li><a href="#1_367" rel="nofollow">1.距离压缩-&gt;二次距离压缩(改进)</a></li><li><a href="#2_385" rel="nofollow">2.方位向傅里叶变换</a></li><li><a href="#3_387" rel="nofollow">3.距离徙动校正-&gt;引入新的徙动量(改进)</a></li><li><a href="#3_405" rel="nofollow">3.方位压缩-&gt;引入新的滤波器(改进)</a></li><li><a href="#4_423" rel="nofollow">4.升采样结果</a></li></ul> 
   </li><li><a href="#_430" rel="nofollow">六、完整代码</a></li><li><ul><li><a href="#1_431" rel="nofollow">1.低斜视角处理</a></li><li><a href="#2_819" rel="nofollow">2.大斜视角处理</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="_3"></a>一、概述</h3> 
<p>本文旨在基于Ian G. Cumming的《合成孔径雷达成像算法与实现》中第六章的距离多普勒算法进行Matlab仿真，信号参数基于高分3号SAR卫星参数。本文将从基本的回波生成概念开始梳理，包含基本的原理讲解与代码讲解，以及一些绘制的插图。在数据处理方法上，从基于低斜视角的数据处理开始，扩展到高斜视角的数据处理。<br> 需要注意的是，本文不会像百科全书一样列举所有需要的知识，因此至少要完成了书本的前4章学习，了解基本的知识点。<br> 另外：作者也是SAR成像的初学者，代码和讲解当中也有许多瑕疵的存在，仅供读者参考</p> 
<h3><a id="_8"></a>二、仿真思路</h3> 
<h4><a id="1_9"></a>1.概述</h4> 
<p>所谓点目标仿真，就是在一个假设的场景内，<strong>对三个“点”发出的回波信号进行模拟计算</strong>，而这三个点的位置和它本身的几何形状会影响回波信号的包络与相位，我们收到回波后即可进行数据处理，将其成像出来。</p> 
<p>基本的仿真包括两个阶段：</p> 
<ul><li> <p><strong>回波生成</strong></p> 
  <ul><li>距离向包络Wr</li><li>方位向包络Wa</li><li>相位Phase</li></ul> </li><li> <p><strong>数据处理</strong></p> 
  <ul><li>基于小斜视角的数据处理改进后可用于处理大斜视角(可以认为是升级版)，但是同样的，处理大斜视角的算法无法再应用于处理小斜视角</li><li>小斜视角的步骤如下图:<br> <img src="https://images2.imgbox.com/c1/66/ANsu14kW_o.png" alt="在这里插入图片描述"><br> 勘误：图中的256与320应分别为Naz与Nrg，下文再解释。</li></ul> </li></ul> 
<p>那么对于<strong>点目标仿真</strong>，我们需要在回波生成时，针对不同的点目标计算R0、Rη和波束中心穿越时刻Rηc；而在数据处理时，只能使用原点或某个点的参数，进行数据处理-&gt;也就是说在数据处理阶段只能使用一个点的R0或者Rηc。<br> 这也就是RD算法的局限性所在，原点或近距点的成像效果较好，而远距点的成像效果就差一些。</p> 
<h4><a id="23_26"></a>2.高分3号简介与基本参数</h4> 
<p>高分三号卫星是中国高分专项工程的一颗遥感卫星，为1米分辨率雷达遥感卫星，也是中国首颗分辨率达到1米的C频段多极化合成孔径雷达（SAR）成像卫星，由中国航天科技集团公司研制。</p> 
<p>已知的基本参数如下：</p> 
<pre><code class="prism language-matlab"><span class="token comment">%% GF3系统参数</span>
<span class="token comment">% 几何参数</span>
H       <span class="token operator">=</span> <span class="token number">755e3</span><span class="token punctuation">;</span>                    	<span class="token comment">% 轨道高度</span>
<span class="token comment">% 天线参数</span>
La      <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span>                       	<span class="token comment">% 天线尺寸</span>
<span class="token comment">% 姿态参数（针对坐标原点的点A）</span>
phi     <span class="token operator">=</span> <span class="token number">20</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">/</span><span class="token number">180</span><span class="token punctuation">;</span>                <span class="token comment">% 俯仰角-20° - +20°</span>
incidence<span class="token operator">=</span> <span class="token number">20.5</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">/</span><span class="token number">180</span><span class="token punctuation">;</span>            	<span class="token comment">% 入射角</span>
<span class="token comment">% 信号参数</span>
c       <span class="token operator">=</span><span class="token number">3e8</span><span class="token punctuation">;</span><span class="token comment">%光速</span>
f0      <span class="token operator">=</span> <span class="token number">5.4e9</span><span class="token punctuation">;</span><span class="token comment">%雷达工作频率</span>
Tr      <span class="token operator">=</span> <span class="token number">40e-6</span><span class="token punctuation">;</span>                   	<span class="token comment">% 距离向周期</span>
Br      <span class="token operator">=</span> <span class="token number">3</span><span class="token operator">*</span><span class="token number">5.995849160000000e+06</span><span class="token punctuation">;</span>   <span class="token comment">% 发射信号带宽</span>
</code></pre> 
<p>这些参数与书本上的符号基本对应，接下来将基于上面的参数进行仿真</p> 
<h3><a id="_47"></a>三、回波生成</h3> 
<h4><a id="1_48"></a>1.卫星运行速度计算</h4> 
<p>在RD算法中我们一般使用直线几何模型，也就是使用等效雷达速度Vr，并且Vr=Vg=Vs(直线几何);<br> 这个Vr实际上我们通过高中的物理知识，使用卫星轨道高度H和地球半径R，以及万有引力常量就可以算出来了</p> 
<pre><code class="prism language-matlab"><span class="token comment">% 卫星轨道速度Vr计算</span>
EarthMass <span class="token operator">=</span> <span class="token number">6e24</span><span class="token punctuation">;</span> <span class="token comment">%地球质量(kg)</span>
EarthRadius <span class="token operator">=</span> <span class="token number">6.37e6</span><span class="token punctuation">;</span> <span class="token comment">%地球半径6371km</span>
Gravitational <span class="token operator">=</span> <span class="token number">6.67e-11</span><span class="token punctuation">;</span> <span class="token comment">%万有引力常量</span>
<span class="token comment">% 姿态参数</span>
phi <span class="token operator">=</span> <span class="token number">20</span> <span class="token operator">*</span> <span class="token keyword">pi</span> <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">;</span> <span class="token comment">% 俯仰角+20°</span>
incidence <span class="token operator">=</span> <span class="token number">20.5</span> <span class="token operator">*</span> <span class="token keyword">pi</span> <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">;</span> <span class="token comment">% 入射角</span>
<span class="token comment">%计算等效雷达速度(卫星做圆周运动的线速度)</span>
Vr <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>Gravitational<span class="token operator">*</span>EarthMass<span class="token operator">/</span><span class="token punctuation">(</span>EarthRadius <span class="token operator">+</span> H<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%第一宇宙速度</span>
</code></pre> 
<h4><a id="2_63"></a>2.几何</h4> 
<p>点目标仿真中涉及到的几何运算并不复杂，但比较重要，例如Rη瞬时斜距可以说是整个仿真当中最重要的参数，回波的计算会影响到成像的质量。<br> 首先从下面的这一副星载的几何关系开始，雷达沿着方位向(Y轴)进行运动，在它的运动过程中，通过波束斜视角刚好能够照射到点目标的斜距即为景中心斜距；雷达与点目标之间的瞬时距离就是瞬时斜距，而最近斜距R0是固定的，通过俯仰角和高度就可以计算出来。<br> 几何关系中的三个重要的角度，还有一个合成角(方位向包络)：</p> 
<ul><li>波束斜视角theta_r_c</li><li>入射角incidence</li><li>俯仰角phi</li><li>合成角theta_bw(图上未标明)<br> <img src="https://images2.imgbox.com/3b/e8/NDXAsiZk_o.png" alt="在这里插入图片描述"></li></ul> 
<pre><code class="prism language-matlab"><span class="token comment">%景中心斜距R_eta_c和最近斜距R0，斜视角theta_rc由轨道高度、俯仰角、入射角计算得出</span>
R_eta_c <span class="token operator">=</span> H <span class="token operator">/</span> <span class="token function">cos</span><span class="token punctuation">(</span>incidence<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%景中心斜距</span>
R0 <span class="token operator">=</span> H <span class="token operator">/</span> <span class="token function">cos</span><span class="token punctuation">(</span>phi<span class="token punctuation">)</span><span class="token punctuation">;</span>
theta_r_c <span class="token operator">=</span> <span class="token function">acos</span><span class="token punctuation">(</span>R0<span class="token operator">/</span>R_eta_c<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%斜视角，单位为弧度;斜视角为4.6°</span>
</code></pre> 
<pre><code class="prism language-matlab">
<span class="token comment">%  合成孔径参数</span>
rho_r <span class="token operator">=</span> c <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> Fr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 距离向分辨率</span>
rho_a <span class="token operator">=</span> Vr<span class="token operator">/</span>Fa<span class="token punctuation">;</span> <span class="token comment">% 距离向分辨率|La / 2</span>
theta_bw <span class="token operator">=</span> <span class="token number">0.886</span> <span class="token operator">*</span> lambda <span class="token operator">/</span> Lr<span class="token punctuation">;</span> <span class="token comment">% 方位向3dB波束宽度</span>
theta_syn <span class="token operator">=</span> Vs <span class="token operator">/</span> Vg <span class="token operator">*</span> theta_bw<span class="token punctuation">;</span> <span class="token comment">% 合成角宽度(斜面上的合成角)</span>
Ls <span class="token operator">=</span> R_eta_c <span class="token operator">*</span> theta_syn<span class="token punctuation">;</span> <span class="token comment">% 合成孔径长度</span>
</code></pre> 
<h4><a id="3_87"></a>3.信号参数与时间轴生成</h4> 
<h5><a id="1_88"></a>(1)信号参数</h5> 
<p>我们在SAR仿真中使用的是二维(距离向，方位向)的线性调频信号，那么在距离向和方位向的两个维度上都有一套信号参数，而基本的信号参数如工作频率f0，光速c等是共用的</p> 
<pre><code class="prism language-matlab"><span class="token comment">%% 信号参数设置</span>

<span class="token comment">%   电磁波参数</span>
c <span class="token operator">=</span> <span class="token number">3e+8</span><span class="token punctuation">;</span> <span class="token comment">% 光速</span>
Vs <span class="token operator">=</span> Vr<span class="token punctuation">;</span> <span class="token comment">% 卫星平台速度</span>
Vg <span class="token operator">=</span> Vr<span class="token punctuation">;</span> <span class="token comment">% 波束扫描速度</span>
La <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span> <span class="token comment">%方位向天线长度-&gt;椭圆的长轴</span>
Lr<span class="token operator">=</span><span class="token number">1.5</span><span class="token punctuation">;</span><span class="token comment">%距离向天线尺寸——&gt;椭圆的短轴</span>
f0 <span class="token operator">=</span> <span class="token number">5.4e+9</span><span class="token punctuation">;</span> <span class="token comment">% 雷达工作频率</span>
lambda <span class="token operator">=</span> c <span class="token operator">/</span> f0<span class="token punctuation">;</span> <span class="token comment">%电磁波波长</span>


<span class="token comment">%  距离向信号参数</span>
Tr <span class="token operator">=</span> <span class="token number">40e-6</span><span class="token punctuation">;</span> <span class="token comment">% 发射脉冲时宽</span>
Br <span class="token operator">=</span> <span class="token number">2.8</span> <span class="token operator">*</span> <span class="token number">6e6</span><span class="token punctuation">;</span> <span class="token comment">% 距离向信号带宽</span>
Kr <span class="token operator">=</span> Br <span class="token operator">/</span> Tr<span class="token punctuation">;</span> <span class="token comment">% 距离向调频率</span>
alpha_os_r <span class="token operator">=</span> <span class="token number">1.2</span><span class="token punctuation">;</span> <span class="token comment">% 距离过采样率</span>
Nrg <span class="token operator">=</span> <span class="token number">2500</span><span class="token punctuation">;</span> <span class="token comment">% 距离线采样点数</span>
Fr <span class="token operator">=</span> alpha_os_r <span class="token operator">*</span> Br<span class="token punctuation">;</span> <span class="token comment">% 距离向采样率</span>

<span class="token comment">%  方位向信号参数</span>
alpha_os_a <span class="token operator">=</span> <span class="token number">1.23</span><span class="token punctuation">;</span> <span class="token comment">% 方位过采样率</span>
Naz <span class="token operator">=</span> <span class="token number">1600</span><span class="token punctuation">;</span> <span class="token comment">% 距离线数</span>
delta_f_dop <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token number">0.886</span> <span class="token operator">*</span> Vr <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token function">cos</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> La<span class="token punctuation">;</span> <span class="token comment">% 多普勒带宽</span>
Fa <span class="token operator">=</span> alpha_os_a <span class="token operator">*</span> delta_f_dop<span class="token punctuation">;</span> <span class="token comment">% 方位向采样率</span>
Ta <span class="token operator">=</span> <span class="token number">0.886</span> <span class="token operator">*</span> lambda <span class="token operator">*</span> R_eta_c <span class="token operator">/</span> <span class="token punctuation">(</span>La <span class="token operator">*</span> Vg <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%目标照射时间</span>


<span class="token comment">%  合成孔径参数</span>
rho_r <span class="token operator">=</span> c <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> Fr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 距离向分辨率</span>
rho_a <span class="token operator">=</span> Vr<span class="token operator">/</span>Fa<span class="token punctuation">;</span> <span class="token comment">% 距离向分辨率|La / 2</span>
theta_bw <span class="token operator">=</span> <span class="token number">0.886</span> <span class="token operator">*</span> lambda <span class="token operator">/</span> Lr<span class="token punctuation">;</span> <span class="token comment">% 方位向3dB波束宽度</span>
theta_syn <span class="token operator">=</span> Vs <span class="token operator">/</span> Vg <span class="token operator">*</span> theta_bw<span class="token punctuation">;</span> <span class="token comment">% 合成角宽度(斜面上的合成角)</span>
Ls <span class="token operator">=</span> R_eta_c <span class="token operator">*</span> theta_syn<span class="token punctuation">;</span> <span class="token comment">% 合成孔径长度</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span>"距离向分辨率<span class="token operator">:</span><span class="token comment">%.2f,方位向分辨率:%.2f\n\n",rho_r,rho_a)</span>
</code></pre> 
<p>在这部分中，需要注意的是Nrg和Naz。这两个参数决定了信号的距离向和方位向点数，如Naz=1600，Nrg=2500，那么生成的回波矩阵就是1600行，2500列；值得注意的是，Naz和Nrg和后续的时间轴相关，导出了Taz和Trg的概念，要和Tr、Ta区分开来，在计算包络时用Tr，Ta，而在和时间轴相关的计算时用Trg和Taz</p> 
<h5><a id="2_128"></a>(2)时间轴生成</h5> 
<p>时间轴包括时域轴和频域轴，基本的参数设置大同小异，但是需要特别注意的是每个轴的<strong>中点</strong>设置。</p> 
<ul><li>距离向和方位向的时间轴中点分别为<strong>2*R_eta_c/c</strong>和<strong>time_eta_c</strong>，从上面的几何关系图我们知道，这两个参数分别就是雷达在距离向上的电磁波运动中点、方位向上雷达运动中点。</li><li>距离向频域轴的中点就是0；方位向的频域中点应当是<strong>多普勒中心频率(f_eta_c)</strong>，将频域轴对准到多普勒中心；<strong>回波生成后还需要重新将回波的频谱搬移到0频</strong></li><li>不论是什么轴，我们都通过repmat或者meshgrid函数将他们扩展到[Naz,Nrg]的维数上便于后续进行处理</li></ul> 
<pre><code class="prism language-matlab"><span class="token comment">%% 时间轴参数</span>
Trg <span class="token operator">=</span> Nrg <span class="token operator">/</span> Fr<span class="token punctuation">;</span>Taz <span class="token operator">=</span> Naz <span class="token operator">/</span> Fa<span class="token punctuation">;</span>
<span class="token comment">%距离向/方位向采样时间间隔</span>
Gap_t_tau <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> Fr<span class="token punctuation">;</span>Gap_t_eta <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> Fa<span class="token punctuation">;</span>
<span class="token comment">%距离向/方位向采样频率间隔</span>
Gap_f_tau <span class="token operator">=</span> Fr <span class="token operator">/</span> Nrg<span class="token punctuation">;</span>Gap_f_eta <span class="token operator">=</span> Fa <span class="token operator">/</span> Naz<span class="token punctuation">;</span>
<span class="token comment">%  时间轴变量</span>
time_tau_r <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> R_eta_c <span class="token operator">/</span> c <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">-</span>Trg <span class="token operator">/</span> <span class="token number">2</span><span class="token operator">:</span>Gap_t_tau<span class="token operator">:</span>Trg <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> Gap_t_tau<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 距离时间变量</span>
time_eta_a <span class="token operator">=</span> time_eta_c <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">-</span>Taz <span class="token operator">/</span> <span class="token number">2</span><span class="token operator">:</span>Gap_t_eta<span class="token operator">:</span>Taz <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> Gap_t_eta<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 方位时间变量</span>
<span class="token comment">%  随着距离向时间变化的最近斜距；c/2是因为距离向上一个时间包含两次电磁波来回</span>
R0_tau_r <span class="token operator">=</span> <span class="token punctuation">(</span>time_tau_r <span class="token operator">*</span> c <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span><span class="token punctuation">;</span>
Ext_R0_tau_r <span class="token operator">=</span> <span class="token function">repmat</span><span class="token punctuation">(</span>R0_tau_r<span class="token punctuation">,</span> Naz<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%扩展R0，用于计算变量Ka</span>
<span class="token comment">%  频率变量</span>
f_tau <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">-</span>Fr <span class="token operator">/</span> <span class="token number">2</span><span class="token operator">:</span>Gap_f_tau<span class="token operator">:</span>Fr <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> Gap_f_tau<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 距离频率变量</span>
f_tau<span class="token operator">=</span>f_tau<span class="token operator">-</span><span class="token punctuation">(</span><span class="token function">round</span><span class="token punctuation">(</span>f_tau<span class="token operator">/</span>Fr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span>Fr<span class="token punctuation">;</span><span class="token comment">%混叠方程</span>
f_eta <span class="token operator">=</span> f_eta_c <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">-</span>Fa <span class="token operator">/</span> <span class="token number">2</span><span class="token operator">:</span>Gap_f_eta<span class="token operator">:</span>Fa <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> Gap_f_eta<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 方位频率变量</span>
f_eta<span class="token operator">=</span>f_eta<span class="token operator">-</span><span class="token punctuation">(</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span>f_eta<span class="token operator">-</span>f_eta_c<span class="token punctuation">)</span><span class="token operator">/</span>Fa<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span>Fa<span class="token punctuation">;</span>
<span class="token comment">%  时间轴</span>
<span class="token punctuation">[</span>Ext_time_tau_r<span class="token punctuation">,</span> Ext_time_eta_a<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">meshgrid</span><span class="token punctuation">(</span>time_tau_r<span class="token punctuation">,</span> time_eta_a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 设置距离时域-方位时域二维网络坐标</span>
<span class="token comment">%  频率轴</span>
<span class="token punctuation">[</span>Ext_f_tau<span class="token punctuation">,</span> Ext_f_eta<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">meshgrid</span><span class="token punctuation">(</span>f_tau<span class="token punctuation">,</span> f_eta<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 设置频率时域-方位频域二维网络坐标</span>
</code></pre> 
<ul><li>其中有一个变量需要特殊说明，也就是Ext_R0_tau_r，它由R0_tau_r扩展而来。也就是计算随着距离门(距离向点数)而变化的最近斜距，可以理解为距离向时间tau，每个tau都对应一个R0（同样也有个Rηc），这将会应用于后面计算方位向调频率Ka（<strong>Ka随着R0而变</strong>）<br> <span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
           
           
             R 
            
           
             0 
            
           
          
            ′ 
           
          
         
           = 
          
         
           τ 
          
         
           × 
          
          
          
            c 
           
          
            2 
           
          
         
           × 
          
         
           cos 
          
         
           ⁡ 
          
         
           ( 
          
          
          
            θ 
           
           
           
             r 
            
           
             , 
            
           
             c 
            
           
          
         
           ) 
          
         
        
          {R_0}' = \tau \times \frac{c}{2} \times \cos ({\theta _{r,c}}) 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.9751em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0077em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.8251em;"><span class="" style="top: -3.1362em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6667em; vertical-align: -0.0833em;"></span><span class="mord mathnormal" style="margin-right: 0.1132em;">τ</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1.7936em; vertical-align: -0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.1076em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1.0361em; vertical-align: -0.2861em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.1514em;"><span class="" style="top: -2.55em; margin-left: -0.0278em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.0278em;">r</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">c</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></span></li></ul> 
<h4><a id="4_160"></a>4.点目标回波生成</h4> 
<h5><a id="1_161"></a>(1)点目标坐标设置</h5> 
<p>有了前面的信号和基本的几何设置，我们还需要在生成回波前设置进行点目标仿真的点的坐标，单位为<strong>标准单位米</strong>。</p> 
<ul><li>点A(原点)，坐标为(0,0)</li><li>点B(近距点)，坐标为(500,500)</li><li>点C(远距点)，远距点C的方位向坐标等于点B，而距离向坐标需要按照以下图示来求解(坐标也可自行设置)<img src="https://images2.imgbox.com/ea/62/LUoQIXby_o.png" alt="在这里插入图片描述"></li></ul> 
<pre><code class="prism language-matlab"><span class="token comment">%% 点目标(三个)坐标设置</span>
<span class="token comment">%  设置目标点相对于景中心之间的距离</span>

xA <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>yA <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">%A=(0,0)</span>
xB <span class="token operator">=</span> xA <span class="token operator">+</span> <span class="token number">500</span><span class="token punctuation">;</span>yB <span class="token operator">=</span> xA <span class="token operator">+</span> <span class="token number">500</span><span class="token punctuation">;</span> <span class="token comment">%（500,500）</span>

xC <span class="token operator">=</span> H<span class="token operator">*</span><span class="token function">tan</span><span class="token punctuation">(</span>phi<span class="token operator">+</span>theta_bw<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span>R0<span class="token operator">*</span><span class="token function">sin</span><span class="token punctuation">(</span>phi<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%计算的C点距离向坐标</span>
yC <span class="token operator">=</span> xA <span class="token operator">+</span> <span class="token number">500</span><span class="token punctuation">;</span>
Position_x_r <span class="token operator">=</span> <span class="token punctuation">[</span>xA<span class="token punctuation">,</span> xB<span class="token punctuation">,</span> xC<span class="token punctuation">]</span><span class="token punctuation">;</span>
Position_y_a <span class="token operator">=</span> <span class="token punctuation">[</span>yA<span class="token punctuation">,</span> yB<span class="token punctuation">,</span> yC<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">%点目标的坐标矩阵表示</span>
</code></pre> 
<h5><a id="2_178"></a>(2)回波生成</h5> 
<p>有了前面基本的信号参数和坐标设置，接下来可以进行回波生成了。所谓回波生成，其实就是在针对每个点目标计算距离向包络、方位向包络、相位，然后将他们相乘在一起；由于点目标的坐标不同，导致其瞬时斜距Rη、波束中心穿越时刻，最近斜距R0等参数都不同，这样就包含了雷达成像所需要的信息；在生成了多个点目标的回波后进行累加，模拟雷达对场景上的点目标进行的采样操作。</p> 
<pre><code class="prism language-matlab"><span class="token comment">%% 生成回波S_echo</span>
Target_num <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">%目标数量</span>
S_echo <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>Naz<span class="token punctuation">,</span> Nrg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token number">i</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span>Target_num
    R0_Target <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>R0 <span class="token operator">*</span> <span class="token function">sin</span><span class="token punctuation">(</span>phi<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">Position_x_r</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span>H<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%对每个目标计算瞬时斜距</span>
    
    time_eta_c_Target <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">Position_y_a</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">-</span>R0_Target <span class="token operator">*</span> <span class="token function">tan</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> Vr<span class="token punctuation">;</span> <span class="token comment">%波束中心穿越时刻</span>

    <span class="token comment">%  计算目标点的瞬时斜距</span>
    R_eta <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>R0_Target<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span><span class="token punctuation">(</span>Vr<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Ext_time_eta_a <span class="token operator">-</span> <span class="token function">Position_y_a</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span> <span class="token operator">/</span> Vr<span class="token punctuation">)</span><span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%R_eta=sqrt(H^2+(Position_x_r(i)-(-R0*sin(phi)))^2+(Position_y_a(i)-Ext_time_eta_a*Vr).^2);</span>
    <span class="token comment">%  距离向包络</span>
    Wr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>Ext_time_tau_r<span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span>R_eta<span class="token operator">/</span>c<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> Tr <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%  方位向包络</span>
    <span class="token comment">% Wa = sinc((La*atan(Vg*(Ext_time_eta_a - time_eta_c_Target)./R0_Target)/lambda).^2);</span>
    Wa <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>La<span class="token operator">*</span><span class="token function">atan</span><span class="token punctuation">(</span>Vg<span class="token operator">*</span><span class="token punctuation">(</span>Ext_time_eta_a <span class="token operator">-</span> time_eta_c_Target<span class="token punctuation">)</span><span class="token operator">./</span><span class="token punctuation">(</span>R0 <span class="token operator">*</span> <span class="token function">sin</span><span class="token punctuation">(</span>phi<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">Position_x_r</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>lambda<span class="token punctuation">)</span><span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span>Ta<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token comment">% Wa = abs(Ext_time_eta_a-time_eta_c_Target) &lt;= Ta / 2;</span>
    <span class="token comment">%   相位</span>
    Phase <span class="token operator">=</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1j</span><span class="token operator">*</span><span class="token number">4</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">*</span>f0<span class="token operator">*</span>R_eta<span class="token operator">/</span>c<span class="token punctuation">)</span> <span class="token operator">.*</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">+</span><span class="token number">1j</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">*</span>Kr<span class="token operator">*</span><span class="token punctuation">(</span>Ext_time_tau_r <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> R_eta <span class="token operator">/</span> c<span class="token punctuation">)</span><span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%  接收信号叠加</span>
    S_echo_Target <span class="token operator">=</span> Wr <span class="token operator">.*</span> Wa <span class="token operator">.*</span> Phase<span class="token punctuation">;</span>
    S_echo <span class="token operator">=</span> S_echo <span class="token operator">+</span> S_echo_Target<span class="token punctuation">;</span>
    <span class="token comment">%%%%%%%%%%%%%%格式化输出%%%%%%%%%%%%%%%%%%</span>
    R_eta_c_Target<span class="token operator">=</span>R0_Target<span class="token operator">/</span><span class="token function">cos</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span>"当前目标<span class="token operator">:</span><span class="token comment">%d,坐标:(%.2f,%.2f),\n最近斜距R0=%.2f,景中心斜距R_eta_c=%.2f,波束中心穿越时刻=%.4f\n", i, Position_x_r(i), Position_y_a(i), R0_Target, R_eta_c_Target,time_eta_c_Target)</span>
    Time_tau_Point <span class="token operator">=</span>  <span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>R0_Target<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>c<span class="token operator">*</span><span class="token function">cos</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">time_tau_r</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>Gap_t_tau<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%目标的距离向标准坐标(距离门),Rηc的坐标</span>
    Time_tau_Point_RCMC <span class="token operator">=</span>  <span class="token function">ceil</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>R0_Target<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">time_tau_r</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>Gap_t_tau<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%RCMC后点数坐标,R0的坐标</span>
    Time_eta_Point <span class="token operator">=</span> Naz <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token function">Position_y_a</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span> <span class="token operator">/</span> Vr<span class="token punctuation">)</span> <span class="token operator">/</span>Gap_t_eta<span class="token punctuation">;</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span>"徙动校正前<span class="token operator">:</span>脉冲点数坐标应为<span class="token comment">%d列(距)\n",Time_tau_Point);</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span>"徙动校正后<span class="token operator">:</span>点数坐标应为<span class="token comment">%d行(方),%d列\n\n",round(Time_eta_Point),Time_tau_Point_RCMC)</span>
<span class="token keyword">end</span>
S_echo <span class="token operator">=</span> S_echo <span class="token operator">.*</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2j</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">*</span>f_eta_c<span class="token operator">*</span>Ext_time_eta_a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%多普勒中心校正</span>
</code></pre> 
<p>在回波生成的计算当中，有几个问题需要注意：</p> 
<ul><li>最近斜距R0的计算时，使用下面的公式<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
       
        
         
          
           
           
             R 
            
           
             0 
            
           
           
           
             t 
            
           
             arg 
            
           
             ⁡ 
            
           
             e 
            
           
             t 
            
           
          
         
           = 
          
          
           
            
             
             
               ( 
              
              
              
                R 
               
              
                0 
               
              
             
               × 
              
             
               sin 
              
             
               ⁡ 
              
             
               ( 
              
             
               p 
              
             
               h 
              
             
               i 
              
             
               ) 
              
             
               + 
              
             
               x 
              
             
               ) 
              
             
            
              2 
             
            
           
             + 
            
            
            
              H 
             
            
              2 
             
            
           
          
         
        
          {R_0}_{t\arg et} = \sqrt {<!-- -->{<!-- -->{({R_0} \times \sin (phi) + x)}^2} + {H^2}} 
         
        
      </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1.0191em; vertical-align: -0.3358em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0077em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2309em;"><span class="" style="top: -2.5003em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mspace mtight" style="margin-right: 0.1952em;"></span><span class="mop mtight"><span class="mtight">a</span><span class="mtight">r</span><span class="mtight" style="margin-right: 0.0139em;">g</span></span><span class="mspace mtight" style="margin-right: 0.1952em;"></span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3358em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1.84em; vertical-align: -0.4541em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.3859em;"><span class="svg-align" style="top: -3.8em;"><span class="pstrut" style="height: 3.8em;"></span><span class="mord" style="padding-left: 1em;"><span class="mord"><span class="mord"><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0077em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mop">sin</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mord mathnormal">hi</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.954em;"><span class="" style="top: -3.2029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0813em;">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7401em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.3459em;"><span class="pstrut" style="height: 3.8em;"></span><span class="hide-tail" style="min-width: 1.02em; height: 1.88em;"> 
             <svg width="400em" height="1.88em" viewbox="0 0 400000 1944" preserveaspectratio="xMinYMin slice"> 
              <path d="M983 90
l0 -0
c4,-6.7,10,-10,18,-10 H400000v40
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M1001 80h400000v40h-400000z"></path> 
             </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.4541em;"><span class=""></span></span></span></span></span></span></span></span></span></span>在这个公式当中，R0*sin(phi)代表的是距离向的绝对距离，也就是雷达的飞行轨迹与地面的法平面(在书上的机载情况由于没有俯仰角，<strong>有些代码直接用R0代替</strong>)，这个法平面就是我们成像完俯视图的最左边</li><li>Rη的计算给出了两个公式，1)在场景建模上进行几何推导，求出当前点目标的瞬时斜距。</li></ul> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          R 
         
        
          ( 
         
        
          η 
         
        
          ) 
         
        
          = 
         
         
          
           
           
             R 
            
           
             0 
            
           
           
            
             
             
             
               t 
              
             
               arg 
              
             
               ⁡ 
              
             
               e 
              
             
               t 
              
             
            
           
             2 
            
           
          
            + 
           
          
            V 
           
           
           
             r 
            
           
             2 
            
           
           
            
            
              ( 
             
            
              η 
             
            
              − 
             
             
             
               y 
              
              
              
                V 
               
              
                r 
               
              
             
            
              ) 
             
            
           
             2 
            
           
          
         
        
       
         R(\eta ) = \sqrt {<!-- -->{R_0}{<!-- -->{_{t\arg et}}^2} + V{r^2}{<!-- -->{(\eta - \frac{y}{<!-- -->{Vr}})}^2}} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0359em;">η</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 2.44em; vertical-align: -0.7933em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.6467em;"><span class="svg-align" style="top: -4.4em;"><span class="pstrut" style="height: 4.4em;"></span><span class="mord" style="padding-left: 1em;"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3011em;"><span class="" style="top: -2.55em; margin-left: -0.0077em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class=""></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.2806em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mspace mtight" style="margin-right: 0.1952em;"></span><span class="mop mtight"><span class="mtight">a</span><span class="mtight">r</span><span class="mtight" style="margin-right: 0.0139em;">g</span></span><span class="mspace mtight" style="margin-right: 0.1952em;"></span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.2861em;"><span class=""></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7401em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathnormal" style="margin-right: 0.2222em;">V</span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0278em;">r</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.7401em;"><span class="" style="top: -2.989em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.0359em;">η</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.1076em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.2222em;">V</span><span class="mord mathnormal" style="margin-right: 0.0278em;">r</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.0359em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.3116em;"><span class="" style="top: -3.5605em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.6067em;"><span class="pstrut" style="height: 4.4em;"></span><span class="hide-tail" style="min-width: 1.02em; height: 2.48em;"> 
            <svg width="400em" height="2.48em" viewbox="0 0 400000 2592" preserveaspectratio="xMinYMin slice"> 
             <path d="M424,2478
c-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514
c0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20
s-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121
s209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081
l0 -0c4,-6.7,10,-10,18,-10 H400000
v40H1014.6
s-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185
c-2,6,-10,9,-24,9
c-8,0,-12,-0.7,-12,-2z M1001 80
h400000v40h-400000z"></path> 
            </svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.7933em;"><span class=""></span></span></span></span></span></span></span></span></span></span>2)直接建立三维坐标系，进行欧式距离计算。请读者仔细斟酌</p> 
<ul><li>还有一个比较重要的概念是波束中心穿越时刻，也就是存在斜视角的雷达波束刚刚好照射到点目标的时刻，这个时间是负数，也就是发生在雷达飞到最近斜距之前(当雷达飞到最近斜距时，时刻为0）；在计算时间轴时，我们默认取的是原点的波束中心穿越时刻，但在计算包络和相位时，必须去计算精确的时刻</li><li>求距离向包络、方位向包络、相位的公式都在书上，相乘即可；在求取每个点目标的信号后进行累加，以模拟天线在一个采样周期内收到了每个点目标的回波信号；通过S_echo = S_echo .* exp(-2j<em>pi</em>f_eta_c*Ext_time_eta_a); %多普勒中心校正——&gt;将频谱搬移到零频处</li></ul> 
<p>回波的可视化和设置的过采样率等都有关，下面的回波图仅供参考(变化主要与信号参数有关)：<br> <img src="https://images2.imgbox.com/ab/11/ZyDKjwaO_o.png" alt="在这里插入图片描述"></p> 
<h3><a id="_226"></a>四、低斜视角处理</h3> 
<p>由于本文的仿真采用的是高分3号(星载)雷达参数，且斜视角为4.6°，因此理论上必须采用大斜视角处理。本节旨在梳理低斜视角处理的数据，导出其不足，进而引入到大斜视角处理方法。</p> 
<h4><a id="1_228"></a>1.距离压缩</h4> 
<p>匹配滤波也称之为压缩的原因，应该是因为它的作用效果类似于我们常说的“降维打击”。也就是说，我们通过三个步骤：</p> 
<ul><li>傅里叶变换到距离频域(fft)</li><li>乘以匹配滤波器</li><li>傅里叶反变换到二维时域(ifft)</li></ul> 
<pre><code class="prism language-matlab">Hf <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>Ext_f_tau<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> Br <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">.*</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">+</span><span class="token number">1j</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">*</span>Ext_f_tau<span class="token operator">.^</span><span class="token number">2</span><span class="token operator">/</span>Kr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%滤波器</span>
<span class="token comment">%  匹配滤波</span>
S1_ftau_eta <span class="token operator">=</span> <span class="token function">fftshift</span><span class="token punctuation">(</span><span class="token function">fft</span><span class="token punctuation">(</span><span class="token function">fftshift</span><span class="token punctuation">(</span>S_echo<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Nrg<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
S1_ftau_eta <span class="token operator">=</span> S1_ftau_eta <span class="token operator">.*</span> Hf<span class="token punctuation">;</span>
S1_tau_eta <span class="token operator">=</span> <span class="token function">fftshift</span><span class="token punctuation">(</span><span class="token function">ifft</span><span class="token punctuation">(</span><span class="token function">fftshift</span><span class="token punctuation">(</span>S1_ftau_eta<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Nrg<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>所得到的效果，很像是将上面的每一个回波包络，看成一个面包，将它沿着两端向内进行压缩，最终得到一条线的效果。（后面的方位压缩，其实就是在方位向上进行所谓的"降维打击"）</p> 
<p><img src="https://images2.imgbox.com/0e/4f/9Wip7cH1_o.png" alt="![在这里插入图片描述](https://img-blog.csdnimg.cn/f4f8e7c529e54cefa38016f4a3abdcaa.png"></p> 
<h4><a id="2_246"></a>2.方位向傅里叶变换</h4> 
<p>方位向傅立叶变换其实就是将当前的二维信号进行傅立叶变换。距离压缩的时候我们有忽略一个问题，就是方位向和距离向是两个不同的维度（对应于矩阵的行和列），在公式里面我们直接对相应的距离向变量tau，或者方位向变量eta，进行傅立叶变换（或者POSP）就可以了；那么在代码的离散情况下，我们应该如何做呢？实际上就是使用matlab中fft函数，自带的dim参数，例如（在我设定的用矩阵表示信号的条件下），将dim设为1就是指进行方位向傅立叶变换，也就是将每一行看作一个单独的信号，对它进行傅立叶变换</p> 
<pre><code class="prism language-matlab"><span class="token comment">%% 方位向傅里叶变换</span>
S2_tau_feta <span class="token operator">=</span> <span class="token function">fftshift</span><span class="token punctuation">(</span><span class="token function">fft</span><span class="token punctuation">(</span><span class="token function">fftshift</span><span class="token punctuation">(</span>S1_tau_eta<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Naz<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>而在fft前和fft后均进行fftshift，就是分别进行搬移（对称）的操作，网上资料很多，不赘述了<br> <img src="https://images2.imgbox.com/99/3d/SOIa5wmJ_o.png" alt="在这里插入图片描述"></p> 
<p>这里要注意的是，我们在距离压缩之后，信号在两个维度上均为时域，而我们在这个基础上进行方位向傅立叶变换，经过后面的距离徙动校正和方位压缩后，才会重新进行方位向傅立叶反变换，将信号变回二维时域，也就做到了我们想要的点目标成像</p> 
<h4><a id="3_258"></a>3.距离徙动校正</h4> 
<p>关于距离徙动校正的原理，可以参考下面的这篇博客</p> 
<pre><code>https://blog.csdn.net/a1367666195/article/details/106614692
</code></pre> 
<p>那在大部分的代码当中，使用的是sinc插值法进行校正，这种方法精度高，但是麻烦、复杂、运算速度慢；这里我使用书提到的相位补偿法进行校正，它虽然效果不如sin插值，但是胜在简单、容易实现</p> 
<pre><code class="prism language-matlab"><span class="token comment">%% 距离徙动校正RCMC:采用相位补偿法</span>
<span class="token comment">%虽然Ka是随着R0变化的，但是在相位补偿时需要假设R0是不变的，这也是相位补偿本身的局限性</span>
delta_R <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>lambda <span class="token operator">*</span> Ext_f_eta<span class="token punctuation">)</span><span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">.*</span> R0<span class="token punctuation">)</span> <span class="token operator">./</span> <span class="token punctuation">(</span><span class="token number">8</span> <span class="token operator">*</span> <span class="token punctuation">(</span>Vr<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%距离徙动表达式</span>
G_rcmc <span class="token operator">=</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">+</span><span class="token number">4j</span> <span class="token operator">*</span> <span class="token keyword">pi</span> <span class="token operator">.*</span> Ext_f_tau <span class="token operator">.*</span> delta_R<span class="token punctuation">)</span><span class="token operator">./</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%补偿相位</span>
S3_ftau_feta <span class="token operator">=</span> <span class="token function">fftshift</span><span class="token punctuation">(</span><span class="token function">fft</span><span class="token punctuation">(</span><span class="token function">fftshift</span><span class="token punctuation">(</span>S2_tau_feta<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Nrg<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%在方位向傅里叶变换的基础上进行距离向傅里叶变换</span>
S3_ftau_feta <span class="token operator">=</span> S3_ftau_feta <span class="token operator">.*</span> G_rcmc<span class="token punctuation">;</span> <span class="token comment">%与补偿相位相乘</span>
S3_tau_feta_RCMC <span class="token operator">=</span> <span class="token function">fftshift</span><span class="token punctuation">(</span><span class="token function">ifft</span><span class="token punctuation">(</span><span class="token function">fftshift</span><span class="token punctuation">(</span>S3_ftau_feta<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Nrg<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%距离向傅里叶逆变换</span>
</code></pre> 
<p>值得注意点是，上面的R0指的是原点(点A)处的最近斜距R0，而由于这个时候方位向上的信号在频域，所以最<strong>近斜距R0的参数是一个定值，无法变化</strong>（方位压缩时计算Ka的时候则不需要考虑），所以最终的成像效果默认是原点R0最好，距离原点越远的点越差；而如果将此处的R0更换成其他点目标（如C点）的最近斜距R0，那么C点的效果就会变得最好-&gt;这也是<strong>相位补偿法本身的局限性</strong>所在<br> <img src="https://images2.imgbox.com/c5/b9/z05DIJDn_o.png" alt="在这里插入图片描述"><br> 此外我们可以通过计算点目标的脉冲所在位置来对徙动校正的效果进行验证，如上面的C点目标，其脉冲在距离向上的点数约为1570点，那么根据下面的公式：</p> 
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"> 
      
       
        
        
          R 
         
        
          0 
         
        
          = 
         
        
          808390 
         
         
         
           . 
          
         
           36 
          
         
        
          &lt; 
         
        
          = 
         
        
          &gt; 
         
        
          [ 
         
        
          τ 
         
        
          ( 
         
        
          1570 
         
        
          ) 
         
        
          ] 
         
        
          × 
         
        
          ( 
         
         
         
           c 
          
         
           2 
          
         
        
          ) 
         
        
          = 
         
        
          8 
         
         
         
           . 
          
         
           0843 
          
         
           e 
          
         
           + 
          
         
           05 
          
         
        
       
         R0 = {\rm{808390}}{\rm{.36}} &lt; = &gt; [\tau (1570)] \times (\frac{c}{2}) = {\rm{ 8}}{\rm{.0843e + 05}} 
        
       
     </span><span class="katex-html"><span class="base"><span class="strut" style="height: 0.6833em;"></span><span class="mord mathnormal" style="margin-right: 0.0077em;">R</span><span class="mord">0</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.6835em; vertical-align: -0.0391em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathrm">808390</span></span></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathrm">.36</span></span></span></span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">&lt;=&gt;</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right: 0.1132em;">τ</span><span class="mopen">(</span><span class="mord">1570</span><span class="mclose">)]</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.2222em;"></span></span><span class="base"><span class="strut" style="height: 1.7936em; vertical-align: -0.686em;"></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.1076em;"><span class="" style="top: -2.314em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">2</span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.677em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.686em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.2778em;"></span></span><span class="base"><span class="strut" style="height: 0.7278em; vertical-align: -0.0833em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathrm">8</span></span></span></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathrm">.0843e</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.2222em;"></span><span class="mord mathrm">05</span></span></span></span></span></span></span></span></span><br> 可以计算出，斜距上的误差约为35.66m</p> 
<h4><a id="4_279"></a>4.方位压缩</h4> 
<p>方位压缩类似于距离压缩，只不过在前面已经进行过了方位向傅里叶变换，这里直接乘上匹配滤波器，进行方位向傅里叶反变换即可</p> 
<pre><code class="prism language-matlab"><span class="token comment">%% 方位压缩</span>
<span class="token comment">%  根据变化的R0计算出相应的Ka矩阵(距离向变化，方位向不变)</span>
Ka <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> Vr<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span> <span class="token operator">./</span> <span class="token punctuation">(</span>lambda <span class="token operator">*</span> Ext_R0_tau_r<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">%  方位向匹配滤波器</span>
Haz <span class="token operator">=</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1j</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">*</span>Ext_f_eta<span class="token operator">.^</span><span class="token number">2.</span><span class="token operator">/</span>Ka<span class="token punctuation">)</span><span class="token punctuation">;</span>
Offset <span class="token operator">=</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1j</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">*</span>Ext_f_eta<span class="token operator">.*</span>time_eta_c<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%偏移滤波器，将原点搬移到Naz/2的位置，校准坐标</span>
<span class="token comment">%  匹配滤波</span>
S4_tau_feta <span class="token operator">=</span> S3_tau_feta_RCMC <span class="token operator">.*</span> Haz<span class="token operator">.*</span>Offset<span class="token punctuation">;</span>
S4_tau_eta <span class="token operator">=</span> <span class="token function">fftshift</span><span class="token punctuation">(</span><span class="token function">ifft</span><span class="token punctuation">(</span><span class="token function">fftshift</span><span class="token punctuation">(</span>S4_tau_feta<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Naz<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>需要注意的是：</p> 
<ul><li>在方位向滤波器后的Offset是将成像的点目标<strong>校准到Naz/2</strong>的位置，也就是方位向上的时间轴中心</li><li>完成方位压缩时，也是在方位向上将已经被压缩成一条线的信号，在方位向上压缩，变成一个“点”<br> 得到的结果就是点目标成像结果：<br> <img src="https://images2.imgbox.com/b8/0f/iHOlW14x_o.png" alt="在这里插入图片描述">可以看到基本符合我们前面的点目标坐标设置</li></ul> 
<h4><a id="5_297"></a>5.升采样</h4> 
<h5><a id="1_298"></a>(1)总体步骤</h5> 
<p>什么是升采样？实际上就是利用了傅里叶变换的一个性质，在频域对信号进行补零，就可以让信号在时域的包络展示出更加多的细节，其本质就是我们说的插值；但是关于补零，书本上说的是：“需要十分小心谨慎”，因为如果补零的位置影响到了脉冲，那么就会破坏掉时域的效果（其实很简单，请看后续讲解）。所以说，升采样需要按顺序的几个步骤如下：</p> 
<ul><li>切片：将点目标信号从原来的Naz×Nrg维数中裁切下来，下面的代码以32×32为例</li><li>升采样（频域补零）：将信号通过fft和fftshift变换到二维频域，在不影响频谱的前提下插入0的数组</li><li>角度校正：由于斜视角的存在，（可以看上面的点目标成像图）点目标在竖直方向是直的，而在水平方向确实倾斜的，所以我们需要使用imrotate函数将图片进行旋转</li><li>剖面：将上面得到的包络使用find和max函数找到峰值点，以它为中心，横向和纵向分别“抽”出一条线，得到我们的剖面；但是剖面还需要进行abs求绝对值和dB化（很简单）</li></ul> 
<pre><code class="prism language-matlab"><span class="token comment">%% 目标的升采样切片</span>
<span class="token comment">%采用二维频域补零的方式进行升采样操作;升采样为了提高目标的切片细节丰富程度，便于观察</span>
CutResolution <span class="token operator">=</span> <span class="token number">32</span><span class="token punctuation">;</span> <span class="token comment">%切片尺寸</span>
Profile_Position <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">901</span><span class="token punctuation">,</span> <span class="token number">1570</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">%切片的中心点位置</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span>"<span class="token operator">\</span>n点目标<span class="token punctuation">(</span>C点<span class="token punctuation">)</span>坐标对应的距离门到雷达距离为<span class="token operator">:</span><span class="token comment">%.2f\n",(time_tau_r(Profile_Position(2)))*(c/2))</span>

<span class="token comment">%切片的升采样倍数：10*CutResolution；也就是在二维频域补多少个零</span>
S5_tau_eta_Cut <span class="token operator">=</span> <span class="token function">S4_tau_eta</span><span class="token punctuation">(</span><span class="token function">Profile_Position</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-</span>CutResolution<span class="token operator">/</span><span class="token number">2</span><span class="token operator">:</span><span class="token function">Profile_Position</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>CutResolution<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token function">Profile_Position</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span>CutResolution<span class="token operator">/</span><span class="token number">2</span><span class="token operator">:</span><span class="token function">Profile_Position</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span>CutResolution<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%切片</span>

<span class="token punctuation">[</span>S_zero_fill<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">fft_zero_fill</span><span class="token punctuation">(</span>S5_tau_eta_Cut<span class="token punctuation">,</span><span class="token number">10</span><span class="token operator">*</span>CutResolution<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%补零函数</span>

<span class="token comment">%由于斜视角的存在，在对升采样切片进行剖面分析前，将方位向和距离向都通过角度旋转校正到便于剖面的方向上</span>
S5_tau_eta_Cut_UP_Azi<span class="token operator">=</span><span class="token function">imrotate</span><span class="token punctuation">(</span>S_zero_fill<span class="token punctuation">,</span><span class="token function">rad2deg</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'bilinear'</span><span class="token punctuation">,</span> <span class="token string">'crop'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%方位向切片无需角度校正</span>
S5_tau_eta_Cut_UP_Ran <span class="token operator">=</span> <span class="token function">imrotate</span><span class="token punctuation">(</span>S_zero_fill<span class="token punctuation">,</span> <span class="token function">rad2deg</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'bilinear'</span><span class="token punctuation">,</span> <span class="token string">'crop'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%角度校正</span>
<span class="token comment">%求解升采样切片包络的abs最大值坐标，用于下面的剖面</span>
<span class="token punctuation">[</span>UP_Profile_Position_Ran<span class="token punctuation">,</span>UP_Profile_Position_Azi<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>S5_tau_eta_Cut_UP_Ran<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token function">abs</span><span class="token punctuation">(</span>S5_tau_eta_Cut_UP_Ran<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%幅度db化+搬移峰值至0dB</span>
<span class="token comment">%基于上面的升采样插值结果-&gt;获得剖面</span>
Abs_S5_Azi <span class="token operator">=</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">S5_tau_eta_Cut_UP_Azi</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> UP_Profile_Position_Azi<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%方位向剖面</span>
Abs_S5_Azi <span class="token operator">=</span> Abs_S5_Azi <span class="token operator">/</span> <span class="token function">max</span><span class="token punctuation">(</span>Abs_S5_Azi<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%移动峰值点</span>
Abs_S5_Ran <span class="token operator">=</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">S5_tau_eta_Cut_UP_Ran</span><span class="token punctuation">(</span>UP_Profile_Position_Ran<span class="token punctuation">,</span> <span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%距离向剖面</span>
Abs_S5_Ran <span class="token operator">=</span> Abs_S5_Ran <span class="token operator">/</span> <span class="token function">max</span><span class="token punctuation">(</span>Abs_S5_Ran<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/23/3c/gIg91zCd_o.png" alt="在这里插入图片描述"><br> 可以看到经过升采样，点目标的细节变得更加丰富，便于我们后续分析</p> 
<h5><a id="2_331"></a>(2)升采样(频域补零)</h5> 
<p>可以看到在上面的代码中，我使用了fft_zero_fill函数，是我自己写的一个补零函数(代码在这小节的最后)，那么具体应该是怎样的思路呢？我们先来看看二维频谱（注意这里不能fftshift）：<br> <img src="https://images2.imgbox.com/6c/44/WviTIA13_o.png" alt="在这里插入图片描述"><br> <strong>黄色区域是我们的频谱</strong>，也就是带有信息的频谱，如果要补零我们是绝对不可以让我们的全零数组影响到它们的！！！所以我的方案是沿着红色箭头的方向进行补零，补完零的效果就是：<br> <img src="https://images2.imgbox.com/86/ca/fRoFQttD_o.png" alt="在这里插入图片描述"><br> 可以看见能量被大量的0元素“挤压”到四角了，那么此时我们再反变换回二维时域即可。<br> fft_zero_fill函数代码如下：</p> 
<pre><code class="prism language-matlab">
<span class="token keyword">function</span> <span class="token punctuation">[</span>S_FFT<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">fft_zero_fill</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>nums<span class="token punctuation">)</span><span class="token comment">%进行补零；补零前一定要观察二维频谱，避免将补零的数组插到有能量的(黄色)区域，破坏原本的频谱！</span>
 S_FFT<span class="token operator">=</span><span class="token function">fft</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 S_FFT<span class="token operator">=</span><span class="token function">fft</span><span class="token punctuation">(</span>S_FFT<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%二维频谱；这里不使用fftshift，避免频谱被搬移到中心</span>
<span class="token function">figure</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span>"二维频域补零前"<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>S_FFT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%将二维频谱可视化，确定补零的范围(中点)</span>
Y_Insert<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%在Y方向插入(方位向)</span>
S_FFT<span class="token operator">=</span><span class="token punctuation">[</span><span class="token function">S_FFT</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span>Y_Insert<span class="token punctuation">;</span><span class="token function">S_FFT</span><span class="token punctuation">(</span><span class="token number">22</span><span class="token operator">:</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">%插入补零的数组;肉眼观察二维频谱的补零数组插入位置！！!</span>
X_Insert<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>S_FFT<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>nums<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%在X方向插入</span>
S_FFT<span class="token operator">=</span><span class="token punctuation">[</span><span class="token function">S_FFT</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">,</span>X_Insert<span class="token punctuation">,</span><span class="token function">S_FFT</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token operator">:</span><span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">%插入补零的数组;肉眼观察二维频谱的补零数组插入位置！！!</span>
<span class="token function">figure</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span>"二维频域补零后"<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>S_FFT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%将二维频谱可视化，确定补零的范围(中点)</span>
S_FFT<span class="token operator">=</span><span class="token punctuation">(</span><span class="token function">ifft</span><span class="token punctuation">(</span><span class="token function">ifft</span><span class="token punctuation">(</span>S_FFT<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%反变换，回到二维时域</span>
<span class="token comment">% </span>
<span class="token comment">% figure;</span>
<span class="token comment">% imagesc(abs(ifft(ifft(S_FFT,[],1),[],2)))</span>
<span class="token keyword">end</span>
</code></pre> 
<h5><a id="3_357"></a>(3)剖面</h5> 
<p>经过了前面的升采样，我们也通过类似于这个代码（实际上很简单）：</p> 
<pre><code class="prism language-Matlab">Abs_S5_Azi = abs(S5_tau_eta_Cut_UP_Azi(:, UP_Profile_Position_Azi)); %方位向剖面
</code></pre> 
<p>完成了剖面的求解、幅值化、dB化的工作，得到了下面的剖面图：<br> <img src="https://images2.imgbox.com/9f/58/8eL096qn_o.png" alt="在这里插入图片描述"><br> 图中的红线就是-13dB，也就是说我们的剖面中峰值旁瓣比未能到达-13dB以下（是必须达到的及格线），可以说算法无法满足高分3号的星载SAR成像条件，需要使用下面的大斜视角处理来进行改进。</p> 
<h3><a id="_365"></a>五、大斜视角处理</h3> 
<p>大斜视角处理其实只是针对上面的几个环节进行改进，基本的框架还是相同的，建议先看看书上的对应内容</p> 
<h4><a id="1_367"></a>1.距离压缩-&gt;二次距离压缩(改进)</h4> 
<p>所谓的二次距离压缩实际上很简单，就是将Km和Ksrc引入以解决调频率失配的问题，基本上就是将书上的参数计算敲进来即可</p> 
<pre><code class="prism language-matlab"><span class="token comment">%% 距离压缩(方式3)</span>
D_feta_Vr<span class="token operator">=</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token punctuation">(</span>lambda<span class="token operator">*</span>Ext_f_eta<span class="token punctuation">)</span><span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token punctuation">(</span>Vr<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%徙动因子</span>
K_src<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span>Vr<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>f0<span class="token operator">^</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>D_feta_Vr<span class="token operator">.^</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">./</span><span class="token punctuation">(</span>c<span class="token operator">*</span>R0<span class="token operator">*</span><span class="token punctuation">(</span>Ext_f_eta<span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Km<span class="token operator">=</span>Kr<span class="token operator">./</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>Kr<span class="token operator">./</span>K_src<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%改进的调频率</span>
Hf <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>Ext_f_tau<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> Br <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">.*</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">+</span><span class="token number">1j</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">*</span><span class="token punctuation">(</span>Ext_f_tau<span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">./</span>Km<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%匹配滤波器</span>

<span class="token comment">%  匹配滤波</span>
S1_ftau_eta <span class="token operator">=</span> <span class="token function">fftshift</span><span class="token punctuation">(</span><span class="token function">fft</span><span class="token punctuation">(</span><span class="token function">fftshift</span><span class="token punctuation">(</span>S_echo<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Nrg<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
S1_ftau_eta <span class="token operator">=</span> S1_ftau_eta <span class="token operator">.*</span> Hf<span class="token punctuation">;</span><span class="token comment">%距离频域进行匹配滤波</span>
S1_tau_eta <span class="token operator">=</span> <span class="token function">fftshift</span><span class="token punctuation">(</span><span class="token function">ifft</span><span class="token punctuation">(</span><span class="token function">fftshift</span><span class="token punctuation">(</span>S1_ftau_eta<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Nrg<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/fb/91/wferAbFz_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="2_385"></a>2.方位向傅里叶变换</h4> 
<p>方位向傅里叶变换没有任何不同，这里不赘述了</p> 
<h4><a id="3_387"></a>3.距离徙动校正-&gt;引入新的徙动量(改进)</h4> 
<p>引入了新的距离徙动量，改进了我们相乘的相位，基本步骤和效果还是相同的</p> 
<pre><code class="prism language-matlab"><span class="token comment">%% 距离徙动校正RCMC:采用相位补偿法</span>

<span class="token comment">%虽然Ka是随着R0变化的，但是在相位补偿时需要假设R0是不变的</span>
<span class="token comment">% delta_R = (((lambda * Ext_f_eta).^2) .* R0) ./ (8 * (Vr^2)); %距离徙动表达式</span>
delta_R <span class="token operator">=</span> R0<span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>D_feta_Vr<span class="token punctuation">)</span><span class="token operator">./</span>D_feta_Vr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%距离徙动表达式</span>
G_rcmc <span class="token operator">=</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">+</span><span class="token number">4j</span> <span class="token operator">*</span> <span class="token keyword">pi</span> <span class="token operator">.*</span> Ext_f_tau <span class="token operator">.*</span> delta_R<span class="token punctuation">)</span><span class="token operator">./</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%补偿相位</span>
S3_ftau_feta <span class="token operator">=</span> <span class="token function">fftshift</span><span class="token punctuation">(</span><span class="token function">fft</span><span class="token punctuation">(</span><span class="token function">fftshift</span><span class="token punctuation">(</span>S2_tau_feta<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Nrg<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%在方位向傅里叶变换的基础上进行距离向傅里叶变换</span>

S3_ftau_feta <span class="token operator">=</span> S3_ftau_feta <span class="token operator">.*</span> G_rcmc<span class="token punctuation">;</span> <span class="token comment">%与补偿相位相乘</span>
S3_tau_feta_RCMC <span class="token operator">=</span> <span class="token function">fftshift</span><span class="token punctuation">(</span><span class="token function">ifft</span><span class="token punctuation">(</span><span class="token function">fftshift</span><span class="token punctuation">(</span>S3_ftau_feta<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Nrg<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%距离向傅里叶逆变换</span>

<span class="token comment">%距离徙动校正结束</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/18/c8/yUOX1qoI_o.png" alt="在这里插入图片描述"><br> 上图中红线代表点目标的多普勒中心频率，可以忽略</p> 
<h4><a id="3_405"></a>3.方位压缩-&gt;引入新的滤波器(改进)</h4> 
<p>在方位向上引入了书上的新的匹配滤波器，能够获得更好的方位压缩效果</p> 
<pre><code class="prism language-matlab"><span class="token comment">%% 方位压缩</span>
<span class="token comment">%  根据变化的R0计算出相应的Ka矩阵(距离向变化，方位向不变)</span>
Ka <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> Vr<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span> <span class="token operator">./</span> <span class="token punctuation">(</span>lambda <span class="token operator">*</span> Ext_R0_tau_r<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">%  方位向匹配滤波器</span>
Haz <span class="token operator">=</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1j</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">*</span>Ext_f_eta<span class="token operator">.^</span><span class="token number">2.</span><span class="token operator">/</span>Ka<span class="token punctuation">)</span><span class="token punctuation">;</span>
Haz_BT<span class="token operator">=</span><span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">+</span><span class="token number">4j</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">*</span><span class="token punctuation">(</span>Ext_R0_tau_r<span class="token operator">.*</span>D_feta_Vr<span class="token operator">*</span>f0<span class="token punctuation">)</span><span class="token operator">/</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%改进的方位滤波器</span>
Offset <span class="token operator">=</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1j</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">*</span>Ext_f_eta<span class="token operator">.*</span>time_eta_c<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%偏移滤波器，将原点搬移到Naz/2的位置，校准坐标</span>
ABS_offset<span class="token operator">=</span><span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2j</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">*</span>Ext_f_eta<span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">29</span><span class="token operator">/</span>Fa<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%上面的Offset校准不够精确，观察方位向上原点与Naz/2的差值，二次校准</span>
<span class="token comment">%  匹配滤波   </span>
S4_tau_feta <span class="token operator">=</span> S3_tau_feta_RCMC <span class="token operator">.*</span> Haz_BT<span class="token operator">.*</span>Offset<span class="token operator">.*</span>ABS_offset<span class="token punctuation">;</span>
S4_tau_eta <span class="token operator">=</span> <span class="token function">fftshift</span><span class="token punctuation">(</span><span class="token function">ifft</span><span class="token punctuation">(</span><span class="token function">fftshift</span><span class="token punctuation">(</span>S4_tau_feta<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Naz<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>其中ABS_offset是校准的一个绝对偏移，因为个人的需要将原点目标矫正到Naz/2；可以忽略<br> <img src="https://images2.imgbox.com/64/ee/cHg68bU9_o.png" alt="在这里插入图片描述"><br> 得到了点目标成像结果，能够看出来变得更加规则一点了</p> 
<h4><a id="4_423"></a>4.升采样结果</h4> 
<p>使用与前面的小斜视角相同的升采样方法，得到的结果如下：<br> <img src="https://images2.imgbox.com/3e/13/YnxRlN4v_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/aa/e9/FaMQlIEY_o.png" alt="在这里插入图片描述"><br> 从图上可以看出：</p> 
<ul><li>轮廓图和等高线图漂亮多了，变得非常规整</li><li>剖面的包络都在-13dB以下，可以认为成像成功</li></ul> 
<h3><a id="_430"></a>六、完整代码</h3> 
<h4><a id="1_431"></a>1.低斜视角处理</h4> 
<pre><code class="prism language-matlab"><span class="token comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="token comment">%      高分3号卫星参数RDA点目标仿真    %</span>
<span class="token comment">%                                    %</span>
<span class="token comment">%        日期：2023年9月22日          %</span>
<span class="token comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
clc<span class="token punctuation">;</span>clear<span class="token punctuation">;</span>close all<span class="token punctuation">;</span>
<span class="token comment">%代码格式化命令：MBeautify.formatCurrentEditorPage()</span>

<span class="token comment">%% 卫星轨道参数</span>

H <span class="token operator">=</span> <span class="token number">755e3</span><span class="token punctuation">;</span> <span class="token comment">%卫星轨道高度</span>
<span class="token comment">% 卫星轨道速度Vr计算</span>
EarthMass <span class="token operator">=</span> <span class="token number">6e24</span><span class="token punctuation">;</span> <span class="token comment">%地球质量(kg)</span>
EarthRadius <span class="token operator">=</span> <span class="token number">6.37e6</span><span class="token punctuation">;</span> <span class="token comment">%地球半径6371km</span>
Gravitational <span class="token operator">=</span> <span class="token number">6.67e-11</span><span class="token punctuation">;</span> <span class="token comment">%万有引力常量</span>
<span class="token comment">% 姿态参数</span>
phi <span class="token operator">=</span> <span class="token number">20</span> <span class="token operator">*</span> <span class="token keyword">pi</span> <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">;</span> <span class="token comment">% 俯仰角+20°</span>
incidence <span class="token operator">=</span> <span class="token number">20.5</span> <span class="token operator">*</span> <span class="token keyword">pi</span> <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">;</span> <span class="token comment">% 入射角</span>
<span class="token comment">%计算等效雷达速度(卫星做圆周运动的线速度)</span>
Vr <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>Gravitational<span class="token operator">*</span>EarthMass<span class="token operator">/</span><span class="token punctuation">(</span>EarthRadius <span class="token operator">+</span> H<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%第一宇宙速度</span>

<span class="token comment">%景中心斜距R_eta_c和最近斜距R0，斜视角theta_rc由轨道高度、俯仰角、入射角计算得出</span>
R_eta_c <span class="token operator">=</span> H <span class="token operator">/</span> <span class="token function">cos</span><span class="token punctuation">(</span>incidence<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%景中心斜距</span>
R0 <span class="token operator">=</span> H <span class="token operator">/</span> <span class="token function">cos</span><span class="token punctuation">(</span>phi<span class="token punctuation">)</span><span class="token punctuation">;</span>
theta_r_c <span class="token operator">=</span> <span class="token function">acos</span><span class="token punctuation">(</span>R0<span class="token operator">/</span>R_eta_c<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%斜视角，单位为弧度;斜视角为4.6°</span>

<span class="token comment">%% 信号参数设置</span>

<span class="token comment">%   电磁波参数</span>
c <span class="token operator">=</span> <span class="token number">3e+8</span><span class="token punctuation">;</span> <span class="token comment">% 光速</span>
Vs <span class="token operator">=</span> Vr<span class="token punctuation">;</span> <span class="token comment">% 卫星平台速度</span>
Vg <span class="token operator">=</span> Vr<span class="token punctuation">;</span> <span class="token comment">% 波束扫描速度</span>
La <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span> <span class="token comment">%方位向天线长度-&gt;椭圆的长轴</span>
Lr<span class="token operator">=</span><span class="token number">1.5</span><span class="token punctuation">;</span><span class="token comment">%距离向天线尺寸——&gt;椭圆的短轴</span>
f0 <span class="token operator">=</span> <span class="token number">5.4e+9</span><span class="token punctuation">;</span> <span class="token comment">% 雷达工作频率</span>
lambda <span class="token operator">=</span> c <span class="token operator">/</span> f0<span class="token punctuation">;</span> <span class="token comment">%电磁波波长</span>


<span class="token comment">%  距离向信号参数</span>
Tr <span class="token operator">=</span> <span class="token number">40e-6</span><span class="token punctuation">;</span> <span class="token comment">% 发射脉冲时宽</span>
Br <span class="token operator">=</span> <span class="token number">2.8</span> <span class="token operator">*</span> <span class="token number">6e6</span><span class="token punctuation">;</span> <span class="token comment">% 距离向信号带宽</span>
Kr <span class="token operator">=</span> Br <span class="token operator">/</span> Tr<span class="token punctuation">;</span> <span class="token comment">% 距离向调频率</span>
alpha_os_r <span class="token operator">=</span> <span class="token number">1.2</span><span class="token punctuation">;</span> <span class="token comment">% 距离过采样率</span>
Nrg <span class="token operator">=</span> <span class="token number">2500</span><span class="token punctuation">;</span> <span class="token comment">% 距离线采样点数</span>
Fr <span class="token operator">=</span> alpha_os_r <span class="token operator">*</span> Br<span class="token punctuation">;</span> <span class="token comment">% 距离向采样率</span>

<span class="token comment">%  方位向信号参数</span>
alpha_os_a <span class="token operator">=</span> <span class="token number">1.7</span><span class="token punctuation">;</span> <span class="token comment">% 方位过采样率(高过采样率避免鬼影目标)</span>
Naz <span class="token operator">=</span> <span class="token number">1600</span><span class="token punctuation">;</span> <span class="token comment">% 距离线数</span>
delta_f_dop <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token number">0.886</span> <span class="token operator">*</span> Vr <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token function">cos</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> La<span class="token punctuation">;</span> <span class="token comment">% 多普勒带宽</span>
Fa <span class="token operator">=</span> alpha_os_a <span class="token operator">*</span> delta_f_dop<span class="token punctuation">;</span> <span class="token comment">% 方位向采样率</span>
Ta <span class="token operator">=</span> <span class="token number">0.886</span> <span class="token operator">*</span> lambda <span class="token operator">*</span> R_eta_c <span class="token operator">/</span> <span class="token punctuation">(</span>La <span class="token operator">*</span> Vg <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%目标照射时间</span>

<span class="token comment">%  景中心点(原点)的参数</span>
time_eta_c <span class="token operator">=</span> <span class="token operator">-</span>R_eta_c <span class="token operator">*</span> <span class="token function">sin</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span> <span class="token operator">/</span> Vr<span class="token punctuation">;</span> <span class="token comment">% 波束中心穿越时刻</span>
f_eta_c <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> Vr <span class="token operator">*</span> <span class="token function">sin</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span> <span class="token operator">/</span> lambda<span class="token punctuation">;</span> <span class="token comment">% 多普勒中心频率</span>

<span class="token comment">%  合成孔径参数</span>
rho_r <span class="token operator">=</span> c <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> Fr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 距离向分辨率</span>
rho_a <span class="token operator">=</span> Vr<span class="token operator">/</span>Fa<span class="token punctuation">;</span> <span class="token comment">% 距离向分辨率|La / 2</span>
theta_bw <span class="token operator">=</span> <span class="token number">0.886</span> <span class="token operator">*</span> lambda <span class="token operator">/</span> Lr<span class="token punctuation">;</span> <span class="token comment">% 方位向3dB波束宽度</span>
theta_syn <span class="token operator">=</span> Vs <span class="token operator">/</span> Vg <span class="token operator">*</span> theta_bw<span class="token punctuation">;</span> <span class="token comment">% 合成角宽度(斜面上的合成角)</span>
Ls <span class="token operator">=</span> R_eta_c <span class="token operator">*</span> theta_syn<span class="token punctuation">;</span> <span class="token comment">% 合成孔径长度</span>

<span class="token comment">%% 时间轴参数</span>
Trg <span class="token operator">=</span> Nrg <span class="token operator">/</span> Fr<span class="token punctuation">;</span>Taz <span class="token operator">=</span> Naz <span class="token operator">/</span> Fa<span class="token punctuation">;</span>
<span class="token comment">%距离向/方位向采样时间间隔</span>
Gap_t_tau <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> Fr<span class="token punctuation">;</span>Gap_t_eta <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> Fa<span class="token punctuation">;</span>
<span class="token comment">%距离向/方位向采样频率间隔</span>
Gap_f_tau <span class="token operator">=</span> Fr <span class="token operator">/</span> Nrg<span class="token punctuation">;</span>Gap_f_eta <span class="token operator">=</span> Fa <span class="token operator">/</span> Naz<span class="token punctuation">;</span>
<span class="token comment">%  时间轴变量</span>
time_tau_r <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> R_eta_c <span class="token operator">/</span> c <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">-</span>Trg <span class="token operator">/</span> <span class="token number">2</span><span class="token operator">:</span>Gap_t_tau<span class="token operator">:</span>Trg <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> Gap_t_tau<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 距离时间变量</span>
time_eta_a <span class="token operator">=</span> time_eta_c <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">-</span>Taz <span class="token operator">/</span> <span class="token number">2</span><span class="token operator">:</span>Gap_t_eta<span class="token operator">:</span>Taz <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> Gap_t_eta<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 方位时间变量</span>
<span class="token comment">%  随着距离向时间变化的最近斜距；c/2是因为距离向上一个时间包含两次电磁波来回</span>
R0_tau_r <span class="token operator">=</span> <span class="token punctuation">(</span>time_tau_r <span class="token operator">*</span> c <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span><span class="token punctuation">;</span>
Ext_R0_tau_r <span class="token operator">=</span> <span class="token function">repmat</span><span class="token punctuation">(</span>R0_tau_r<span class="token punctuation">,</span> Naz<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%扩展R0，用于计算变量Ka</span>
<span class="token comment">%  频率变量</span>
f_tau <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">-</span>Fr <span class="token operator">/</span> <span class="token number">2</span><span class="token operator">:</span>Gap_f_tau<span class="token operator">:</span>Fr <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> Gap_f_tau<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 距离频率变量</span>
f_tau<span class="token operator">=</span>f_tau<span class="token operator">-</span><span class="token punctuation">(</span><span class="token function">round</span><span class="token punctuation">(</span>f_tau<span class="token operator">/</span>Fr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>Fr<span class="token punctuation">;</span><span class="token comment">%混叠方程</span>
f_eta <span class="token operator">=</span> f_eta_c <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">-</span>Fa <span class="token operator">/</span> <span class="token number">2</span><span class="token operator">:</span>Gap_f_eta<span class="token operator">:</span>Fa <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> Gap_f_eta<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 方位频率变量</span>
f_eta<span class="token operator">=</span>f_eta<span class="token operator">-</span><span class="token punctuation">(</span><span class="token function">round</span><span class="token punctuation">(</span>f_eta<span class="token operator">/</span>Fa<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>Fa<span class="token punctuation">;</span>

<span class="token comment">%  时间轴</span>
<span class="token punctuation">[</span>Ext_time_tau_r<span class="token punctuation">,</span> Ext_time_eta_a<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">meshgrid</span><span class="token punctuation">(</span>time_tau_r<span class="token punctuation">,</span> time_eta_a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 设置距离时域-方位时域二维网络坐标</span>
<span class="token comment">%  频率轴</span>
<span class="token punctuation">[</span>Ext_f_tau<span class="token punctuation">,</span> Ext_f_eta<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">meshgrid</span><span class="token punctuation">(</span>f_tau<span class="token punctuation">,</span> f_eta<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 设置频率时域-方位频域二维网络坐标</span>

<span class="token comment">%% 点目标(三个)坐标设置</span>
<span class="token comment">%  设置目标点相对于景中心之间的距离</span>

xA <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>yA <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">%A=(0,0)</span>
xB <span class="token operator">=</span> xA <span class="token operator">+</span> <span class="token number">500</span><span class="token punctuation">;</span>yB <span class="token operator">=</span> xA <span class="token operator">+</span> <span class="token number">500</span><span class="token punctuation">;</span> <span class="token comment">%（500,500）</span>

xC <span class="token operator">=</span> H<span class="token operator">*</span><span class="token function">tan</span><span class="token punctuation">(</span>phi<span class="token operator">+</span>theta_bw<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span>R0<span class="token operator">*</span><span class="token function">sin</span><span class="token punctuation">(</span>phi<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%计算的C点距离向坐标</span>
yC <span class="token operator">=</span> xA <span class="token operator">+</span> <span class="token number">500</span><span class="token punctuation">;</span>
Position_x_r <span class="token operator">=</span> <span class="token punctuation">[</span>xA<span class="token punctuation">,</span> xB<span class="token punctuation">,</span> xC<span class="token punctuation">]</span><span class="token punctuation">;</span>
Position_y_a <span class="token operator">=</span> <span class="token punctuation">[</span>yA<span class="token punctuation">,</span> yB<span class="token punctuation">,</span> yC<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">%点目标的坐标矩阵表示</span>

<span class="token comment">%% 生成回波S_echo</span>
Target_num <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">%目标数量</span>
S_echo <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>Naz<span class="token punctuation">,</span> Nrg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token number">i</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span>Target_num
    R0_Target <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>R0 <span class="token operator">*</span> <span class="token function">sin</span><span class="token punctuation">(</span>phi<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">Position_x_r</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span>H<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%对每个目标计算瞬时斜距</span>
    
    time_eta_c_Target <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">Position_y_a</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">-</span>R0_Target <span class="token operator">*</span> <span class="token function">tan</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> Vr<span class="token punctuation">;</span> <span class="token comment">%波束中心穿越时刻</span>

    <span class="token comment">%  计算目标点的瞬时斜距</span>
    R_eta <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>R0_Target<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span><span class="token punctuation">(</span>Vr<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Ext_time_eta_a <span class="token operator">-</span> <span class="token function">Position_y_a</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span> <span class="token operator">/</span> Vr<span class="token punctuation">)</span><span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%R_eta=sqrt(H^2+(Position_x_r(i)-(-R0*sin(phi)))^2+(Position_y_a(i)-Ext_time_eta_a*Vr).^2);</span>
    <span class="token comment">%  距离向包络</span>
    Wr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>Ext_time_tau_r<span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span>R_eta<span class="token operator">/</span>c<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> Tr <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%  方位向包络</span>
    <span class="token comment">%Wa = sinc((La*atan(Vg*(Ext_time_eta_a - time_eta_c_Target)./R0_Target)/lambda).^2);</span>
    Wa <span class="token operator">=</span> <span class="token punctuation">(</span>La<span class="token operator">*</span><span class="token function">atan</span><span class="token punctuation">(</span>Vg<span class="token operator">*</span><span class="token punctuation">(</span>Ext_time_eta_a <span class="token operator">-</span> time_eta_c_Target<span class="token punctuation">)</span><span class="token operator">./</span><span class="token punctuation">(</span>R0 <span class="token operator">*</span> <span class="token function">sin</span><span class="token punctuation">(</span>phi<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">Position_x_r</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>lambda<span class="token punctuation">)</span><span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span>Ta<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token comment">%Wa = abs(Ext_time_eta_a-time_eta_c_Target) &lt;= Ta / 2;</span>
    <span class="token comment">%   相位</span>
    Phase <span class="token operator">=</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1j</span><span class="token operator">*</span><span class="token number">4</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">*</span>f0<span class="token operator">*</span>R_eta<span class="token operator">/</span>c<span class="token punctuation">)</span> <span class="token operator">.*</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">+</span><span class="token number">1j</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">*</span>Kr<span class="token operator">*</span><span class="token punctuation">(</span>Ext_time_tau_r <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> R_eta <span class="token operator">/</span> c<span class="token punctuation">)</span><span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%  接收信号叠加</span>
    S_echo_Target <span class="token operator">=</span> Wr <span class="token operator">.*</span> Wa <span class="token operator">.*</span> Phase<span class="token punctuation">;</span>
    S_echo <span class="token operator">=</span> S_echo <span class="token operator">+</span> S_echo_Target<span class="token punctuation">;</span>
    <span class="token comment">%%%%%%%%%%%%%%格式化输出%%%%%%%%%%%%%%%%%%</span>
    R_eta_c_Target<span class="token operator">=</span>R0_Target<span class="token operator">/</span><span class="token function">cos</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span>"当前目标<span class="token operator">:</span><span class="token comment">%d,坐标:(%.2f,%.2f),\n最近斜距R0=%.2f,景中心斜距R_eta_c=%.2f,波束中心穿越时刻=%.4f\n", i, Position_x_r(i), Position_y_a(i), R0_Target, R_eta_c_Target,time_eta_c_Target)</span>
    Time_tau_Point <span class="token operator">=</span>  <span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>R0_Target<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>c<span class="token operator">*</span><span class="token function">cos</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">time_tau_r</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>Gap_t_tau<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%目标的距离向标准坐标(距离门)</span>
    Time_eta_Point <span class="token operator">=</span> Naz <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token function">Position_y_a</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span> <span class="token operator">/</span> Vr<span class="token punctuation">)</span> <span class="token operator">/</span>Gap_t_eta<span class="token punctuation">;</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span>"徙动校正前<span class="token punctuation">,</span>点数坐标应为<span class="token comment">%d行(方),%d列(距)\n\n",round(Time_eta_Point),Time_tau_Point);</span>
<span class="token keyword">end</span>
S_echo <span class="token operator">=</span> S_echo <span class="token operator">.*</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2j</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">*</span>f_eta_c<span class="token operator">*</span>Ext_time_eta_a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%校正时间轴</span>

<span class="token comment">%% 距离压缩</span>

Hf <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>Ext_f_tau<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> Br <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">.*</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">+</span><span class="token number">1j</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">*</span>Ext_f_tau<span class="token operator">.^</span><span class="token number">2</span><span class="token operator">/</span>Kr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%滤波器</span>
<span class="token comment">%  匹配滤波</span>
S1_ftau_eta <span class="token operator">=</span> <span class="token function">fftshift</span><span class="token punctuation">(</span><span class="token function">fft</span><span class="token punctuation">(</span><span class="token function">fftshift</span><span class="token punctuation">(</span>S_echo<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Nrg<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
S1_ftau_eta <span class="token operator">=</span> S1_ftau_eta <span class="token operator">.*</span> Hf<span class="token punctuation">;</span>
S1_tau_eta <span class="token operator">=</span> <span class="token function">fftshift</span><span class="token punctuation">(</span><span class="token function">ifft</span><span class="token punctuation">(</span><span class="token function">fftshift</span><span class="token punctuation">(</span>S1_ftau_eta<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Nrg<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% 方位向傅里叶变换</span>
S2_tau_feta <span class="token operator">=</span> <span class="token function">fftshift</span><span class="token punctuation">(</span><span class="token function">fft</span><span class="token punctuation">(</span><span class="token function">fftshift</span><span class="token punctuation">(</span>S1_tau_eta<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Naz<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% 距离徙动校正RCMC:采用相位补偿法</span>

<span class="token comment">%虽然Ka是随着R0变化的，但是在相位补偿时需要假设R0是不变的</span>
delta_R <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>lambda <span class="token operator">*</span> Ext_f_eta<span class="token punctuation">)</span><span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">.*</span> R0<span class="token punctuation">)</span> <span class="token operator">./</span> <span class="token punctuation">(</span><span class="token number">8</span> <span class="token operator">*</span> <span class="token punctuation">(</span>Vr<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%距离徙动表达式</span>
G_rcmc <span class="token operator">=</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">+</span><span class="token number">4j</span> <span class="token operator">*</span> <span class="token keyword">pi</span> <span class="token operator">.*</span> Ext_f_tau <span class="token operator">.*</span> delta_R<span class="token punctuation">)</span><span class="token operator">./</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%补偿相位</span>
S3_ftau_feta <span class="token operator">=</span> <span class="token function">fftshift</span><span class="token punctuation">(</span><span class="token function">fft</span><span class="token punctuation">(</span><span class="token function">fftshift</span><span class="token punctuation">(</span>S2_tau_feta<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Nrg<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%在方位向傅里叶变换的基础上进行距离向傅里叶变换</span>

S3_ftau_feta <span class="token operator">=</span> S3_ftau_feta <span class="token operator">.*</span> G_rcmc<span class="token punctuation">;</span> <span class="token comment">%与补偿相位相乘</span>
S3_tau_feta_RCMC <span class="token operator">=</span> <span class="token function">fftshift</span><span class="token punctuation">(</span><span class="token function">ifft</span><span class="token punctuation">(</span><span class="token function">fftshift</span><span class="token punctuation">(</span>S3_ftau_feta<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Nrg<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%距离向傅里叶逆变换</span>

<span class="token comment">%距离徙动校正结束</span>

<span class="token comment">%% 方位压缩</span>
<span class="token comment">%  根据变化的R0计算出相应的Ka矩阵(距离向变化，方位向不变)</span>
Ka <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> Vr<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span> <span class="token operator">./</span> <span class="token punctuation">(</span>lambda <span class="token operator">*</span> Ext_R0_tau_r<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">%  方位向匹配滤波器</span>
Haz <span class="token operator">=</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1j</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">*</span>Ext_f_eta<span class="token operator">.^</span><span class="token number">2.</span><span class="token operator">/</span>Ka<span class="token punctuation">)</span><span class="token punctuation">;</span>
Offset <span class="token operator">=</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1j</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">*</span>Ext_f_eta<span class="token operator">.*</span>time_eta_c<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%偏移滤波器，将原点搬移到Naz/2的位置，校准坐标</span>
<span class="token comment">%  匹配滤波</span>
S4_tau_feta <span class="token operator">=</span> S3_tau_feta_RCMC <span class="token operator">.*</span> Haz<span class="token operator">.*</span>Offset<span class="token punctuation">;</span>
S4_tau_eta <span class="token operator">=</span> <span class="token function">fftshift</span><span class="token punctuation">(</span><span class="token function">ifft</span><span class="token punctuation">(</span><span class="token function">fftshift</span><span class="token punctuation">(</span>S4_tau_feta<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Naz<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% 目标的升采样切片</span>
<span class="token comment">%采用二维频域补零的方式进行升采样操作;升采样为了提高目标的切片细节丰富程度，便于观察</span>
CutResolution <span class="token operator">=</span> <span class="token number">32</span><span class="token punctuation">;</span> <span class="token comment">%切片尺寸</span>
Profile_Position <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">901</span><span class="token punctuation">,</span> <span class="token number">1570</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">%切片的中心点位置</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span>"<span class="token operator">\</span>n点目标<span class="token punctuation">(</span>C点<span class="token punctuation">)</span>坐标对应的距离门到雷达距离为<span class="token operator">:</span><span class="token comment">%.2f\n",(time_tau_r(Profile_Position(2)))*(c/2))</span>

<span class="token comment">%切片的升采样倍数：10*CutResolution；也就是在二维频域补多少个零</span>
S5_tau_eta_Cut <span class="token operator">=</span> <span class="token function">S4_tau_eta</span><span class="token punctuation">(</span><span class="token function">Profile_Position</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-</span>CutResolution<span class="token operator">/</span><span class="token number">2</span><span class="token operator">:</span><span class="token function">Profile_Position</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>CutResolution<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token function">Profile_Position</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span>CutResolution<span class="token operator">/</span><span class="token number">2</span><span class="token operator">:</span><span class="token function">Profile_Position</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span>CutResolution<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%切片</span>

<span class="token punctuation">[</span>S_zero_fill<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">fft_zero_fill</span><span class="token punctuation">(</span>S5_tau_eta_Cut<span class="token punctuation">,</span><span class="token number">10</span><span class="token operator">*</span>CutResolution<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%补零函数</span>

<span class="token comment">%由于斜视角的存在，在对升采样切片进行剖面分析前，将方位向和距离向都通过角度旋转校正到便于剖面的方向上</span>
S5_tau_eta_Cut_UP_Azi<span class="token operator">=</span><span class="token function">imrotate</span><span class="token punctuation">(</span>S_zero_fill<span class="token punctuation">,</span><span class="token function">rad2deg</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'bilinear'</span><span class="token punctuation">,</span> <span class="token string">'crop'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%方位向切片无需角度校正</span>
S5_tau_eta_Cut_UP_Ran <span class="token operator">=</span> <span class="token function">imrotate</span><span class="token punctuation">(</span>S_zero_fill<span class="token punctuation">,</span> <span class="token function">rad2deg</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'bilinear'</span><span class="token punctuation">,</span> <span class="token string">'crop'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%角度校正</span>
<span class="token comment">%求解升采样切片包络的abs最大值坐标，用于下面的剖面</span>
<span class="token punctuation">[</span>UP_Profile_Position_Ran<span class="token punctuation">,</span>UP_Profile_Position_Azi<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>S5_tau_eta_Cut_UP_Ran<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token function">abs</span><span class="token punctuation">(</span>S5_tau_eta_Cut_UP_Ran<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%幅度db化+搬移峰值至0dB</span>
<span class="token comment">%基于上面的升采样插值结果-&gt;获得剖面</span>
Abs_S5_Azi <span class="token operator">=</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">S5_tau_eta_Cut_UP_Azi</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> UP_Profile_Position_Azi<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%方位向剖面</span>
Abs_S5_Azi <span class="token operator">=</span> Abs_S5_Azi <span class="token operator">/</span> <span class="token function">max</span><span class="token punctuation">(</span>Abs_S5_Azi<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%移动峰值点</span>
Abs_S5_Ran <span class="token operator">=</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">S5_tau_eta_Cut_UP_Ran</span><span class="token punctuation">(</span>UP_Profile_Position_Ran<span class="token punctuation">,</span> <span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%距离向剖面</span>
Abs_S5_Ran <span class="token operator">=</span> Abs_S5_Ran <span class="token operator">/</span> <span class="token function">max</span><span class="token punctuation">(</span>Abs_S5_Ran<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% 回波图可视化</span>

<span class="token function">figure</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> "回波可视化"<span class="token punctuation">)</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">real</span><span class="token punctuation">(</span>S_echo<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'原始仿真信号实部'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间 \tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间 \eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">imag</span><span class="token punctuation">(</span>S_echo<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'原始仿真信号虚部'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间 \tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间 \eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>S_echo<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'原始仿真信号幅度'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间 \tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间 \eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">angle</span><span class="token punctuation">(</span>S_echo<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'原始仿真信号相位'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间 \tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间 \eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% 距离压缩可视化</span>

<span class="token comment">%距离频谱可视化</span>
<span class="token function">figure</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> "回波频谱可视化"<span class="token punctuation">)</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">real</span><span class="token punctuation">(</span>S1_ftau_eta<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'回波距离向实部'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向频谱点数f_\tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间 \eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">imag</span><span class="token punctuation">(</span>S1_ftau_eta<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'回波距离向虚部'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向频谱点数f_\tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间 \eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>S1_ftau_eta<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'回波距离向频谱幅度'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向频谱点数f_\tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间 \eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">angle</span><span class="token punctuation">(</span>S1_ftau_eta<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'回波距离向相位'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向频谱点数f_\tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间 \eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%距离压缩结果</span>
<span class="token function">figure</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> "距离压缩时域结果"<span class="token punctuation">)</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">real</span><span class="token punctuation">(</span>S1_tau_eta<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'实部'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间 \tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间 \eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>S1_tau_eta<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'幅度'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间 \tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间 \eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% 方位向傅里叶变换可视化</span>

<span class="token function">figure</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> "方位向傅里叶变换结果"<span class="token punctuation">)</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">real</span><span class="token punctuation">(</span>S2_tau_feta<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'实部'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间\tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向频谱点数f_\eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>S2_tau_feta<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'幅度'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间\tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向频谱点数f_\eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% 距离徙动校正可视化</span>

<span class="token function">figure</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> "距离徙动校正结果"<span class="token punctuation">)</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">real</span><span class="token punctuation">(</span>S3_tau_feta_RCMC<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'实部'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间\tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向频率点数 f_\eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>S3_tau_feta_RCMC<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'幅度'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间\tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向频率点数 f_\eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% 回波成像</span>
<span class="token function">figure</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> "点目标成像结果"<span class="token punctuation">)</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>S4_tau_eta<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'幅度'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间\tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间 \eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>S5_tau_eta_Cut<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%切片</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'点目标C的32×32切片(角度校正前)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间\tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间\eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">%% 升采样成像</span>
<span class="token function">figure</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> "升采样成像结果"<span class="token punctuation">)</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>S5_tau_eta_Cut_UP_Ran<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'幅度'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间\tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间 \eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%contour((1:Nrg),(1:Naz),abs(S5_tau_eta_Cut_UP_Ran),20);</span>
<span class="token function">contour</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>S5_tau_eta_Cut_UP_Ran<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'升采样轮廓图'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间\tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间\eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% 切片包络幅度(dB)剖面</span>
<span class="token function">figure</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> "目标C的距离和方位幅度包络切片<span class="token punctuation">(</span>插值后<span class="token punctuation">)</span>"<span class="token punctuation">)</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span><span class="token function">mag2db</span><span class="token punctuation">(</span>Abs_S5_Ran<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'目标A距离向包络剖面(有角度校正)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间\tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'包络剖面幅度(dB)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">yticks</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">50</span><span class="token operator">:</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 设置刻度间隔为0.1</span>
<span class="token comment">%画一条-13dB的参考线</span>
x <span class="token operator">=</span> <span class="token function">linspace</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 生成 x 坐标的数据</span>
y <span class="token operator">=</span> <span class="token function">repmat</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 生成对应的 y 坐标的数据，全都是-13</span>
hold on<span class="token punctuation">;</span>
<span class="token function">line</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span><span class="token string">'Color'</span><span class="token punctuation">,</span><span class="token string">'red'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 绘制直线</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span><span class="token function">mag2db</span><span class="token punctuation">(</span>Abs_S5_Azi<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'目标A方位向包络剖面(无角度校正)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间\eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'包络剖面幅度(dB)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">yticks</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">50</span><span class="token operator">:</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 设置刻度间隔为0.1</span>

<span class="token comment">%画一条-13dB的参考线</span>
x <span class="token operator">=</span> <span class="token function">linspace</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 生成 x 坐标的数据</span>
y <span class="token operator">=</span> <span class="token function">repmat</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 生成对应的 y 坐标的数据，全都是-13</span>
hold on<span class="token punctuation">;</span>
<span class="token function">line</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span><span class="token string">'Color'</span><span class="token punctuation">,</span><span class="token string">'red'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 绘制直线</span>

<span class="token comment">%% 切片相位剖面</span>
<span class="token function">figure</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> "目标C的距离和方位幅度包络切片<span class="token punctuation">(</span>插值后<span class="token punctuation">)</span>"<span class="token punctuation">)</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span><span class="token function">angle</span><span class="token punctuation">(</span><span class="token function">S5_tau_eta_Cut_UP_Ran</span><span class="token punctuation">(</span>UP_Profile_Position_Ran<span class="token punctuation">,</span> <span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'目标A距离向相位剖面(有角度校正)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间\tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'包络剖面幅度(dB)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span><span class="token function">angle</span><span class="token punctuation">(</span><span class="token function">S5_tau_eta_Cut_UP_Azi</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> UP_Profile_Position_Azi<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'目标A方位向相位剖面(无角度校正)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间\eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'包络剖面幅度(dB)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">%% 手动补零</span>


<span class="token keyword">function</span> <span class="token punctuation">[</span>S_FFT<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">fft_zero_fill</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>nums<span class="token punctuation">)</span><span class="token comment">%进行补零；补零前一定要观察二维频谱，避免将补零的数组插到有能量的(黄色)区域，破坏原本的频谱！</span>
 S_FFT<span class="token operator">=</span><span class="token function">fft</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 S_FFT<span class="token operator">=</span><span class="token function">fft</span><span class="token punctuation">(</span>S_FFT<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%二维频谱；这里不使用fftshift，避免频谱被搬移到中心</span>
<span class="token function">figure</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span>"二维频域补零前"<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>S_FFT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%将二维频谱可视化，确定补零的范围(中点)</span>

Y_Insert<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%在Y方向插入(方位向)</span>

S_FFT<span class="token operator">=</span><span class="token punctuation">[</span><span class="token function">S_FFT</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span>Y_Insert<span class="token punctuation">;</span><span class="token function">S_FFT</span><span class="token punctuation">(</span><span class="token number">22</span><span class="token operator">:</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">%插入补零的数组;肉眼观察二维频谱的补零数组插入位置！！!</span>
X_Insert<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>S_FFT<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>nums<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%在X方向插入</span>

S_FFT<span class="token operator">=</span><span class="token punctuation">[</span><span class="token function">S_FFT</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">,</span>X_Insert<span class="token punctuation">,</span><span class="token function">S_FFT</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token operator">:</span><span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">%插入补零的数组;肉眼观察二维频谱的补零数组插入位置！！!</span>
<span class="token function">figure</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span>"二维频域补零后"<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>S_FFT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%将二维频谱可视化，确定补零的范围(中点)</span>
S_FFT<span class="token operator">=</span><span class="token punctuation">(</span><span class="token function">ifft</span><span class="token punctuation">(</span><span class="token function">ifft</span><span class="token punctuation">(</span>S_FFT<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%反变换，回到二维时域</span>

<span class="token comment">% </span>
<span class="token comment">% figure;</span>
<span class="token comment">% imagesc(abs(ifft(ifft(S_FFT,[],1),[],2)))</span>
<span class="token keyword">end</span>
</code></pre> 
<h4><a id="2_819"></a>2.大斜视角处理</h4> 
<pre><code class="prism language-matlab"><span class="token comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="token comment">%      高分3号卫星参数RDA点目标仿真(大斜视角方法)   %</span>
<span class="token comment">%        作者：CYAN                              %</span>
<span class="token comment">%        日期：2023年10月11日                     %</span>
<span class="token comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
clc<span class="token punctuation">;</span>clear<span class="token punctuation">;</span>close all<span class="token punctuation">;</span>
<span class="token comment">%代码格式化命令：MBeautify.formatCurrentEditorPage()</span>
<span class="token comment">%基于Gaofen3_Rda.m：由于星载的斜视角超过3.5°，需要当作大斜视角进行处理，故此仿真脚本将进行大斜视角数据处理</span>
<span class="token comment">% 使用参数Km用于匹配滤波解决调频率失配问题-&gt;二次距离压缩</span>
<span class="token comment">% 大斜视角距离徙动校正</span>
<span class="token comment">% 方位压缩的改进</span>
<span class="token comment">%% 卫星轨道参数</span>

H <span class="token operator">=</span> <span class="token number">755e3</span><span class="token punctuation">;</span> <span class="token comment">%卫星轨道高度</span>
<span class="token comment">% 卫星轨道速度Vr计算</span>
EarthMass <span class="token operator">=</span> <span class="token number">6e24</span><span class="token punctuation">;</span> <span class="token comment">%地球质量(kg)</span>
EarthRadius <span class="token operator">=</span> <span class="token number">6.37e6</span><span class="token punctuation">;</span> <span class="token comment">%地球半径6371km</span>
Gravitational <span class="token operator">=</span> <span class="token number">6.67e-11</span><span class="token punctuation">;</span> <span class="token comment">%万有引力常量</span>
<span class="token comment">% 姿态参数</span>
phi <span class="token operator">=</span> <span class="token number">20</span> <span class="token operator">*</span> <span class="token keyword">pi</span> <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">;</span> <span class="token comment">% 俯仰角+20°</span>
incidence <span class="token operator">=</span> <span class="token number">20.5</span> <span class="token operator">*</span> <span class="token keyword">pi</span> <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">;</span> <span class="token comment">% 入射角</span>
<span class="token comment">%计算等效雷达速度(卫星做圆周运动的线速度)</span>
Vr <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>Gravitational<span class="token operator">*</span>EarthMass<span class="token operator">/</span><span class="token punctuation">(</span>EarthRadius <span class="token operator">+</span> H<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%第一宇宙速度</span>

<span class="token comment">%景中心斜距R_eta_c和最近斜距R0，斜视角theta_rc由轨道高度、俯仰角、入射角计算得出</span>
R_eta_c <span class="token operator">=</span> H <span class="token operator">/</span> <span class="token function">cos</span><span class="token punctuation">(</span>incidence<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%景中心斜距</span>
R0 <span class="token operator">=</span> H <span class="token operator">/</span> <span class="token function">cos</span><span class="token punctuation">(</span>phi<span class="token punctuation">)</span><span class="token punctuation">;</span>
theta_r_c <span class="token operator">=</span> <span class="token function">acos</span><span class="token punctuation">(</span>R0<span class="token operator">/</span>R_eta_c<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%斜视角，单位为弧度;斜视角为4.6°</span>

<span class="token comment">%% 信号参数设置</span>

<span class="token comment">%   电磁波参数</span>
c <span class="token operator">=</span> <span class="token number">3e+8</span><span class="token punctuation">;</span> <span class="token comment">% 光速</span>
Vs <span class="token operator">=</span> Vr<span class="token punctuation">;</span> <span class="token comment">% 卫星平台速度</span>
Vg <span class="token operator">=</span> Vr<span class="token punctuation">;</span> <span class="token comment">% 波束扫描速度</span>
La <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span> <span class="token comment">%方位向天线长度-&gt;椭圆的长轴</span>
Lr<span class="token operator">=</span><span class="token number">1.5</span><span class="token punctuation">;</span><span class="token comment">%距离向天线尺寸——&gt;椭圆的短轴</span>
f0 <span class="token operator">=</span> <span class="token number">5.4e+9</span><span class="token punctuation">;</span> <span class="token comment">% 雷达工作频率</span>
lambda <span class="token operator">=</span> c <span class="token operator">/</span> f0<span class="token punctuation">;</span> <span class="token comment">%电磁波波长</span>


<span class="token comment">%  距离向信号参数</span>
Tr <span class="token operator">=</span> <span class="token number">40e-6</span><span class="token punctuation">;</span> <span class="token comment">% 发射脉冲时宽</span>
Br <span class="token operator">=</span> <span class="token number">2.8</span> <span class="token operator">*</span> <span class="token number">6e6</span><span class="token punctuation">;</span> <span class="token comment">% 距离向信号带宽</span>
Kr <span class="token operator">=</span> Br <span class="token operator">/</span> Tr<span class="token punctuation">;</span> <span class="token comment">% 距离向调频率</span>
alpha_os_r <span class="token operator">=</span> <span class="token number">1.2</span><span class="token punctuation">;</span> <span class="token comment">% 距离过采样率</span>
Nrg <span class="token operator">=</span> <span class="token number">2500</span><span class="token punctuation">;</span> <span class="token comment">% 距离线采样点数</span>
Fr <span class="token operator">=</span> alpha_os_r <span class="token operator">*</span> Br<span class="token punctuation">;</span> <span class="token comment">% 距离向采样率</span>

<span class="token comment">%  方位向信号参数</span>
alpha_os_a <span class="token operator">=</span> <span class="token number">1.23</span><span class="token punctuation">;</span> <span class="token comment">% 方位过采样率</span>
Naz <span class="token operator">=</span> <span class="token number">1600</span><span class="token punctuation">;</span> <span class="token comment">% 距离线数</span>
delta_f_dop <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token number">0.886</span> <span class="token operator">*</span> Vr <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token function">cos</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> La<span class="token punctuation">;</span> <span class="token comment">% 多普勒带宽</span>
Fa <span class="token operator">=</span> alpha_os_a <span class="token operator">*</span> delta_f_dop<span class="token punctuation">;</span> <span class="token comment">% 方位向采样率</span>
Ta <span class="token operator">=</span> <span class="token number">0.886</span> <span class="token operator">*</span> lambda <span class="token operator">*</span> R_eta_c <span class="token operator">/</span> <span class="token punctuation">(</span>La <span class="token operator">*</span> Vg <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%目标照射时间</span>

<span class="token comment">%  景中心点(原点)的参数</span>
time_eta_c <span class="token operator">=</span> <span class="token operator">-</span>R_eta_c <span class="token operator">*</span> <span class="token function">sin</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span> <span class="token operator">/</span> Vr<span class="token punctuation">;</span> <span class="token comment">% 波束中心穿越时刻</span>
f_eta_c <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> Vr <span class="token operator">*</span> <span class="token function">sin</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span> <span class="token operator">/</span> lambda<span class="token punctuation">;</span> <span class="token comment">% 多普勒中心频率</span>

<span class="token comment">%  合成孔径参数</span>
rho_r <span class="token operator">=</span> c <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> Fr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 距离向分辨率</span>
rho_a <span class="token operator">=</span> Vr<span class="token operator">/</span>Fa<span class="token punctuation">;</span> <span class="token comment">% 距离向分辨率；书上另一定义为La / 2</span>
theta_bw <span class="token operator">=</span> <span class="token number">0.886</span> <span class="token operator">*</span> lambda <span class="token operator">/</span> Lr<span class="token punctuation">;</span> <span class="token comment">% 方位向3dB波束宽度</span>
theta_syn <span class="token operator">=</span> Vs <span class="token operator">/</span> Vg <span class="token operator">*</span> theta_bw<span class="token punctuation">;</span> <span class="token comment">% 合成角宽度(斜面上的合成角)</span>
Ls <span class="token operator">=</span> R_eta_c <span class="token operator">*</span> theta_syn<span class="token punctuation">;</span> <span class="token comment">% 合成孔径长度</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span>"距离向分辨率<span class="token operator">:</span><span class="token comment">%.2f,方位向分辨率:%.2f\n\n",rho_r,rho_a)</span>
<span class="token comment">%% 时间轴参数</span>
Trg <span class="token operator">=</span> Nrg <span class="token operator">/</span> Fr<span class="token punctuation">;</span>Taz <span class="token operator">=</span> Naz <span class="token operator">/</span> Fa<span class="token punctuation">;</span><span class="token comment">%采样的每个时间片为1/Fr或1/Fa;乘以点数计算出总的时长</span>
<span class="token comment">%距离向/方位向采样时间间隔</span>
Gap_t_tau <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> Fr<span class="token punctuation">;</span>Gap_t_eta <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> Fa<span class="token punctuation">;</span>
<span class="token comment">%距离向/方位向采样频率间隔</span>
Gap_f_tau <span class="token operator">=</span> Fr <span class="token operator">/</span> Nrg<span class="token punctuation">;</span>Gap_f_eta <span class="token operator">=</span> Fa <span class="token operator">/</span> Naz<span class="token punctuation">;</span>
<span class="token comment">%  时间轴变量</span>
time_tau_r <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> R0 <span class="token operator">/</span> c <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">-</span>Trg <span class="token operator">/</span> <span class="token number">2</span><span class="token operator">:</span>Gap_t_tau<span class="token operator">:</span>Trg <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> Gap_t_tau<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 距离时间变量</span>
time_eta_a <span class="token operator">=</span> time_eta_c <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">-</span>Taz <span class="token operator">/</span> <span class="token number">2</span><span class="token operator">:</span>Gap_t_eta<span class="token operator">:</span>Taz <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> Gap_t_eta<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 方位时间变量</span>
<span class="token comment">%  随着距离向时间变化的最近斜距；c/2是因为距离向上一个时间包含两次电磁波来回</span>
R0_tau_r <span class="token operator">=</span> <span class="token punctuation">(</span>time_tau_r <span class="token operator">*</span> c <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span><span class="token punctuation">;</span>
Ext_R0_tau_r <span class="token operator">=</span> <span class="token function">repmat</span><span class="token punctuation">(</span>R0_tau_r<span class="token punctuation">,</span> Naz<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%扩展R0，用于计算变量Ka</span>
<span class="token comment">%  频率变量</span>
f_tau <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">-</span>Fr <span class="token operator">/</span> <span class="token number">2</span><span class="token operator">:</span>Gap_f_tau<span class="token operator">:</span>Fr <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> Gap_f_tau<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 距离频率变量</span>
f_tau<span class="token operator">=</span>f_tau<span class="token operator">-</span><span class="token punctuation">(</span><span class="token function">round</span><span class="token punctuation">(</span>f_tau<span class="token operator">/</span>Fr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span>Fr<span class="token punctuation">;</span><span class="token comment">%混叠方程</span>
f_eta <span class="token operator">=</span> f_eta_c <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">-</span>Fa <span class="token operator">/</span> <span class="token number">2</span><span class="token operator">:</span>Gap_f_eta<span class="token operator">:</span>Fa <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">-</span> Gap_f_eta<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 方位频率变量</span>
f_eta<span class="token operator">=</span>f_eta<span class="token operator">-</span><span class="token punctuation">(</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span>f_eta<span class="token operator">-</span>f_eta_c<span class="token punctuation">)</span><span class="token operator">/</span>Fa<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span>Fa<span class="token punctuation">;</span>
<span class="token comment">%  时间轴</span>
<span class="token punctuation">[</span>Ext_time_tau_r<span class="token punctuation">,</span> Ext_time_eta_a<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">meshgrid</span><span class="token punctuation">(</span>time_tau_r<span class="token punctuation">,</span> time_eta_a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 设置距离时域-方位时域二维网络坐标</span>
<span class="token comment">%  频率轴</span>
<span class="token punctuation">[</span>Ext_f_tau<span class="token punctuation">,</span> Ext_f_eta<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">meshgrid</span><span class="token punctuation">(</span>f_tau<span class="token punctuation">,</span> f_eta<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 设置频率时域-方位频域二维网络坐标</span>

<span class="token comment">%% 点目标(三个)坐标设置</span>
<span class="token comment">%  设置目标点相对于景中心之间的距离</span>

xA <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>yA <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">%A=(0,0)</span>
xB <span class="token operator">=</span> xA <span class="token operator">+</span> <span class="token number">500</span><span class="token punctuation">;</span>yB <span class="token operator">=</span> xA <span class="token operator">+</span> <span class="token number">500</span><span class="token punctuation">;</span> <span class="token comment">%（500,500）</span>

xC <span class="token operator">=</span> H<span class="token operator">*</span><span class="token function">tan</span><span class="token punctuation">(</span>phi<span class="token operator">+</span>theta_bw<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span>R0<span class="token operator">*</span><span class="token function">sin</span><span class="token punctuation">(</span>phi<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%计算的C点距离向坐标</span>
yC <span class="token operator">=</span> xA <span class="token operator">+</span> <span class="token number">500</span><span class="token punctuation">;</span>
Position_x_r <span class="token operator">=</span> <span class="token punctuation">[</span>xA<span class="token punctuation">,</span> xB<span class="token punctuation">,</span> xC<span class="token punctuation">]</span><span class="token punctuation">;</span>
Position_y_a <span class="token operator">=</span> <span class="token punctuation">[</span>yA<span class="token punctuation">,</span> yB<span class="token punctuation">,</span> yC<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">%点目标的坐标矩阵表示</span>

<span class="token comment">%% 生成回波S_echo</span>
Target_num <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">%目标数量</span>
S_echo <span class="token operator">=</span> <span class="token function">zeros</span><span class="token punctuation">(</span>Naz<span class="token punctuation">,</span> Nrg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token number">i</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">:</span>Target_num
    R0_Target <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>R0 <span class="token operator">*</span> <span class="token function">sin</span><span class="token punctuation">(</span>phi<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">Position_x_r</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span>H<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%对每个目标计算瞬时斜距</span>
    
    time_eta_c_Target <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">Position_y_a</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token operator">-</span>R0_Target <span class="token operator">*</span> <span class="token function">tan</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> Vr<span class="token punctuation">;</span> <span class="token comment">%波束中心穿越时刻</span>

    <span class="token comment">%  计算目标点的瞬时斜距</span>
    R_eta <span class="token operator">=</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>R0_Target<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span><span class="token punctuation">(</span>Vr<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Ext_time_eta_a <span class="token operator">-</span> <span class="token function">Position_y_a</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span> <span class="token operator">/</span> Vr<span class="token punctuation">)</span><span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%R_eta=sqrt(H^2+(Position_x_r(i)-(-R0*sin(phi)))^2+(Position_y_a(i)-Ext_time_eta_a*Vr).^2);</span>
    <span class="token comment">%  距离向包络</span>
    Wr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>Ext_time_tau_r<span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span>R_eta<span class="token operator">/</span>c<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> Tr <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%  方位向包络</span>
    <span class="token comment">% Wa = sinc((La*atan(Vg*(Ext_time_eta_a - time_eta_c_Target)./R0_Target)/lambda).^2);</span>
    Wa <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>La<span class="token operator">*</span><span class="token function">atan</span><span class="token punctuation">(</span>Vg<span class="token operator">*</span><span class="token punctuation">(</span>Ext_time_eta_a <span class="token operator">-</span> time_eta_c_Target<span class="token punctuation">)</span><span class="token operator">./</span><span class="token punctuation">(</span>R0 <span class="token operator">*</span> <span class="token function">sin</span><span class="token punctuation">(</span>phi<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">Position_x_r</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>lambda<span class="token punctuation">)</span><span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span>Ta<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token comment">% Wa = abs(Ext_time_eta_a-time_eta_c_Target) &lt;= Ta / 2;</span>
    <span class="token comment">%   相位</span>
    Phase <span class="token operator">=</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1j</span><span class="token operator">*</span><span class="token number">4</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">*</span>f0<span class="token operator">*</span>R_eta<span class="token operator">/</span>c<span class="token punctuation">)</span> <span class="token operator">.*</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">+</span><span class="token number">1j</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">*</span>Kr<span class="token operator">*</span><span class="token punctuation">(</span>Ext_time_tau_r <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> R_eta <span class="token operator">/</span> c<span class="token punctuation">)</span><span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">%  接收信号叠加</span>
    S_echo_Target <span class="token operator">=</span> Wr <span class="token operator">.*</span> Wa <span class="token operator">.*</span> Phase<span class="token punctuation">;</span>
    S_echo <span class="token operator">=</span> S_echo <span class="token operator">+</span> S_echo_Target<span class="token punctuation">;</span>
    <span class="token comment">%%%%%%%%%%%%%%格式化输出%%%%%%%%%%%%%%%%%%</span>
    R_eta_c_Target<span class="token operator">=</span>R0_Target<span class="token operator">/</span><span class="token function">cos</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span>"当前目标<span class="token operator">:</span><span class="token comment">%d,坐标:(%.2f,%.2f),\n最近斜距R0=%.2f,景中心斜距R_eta_c=%.2f,波束中心穿越时刻=%.4f\n", i, Position_x_r(i), Position_y_a(i), R0_Target, R_eta_c_Target,time_eta_c_Target)</span>
    Time_tau_Point <span class="token operator">=</span>  <span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>R0_Target<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>c<span class="token operator">*</span><span class="token function">cos</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">time_tau_r</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>Gap_t_tau<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%目标的距离向标准坐标(距离门),Rηc的坐标</span>
    Time_tau_Point_RCMC <span class="token operator">=</span>  <span class="token function">ceil</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>R0_Target<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">time_tau_r</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span>Gap_t_tau<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%RCMC后点数坐标,R0的坐标</span>
    Time_eta_Point <span class="token operator">=</span> Naz <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token function">Position_y_a</span><span class="token punctuation">(</span><span class="token number">i</span><span class="token punctuation">)</span> <span class="token operator">/</span> Vr<span class="token punctuation">)</span> <span class="token operator">/</span>Gap_t_eta<span class="token punctuation">;</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span>"<span class="token punctuation">(</span>仅参考<span class="token punctuation">)</span>徙动校正前<span class="token operator">:</span>脉冲点数坐标应为<span class="token comment">%d列(距)\n",Time_tau_Point);</span>
    <span class="token function">fprintf</span><span class="token punctuation">(</span>"徙动校正后<span class="token operator">:</span>点数坐标应为<span class="token comment">%d行(方),%d列\n\n",round(Time_eta_Point),Time_tau_Point_RCMC)</span>
<span class="token keyword">end</span>
S_echo <span class="token operator">=</span> S_echo <span class="token operator">.*</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2j</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">*</span>f_eta_c<span class="token operator">*</span>Ext_time_eta_a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%多普勒中心校正</span>

<span class="token comment">%% 距离压缩(方式3)</span>
D_feta_Vr<span class="token operator">=</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token punctuation">(</span>lambda<span class="token operator">*</span>Ext_f_eta<span class="token punctuation">)</span><span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token punctuation">(</span>Vr<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%徙动因子</span>
K_src<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span>Vr<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>f0<span class="token operator">^</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>D_feta_Vr<span class="token operator">.^</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">./</span><span class="token punctuation">(</span>c<span class="token operator">*</span>R0<span class="token operator">*</span><span class="token punctuation">(</span>Ext_f_eta<span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Km<span class="token operator">=</span>Kr<span class="token operator">./</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>Kr<span class="token operator">./</span>K_src<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%改进的调频率</span>
Hf <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>Ext_f_tau<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> Br <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">.*</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">+</span><span class="token number">1j</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">*</span><span class="token punctuation">(</span>Ext_f_tau<span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">./</span>Km<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%匹配滤波器</span>

<span class="token comment">%  匹配滤波</span>
S1_ftau_eta <span class="token operator">=</span> <span class="token function">fftshift</span><span class="token punctuation">(</span><span class="token function">fft</span><span class="token punctuation">(</span><span class="token function">fftshift</span><span class="token punctuation">(</span>S_echo<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Nrg<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
S1_ftau_eta <span class="token operator">=</span> S1_ftau_eta <span class="token operator">.*</span> Hf<span class="token punctuation">;</span><span class="token comment">%距离频域进行匹配滤波</span>
S1_tau_eta <span class="token operator">=</span> <span class="token function">fftshift</span><span class="token punctuation">(</span><span class="token function">ifft</span><span class="token punctuation">(</span><span class="token function">fftshift</span><span class="token punctuation">(</span>S1_ftau_eta<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Nrg<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% 二次距离压缩相位误差计算（判断是否小于pi/2）</span>
D_feta_Vr_O<span class="token operator">=</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token punctuation">(</span>lambda<span class="token operator">*</span>f_eta_c<span class="token punctuation">)</span><span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">*</span><span class="token punctuation">(</span>Vr<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
K_src_O<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span>Vr<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>f0<span class="token operator">^</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>D_feta_Vr_O<span class="token operator">.^</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">./</span><span class="token punctuation">(</span>c<span class="token operator">*</span>R0<span class="token operator">*</span><span class="token punctuation">(</span>Ext_f_eta<span class="token operator">.^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Km_O<span class="token operator">=</span>Kr<span class="token operator">./</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>Kr<span class="token operator">./</span>K_src_O<span class="token punctuation">)</span><span class="token punctuation">;</span>

delta_phi_srcf<span class="token operator">=</span><span class="token keyword">pi</span><span class="token operator">*</span><span class="token function">abs</span><span class="token punctuation">(</span>Km_O<span class="token operator">-</span>Km<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>Tr<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">&lt;</span><span class="token keyword">pi</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span><span class="token comment">%相位误差应小于pi/2;小于则数组全为1</span>


<span class="token comment">%% 方位向傅里叶变换</span>
S2_tau_feta <span class="token operator">=</span> <span class="token function">fftshift</span><span class="token punctuation">(</span><span class="token function">fft</span><span class="token punctuation">(</span><span class="token function">fftshift</span><span class="token punctuation">(</span>S1_tau_eta<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Naz<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% 距离徙动校正RCMC:采用相位补偿法</span>

<span class="token comment">%虽然Ka是随着R0变化的，但是在相位补偿时需要假设R0是不变的</span>
<span class="token comment">% delta_R = (((lambda * Ext_f_eta).^2) .* R0) ./ (8 * (Vr^2)); %距离徙动表达式</span>
delta_R <span class="token operator">=</span> R0<span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>D_feta_Vr<span class="token punctuation">)</span><span class="token operator">./</span>D_feta_Vr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%距离徙动表达式</span>
G_rcmc <span class="token operator">=</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">+</span><span class="token number">4j</span> <span class="token operator">*</span> <span class="token keyword">pi</span> <span class="token operator">.*</span> Ext_f_tau <span class="token operator">.*</span> delta_R<span class="token punctuation">)</span><span class="token operator">./</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%补偿相位</span>
S3_ftau_feta <span class="token operator">=</span> <span class="token function">fftshift</span><span class="token punctuation">(</span><span class="token function">fft</span><span class="token punctuation">(</span><span class="token function">fftshift</span><span class="token punctuation">(</span>S2_tau_feta<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Nrg<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%在方位向傅里叶变换的基础上进行距离向傅里叶变换</span>

S3_ftau_feta <span class="token operator">=</span> S3_ftau_feta <span class="token operator">.*</span> G_rcmc<span class="token punctuation">;</span> <span class="token comment">%与补偿相位相乘</span>
S3_tau_feta_RCMC <span class="token operator">=</span> <span class="token function">fftshift</span><span class="token punctuation">(</span><span class="token function">ifft</span><span class="token punctuation">(</span><span class="token function">fftshift</span><span class="token punctuation">(</span>S3_ftau_feta<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Nrg<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%距离向傅里叶逆变换</span>

<span class="token comment">%距离徙动校正结束</span>

<span class="token comment">%% 方位压缩</span>
<span class="token comment">%  根据变化的R0计算出相应的Ka矩阵(距离向变化，方位向不变)</span>
Ka <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> Vr<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">*</span> <span class="token function">cos</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span> <span class="token operator">./</span> <span class="token punctuation">(</span>lambda <span class="token operator">*</span> Ext_R0_tau_r<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">%  方位向匹配滤波器</span>
Haz <span class="token operator">=</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1j</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">*</span>Ext_f_eta<span class="token operator">.^</span><span class="token number">2.</span><span class="token operator">/</span>Ka<span class="token punctuation">)</span><span class="token punctuation">;</span>
Haz_BT<span class="token operator">=</span><span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">+</span><span class="token number">4j</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">*</span><span class="token punctuation">(</span>Ext_R0_tau_r<span class="token operator">.*</span>D_feta_Vr<span class="token operator">*</span>f0<span class="token punctuation">)</span><span class="token operator">/</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%改进的方位滤波器</span>
Offset <span class="token operator">=</span> <span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1j</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">*</span>Ext_f_eta<span class="token operator">.*</span>time_eta_c<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%偏移滤波器，将原点搬移到Naz/2的位置，校准坐标</span>
ABS_offset<span class="token operator">=</span><span class="token function">exp</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2j</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token operator">*</span>Ext_f_eta<span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">29</span><span class="token operator">/</span>Fa<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%上面的Offset校准不够精确，观察方位向上原点与Naz/2的差值，二次校准</span>
<span class="token comment">%  匹配滤波   </span>
S4_tau_feta <span class="token operator">=</span> S3_tau_feta_RCMC <span class="token operator">.*</span> Haz_BT<span class="token operator">.*</span>Offset<span class="token operator">.*</span>ABS_offset<span class="token punctuation">;</span>
S4_tau_eta <span class="token operator">=</span> <span class="token function">fftshift</span><span class="token punctuation">(</span><span class="token function">ifft</span><span class="token punctuation">(</span><span class="token function">fftshift</span><span class="token punctuation">(</span>S4_tau_feta<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Naz<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% 目标的升采样切片</span>
<span class="token comment">%采用二维频域补零的方式进行升采样操作;升采样为了提高目标的切片细节丰富程度，便于观察</span>
CutResolution <span class="token operator">=</span> <span class="token number">32</span><span class="token punctuation">;</span> <span class="token comment">%切片尺寸</span>
Profile_Position <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">872</span><span class="token punctuation">,</span> <span class="token number">1914</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">%切片的中心点位置</span>
<span class="token comment">% fprintf("\n点目标(C点)坐标对应的距离门到雷达距离为:%.2f\n",(time_tau_r(Profile_Position(2)))*(c/2))</span>

<span class="token comment">%切片的升采样倍数：10*CutResolution；也就是在二维频域补多少个零</span>
S5_tau_eta_Cut <span class="token operator">=</span> <span class="token function">S4_tau_eta</span><span class="token punctuation">(</span><span class="token function">Profile_Position</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-</span>CutResolution<span class="token operator">/</span><span class="token number">2</span><span class="token operator">:</span><span class="token function">Profile_Position</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">+</span>CutResolution<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token function">Profile_Position</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span>CutResolution<span class="token operator">/</span><span class="token number">2</span><span class="token operator">:</span><span class="token function">Profile_Position</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">+</span>CutResolution<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%切片</span>

<span class="token punctuation">[</span>S_zero_fill<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">fft_zero_fill</span><span class="token punctuation">(</span>S5_tau_eta_Cut<span class="token punctuation">,</span><span class="token number">10</span><span class="token operator">*</span>CutResolution<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%补零函数</span>

<span class="token comment">%由于斜视角的存在，在对升采样切片进行剖面分析前，将方位向和距离向都通过角度旋转校正到便于剖面的方向上</span>
S5_tau_eta_Cut_UP_Azi<span class="token operator">=</span><span class="token function">imrotate</span><span class="token punctuation">(</span>S_zero_fill<span class="token punctuation">,</span><span class="token function">rad2deg</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'bilinear'</span><span class="token punctuation">,</span> <span class="token string">'crop'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%方位向切片无需角度校正</span>
S5_tau_eta_Cut_UP_Ran <span class="token operator">=</span> <span class="token function">imrotate</span><span class="token punctuation">(</span>S_zero_fill<span class="token punctuation">,</span> <span class="token function">rad2deg</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'bilinear'</span><span class="token punctuation">,</span> <span class="token string">'crop'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%角度校正</span>
<span class="token comment">%求解升采样切片包络的abs最大值坐标，用于下面的剖面</span>
<span class="token punctuation">[</span>UP_Profile_Position_Ran<span class="token punctuation">,</span>UP_Profile_Position_Azi<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>S5_tau_eta_Cut_UP_Ran<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token function">abs</span><span class="token punctuation">(</span>S5_tau_eta_Cut_UP_Ran<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%幅度db化+搬移峰值至0dB</span>
<span class="token comment">%基于上面的升采样插值结果-&gt;获得剖面</span>
Abs_S5_Azi <span class="token operator">=</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">S5_tau_eta_Cut_UP_Azi</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> UP_Profile_Position_Azi<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%方位向剖面</span>
Abs_S5_Azi <span class="token operator">=</span> Abs_S5_Azi <span class="token operator">/</span> <span class="token function">max</span><span class="token punctuation">(</span>Abs_S5_Azi<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%移动峰值点</span>
Abs_S5_Ran <span class="token operator">=</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">S5_tau_eta_Cut_UP_Ran</span><span class="token punctuation">(</span>UP_Profile_Position_Ran<span class="token punctuation">,</span> <span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%距离向剖面</span>
Abs_S5_Ran <span class="token operator">=</span> Abs_S5_Ran <span class="token operator">/</span> <span class="token function">max</span><span class="token punctuation">(</span>Abs_S5_Ran<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% 回波图可视化</span>

<span class="token function">figure</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> "回波可视化"<span class="token punctuation">)</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">real</span><span class="token punctuation">(</span>S_echo<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'原始仿真信号实部'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间 \tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间 \eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">imag</span><span class="token punctuation">(</span>S_echo<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'原始仿真信号虚部'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间 \tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间 \eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>S_echo<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'原始仿真信号幅度'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间 \tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间 \eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">angle</span><span class="token punctuation">(</span>S_echo<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'原始仿真信号相位'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间 \tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间 \eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% 距离压缩可视化</span>

<span class="token comment">%距离频谱可视化</span>
<span class="token function">figure</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> "回波频谱可视化"<span class="token punctuation">)</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">real</span><span class="token punctuation">(</span>S1_ftau_eta<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'回波距离向实部'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向频谱点数f_\tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间 \eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">imag</span><span class="token punctuation">(</span>S1_ftau_eta<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'回波距离向虚部'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向频谱点数f_\tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间 \eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>S1_ftau_eta<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'回波距离向频谱幅度'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向频谱点数f_\tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间 \eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">angle</span><span class="token punctuation">(</span>S1_ftau_eta<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'回波距离向相位'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向频谱点数f_\tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间 \eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%距离压缩结果</span>
<span class="token function">figure</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> "距离压缩时域结果"<span class="token punctuation">)</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">real</span><span class="token punctuation">(</span>S1_tau_eta<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'实部'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间 \tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间 \eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>S1_tau_eta<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'幅度'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间 \tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间 \eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% 方位向傅里叶变换可视化</span>
hold on<span class="token punctuation">;</span>
<span class="token function">figure</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> "方位向傅里叶变换结果"<span class="token punctuation">)</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">real</span><span class="token punctuation">(</span>S2_tau_feta<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'实部'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间\tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向频谱点数f_\eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>S2_tau_feta<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'幅度'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间\tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向频谱点数f_\eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

pix_fnc1 <span class="token operator">=</span><span class="token function">find</span><span class="token punctuation">(</span>f_eta<span class="token operator">==</span>f_eta_c<span class="token punctuation">)</span><span class="token punctuation">;</span>
pin_fnc2 <span class="token operator">=</span> <span class="token number">1053</span><span class="token punctuation">;</span>
pix_fnc3 <span class="token operator">=</span> <span class="token number">1053</span><span class="token punctuation">;</span>
<span class="token function">line</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> Nrg<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>pix_fnc1<span class="token punctuation">,</span> pix_fnc1<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'Color'</span><span class="token punctuation">,</span> <span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token string">'LineWidth'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">line</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> Nrg<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>pin_fnc2<span class="token punctuation">,</span> pin_fnc2<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'Color'</span><span class="token punctuation">,</span> <span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token string">'LineWidth'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">line</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> Nrg<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>pix_fnc3<span class="token punctuation">,</span> pix_fnc3<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'Color'</span><span class="token punctuation">,</span> <span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token string">'LineWidth'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
hold off<span class="token punctuation">;</span>


<span class="token comment">%% 距离徙动校正可视化</span>
hold on<span class="token punctuation">;</span>

<span class="token function">figure</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> "距离徙动校正结果"<span class="token punctuation">)</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">real</span><span class="token punctuation">(</span>S3_tau_feta_RCMC<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'实部'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间\tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向频率点数 f_\eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>S3_tau_feta_RCMC<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'幅度'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间\tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向频率点数 f_\eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

pix_fnc1 <span class="token operator">=</span><span class="token function">find</span><span class="token punctuation">(</span>f_eta<span class="token operator">==</span>f_eta_c<span class="token punctuation">)</span><span class="token punctuation">;</span>
pin_fnc2 <span class="token operator">=</span> <span class="token number">1053</span><span class="token punctuation">;</span>
pix_fnc3 <span class="token operator">=</span> <span class="token number">1053</span><span class="token punctuation">;</span>
<span class="token function">line</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> Nrg<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>pix_fnc1<span class="token punctuation">,</span> pix_fnc1<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'Color'</span><span class="token punctuation">,</span> <span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token string">'LineWidth'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">line</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> Nrg<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>pin_fnc2<span class="token punctuation">,</span> pin_fnc2<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'Color'</span><span class="token punctuation">,</span> <span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token string">'LineWidth'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">line</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> Nrg<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>pix_fnc3<span class="token punctuation">,</span> pix_fnc3<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'Color'</span><span class="token punctuation">,</span> <span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token string">'LineWidth'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
hold off<span class="token punctuation">;</span>
<span class="token comment">%% 回波成像</span>
<span class="token function">figure</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> "点目标成像结果"<span class="token punctuation">)</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>S4_tau_eta<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'幅度'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间\tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间 \eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>S5_tau_eta_Cut<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">%切片</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'点目标C的32×32切片(角度校正前)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间\tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间\eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% 升采样成像</span>
<span class="token function">figure</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> "升采样成像结果"<span class="token punctuation">)</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>S5_tau_eta_Cut_UP_Ran<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'幅度(距离向)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间\tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间 \eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">contour</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>S5_tau_eta_Cut_UP_Ran<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'升采样轮廓图(距离向)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间\tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间\eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>S5_tau_eta_Cut_UP_Azi<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'幅度(方位向)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间\tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间 \eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">contour</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>S5_tau_eta_Cut_UP_Azi<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'升采样轮廓图(方位向)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间\tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间\eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">%% 切片包络幅度(dB)剖面</span>
<span class="token function">figure</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> "目标C的距离和方位幅度包络切片<span class="token punctuation">(</span>插值后<span class="token punctuation">)</span>"<span class="token punctuation">)</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span><span class="token function">mag2db</span><span class="token punctuation">(</span>Abs_S5_Ran<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'目标A距离向包络剖面(有角度校正)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间\tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'包络剖面幅度(dB)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">yticks</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">50</span><span class="token operator">:</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 设置刻度间隔为0.1</span>
<span class="token comment">%画一条-13dB的参考线</span>
x <span class="token operator">=</span> <span class="token function">linspace</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 生成 x 坐标的数据</span>
y <span class="token operator">=</span> <span class="token function">repmat</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 生成对应的 y 坐标的数据，全都是-13</span>
hold on<span class="token punctuation">;</span>
<span class="token function">line</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span><span class="token string">'Color'</span><span class="token punctuation">,</span><span class="token string">'red'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 绘制直线</span>

<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span><span class="token function">mag2db</span><span class="token punctuation">(</span>Abs_S5_Azi<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'目标A方位向包络剖面(无角度校正)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间\eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'包络剖面幅度(dB)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">yticks</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">50</span><span class="token operator">:</span><span class="token number">2</span><span class="token operator">:</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 设置刻度间隔为0.1</span>

<span class="token comment">%画一条-13dB的参考线</span>
x <span class="token operator">=</span> <span class="token function">linspace</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 生成 x 坐标的数据</span>
y <span class="token operator">=</span> <span class="token function">repmat</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 生成对应的 y 坐标的数据，全都是-13</span>
hold on<span class="token punctuation">;</span>
<span class="token function">line</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span><span class="token string">'Color'</span><span class="token punctuation">,</span><span class="token string">'red'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">% 绘制直线</span>

<span class="token comment">%% 切片相位剖面</span>
<span class="token function">figure</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> "目标C的距离和方位幅度包络切片<span class="token punctuation">(</span>插值后<span class="token punctuation">)</span>"<span class="token punctuation">)</span>
<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span><span class="token function">angle</span><span class="token punctuation">(</span><span class="token function">S5_tau_eta_Cut_UP_Ran</span><span class="token punctuation">(</span>UP_Profile_Position_Ran<span class="token punctuation">,</span> <span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'目标A距离向相位剖面(有角度校正)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'距离向时间\tau'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'包络剖面幅度(dB)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span><span class="token function">angle</span><span class="token punctuation">(</span><span class="token function">S5_tau_eta_Cut_UP_Azi</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span> UP_Profile_Position_Azi<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'目标A方位向相位剖面(无角度校正)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'方位向时间\eta'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'包络剖面幅度(dB)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">%% 距离与方位验算</span>
<span class="token comment">%距离向</span>
RelaDist_AandC_Ran<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1917</span><span class="token operator">-</span><span class="token number">1251</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span>Fr<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>c<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">cos</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>R0<span class="token operator">*</span><span class="token function">sin</span><span class="token punctuation">(</span>phi<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">14114.18</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span>H<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span>R0<span class="token punctuation">)</span><span class="token punctuation">;</span>
Ground_RelaDist_AandC_Ran<span class="token operator">=</span>RelaDist_AandC_Ran<span class="token operator">*</span><span class="token function">sin</span><span class="token punctuation">(</span>phi<span class="token operator">+</span>theta_bw<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span>"<span class="token operator">\</span><span class="token function">n</span><span class="token punctuation">(</span>距离向<span class="token punctuation">)</span>A点与C点相对的斜距误差<span class="token operator">:</span><span class="token comment">%.2fm;映射到地面上为:%.2fm\n",RelaDist_AandC_Ran,Ground_RelaDist_AandC_Ran)</span>
RelaDist_AandB_Ran<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1274</span><span class="token operator">-</span><span class="token number">1251</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span>Fr<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>c<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">cos</span><span class="token punctuation">(</span>theta_r_c<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>R0<span class="token operator">*</span><span class="token function">sin</span><span class="token punctuation">(</span>phi<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span>H<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span>R0<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span>"<span class="token operator">\</span><span class="token function">n</span><span class="token punctuation">(</span>距离向<span class="token punctuation">)</span>A点与B点相对的斜距误差<span class="token operator">:</span><span class="token comment">%.2fm\n",RelaDist_AandB_Ran)</span>
<span class="token comment">%方位向</span>
RelaDist_AandC_Azi<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">872</span><span class="token operator">-</span><span class="token number">800</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>Vr<span class="token operator">/</span>Fa<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">500</span><span class="token punctuation">;</span>
<span class="token function">fprintf</span><span class="token punctuation">(</span>"<span class="token operator">\</span><span class="token function">n</span><span class="token punctuation">(</span>方位向<span class="token punctuation">)</span>A点与C点<span class="token punctuation">(</span>B点<span class="token punctuation">)</span>相对的方位向误差<span class="token operator">:</span><span class="token comment">%.2fm\n",RelaDist_AandC_Azi)</span>



<span class="token comment">%% 手动补零</span>


<span class="token keyword">function</span> <span class="token punctuation">[</span>S_FFT<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">fft_zero_fill</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>nums<span class="token punctuation">)</span><span class="token comment">%进行补零；补零前一定要观察二维频谱，避免将补零的数组插到有能量的(黄色)区域，破坏原本的频谱！</span>
 S_FFT<span class="token operator">=</span><span class="token function">fft</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 S_FFT<span class="token operator">=</span><span class="token function">fft</span><span class="token punctuation">(</span>S_FFT<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%二维频谱；这里不使用fftshift，避免频谱被搬移到中心</span>
<span class="token function">figure</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span>"二维频域补零前"<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>S_FFT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%将二维频谱可视化，确定补零的范围(中点)</span>

Y_Insert<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%在Y方向插入(方位向);肉眼观察二维频谱的补零数组插入位置！！!</span>

S_FFT<span class="token operator">=</span><span class="token punctuation">[</span><span class="token function">S_FFT</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">;</span>Y_Insert<span class="token punctuation">;</span><span class="token function">S_FFT</span><span class="token punctuation">(</span><span class="token number">22</span><span class="token operator">:</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">%插入补零的数组</span>
X_Insert<span class="token operator">=</span><span class="token function">zeros</span><span class="token punctuation">(</span><span class="token function">size</span><span class="token punctuation">(</span>S_FFT<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>nums<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%在X方向插入;肉眼观察二维频谱的补零数组插入位置！！!</span>

S_FFT<span class="token operator">=</span><span class="token punctuation">[</span><span class="token function">S_FFT</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">,</span>X_Insert<span class="token punctuation">,</span><span class="token function">S_FFT</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token operator">:</span><span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">%插入补零的数组</span>
<span class="token function">figure</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span>"二维频域补零后"<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>S_FFT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%将二维频谱可视化，确定补零的范围(中点)</span>
S_FFT<span class="token operator">=</span><span class="token punctuation">(</span><span class="token function">ifft</span><span class="token punctuation">(</span><span class="token function">ifft</span><span class="token punctuation">(</span>S_FFT<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">%反变换，回到二维时域</span>

<span class="token comment">% </span>
<span class="token comment">% figure;</span>
<span class="token comment">% imagesc(abs(ifft(ifft(S_FFT,[],1),[],2)))</span>
<span class="token keyword">end</span>



<span class="token comment">%%位置验证</span>
<span class="token keyword">function</span> <span class="token punctuation">[</span>temp<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">PositionVal</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">% 创建一个示例图像</span>
image <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token number">4</span> <span class="token number">5</span> <span class="token number">6</span><span class="token punctuation">;</span> <span class="token number">7</span> <span class="token number">8</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">% 绘制图像</span>
<span class="token function">imagesc</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token punctuation">;</span>
colormap gray<span class="token punctuation">;</span>
colorbar<span class="token punctuation">;</span>

<span class="token comment">% 在图像上画一条二维直线</span>
hold on<span class="token punctuation">;</span>
<span class="token function">line</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'Color'</span><span class="token punctuation">,</span> <span class="token string">'red'</span><span class="token punctuation">,</span> <span class="token string">'LineWidth'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
hold off<span class="token punctuation">;</span>

<span class="token keyword">end</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/c61a1fa56d880d583f4148c0a641a098/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Python 处理 Excel 的14个常用操作详解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/76b1cde81277c6f14fed097fb54608df/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Python之Tkinter包的filedialog模块介绍</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程学习者.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
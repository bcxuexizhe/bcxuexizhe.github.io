<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>使用mysql查询当天、近一周、近一个月及近一年的数据以及各种报表查询sql - 编程学习者</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcxuexizhe.github.io/posts/84569b41098ac95537526ae2b314bba4/">
  <meta property="og:site_name" content="编程学习者">
  <meta property="og:title" content="使用mysql查询当天、近一周、近一个月及近一年的数据以及各种报表查询sql">
  <meta property="og:description" content="1.mysql查询当天的数据 1
select * from table where to_days(时间字段) = to_days(now());
2.mysql查询昨天的数据 1
select * from table where to_days(now( ) ) - to_days( 时间字段名) &lt;= 1
3.mysql查询近一个月的数据 1
SELECT * FROM table WHERE date(时间字段) &gt;= DATE_SUB(CURDATE(),INTERVAL 1 MONTH)//查询近一个月
SELECT * FROM table WHERE date(时间字段) &gt;= DATE_SUB(CURDATE(),INTERVAL 1 YEAR) //查询近一年
SELECT * FROM table WHERE date(时间字段) &gt;= DATE_SUB(CURDATE(),INTERVAL 7 DAY) //查询近七天
4.mysql查询本月的数据 1
select * from table where DATE_FORMAT(时间字段, &#39;%Y%m&#39; ) = DATE_FORMAT( CURDATE( ) , &#39;%Y%m&#39; )">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-01-05T15:57:25+08:00">
    <meta property="article:modified_time" content="2024-01-05T15:57:25+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程学习者" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程学习者</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">使用mysql查询当天、近一周、近一个月及近一年的数据以及各种报表查询sql</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h3 id="heading-0">1.mysql查询当天的数据</h3> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> </td><td> <p><code>select</code> <code>* </code><code>from</code> <code>table</code> <code>where</code> <code>to_days(时间字段) = to_days(now());</code></p> </td></tr></tbody></table> 
<p><a name="_label1"></a></p> 
<h3 id="heading-1">2.mysql查询昨天的数据</h3> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> </td><td> <p><code>select</code> <code>* </code><code>from</code> <code>table</code> <code>where</code> <code>to_days(now( ) ) - to_days( 时间字段名) &lt;= 1</code></p> </td></tr></tbody></table> 
<p><a name="_label2"></a></p> 
<p><a name="_label3"></a></p> 
<h3 id="heading-3">3.mysql查询近一个月的数据</h3> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> </td><td> <p><code>SELECT</code> <code>* </code><code>FROM</code> <code>table</code> <code>WHERE</code> <code>date</code><code>(时间字段) &gt;= DATE_SUB(CURDATE(),INTERVAL 1 </code><code>MONTH</code><code>)//查询近一个月</code></p> <p><code>SELECT</code> <code>* </code><code>FROM</code> <code>table</code> <code>WHERE</code> <code>date</code><code>(时间字段) &gt;= DATE_SUB(CURDATE(),INTERVAL 1 </code><code>YEAR) //查询近一年</code></p> <p><code>SELECT</code> <code>* </code><code>FROM</code> <code>table</code> <code>WHERE</code> <code>date</code><code>(时间字段) &gt;= DATE_SUB(CURDATE(),INTERVAL 7 </code><code>DAY) //查询近七天</code></p> </td></tr></tbody></table> 
<p><a name="_label4"></a></p> 
<h3 id="heading-4">4.mysql查询本月的数据</h3> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> </td><td> <p><code>select</code> <code>* </code><code>from</code> <code>table</code> <code>where</code> <code>DATE_FORMAT(时间字段, </code><code>'%Y%m'</code> <code>) = DATE_FORMAT( CURDATE( ) , </code><code>'%Y%m'</code> <code>)</code></p> </td></tr></tbody></table> 
<p><a name="_label5"></a></p> 
<h3 id="heading-5">5.mysql查询上月的数据</h3> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> </td><td> <p><code>select</code> <code>* </code><code>from</code> <code>table</code> <code>where</code> <code>PERIOD_DIFF(date_format(now(),</code><code>'%Y%m'</code><code>) , date_format(时间字段,</code><code>'%Y%m'</code><code>)) =1</code></p> </td></tr></tbody></table> 
<p><a name="_label6"></a></p> 
<h3 id="heading-6">6.mysql查询本年的数据</h3> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> </td><td> <p><code>select</code> <code>* </code><code>from</code> <code>table</code> <code>where</code> <code>YEAR</code><code>(时间字段)=</code><code>YEAR</code><code>(now());</code></p> </td></tr></tbody></table> 
<p><a name="_label7"></a></p> 
<h3 id="heading-7">7.mysql查询上一年的数据</h3> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> </td><td> <p><code>select</code> <code>* </code><code>from</code> <code>table</code> <code>where</code> <code>year</code><code>(时间字段)=</code><code>year</code><code>(date_sub(now(),interval 1 </code><code>year</code><code>));</code></p> </td></tr></tbody></table> 
<p><a name="_label8"></a></p> 
<h3 id="heading-8">8.mysql查询本周数据（周一为第一天）</h3> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> </td><td> <p><code>SELECT</code> <code>* </code><code>FROM</code> <code>table</code> <code>WHERE</code> <code>YEARWEEK(date_format(时间字段,</code><code>'%Y-%m-%d'</code><code>),1) = YEARWEEK(now(),1);</code></p> </td></tr></tbody></table> 
<p><a name="_label9"></a></p> 
<h3 id="heading-9">9.mysql查询近五分钟的数据</h3> 
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td> <p>1</p> </td><td> <p><code>SELECT</code> <code>* </code><code>FROM</code> <code>table</code> <code>WHERE</code> <code>时间字段 &gt;= DATE_SUB(now(),INTERVAL 5 </code><code>MINUTE</code><code>)</code></p> </td></tr></tbody></table> 
<h3><strong> 10.mysql查询某年度的每个月数据报表</strong></h3> 
<pre><code>      select a.date AS 'xData',IFNULL(b.sum, 0) AS 'yData'
        from  (
        select DATE_FORMAT(adddate(DATE_SUB(CURDATE(), INTERVAL dayofyear(now()) - 1 DAY),
        INTERVAL numlist.id - 1 month), '%m') as date
        from (SELECT @xi := @xi + 1 as id
        from (SELECT 1 UNION SELECT 2 UNION SELECT 3) xc1,
        (SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4) xc2,
        (SELECT @xi := 0) xc0) as numlist
        ) a
        left join
        (
        SELECT  IFNULL(SUM(income),0) sum, DATE_FORMAT(time, '%m') as date
        FROM zq_cnz_hy_income_report ts
        WHERE YEAR(time)=#{year}
        GROUP BY date ORDER BY date
        ) b
        on a.date = b.date order by a.date</code></pre> 
<p>效果图：</p> 
<p><img alt="" height="318" src="https://images2.imgbox.com/98/29/GwtWpJVt_o.png" width="808"></p> 
<h3>  11.mysql查询近一年的每个月数据报表</h3> 
<pre><code>        SELECT v.month AS 'xData',IFNULL(b.COUNT,0) AS 'yData' FROM (
        SELECT DATE_FORMAT(CURDATE(), '%Y-%m') AS `month`
        UNION SELECT DATE_FORMAT((CURDATE() - INTERVAL 1 MONTH), '%Y-%m') AS `month`
        UNION SELECT DATE_FORMAT((CURDATE() - INTERVAL 2 MONTH), '%Y-%m') AS `month`
        UNION SELECT DATE_FORMAT((CURDATE() - INTERVAL 3 MONTH), '%Y-%m') AS `month`
        UNION SELECT DATE_FORMAT((CURDATE() - INTERVAL 4 MONTH), '%Y-%m') AS `month`
        UNION SELECT DATE_FORMAT((CURDATE() - INTERVAL 5 MONTH), '%Y-%m') AS `month`
        UNION SELECT DATE_FORMAT((CURDATE() - INTERVAL 6 MONTH), '%Y-%m') AS `month`
        UNION SELECT DATE_FORMAT((CURDATE() - INTERVAL 7 MONTH), '%Y-%m') AS `month`
        UNION SELECT DATE_FORMAT((CURDATE() - INTERVAL 8 MONTH), '%Y-%m') AS `month`
        UNION SELECT DATE_FORMAT((CURDATE() - INTERVAL 9 MONTH), '%Y-%m') AS `month`
        UNION SELECT DATE_FORMAT((CURDATE() - INTERVAL 10 MONTH), '%Y-%m') AS `month`
        UNION SELECT DATE_FORMAT((CURDATE() - INTERVAL 11 MONTH), '%Y-%m') AS `month`
        ) v
        LEFT JOIN
        (
        SELECT LEFT(a.time,7) AS 'month',SUM(income) AS COUNT
        FROM zq_cnz_hy_income_report AS a
        LEFT JOIN zq_cnz_hy_user_station zs ON a.station_id=zs.station_id
        WHERE DATE_FORMAT(a.time,'%Y-%m')&gt;DATE_FORMAT(DATE_SUB(CURDATE(), INTERVAL 12 MONTH),'%Y-%m')
        GROUP BY MONTH) AS b
        ON v.month = b.month  GROUP BY v.month ORDER BY v.month</code></pre> 
<p>效果图：</p> 
<p><img alt="" height="302" src="https://images2.imgbox.com/74/2e/rhCaMRDB_o.png" width="744"></p> 
<h3> 12.mysql查询本月数据报表</h3> 
<pre><code>       select a.date as 'xData',IFNULL(b.sum, 0) AS 'yData'
        from  (
        select date from (
        SELECT DATE_FORMAT(DATE_SUB(last_day(curdate()), INTERVAL xc-1 day), '%Y-%m-%d') as date
        FROM (
        SELECT @xi:=@xi+1 as xc from
        (SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6) xc1,
        (SELECT 1 UNION SELECT 2 UNION SELECT 3 UNION SELECT 4 UNION SELECT 5 UNION SELECT 6) xc2,
        (SELECT @xi:=0) xc0
        ) xcxc) x0 where x0.date &gt;= (select date_add(curdate(),interval-day(curdate())+1 day))
        ) a
        left join
        (
        select IFNULL(SUM(income),0) sum, DATE_FORMAT(time,'%Y-%m-%d') as date
        FROM zq_cnz_hy_income_report ts
        group by DATE_FORMAT(time, '%Y-%m-%d')
        ) b
        on a.date =b.date order by a.date</code></pre> 
<p>效果图：</p> 
<p><img alt="" height="661" src="https://images2.imgbox.com/6e/6a/C5VknjoG_o.png" width="885"></p> 
<h3>13.mysql查询近一个月数据报表</h3> 
<pre><code>SELECT
        b.created AS 'xData',
        IFNULL(c.sum, 0) AS 'yData'
        FROM
        (
        SELECT
        @cdate := date_add( @cdate, INTERVAL - 1 DAY ) created
        FROM
        ( SELECT @cdate := date_add( CURDATE( ), INTERVAL 1 DAY ) FROM zq_cnz_hy_income_report LIMIT 30 ) a
        ) b
        LEFT JOIN (
        select SUM(income) as sum, DATE_FORMAT(time,'%Y-%m-%d') as date
        FROM zq_cnz_hy_income_report ts
        group by DATE_FORMAT(time, '%Y-%m-%d')) c
        ON b.created = date_format( c.date, '%Y-%m-%d')
        GROUP BY
        b.created
        ORDER BY
        b.created;</code></pre> 
<p>效果图：</p> 
<p><img alt="" height="657" src="https://images2.imgbox.com/f4/5b/6LhwQkTd_o.png" width="853"></p> 
<h3>14.mysql查询近一周数据报表</h3> 
<pre><code> SELECT t1.datetime as 'xData', IFNULL(t2.num, 0) AS 'yData' FROM (
        SELECT CURDATE() AS datetime
        union all
        SELECT DATE_SUB(CURDATE(), INTERVAL 1 DAY) AS datetime
        union all
        SELECT DATE_SUB(CURDATE(), INTERVAL 2 DAY) AS datetime
        union all
        SELECT DATE_SUB(CURDATE(), INTERVAL 3 DAY) AS datetime
        union all
        SELECT DATE_SUB(CURDATE(), INTERVAL 4 DAY) AS datetime
        union all
        SELECT DATE_SUB(CURDATE(), INTERVAL 5 DAY) AS datetime
        union all
        SELECT DATE_SUB(CURDATE(), INTERVAL 6 DAY) AS datetime
        ) t1 LEFT JOIN (
        select IFNULL(SUM(income),0) num, DATE_FORMAT(time, '%Y-%m-%d') as datetime
        FROM zq_cnz_hy_income_report ts
        GROUP BY LEFT(datetime, 10) ORDER BY datetime DESC LIMIT 7
        ) t2 ON t1.datetime = t2.datetime ORDER BY t1.datetime asc</code></pre> 
<p>效果图：</p> 
<p><img alt="" height="201" src="https://images2.imgbox.com/8f/bd/XsoU0Mf4_o.png" width="853"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/4a276115f4d95407173286b051e93abb/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">如何在 Linux 命令行中运行 Python 脚本？</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/d0a46bcb42669d27035783d7ea021dee/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">全网最全stable diffusion图生图教程！！！小白必收藏！！！！</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程学习者.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>基于SpringBoot的全国风景区WebGIS按省展示实践 - 编程学习者</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcxuexizhe.github.io/posts/1707713a0884f2958b9a1448ec90bd7b/">
  <meta property="og:site_name" content="编程学习者">
  <meta property="og:title" content="基于SpringBoot的全国风景区WebGIS按省展示实践">
  <meta property="og:description" content="目录
前言
一、全国风景区信息介绍
1、全国范围内数据分布
2、全国风景区分布
3、PostGIS空间关联查询
二、后台查询的设计与实现 1、Model和Mapper层
2、业务层和控制层设计
三、WebGIS可视化
1、省份范围可视化
2、省级风景区可视化展示 3、成果展示 总结 前言 旅行是心灵的洗涤，让每一步都充满感悟和思考。在旅途中，我学会了更加珍惜眼前的风景和时光。每一次旅行都是一次重新认识自己的机会，让我更加明白自己想要的是什么。旅途中的风景和经历，成为了我人生中最宝贵的财富。旅行让我感受到了世界的广阔和无限可能，让我更加勇敢地追求自己的梦想。在旅途中，我学会了用心去感受每一个细节，去品味生活的美好。旅行是一种生活方式，让我不断地探索和发现，不断地成长和进步。每一次旅行都是一次心灵的洗礼，让我更加清晰地认识自己和世界。旅途中的风景和经历成为了我人生中最珍贵的记忆，陪伴着我走过每一个春夏秋冬。旅行是一种自由和释放，让我在行走中找到自己的方向和目标。
不知道您是否还记得自己上一次旅行是在什么时候？是跟身边的谁一起去参加的旅行？在旅行中最令人难忘的风景是什么？除了风景还有什么让你印象深刻。身体和灵魂，总要有一个在路上。既然选择了在路上，那么我们就要去风景优美的地方看看，去美丽的景区游览，让身心得到放松，放松之后积蓄能量，为以后的生活持续奋斗。
各省风景区
不管是作为爱旅游的你，还是热爱文旅分析。使用WebGIS，我们来进行一场时空之旅，在地图上实现我们的地图旅行。本文以全国的旅游资源为例，分省份进行展示，将不同省份的风景区信息进行地图标注。我们也可以看一下全国范围内，风景区的时空分布。
本文即是在此背景下创作的，文章首先对数据库中的风景区数据进行简单介绍，然后介绍如何使SpringBoot进行风景区查询功能的设计与实现，接着介绍前端基于Leaflet进行可视化设计，最后使用实际应用，介绍和分析不同省份的风景区旅游资源。热爱旅游的你，一定不要错过，欣赏风景，让我们一起去看看吧。
一、全国风景区信息介绍 本节将对涉及的主要数据，即全国风景区信息进行简单介绍，其实在之前的一篇博客中，曾经对全国的风景区数据进行了详细的介绍，使用Java和PostGis的全国A级风景区数据入库实战。在这篇博客中，对全国A级风景区进行了入库的实践。
1、全国范围内数据分布 在之前的博客中，我们已经实现了数据的入库，为了避免让读者引起唐突的感觉，这里首先将数据表结构再次进行介绍，让读者熟悉和掌握对空间表的设计与实现。
对应的表结构脚本如下：
CREATE TABLE &#34;public&#34;.&#34;biz_scenic_spot&#34; ( &#34;id&#34; int8 NOT NULL, &#34;name&#34; varchar(255) COLLATE &#34;pg_catalog&#34;.&#34;default&#34;, &#34;level&#34; varchar(4) COLLATE &#34;pg_catalog&#34;.&#34;default&#34;, &#34;province&#34; varchar(255) COLLATE &#34;pg_catalog&#34;.&#34;default&#34;, &#34;city&#34; varchar(255) COLLATE &#34;pg_catalog&#34;.&#34;default&#34;, &#34;area&#34; varchar(255) COLLATE &#34;pg_catalog&#34;.&#34;default&#34;, &#34;address&#34; varchar(255) COLLATE &#34;pg_catalog&#34;.&#34;default&#34;, &#34;evaluation_time&#34; varchar(255) COLLATE &#34;pg_catalog&#34;.&#34;default&#34;, &#34;publish_time&#34; varchar(255) COLLATE &#34;pg_catalog&#34;.&#34;default&#34;, &#34;lng_gcj02&#34; varchar(30) COLLATE &#34;pg_catalog&#34;.&#34;default&#34;, &#34;">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-10T20:51:46+08:00">
    <meta property="article:modified_time" content="2024-05-10T20:51:46+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程学习者" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程学习者</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">基于SpringBoot的全国风景区WebGIS按省展示实践</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="htmledit_views">
                    <h2><a id="AI_0"></a></h2> 
<p id="main-toc"><strong>目录</strong></p> 
<p id="-toc" style="margin-left:0px;"></p> 
<p id="%E5%89%8D%E8%A8%80-toc" style="margin-left:0px;"><a href="#%E5%89%8D%E8%A8%80" rel="nofollow">前言</a></p> 
<p id="%E4%B8%80%E3%80%81%E5%85%A8%E5%9B%BD%E9%A3%8E%E6%99%AF%E5%8C%BA%E4%BF%A1%E6%81%AF%E4%BB%8B%E7%BB%8D-toc" style="margin-left:0px;"><a href="#%E4%B8%80%E3%80%81%E5%85%A8%E5%9B%BD%E9%A3%8E%E6%99%AF%E5%8C%BA%E4%BF%A1%E6%81%AF%E4%BB%8B%E7%BB%8D" rel="nofollow">一、全国风景区信息介绍</a></p> 
<p id="1%E3%80%81%E5%85%A8%E5%9B%BD%E8%8C%83%E5%9B%B4%E5%86%85%E6%95%B0%E6%8D%AE%E5%88%86%E5%B8%83-toc" style="margin-left:40px;"><a href="#1%E3%80%81%E5%85%A8%E5%9B%BD%E8%8C%83%E5%9B%B4%E5%86%85%E6%95%B0%E6%8D%AE%E5%88%86%E5%B8%83" rel="nofollow">1、全国范围内数据分布</a></p> 
<p id="2%E3%80%81%E5%85%A8%E5%9B%BD%E9%A3%8E%E6%99%AF%E5%8C%BA%E5%88%86%E5%B8%83-toc" style="margin-left:40px;"><a href="#2%E3%80%81%E5%85%A8%E5%9B%BD%E9%A3%8E%E6%99%AF%E5%8C%BA%E5%88%86%E5%B8%83" rel="nofollow">2、全国风景区分布</a></p> 
<p id="3%E3%80%81PostGIS%E7%A9%BA%E9%97%B4%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2-toc" style="margin-left:40px;"><a href="#3%E3%80%81PostGIS%E7%A9%BA%E9%97%B4%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2" rel="nofollow">3、PostGIS空间关联查询</a></p> 
<p id="%E4%BA%8C%E3%80%81%E5%90%8E%E5%8F%B0%E6%9F%A5%E8%AF%A2%E7%9A%84%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0%C2%A0-toc" style="margin-left:0px;"><a href="#%E4%BA%8C%E3%80%81%E5%90%8E%E5%8F%B0%E6%9F%A5%E8%AF%A2%E7%9A%84%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0%C2%A0" rel="nofollow">二、后台查询的设计与实现 </a></p> 
<p id="1%E3%80%81Model%E5%92%8CMapper%E5%B1%82-toc" style="margin-left:40px;"><a href="#1%E3%80%81Model%E5%92%8CMapper%E5%B1%82" rel="nofollow">1、Model和Mapper层</a></p> 
<p id="2%E3%80%81%E4%B8%9A%E5%8A%A1%E5%B1%82%E5%92%8C%E6%8E%A7%E5%88%B6%E5%B1%82%E8%AE%BE%E8%AE%A1-toc" style="margin-left:40px;"><a href="#2%E3%80%81%E4%B8%9A%E5%8A%A1%E5%B1%82%E5%92%8C%E6%8E%A7%E5%88%B6%E5%B1%82%E8%AE%BE%E8%AE%A1" rel="nofollow">2、业务层和控制层设计</a></p> 
<p id="%E4%B8%89%E3%80%81WebGIS%E5%8F%AF%E8%A7%86%E5%8C%96-toc" style="margin-left:0px;"><a href="#%E4%B8%89%E3%80%81WebGIS%E5%8F%AF%E8%A7%86%E5%8C%96" rel="nofollow">三、WebGIS可视化</a></p> 
<p id="1%E3%80%81%E7%9C%81%E4%BB%BD%E8%8C%83%E5%9B%B4%E5%8F%AF%E8%A7%86%E5%8C%96-toc" style="margin-left:40px;"><a href="#1%E3%80%81%E7%9C%81%E4%BB%BD%E8%8C%83%E5%9B%B4%E5%8F%AF%E8%A7%86%E5%8C%96" rel="nofollow">1、省份范围可视化</a></p> 
<p id="2%E3%80%81%E7%9C%81%E7%BA%A7%E9%A3%8E%E6%99%AF%E5%8C%BA%E5%8F%AF%E8%A7%86%E5%8C%96%E5%B1%95%E7%A4%BA%C2%A0-toc" style="margin-left:40px;"><a href="#2%E3%80%81%E7%9C%81%E7%BA%A7%E9%A3%8E%E6%99%AF%E5%8C%BA%E5%8F%AF%E8%A7%86%E5%8C%96%E5%B1%95%E7%A4%BA%C2%A0" rel="nofollow">2、省级风景区可视化展示 </a></p> 
<p id="3%E3%80%81%E6%88%90%E6%9E%9C%E5%B1%95%E7%A4%BA%C2%A0-toc" style="margin-left:40px;"><a href="#3%E3%80%81%E6%88%90%E6%9E%9C%E5%B1%95%E7%A4%BA%C2%A0" rel="nofollow">3、成果展示 </a></p> 
<p id="%E6%80%BB%E7%BB%93%C2%A0-toc" style="margin-left:0px;"><a href="#%E6%80%BB%E7%BB%93%C2%A0" rel="nofollow">总结 </a></p> 
<hr id="hr-toc"> 
<p></p> 
<h2 id="%E5%89%8D%E8%A8%80">前言</h2> 
<p>        旅行是心灵的洗涤，让每一步都充满感悟和思考。在旅途中，我学会了更加珍惜眼前的风景和时光。每一次旅行都是一次重新认识自己的机会，让我更加明白自己想要的是什么。旅途中的风景和经历，成为了我人生中最宝贵的财富。旅行让我感受到了世界的广阔和无限可能，让我更加勇敢地追求自己的梦想。在旅途中，我学会了用心去感受每一个细节，去品味生活的美好。旅行是一种生活方式，让我不断地探索和发现，不断地成长和进步。每一次旅行都是一次心灵的洗礼，让我更加清晰地认识自己和世界。旅途中的风景和经历成为了我人生中最珍贵的记忆，陪伴着我走过每一个春夏秋冬。旅行是一种自由和释放，让我在行走中找到自己的方向和目标。</p> 
<p>        不知道您是否还记得自己上一次旅行是在什么时候？是跟身边的谁一起去参加的旅行？在旅行中最令人难忘的风景是什么？除了风景还有什么让你印象深刻。身体和灵魂，总要有一个在路上。既然选择了在路上，那么我们就要去风景优美的地方看看，去美丽的景区游览，让身心得到放松，放松之后积蓄能量，为以后的生活持续奋斗。</p> 
<p class="img-center"><img alt="" height="308" src="https://images2.imgbox.com/14/0f/rDAl5q1L_o.png" width="669"></p> 
<div class="csdn-video-box"> 
 <iframe id="U8ePeIlS-1715342658126" frameborder="0" src="https://live.csdn.net/v/embed/385836" allowfullscreen="true" data-mediaembed="csdn"></iframe> 
 <p>各省风景区</p> 
</div> 
<p>        不管是作为爱旅游的你，还是热爱文旅分析。使用WebGIS，我们来进行一场时空之旅，在地图上实现我们的地图旅行。本文以全国的旅游资源为例，分省份进行展示，将不同省份的风景区信息进行地图标注。我们也可以看一下全国范围内，风景区的时空分布。</p> 
<p>        本文即是在此背景下创作的，文章首先对数据库中的风景区数据进行简单介绍，然后介绍如何使SpringBoot进行风景区查询功能的设计与实现，接着介绍前端基于Leaflet进行可视化设计，最后使用实际应用，介绍和分析不同省份的风景区旅游资源。热爱旅游的你，一定不要错过，欣赏风景，让我们一起去看看吧。</p> 
<h2 id="%E4%B8%80%E3%80%81%E5%85%A8%E5%9B%BD%E9%A3%8E%E6%99%AF%E5%8C%BA%E4%BF%A1%E6%81%AF%E4%BB%8B%E7%BB%8D">一、全国风景区信息介绍</h2> 
<p>        本节将对涉及的主要数据，即全国风景区信息进行简单介绍，其实在之前的一篇博客中，曾经对全国的风景区数据进行了详细的介绍，<a class="link-info" href="https://blog.csdn.net/yelangkingwuzuhu/article/details/136354288" title="使用Java和PostGis的全国A级风景区数据入库实战">使用Java和PostGis的全国A级风景区数据入库实战</a>。在这篇博客中，对全国A级风景区进行了入库的实践。</p> 
<h3 id="1%E3%80%81%E5%85%A8%E5%9B%BD%E8%8C%83%E5%9B%B4%E5%86%85%E6%95%B0%E6%8D%AE%E5%88%86%E5%B8%83">1、全国范围内数据分布</h3> 
<p>        在之前的博客中，我们已经实现了数据的入库，为了避免让读者引起唐突的感觉，这里首先将数据表结构再次进行介绍，让读者熟悉和掌握对空间表的设计与实现。</p> 
<p class="img-center"><img alt="" height="333" src="https://images2.imgbox.com/f7/fb/zVQ33HjT_o.png" width="653"></p> 
<p>        对应的表结构脚本如下：</p> 
<pre><code class="language-sql">CREATE TABLE "public"."biz_scenic_spot" (
  "id" int8 NOT NULL,
  "name" varchar(255) COLLATE "pg_catalog"."default",
  "level" varchar(4) COLLATE "pg_catalog"."default",
  "province" varchar(255) COLLATE "pg_catalog"."default",
  "city" varchar(255) COLLATE "pg_catalog"."default",
  "area" varchar(255) COLLATE "pg_catalog"."default",
  "address" varchar(255) COLLATE "pg_catalog"."default",
  "evaluation_time" varchar(255) COLLATE "pg_catalog"."default",
  "publish_time" varchar(255) COLLATE "pg_catalog"."default",
  "lng_gcj02" varchar(30) COLLATE "pg_catalog"."default",
  "lat_gcj02" varchar(30) COLLATE "pg_catalog"."default",
  "lng_bd09" varchar(30) COLLATE "pg_catalog"."default",
  "lat_bd09" varchar(30) COLLATE "pg_catalog"."default",
  "lng_wgs84" varchar(30) COLLATE "pg_catalog"."default",
  "lat_wgs84" varchar(30) COLLATE "pg_catalog"."default",
  "geom" "public"."geometry",
  "publish_link" varchar(255) COLLATE "pg_catalog"."default",
  CONSTRAINT "pk_biz_scenic_spot" PRIMARY KEY ("id")
);

CREATE INDEX "idx_biz_scenic_spot_geom" ON "public"."biz_scenic_spot" USING gist (
  "geom" "public"."gist_geometry_ops_2d"
);

COMMENT ON COLUMN "public"."biz_scenic_spot"."id" IS '主键';

COMMENT ON COLUMN "public"."biz_scenic_spot"."name" IS '景区名称';

COMMENT ON COLUMN "public"."biz_scenic_spot"."level" IS '景区级别';

COMMENT ON COLUMN "public"."biz_scenic_spot"."province" IS '所属省份';

COMMENT ON COLUMN "public"."biz_scenic_spot"."city" IS '所属城市';

COMMENT ON COLUMN "public"."biz_scenic_spot"."area" IS '所属区县';

COMMENT ON COLUMN "public"."biz_scenic_spot"."address" IS '地址';

COMMENT ON COLUMN "public"."biz_scenic_spot"."evaluation_time" IS '评定时间';

COMMENT ON COLUMN "public"."biz_scenic_spot"."publish_time" IS '发布时间';

COMMENT ON COLUMN "public"."biz_scenic_spot"."lng_gcj02" IS 'lng_GCJ02';

COMMENT ON COLUMN "public"."biz_scenic_spot"."lat_gcj02" IS 'lat_GCJ02';

COMMENT ON COLUMN "public"."biz_scenic_spot"."lng_bd09" IS 'lng_BD09';

COMMENT ON COLUMN "public"."biz_scenic_spot"."lat_bd09" IS 'lat_BD09';

COMMENT ON COLUMN "public"."biz_scenic_spot"."lng_wgs84" IS 'lng_WGS84';

COMMENT ON COLUMN "public"."biz_scenic_spot"."lat_wgs84" IS 'lat_WGS84';

COMMENT ON COLUMN "public"."biz_scenic_spot"."publish_link" IS '发布链接';

COMMENT ON TABLE "public"."biz_scenic_spot" IS '全国风景区信息表';</code></pre> 
<p>        数据库库一共有风景区14847条，在数据库中执行以下sql可以实现按照风景区级别进行分组统计，sql语句如下：</p> 
<pre><code class="language-sql">select count(level),level from biz_scenic_spot group by level;</code></pre> 
<p>        按照景区级别分类如下，其中有3条没有具体的级别（应该是数据的问题）：</p> 
<table align="center" border="1" cellpadding="1" cellspacing="1"><tbody><tr><td style="width:207px;">序号</td><td style="width:475px;">景区级别</td><td style="width:475px;">数量</td></tr><tr><td style="width:207px;">1</td><td style="width:475px;">5A</td><td style="width:475px;">336</td></tr><tr><td style="width:207px;">2</td><td style="width:475px;">4A</td><td style="width:475px;">4486</td></tr><tr><td style="width:207px;">3</td><td style="width:475px;">3A</td><td style="width:475px;">7866</td></tr><tr><td style="width:207px;">4</td><td style="width:475px;">2A</td><td style="width:475px;">2066</td></tr><tr><td style="width:207px;">5</td><td style="width:475px;">A</td><td style="width:475px;">93</td></tr></tbody></table> 
<h3 id="2%E3%80%81%E5%85%A8%E5%9B%BD%E9%A3%8E%E6%99%AF%E5%8C%BA%E5%88%86%E5%B8%83">2、全国风景区分布</h3> 
<p>        首先从数据库层面，我们先来看一下全国的风景区分布是一个什么样的情况，这里使用表格的方式进行汇总。在上述的风景区表中执行以下语句，可以得到按省份分组的景区分布（注意：这里的分组没有使用关联外部的省份信息表，而是直接利用风景区表内的省份字段），在我们的系统中，我们有省份的空间信息表，在本文的空间分析中，我们使用省级行政区表。</p> 
<pre><code class="language-sql">select count(1) num,province from biz_scenic_spot group by province order by num desc;</code></pre> 
<p>        执行后可以在数据库中看到以下数据：</p> 
<table align="center" border="1" cellpadding="1" cellspacing="1"><tbody><tr><td style="width:183px;">序号</td><td style="width:271px;">城市名称</td><td>景区数量</td></tr><tr><td style="width:183px;">1</td><td style="width:271px;">浙江</td><td>1322</td></tr><tr><td style="width:183px;">2</td><td style="width:271px;">山东</td><td>1205</td></tr><tr><td style="width:183px;">3</td><td style="width:271px;">四川</td><td>895</td></tr><tr><td style="width:183px;">4</td><td style="width:271px;">广西</td><td>662</td></tr><tr><td style="width:183px;">5</td><td style="width:271px;">安徽</td><td>605</td></tr><tr><td style="width:183px;">6</td><td style="width:271px;">江苏</td><td>600</td></tr><tr><td style="width:183px;">7</td><td style="width:271px;">广东</td><td>597</td></tr><tr><td style="width:183px;">8</td><td style="width:271px;">河南</td><td>580</td></tr><tr><td style="width:183px;">9</td><td style="width:271px;">湖北</td><td>576</td></tr><tr><td style="width:183px;">10</td><td style="width:271px;">新疆</td><td>574</td></tr><tr><td style="width:183px;">11</td><td style="width:271px;">贵州</td><td>570</td></tr><tr><td style="width:183px;">12</td><td style="width:271px;">云南</td><td>561</td></tr><tr><td style="width:183px;">13</td><td style="width:271px;">辽宁</td><td>558</td></tr><tr><td style="width:183px;">14</td><td style="width:271px;">湖南</td><td>550</td></tr><tr><td style="width:183px;">16</td><td style="width:271px;">陕西</td><td>527</td></tr><tr><td style="width:183px;">17</td><td style="width:271px;">河北</td><td>490</td></tr><tr><td style="width:183px;">18</td><td style="width:271px;">福建</td><td>463</td></tr><tr><td style="width:183px;">19</td><td style="width:271px;">甘肃</td><td>442</td></tr><tr><td style="width:183px;">20</td><td style="width:271px;">内蒙古</td><td>428</td></tr><tr><td style="width:183px;">21</td><td style="width:271px;">江西</td><td>421</td></tr><tr><td style="width:183px;">22</td><td style="width:271px;">黑龙江</td><td>409</td></tr><tr><td style="width:183px;">23</td><td style="width:271px;">吉林</td><td>275</td></tr><tr><td style="width:183px;">24</td><td style="width:271px;">重庆</td><td>272</td></tr><tr><td style="width:183px;">25</td><td style="width:271px;">山西</td><td>268</td></tr><tr><td style="width:183px;">26</td><td style="width:271px;">北京</td><td>216</td></tr><tr><td style="width:183px;">27</td><td style="width:271px;">青海</td><td>163</td></tr><tr><td style="width:183px;">28</td><td style="width:271px;">西藏</td><td>148</td></tr><tr><td style="width:183px;">29</td><td style="width:271px;">宁夏</td><td>147</td></tr><tr><td style="width:183px;">30</td><td style="width:271px;">上海</td><td>139</td></tr><tr><td style="width:183px;">31</td><td style="width:271px;">天津</td><td>100</td></tr><tr><td style="width:183px;">32</td><td style="width:271px;">海南</td><td>84</td></tr></tbody></table> 
<p>        从上表中可以很直观的看出，浙江省、山东省、四川省的旅游资源相当丰富，居全国前三甲。而海南省、天津市、上海市位于后三甲。这里仅对数据进行表格可视化，为了让数据具有空间分布，我们将使用WebGIS的方式进行展示，让地图具有空间分布的特性。</p> 
<h3 id="3%E3%80%81PostGIS%E7%A9%BA%E9%97%B4%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2">3、PostGIS空间关联查询</h3> 
<p>        为了让景区信息更加具有空间分布的特性，我们采用和biz_province即省级行政区划信息表进行关联，查询出指定省份对应的风景信息，这里使用st_contains(geom,geom)这个函数来进行对比。sql查询示例如下所示（以湖南省430000为例）：</p> 
<pre><code class="language-sql">SELECT T
	.*,
	st_asgeojson ( T.geom ) AS geomJson 
FROM
	biz_province P,
	biz_scenic_spot T 
WHERE
	P.code = '430000' 
	AND st_contains ( P.geom, T.geom );</code></pre> 
<p class="img-center"><img alt="" height="393" src="https://images2.imgbox.com/5e/4e/C0cJqzpL_o.png" width="659"></p> 
<h2 id="%E4%BA%8C%E3%80%81%E5%90%8E%E5%8F%B0%E6%9F%A5%E8%AF%A2%E7%9A%84%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0%C2%A0" style="background-color:transparent;">二、后台查询的设计与实现 </h2> 
<p>        本节重点讲解后台服务的设计，这里我们依然采用SpringBoot和Mybatis-Plus的组合，空间数据库采用PostGIS数据。因此后台服务的设计采用MVC模式，下面针对每一层进行详细的设计。</p> 
<h3 id="1%E3%80%81Model%E5%92%8CMapper%E5%B1%82">1、Model和Mapper层</h3> 
<p>        model层包括实体类和相关视图层对象。Mapper即dao层，数据访问层。通过Mapper来操作数据库，基于MP进行实体数据库操作。</p> 
<pre><code class="language-java">package com.yelang.project.extend.scenicspot.domain;
import java.io.Serializable;
import org.apache.ibatis.type.BlobByteObjectArrayTypeHandler;
import org.apache.ibatis.type.BlobInputStreamTypeHandler;
import org.apache.ibatis.type.BlobTypeHandler;
import org.apache.ibatis.type.ByteArrayTypeHandler;
import org.apache.ibatis.type.ByteObjectArrayTypeHandler;
import org.apache.ibatis.type.ByteTypeHandler;
import com.baomidou.mybatisplus.annotation.TableField;
import com.baomidou.mybatisplus.annotation.TableId;
import com.baomidou.mybatisplus.annotation.TableName;
import com.yelang.framework.handler.PgGeometryTypeHandler;
import lombok.AllArgsConstructor;
import lombok.Getter;
import lombok.NoArgsConstructor;
import lombok.Setter;
import lombok.ToString;

/**
 *  全国风景区信息表
* @author wzh
*
*/
@TableName(value = "biz_scenic_spot", autoResultMap = true)
@NoArgsConstructor
@AllArgsConstructor
@Setter
@Getter
@ToString
public class ScenicSpot implements Serializable{
	private static final long serialVersionUID = 1830004907219610805L;
	@TableId
	private Long id;
	private String name;//景区名称
	private String level;//景区级别
	private String province;//所属省份
	private String city;//所属城市
	private String area;//所属区县
	private String address;//地址
	@TableField(value="evaluation_time")
	private String evaluationTime;//评定时间
	@TableField(value="publish_time")
	private String publishTime;//发布时间
	@TableField(value="publish_link")
	private String publishLink;//发布时间
	@TableField(value="lng_GCJ02")
	private String lngGCJ02;
	@TableField(value="lat_GCJ02")
	private String latGCJ02;
	@TableField(value="lng_BD09")
	private String lngBD09;
	@TableField(value="lat_BD09")
	private String latBD09;
	@TableField(value="lng_WGS84")
	private String lngWGS84;
	@TableField(value="lat_WGS84")
	private String latWGS84;
	@TableField(typeHandler = PgGeometryTypeHandler.class)
	private String geom;
	@TableField(exist=false)
	private String geomJson;
	@TableField(exist=false)
	private byte[] tile;

	public ScenicSpot(String name, String level, String province, String city, String area, String address,
			String evaluationTime, String publishTime, String publishLink,String lngGCJ02, String latGCJ02, String lngBD09, String latBD09,
			String lngWGS84, String latWGS84, String geom) {
		super();
		this.name = name;
		this.level = level;
		this.province = province;
		this.city = city;
		this.area = area;
		this.address = address;
		this.evaluationTime = evaluationTime;
		this.publishTime = publishTime;
		this.publishLink = publishLink;
		this.lngGCJ02 = lngGCJ02;
		this.latGCJ02 = latGCJ02;
		this.lngBD09 = lngBD09;
		this.latBD09 = latBD09;
		this.lngWGS84 = lngWGS84;
		this.latWGS84 = latWGS84;
		this.geom = geom;
	}
}</code></pre> 
<p>        mapper层主要提供查询省级范围内的风景区列表方法，关键代码如下：</p> 
<pre><code class="language-java">package com.yelang.project.extend.scenicspot.mapper;
import java.util.List;
import org.apache.ibatis.annotations.Param;
import org.apache.ibatis.annotations.Result;
import org.apache.ibatis.annotations.Results;
import org.apache.ibatis.annotations.Select;
import org.apache.ibatis.type.JdbcType;
import com.baomidou.mybatisplus.core.mapper.BaseMapper;
import com.yelang.project.extend.scenicspot.domain.ScenicSpot;
import com.yelang.project.extend.scenicspot.domain.TileBox;
public interface ScenicSpotMapper extends BaseMapper&lt;ScenicSpot&gt;{
	static final String FIND_GEOJSON_SQL="&lt;script&gt;"
			+ "select st_asgeojson(geom) as geomJson from biz_scenic_spot "
			+ "where id = #{id} "
			+ "&lt;if test='null != name'&gt;and name like concat('%', #{name}, '%')&lt;/if&gt;"
			+ "&lt;/script&gt;";
	@Select(FIND_GEOJSON_SQL)
	ScenicSpot findGeoJsonById(@Param("id")Long id,@Param("name")String name);
	
	static final String FIND_LISTBY_PCODE = "&lt;script&gt;"
			+ " select t.*,st_asgeojson(t.geom) as geomJson from biz_province p,biz_scenic_spot t where p.code = #{code} and st_contains(p.geom, t.geom) "
			+ "&lt;/script&gt;";
	/**
	 *  根据省级行政区划code查询对应的风景名胜列表
	 * @param code 省份编码
	 * @return 对应的风景名胜区列表
	 */
	@Select(FIND_LISTBY_PCODE)
	List&lt;ScenicSpot&gt; findListByPcode(@Param("code")String code);
}
</code></pre> 
<h3 id="2%E3%80%81%E4%B8%9A%E5%8A%A1%E5%B1%82%E5%92%8C%E6%8E%A7%E5%88%B6%E5%B1%82%E8%AE%BE%E8%AE%A1">2、业务层和控制层设计</h3> 
<p>        业务层比较简单，实现控制层到数据库访问层的调用。这里贴出关键代码：</p> 
<pre><code class="language-java">package com.yelang.project.extend.scenicspot.service.impl;

@Service
public class ScenicSpotServiceImpl extends ServiceImpl&lt;ScenicSpotMapper, ScenicSpot&gt; implements IScenicSpotService{
	@Override
	public List&lt;ScenicSpot&gt; findListByPcode(String code) {
		return this.baseMapper.findListByPcode(code);
	}
}</code></pre> 
<p>        </p> 
<pre><code class="language-java">package com.yelang.project.extend.scenicspot.controller;
import java.util.List;
import org.apache.shiro.authz.annotation.RequiresPermissions;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;
@Controller
@RequestMapping("/sspot/province")
public class ScenicSpotProvinceController extends BaseController{
private String prefix = "scenicspot/province";
	@Autowired
	private IProvinceService provinceService;
	@Autowired
	private IScenicSpotService sspotService;
	@RequiresPermissions("sspot:province:view")
    @GetMapping()
    public String map(){
        return prefix + "/map";
    }
    @RequiresPermissions("sspot:province:list")
    @PostMapping("/list")
    @ResponseBody
    public TableDataInfo list(Province province){
        startPage();
        List&lt;Province&gt; list = provinceService.selectList(province);
        return getDataTable(list);
    }
    @RequiresPermissions("sspot:province:geom")
    @GetMapping("/geojson/{id}")
    @ResponseBody
    public AjaxResult getGeojson(@PathVariable("id") Long id){
    	Province province = provinceService.findGeoJsonById(id, null);
        return AjaxResult.success().put("data", province.getGeomJson());
    }
    @RequiresPermissions("sspot:province:sspotlist")
    @GetMapping("/datalist/{code}")
    @ResponseBody
    public AjaxResult sspotList(@PathVariable("code") String code){
    	List&lt;ScenicSpot&gt; list = sspotService.findListByPcode(code);
    	AjaxResult ar = AjaxResult.success();
        ar.put("data", list);
        return ar;
    }
}
</code></pre> 
<p>        控制层提供四个主要的方法，第一个是跳转到页面的方法，第二个是获取省份列表，第三个是获取省份geojson数据，最后一个是获取省份下辖风景区列表。以上就是后台各层的代码设计与实现。通过这几个方法为前台提供服务。</p> 
<h2 id="%E4%B8%89%E3%80%81WebGIS%E5%8F%AF%E8%A7%86%E5%8C%96">三、WebGIS可视化</h2> 
<p>        本节将重点讲解如何WebGIS当中采用leaflet框架实现对风景区信息的展示，这里采用熟悉的Leaflet架构。使用基于Canvas的文本标记方法。关于地图的定义，列表的展示非本文重点，这里不再赘述。</p> 
<h3 id="1%E3%80%81%E7%9C%81%E4%BB%BD%E8%8C%83%E5%9B%B4%E5%8F%AF%E8%A7%86%E5%8C%96">1、省份范围可视化</h3> 
<p>        在界面中，首先会展示省份列表，通过点击省份列表的操作按钮，获取当前省份的code，然后根据code获取对应的省级行政区划范围GeoJSON，然后使用Leaflet将GeoJSON展示出来。关键代码如下：</p> 
<pre><code class="language-javascript">function showProvince(id){
     var myStyle = {color:"white",weight:5,"opacity":1,fillOpacity: 0};
	  $.ajax({  
		   type:"get",  
		   url:prefix + "/geojson/" + id,  
		   data:{},  
		   async: false,
		   dataType:"json",  
		   cache:false,
		   processData:false,
		   success:function(result){
		       if(undefined != provinceAreaLayer ){
		            provinceAreaLayer.removeFrom(mymap);//先移除
		       }
		       if(result.code == web_status.SUCCESS){
		        	var geojson = JSON.parse(result.data);
		        	provinceAreaLayer = L.geoJSON(geojson,{style:myStyle}).addTo(mymap);
		        		//同时设置中心位置和级别，一般省份设置为7
		        	    mymap.setView(provinceAreaLayer.getBounds().getCenter(),7);
		        	}
		      },
		      error:function(){
		        	$.modal.alertWarning("获取空间信息失败");
		        }
		 });
   }</code></pre> 
<p class="img-center"><img alt="" height="303" src="https://images2.imgbox.com/bd/a6/M0qrPUPQ_o.png" width="662"></p> 
<h3 id="2%E3%80%81%E7%9C%81%E7%BA%A7%E9%A3%8E%E6%99%AF%E5%8C%BA%E5%8F%AF%E8%A7%86%E5%8C%96%E5%B1%95%E7%A4%BA%C2%A0">2、省级风景区可视化展示 </h3> 
<p>        通过code关联省级行政区划表和风景区信息表，进行两个图层的空间叠加分析，实现省级区域的风景区划覆盖。前台的核心代码如下所示：</p> 
<pre><code class="language-javascript"> function showScenicSpot(code){
        	$.ajax({  
		        type:"get",  
		        url:prefix + "/datalist/" + code,  
		        dataType:"json",  
		        cache:false,
		        processData:false,
		        success:function(result){
		        	if(result.code == web_status.SUCCESS){
		        		var strokeStyleSet = "#23168d";
		        		var lat,lng,cityInfo;
		        		for(var i=0;i&lt;result.data.length;i++){
		        			var dataInfo = result.data[i];
		        			var geomObj = JSON.parse(dataInfo.geomJson);
		        			if(i == 0){
		        				lat = geomObj.coordinates[1];
		        				lng = geomObj.coordinates[0];
		        				continue;
		        			}
		        			var radiusSize = 5;
		        			switch(dataInfo.level) {
			        		    case '5A':  
			        		    	strokeStyleSet = "#c50808";
			        		    	radiusSize += 7;
			        		        break;
			        		    case '4A':  
			        		    	strokeStyleSet = "#c37322";
			        		    	radiusSize += 5;
			        		        break;
			        		    case '3A':
			        		    	strokeStyleSet = "#6f8d16";
			        		    	radiusSize += 3;
			        		        break;
		        		        case '2A':
		        		        	strokeStyleSet = "#168d40";
		        		        	radiusSize += 1;
			        		        break;
			        		    default:
			        		    	strokeStyleSet = "#23168d";
			        		}
		    				var content = "&lt;strong&gt;名称:&lt;/strong&gt;"+dataInfo.name + "&lt;br/&gt;&lt;strong&gt;级别:&lt;/strong&gt;"+ dataInfo.level;
		    				    content += "&lt;br/&gt;&lt;strong&gt;所属行政区划:&lt;/strong&gt;"+ dataInfo.province + "/" + dataInfo.city + "/" + dataInfo.area;
		    				    content += "&lt;br/&gt;&lt;strong&gt;评定时间:&lt;/strong&gt;"+ dataInfo.evaluationTime ;
		    				var latlng = new L.latLng(geomObj.coordinates[1], geomObj.coordinates[0]);
		    			    let marker = L.circleMarker(latlng, {
		        		        radius: radiusSize,
		        		        color: strokeStyleSet,
		        		        labelStyle: {
		        		          offsetX: 0, //横坐标偏移(像素)
		        		          offsetY: 30, //纵坐标偏移(像素)
		        		          text: dataInfo.name,
		        		          rotation: 0,
		        		          zIndex: radiusSize,
		        				  minZoom : 5,
		        				  strokeStyle: strokeStyleSet
		        		        }
	        		      	}).addTo(showLayerGroup);
		    				marker.bindPopup(content); 
		        		}
		        		mymap.addLayer(showLayerGroup);
		        	}
		        },
		        error:function(){
		        	$.modal.alertWarning("获取信息失败");
		        }
		    });
        }</code></pre> 
<p class="img-center"><img alt="" height="292" src="https://images2.imgbox.com/4d/8b/6z4KMcaE_o.png" width="640"></p> 
<h3 id="3%E3%80%81%E6%88%90%E6%9E%9C%E5%B1%95%E7%A4%BA%C2%A0">3、成果展示 </h3> 
<p>        通过以上的代码，大致实现了风景区的WebGIS展示，这里将选择几个省份将其旅游资源进行集中展示。也让大家了解项目实际的成果。快来看看你所在省份的风景区信息吧。如果没有的省份，感兴趣的可以私聊，可以私发可视化结果哦。</p> 
<p class="img-center"><img alt="" height="302" src="https://images2.imgbox.com/d4/f9/8gCMkd3m_o.png" width="662"></p> 
<p style="text-align:center;">山西省风景区分布图</p> 
<p class="img-center"><img alt="" height="304" src="https://images2.imgbox.com/0f/d9/TH384unZ_o.png" width="662"></p> 
<p style="text-align:center;">辽宁省风景区分布图</p> 
<p class="img-center"><img alt="" height="300" src="https://images2.imgbox.com/36/35/4KLTnjdY_o.png" width="655"></p> 
<p style="text-align:center;">江苏省风景区分布图</p> 
<p class="img-center"><img alt="" height="300" src="https://images2.imgbox.com/c4/ea/oKZUqLoK_o.png" width="658"></p> 
<p style="text-align:center;">安徽省风景区分布图</p> 
<p class="img-center"><img alt="" height="304" src="https://images2.imgbox.com/b4/06/16VmEAl1_o.png" width="664"></p> 
<p style="text-align:center;"> 四川省风景区分布图</p> 
<p class="img-center"><img alt="" height="303" src="https://images2.imgbox.com/b1/bf/aTBhKYN3_o.png" width="660"></p> 
<p style="text-align:center;">新疆维吾尔自治区风景区分布示意图</p> 
<h2 id="%E6%80%BB%E7%BB%93%C2%A0">总结 </h2> 
<p>        以上就是本文的主要内容，本文即是在此背景下创作的，文章首先对数据库中的风景区数据进行简单介绍，然后介绍如何使SpringBoot进行风景区查询功能的设计与实现，接着介绍前端基于Leaflet进行可视化设计，最后使用实际应用，介绍和分析不同省份的风景区旅游资源。行文仓促，定有不足之处，还请朋友们不吝批评指正。</p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/555c9fe3b318720f13a9df7f883675c3/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">JS执行原理大揭秘：事件循环Event Loop与宏任务、微任务</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a301ee4d41a56ccf9ef0a2d3e7d0ebbc/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">【研发日记】Matlab/Simulink避坑指南(十二)——Initialize Function执行Bug</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程学习者.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
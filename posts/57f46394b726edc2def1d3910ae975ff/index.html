<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>python如何读取excel表格数据 - 编程学习者</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcxuexizhe.github.io/posts/57f46394b726edc2def1d3910ae975ff/">
  <meta property="og:site_name" content="编程学习者">
  <meta property="og:title" content="python如何读取excel表格数据">
  <meta property="og:description" content="文章目录 excel的格式xls格式文件xlrdxlwtexcel读取xls类型数据三个方法 xlsx格式文件openpyxl excel的格式 excel有xls和xlsx两种格式，他们的区别在于
文件格式不同：xls是一个特有的二进制格式，其核心结构是符合文档类型的机构，而xlsx的核心结构是xml类型的结构，采用的事基于xml的压缩方式，使其占用的空间更小。xlsx中最后一个x的意义就在于此。兼容性不同，xlsx格式是向下兼容的，可以兼容xls格式。python自带的模块中有针对xls格式的xlrd和xlwt模块，但是这两个库仅仅针对xls的操作，当我们要操作xlsx格式文件时，则需要使用到openpyxl第三方库
xls格式文件 python中对xls格式文件相关的包有三个：xlrd、xlwt和xlutils
xlrd只能读取文件，不能写入文件xlwt只能写入文件，不能读取文件xlutils通过.copy.copy方法，将xlrd读取的文件复制给xlwt处理，相当于在xlrd和xlwt之间架起一座桥梁 xlrd # xls import xlrd path=&#39;11.xls&#39; index=0 sheetname=&#39;sheet1&#39; # 打开文件，绝对路径或者相对路径，找不到文件会报错 workbook=xlrd.open_workbook(path) # 获取文件中所有的sheet对象 sheets=workbook.sheets() # 获取文件中所有的sheet名称，返回名称列表 names=workbook.sheet_names() # 获取一个文件中有多少对象 n=workbook.nsheets # 获取对应索引的对象,索引从0开始 sheet_index=workbook.sheet_by_index(index) # 获取指定工作表的表名 name=sheet_index.name # 获取对应名字的对象 sheet_name=workbook.sheet_by_name(sheetname) print(sheet_name) # 获取xls的行和列的数量 nrows=sheet_index.nrows ncols=sheet_index.ncols # 获取工作表对应行和列的单元格组成的列表 # 元素的格式是 数值类型：对应数据 row_list=sheet_index.row(0) print(row_list,&#39;\n&#39;) row_list=sheet_index.row(1) # print(row_list,&#39;\n&#39;) col_list=sheet_index.col(2) # print(col_list,&#39;\n&#39;) # 取出工作表对应行和列的值组成的列表 row_value=sheet_index.row_values(-1)# 最后一行 print(row_value,&#34;\n&#34;) col_value=sheet_index.col_values(0) # 输出行和列 row_type=sheet_index.row_types(6)# 数据类型：0.空，1.字符串，2.数字，3.日期，4.布尔，5.error print(row_type,&#34;\n&#34;) col_type=sheet_index.col_types(1) # 根据索引值，返回该行的长度，列没有对应操作 len=sheet_index.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-01-15T20:36:32+08:00">
    <meta property="article:modified_time" content="2024-01-15T20:36:32+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程学习者" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程学习者</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">python如何读取excel表格数据</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-tomorrow-night-eighties">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><ul><li><a href="#excel_1" rel="nofollow">excel的格式</a></li><li><a href="#xls_8" rel="nofollow">xls格式文件</a></li><li><ul><li><a href="#xlrd_15" rel="nofollow">xlrd</a></li><li><a href="#xlwt_84" rel="nofollow">xlwt</a></li><li><a href="#excelxls_104" rel="nofollow">excel读取xls类型数据三个方法</a></li></ul> 
   </li><li><a href="#xlsx_176" rel="nofollow">xlsx格式文件</a></li><li><ul><li><a href="#openpyxl_177" rel="nofollow">openpyxl</a></li></ul> 
  </li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h3><a id="excel_1"></a>excel的格式</h3> 
<p>excel有xls和xlsx两种格式，他们的区别在于</p> 
<ul><li>文件格式不同：xls是一个特有的二进制格式，其核心结构是符合文档类型的机构，而xlsx的核心结构是xml类型的结构，采用的事基于xml的压缩方式，使其占用的空间更小。xlsx中最后一个x的意义就在于此。</li><li>兼容性不同，xlsx格式是向下兼容的，可以兼容xls格式。</li><li>python自带的模块中有针对xls格式的xlrd和xlwt模块，但是这两个库仅仅针对xls的操作，当我们要操作xlsx格式文件时，则需要使用到openpyxl第三方库<br> <img src="https://images2.imgbox.com/3f/9d/mDEPyMYM_o.png" alt="在这里插入图片描述"></li></ul> 
<h3><a id="xls_8"></a>xls格式文件</h3> 
<blockquote> 
 <p>python中对xls格式文件相关的包有三个：xlrd、xlwt和xlutils</p> 
</blockquote> 
<ul><li>xlrd只能读取文件，不能写入文件</li><li>xlwt只能写入文件，不能读取文件</li><li>xlutils通过.copy.copy方法，将xlrd读取的文件复制给xlwt处理，相当于在xlrd和xlwt之间架起一座桥梁</li></ul> 
<h4><a id="xlrd_15"></a>xlrd</h4> 
<pre><code class="prism language-python"><span class="token comment"># xls</span>
<span class="token keyword">import</span> xlrd

path<span class="token operator">=</span><span class="token string">'11.xls'</span>
index<span class="token operator">=</span><span class="token number">0</span>
sheetname<span class="token operator">=</span><span class="token string">'sheet1'</span>
<span class="token comment"># 打开文件，绝对路径或者相对路径，找不到文件会报错</span>
workbook<span class="token operator">=</span>xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span>path<span class="token punctuation">)</span>
<span class="token comment"># 获取文件中所有的sheet对象</span>
sheets<span class="token operator">=</span>workbook<span class="token punctuation">.</span>sheets<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 获取文件中所有的sheet名称，返回名称列表</span>
names<span class="token operator">=</span>workbook<span class="token punctuation">.</span>sheet_names<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 获取一个文件中有多少对象</span>
n<span class="token operator">=</span>workbook<span class="token punctuation">.</span>nsheets

<span class="token comment"># 获取对应索引的对象,索引从0开始</span>
sheet_index<span class="token operator">=</span>workbook<span class="token punctuation">.</span>sheet_by_index<span class="token punctuation">(</span>index<span class="token punctuation">)</span>
<span class="token comment"># 获取指定工作表的表名</span>
name<span class="token operator">=</span>sheet_index<span class="token punctuation">.</span>name

<span class="token comment"># 获取对应名字的对象</span>
sheet_name<span class="token operator">=</span>workbook<span class="token punctuation">.</span>sheet_by_name<span class="token punctuation">(</span>sheetname<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>sheet_name<span class="token punctuation">)</span>


<span class="token comment"># 获取xls的行和列的数量</span>
nrows<span class="token operator">=</span>sheet_index<span class="token punctuation">.</span>nrows
ncols<span class="token operator">=</span>sheet_index<span class="token punctuation">.</span>ncols

<span class="token comment"># 获取工作表对应行和列的单元格组成的列表</span>
<span class="token comment"># 元素的格式是 数值类型：对应数据</span>
row_list<span class="token operator">=</span>sheet_index<span class="token punctuation">.</span>row<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>row_list<span class="token punctuation">,</span><span class="token string">'\n'</span><span class="token punctuation">)</span>
row_list<span class="token operator">=</span>sheet_index<span class="token punctuation">.</span>row<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment"># print(row_list,'\n')</span>
col_list<span class="token operator">=</span>sheet_index<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment"># print(col_list,'\n')</span>


<span class="token comment"># 取出工作表对应行和列的值组成的列表</span>
row_value<span class="token operator">=</span>sheet_index<span class="token punctuation">.</span>row_values<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment"># 最后一行</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>row_value<span class="token punctuation">,</span><span class="token string">"\n"</span><span class="token punctuation">)</span>
col_value<span class="token operator">=</span>sheet_index<span class="token punctuation">.</span>col_values<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token comment"># 输出行和列</span>
row_type<span class="token operator">=</span>sheet_index<span class="token punctuation">.</span>row_types<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token comment"># 数据类型：0.空，1.字符串，2.数字，3.日期，4.布尔，5.error</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>row_type<span class="token punctuation">,</span><span class="token string">"\n"</span><span class="token punctuation">)</span>
col_type<span class="token operator">=</span>sheet_index<span class="token punctuation">.</span>col_types<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment"># 根据索引值，返回该行的长度，列没有对应操作</span>
<span class="token builtin">len</span><span class="token operator">=</span>sheet_index<span class="token punctuation">.</span>row_len<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>


<span class="token comment"># 对单元格进行操作</span>
<span class="token comment"># 根据行列的索引，返回单元格的数据 数据类型：对应数据</span>
di<span class="token operator">=</span>sheet_index<span class="token punctuation">.</span>cell<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>di<span class="token punctuation">,</span><span class="token string">"\n"</span><span class="token punctuation">)</span>

<span class="token comment"># 返回单元格的数据</span>
ty<span class="token operator">=</span>sheet_index<span class="token punctuation">.</span>cell_value<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
ty<span class="token operator">=</span>sheet_index<span class="token punctuation">.</span>cell<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value
ty<span class="token operator">=</span>sheet_index<span class="token punctuation">.</span>row<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value
</code></pre> 
<p><strong>运行结果</strong></p> 
<p><img src="https://images2.imgbox.com/2d/cf/FP4ePBgc_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="xlwt_84"></a>xlwt</h4> 
<pre><code class="prism language-python"><span class="token keyword">import</span> xlwt

name<span class="token operator">=</span><span class="token string">'sheet1'</span>
new_workbook<span class="token operator">=</span>xlwt<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
<span class="token comment"># 在工作簿中添加一个工作表，如果不添加会报错</span>
new_sheet<span class="token operator">=</span>new_workbook<span class="token punctuation">.</span>add_sheet<span class="token punctuation">(</span>name<span class="token punctuation">)</span>

<span class="token comment"># 添加内容</span>
row<span class="token operator">=</span><span class="token number">0</span>
col<span class="token operator">=</span><span class="token number">0</span>
text<span class="token operator">=</span><span class="token string">'11111'</span>
new_sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span>row<span class="token punctuation">,</span>col<span class="token punctuation">,</span>text<span class="token punctuation">)</span>
<span class="token comment"># 保存</span>
file_path<span class="token operator">=</span><span class="token string">'11.xls'</span>
new_workbook<span class="token punctuation">.</span>save<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>
</code></pre> 
<h4><a id="excelxls_104"></a>excel读取xls类型数据三个方法</h4> 
<blockquote> 
 <p>可以通过一下方法，对xls数据进行读取、写入和追加写入</p> 
</blockquote> 
<pre><code class="prism language-python"><span class="token keyword">import</span> xlrd
<span class="token keyword">import</span> xlwt
<span class="token keyword">from</span> xlutils<span class="token punctuation">.</span>copy <span class="token keyword">import</span> copy

<span class="token comment"># 读取xls格式的文件,读取全部的数据，以最大的行和最大的列来计算</span>
<span class="token keyword">def</span> <span class="token function">read_xls_all</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>index<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    url:文件的路径
    index：第几个工作表，从1开始
    
    返回值：表格中的数据
    '''</span>
    <span class="token comment"># 打开指定的工作簿</span>
    workbook<span class="token operator">=</span>xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    <span class="token comment"># 获取工作簿中所有的表格</span>
    sheets<span class="token operator">=</span>workbook<span class="token punctuation">.</span>sheet_names<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># sheets: ['Sheet1', 'Sheet2', 'Sheet3']</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'sheets:'</span><span class="token punctuation">,</span>sheets<span class="token punctuation">)</span>
    <span class="token comment"># 获取index的表格</span>
    worksheet<span class="token operator">=</span>workbook<span class="token punctuation">.</span>sheet_by_name<span class="token punctuation">(</span>sheets<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span>
    
    datas<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token comment"># 遍历每一行数据</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>worksheet<span class="token punctuation">.</span>nrows<span class="token punctuation">)</span><span class="token punctuation">:</span>
        item<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token comment"># 遍历每一列数据</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>worksheet<span class="token punctuation">.</span>ncols<span class="token punctuation">)</span><span class="token punctuation">:</span>
            item<span class="token punctuation">.</span>append<span class="token punctuation">(</span>worksheet<span class="token punctuation">.</span>cell_value<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># 可以获取单个数据</span>
        datas<span class="token punctuation">.</span>append<span class="token punctuation">(</span>item<span class="token punctuation">)</span>
    <span class="token keyword">return</span> datas

<span class="token comment"># 往xls文件写入数据</span>
<span class="token keyword">def</span> <span class="token function">write_xls_excel</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>sheet_name<span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    data必须是二维表
    '''</span>
    <span class="token comment"># 创建工作簿对象</span>
    workbook<span class="token operator">=</span>xlwt<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 创建一个工作表对象</span>
    sheet<span class="token operator">=</span>workbook<span class="token punctuation">.</span>add_sheet<span class="token punctuation">(</span>sheet_name<span class="token punctuation">)</span>
    <span class="token comment"># 遍历每一行数据</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment"># 把原来所有的数据都清空，再写入数据</span>
    
    workbook<span class="token punctuation">.</span>save<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'写入成功'</span><span class="token punctuation">)</span>
    
<span class="token comment"># 以追加的形式写入xls</span>
<span class="token keyword">def</span> <span class="token function">write_xls_add</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>index<span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    workbook<span class="token operator">=</span>xlrd<span class="token punctuation">.</span>open_workbook<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    sheets<span class="token operator">=</span>workbook<span class="token punctuation">.</span>sheet_names<span class="token punctuation">(</span><span class="token punctuation">)</span>
    worksheet<span class="token operator">=</span>workbook<span class="token punctuation">.</span>sheet_by_name<span class="token punctuation">(</span>sheets<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># 获取行数</span>
    rows<span class="token operator">=</span>worksheet<span class="token punctuation">.</span>nrows
    <span class="token comment"># 将xlrd对象拷贝转化为xlwt对象</span>
    new_workbook<span class="token operator">=</span>copy<span class="token punctuation">(</span>workbook<span class="token punctuation">)</span>
    <span class="token comment"># 获取转化后工作簿中的第index个表格</span>
    new_worksheet<span class="token operator">=</span>new_workbook<span class="token punctuation">.</span>get_sheet<span class="token punctuation">(</span>index<span class="token punctuation">)</span>
    <span class="token comment"># 遍历每一行数据</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># 追加数据</span>
            new_worksheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span>i<span class="token operator">+</span>rows<span class="token punctuation">,</span>j<span class="token punctuation">,</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># 保存工作簿</span>
    new_workbook<span class="token punctuation">.</span>save<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'追加数据成功'</span><span class="token punctuation">)</span>
</code></pre> 
<h3><a id="xlsx_176"></a>xlsx格式文件</h3> 
<h4><a id="openpyxl_177"></a>openpyxl</h4> 
<blockquote> 
 <p>openpyxl不能凭空产生一个表格文件，但是xlwt可以，所以openpyxl需要传入一个excel文件</p> 
</blockquote> 
<pre><code class="prism language-python"><span class="token keyword">import</span> openpyxl

<span class="token comment"># 读取xlsx格式文件</span>
<span class="token keyword">def</span> <span class="token function">read_xlsx_excel</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>sheet_name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    读取xlsx格式文件
    返回值：表格中的数据
    '''</span>
    <span class="token comment"># 使用openpyxl加载指定路径的excel文件并得到对应的workbook对象</span>
    workbook<span class="token operator">=</span>openpyxl<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    <span class="token comment"># 根据指定表名获取表格并得到对应的sheet对象</span>
    sheet<span class="token operator">=</span>workbook<span class="token punctuation">[</span>sheet_name<span class="token punctuation">]</span>
    data<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token comment"># 遍历表格中的每一行</span>
    <span class="token keyword">for</span> row <span class="token keyword">in</span> sheet<span class="token punctuation">.</span>rows<span class="token punctuation">:</span>
        da<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> item <span class="token keyword">in</span> row<span class="token punctuation">:</span>
            da<span class="token punctuation">.</span>append<span class="token punctuation">(</span>item<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
        data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>da<span class="token punctuation">)</span>
    <span class="token keyword">return</span> data

<span class="token comment"># 写入数据</span>
<span class="token keyword">def</span> <span class="token function">write_xlsx_excel</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>sheet_name<span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    写入xlsx格式文件
    会创建一个名为sheet_name的对象，把data写入，其他的全部清空
    '''</span>
    <span class="token comment"># 创建工作簿</span>
    workbook<span class="token operator">=</span>openpyxl<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 创建工作表对象</span>
    sheet<span class="token operator">=</span>workbook<span class="token punctuation">.</span>active
    <span class="token comment"># 设置工作表的名字</span>
    sheet<span class="token punctuation">.</span>title<span class="token operator">=</span>sheet_name
    
    <span class="token comment"># 遍历数据</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># 写入数据，注意openpyxl的行和列式从1开始的</span>
            sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>column<span class="token operator">=</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>value<span class="token operator">=</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
            
    
    <span class="token comment"># 保存</span>
    workbook<span class="token punctuation">.</span>save<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'写入成功'</span><span class="token punctuation">)</span>
    
    
    
<span class="token comment"># 追加写入xlsx格式文件</span>
<span class="token keyword">def</span> <span class="token function">write_xlsx_add</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>sheet_name<span class="token punctuation">,</span>datas<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    追加数据
    '''</span>
    <span class="token comment"># 使用openpyxl加载指定路径的excel文件并得到对应的workbook对象</span>
    workbook<span class="token operator">=</span>openpyxl<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    <span class="token comment"># 根据指定表名获取表格并得到对应的sheet对象</span>
    sheet<span class="token operator">=</span>workbook<span class="token punctuation">[</span>sheet_name<span class="token punctuation">]</span>
    <span class="token comment"># 增加一个定位</span>
    sheet<span class="token punctuation">[</span><span class="token string">'B1'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'开始'</span><span class="token comment"># 可用于增加表头</span>
    <span class="token keyword">for</span> item <span class="token keyword">in</span> datas<span class="token punctuation">:</span>
        sheet<span class="token punctuation">.</span>append<span class="token punctuation">(</span>item<span class="token punctuation">)</span>
    
    <span class="token comment"># 保存</span>
    workbook<span class="token punctuation">.</span>save<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token comment"># 覆盖原来已经存在的文件</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'追加数据成功'</span><span class="token punctuation">)</span>
    
url<span class="token operator">=</span><span class="token string">'example.xlsx'</span>
sheet_name<span class="token operator">=</span><span class="token string">'Sheet2'</span>
data<span class="token operator">=</span>read_xlsx_excel<span class="token punctuation">(</span>url<span class="token punctuation">,</span>sheet_name<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token comment"># write_xlsx_excel(url,'Sheet2',data)</span>
write_xlsx_add<span class="token punctuation">(</span>url<span class="token punctuation">,</span>sheet_name<span class="token punctuation">,</span>data<span class="token punctuation">)</span>
</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/b767b4f64a5972cd9396b46eeb591b4c/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">【数据结构】---树：中序遍历</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/a61d4dda20e009dfd7065c873eada6b2/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">AIGC笔记--VQVAE模型搭建</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程学习者.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
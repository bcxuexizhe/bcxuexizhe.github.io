<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>保姆级自动化测试教程(Selenium&#43;java） - 编程学习者</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcxuexizhe.github.io/posts/189e94327a2b499ea451ce3afd814aa3/">
  <meta property="og:site_name" content="编程学习者">
  <meta property="og:title" content="保姆级自动化测试教程(Selenium&#43;java）">
  <meta property="og:description" content="文章目录 自动化测试1. 自动化测试介绍2. Selenium介绍与环境搭建2.1 介绍2.2 Selenium原理2.3 Selenium&#43;Java环境搭建 3. webdriver API3.1 元素的定位3.2 操作测试对象3.3 添加等待3.4 打印信息3.5 浏览器操作3.6 键盘事件3.7 鼠标事件3.9 特殊使用3.10 浏览器关闭3.11 切换窗口3.12 截图 4. 实现自动化测试 自动化测试 1. 自动化测试介绍 自动化测试指软件测试的自动化，在预设状态下运行应用程序或者系统，预设条件包括正常和异常，最后评估运行结果。将人为驱动的测试行为转化为机器执行的过程。
自动化测试包括 UI自动化 ，接口自动化 ，单元测试自动化 。
单元测试 ：最大的投入应该在单元测试上，单元测试运行的频率也更加高。java的单元测试框架是Junit。
接口自动化 ：接口测试就是API测试，相对于UI自动化，API自动化更加容易实现，执行起来也更稳定。
特点：
- 可在产品前期，接口完成后介入。 - 用例维护量小。 - 适合接口变动较小，界面变动频繁的项目。 常见的接口自动化测试工具有RobotFramework，JMeter，SoapUI，TestNG&#43;HttpClient，Postman等。
UI自动化 ：虽然测试金字塔告诉我们尽量多做API层的自动化测试，但是UI层的自动化测试更加贴近用户的需求和软件系统的实际业务。并且有时候我们不得不进行UI层的测试。
特点：
用例维护量大。页面相关性强，必须后期项目页面开发完成后介入。UI测试适合与界面变动较小的项目。 UI层的测试框架比较多，比如Windows客户端测试的AutoIT，web测试的selenium以及TestPlant eggPlant，Robot framework，QTP等。
以下将介绍的就是web应用中基于UI的自动化测试框架Selenium的使用；
2. Selenium介绍与环境搭建 2.1 介绍 Selenium是web应用中基于UI的自动化测试框架，支持多平台、多浏览器、多语言。早期的selenium RC已经被现在的webDriver所替代，可以简单的理解为selenium1.0&#43;webdriver构成现在的Selenium2.0。它有由Selenium IDE，Webdriver，Selenium Grid组成。
Selenium IDE ：用于Selenium测试的完成集成开发环境，可以 录制在浏览器的用户操作，并且能回放，编辑和调试测试脚本。调试过程中可以逐步进行或调整执行的速度，并且可以在底部浏览日志出错信息。 录制的测试脚本可以以多种语言导出，比如java，C#，Python，Ruby等，方便掌握不同语言的测试人员操作。
Webdriver ：Selenium RC 在浏览器中运行 JavaScript 应用，会存在环境沙箱问题，而WebDriver可以跳出沙箱，针对不同的浏览器创建更健壮的，分布式的，跨平台的自动化测试脚本。基于特定语言绑定来驱动浏览器对Web元素进行操作和验证。">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-06-29T13:17:00+08:00">
    <meta property="article:modified_time" content="2023-06-29T13:17:00+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程学习者" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程学习者</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">保姆级自动化测试教程(Selenium&#43;java）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_1" rel="nofollow">自动化测试</a></li><li><ul><li><a href="#1__2" rel="nofollow">1. 自动化测试介绍</a></li><li><a href="#2_Selenium_26" rel="nofollow">2. Selenium介绍与环境搭建</a></li><li><ul><li><a href="#21__27" rel="nofollow">2.1 介绍</a></li><li><a href="#22_Selenium_36" rel="nofollow">2.2 Selenium原理</a></li><li><a href="#23_SeleniumJava_39" rel="nofollow">2.3 Selenium+Java环境搭建</a></li></ul> 
   </li><li><a href="#3_webdriver_API_91" rel="nofollow">3. webdriver API</a></li><li><ul><li><a href="#31__92" rel="nofollow">3.1 元素的定位</a></li><li><a href="#32__115" rel="nofollow">3.2 操作测试对象</a></li><li><a href="#33__126" rel="nofollow">3.3 添加等待</a></li><li><a href="#34__146" rel="nofollow">3.4 打印信息</a></li><li><a href="#35__153" rel="nofollow">3.5 浏览器操作</a></li><li><a href="#36__198" rel="nofollow">3.6 键盘事件</a></li><li><a href="#37__237" rel="nofollow">3.7 鼠标事件</a></li><li><a href="#39__271" rel="nofollow">3.9 特殊使用</a></li><li><a href="#310__407" rel="nofollow">3.10 浏览器关闭</a></li><li><a href="#311__430" rel="nofollow">3.11 切换窗口</a></li><li><a href="#312__464" rel="nofollow">3.12 截图</a></li></ul> 
   </li><li><a href="#4__485" rel="nofollow">4. 实现自动化测试</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_1"></a>自动化测试</h2> 
<h3><a id="1__2"></a>1. 自动化测试介绍</h3> 
<p>自动化测试指软件测试的自动化，在预设状态下运行应用程序或者系统，预设条件包括正常和异常，最后评估运行结果。将人为驱动的测试行为转化为机器执行的过程。<br> 自动化测试包括 <strong>UI自动化</strong> ，<strong>接口自动化</strong> ，<strong>单元测试自动化</strong> 。</p> 
<ol><li> <p><strong>单元测试</strong> ：最大的投入应该在单元测试上，单元测试运行的频率也更加高。java的单元测试框架是Junit。</p> </li><li> <p><strong>接口自动化</strong> ：接口测试就是API测试，相对于UI自动化，API自动化更加容易实现，执行起来也更稳定。<br> 特点：</p> <pre><code> - 可在产品前期，接口完成后介入。
 - 用例维护量小。
 - 适合接口变动较小，界面变动频繁的项目。
</code></pre> <p>常见的接口自动化测试工具有RobotFramework，JMeter，SoapUI，TestNG+HttpClient，Postman等。</p> </li><li> <p><strong>UI自动化</strong> ：虽然测试金字塔告诉我们尽量多做API层的自动化测试，但是UI层的自动化测试更加贴近用户的需求和软件系统的实际业务。并且有时候我们不得不进行UI层的测试。<br> 特点：</p> 
  <ul><li>用例维护量大。</li><li>页面相关性强，必须后期项目页面开发完成后介入。</li><li>UI测试适合与界面变动较小的项目。</li></ul> </li></ol> 
<p>UI层的测试框架比较多，比如Windows客户端测试的AutoIT，web测试的selenium以及TestPlant eggPlant，Robot framework，QTP等。</p> 
<p><strong>以下将介绍的就是web应用中基于UI的自动化测试框架Selenium的使用；</strong></p> 
<h3><a id="2_Selenium_26"></a>2. Selenium介绍与环境搭建</h3> 
<h4><a id="21__27"></a>2.1 介绍</h4> 
<p>Selenium是web应用中基于UI的自动化测试框架，支持多平台、多浏览器、多语言。早期的selenium RC已经被现在的webDriver所替代，可以简单的理解为selenium1.0+webdriver构成现在的Selenium2.0。它有由Selenium IDE，Webdriver，Selenium Grid组成。</p> 
<ol><li> <p><strong>Selenium IDE</strong> ：用于Selenium测试的完成集成开发环境，可以 <mark>录制在浏览器的用户操作，并且能回放，编辑和调试测试脚本。调试过程中可以逐步进行或调整执行的速度，并且可以在底部浏览日志出错信息。</mark> 录制的测试脚本可以以多种语言导出，比如java，C#，Python，Ruby等，方便掌握不同语言的测试人员操作。</p> </li><li> <p><strong>Webdriver</strong> ：Selenium RC 在浏览器中运行 JavaScript 应用，会存在环境沙箱问题，而WebDriver可以跳出沙箱，针对不同的浏览器创建更健壮的，分布式的，跨平台的自动化测试脚本。基于特定语言绑定来驱动浏览器对Web元素进行操作和验证。</p> </li><li> <p><strong>selenium Grid</strong> ：selenium Grid是一个服务器，提供对浏览器实例访问的服务器列表，管理各个节点的注册和状态信<br> 息。可以实现在同一时刻不同服务器上执行不同的测试脚本。</p> </li></ol> 
<h4><a id="22_Selenium_36"></a>2.2 Selenium原理</h4> 
<p><img src="https://images2.imgbox.com/44/11/AnzeuwGP_o.png" alt="在这里插入图片描述"><br> <mark>解释说明</mark> ：通过自动化脚本代码创建一个HTTP请求发送到webdriver浏览器驱动，webdriver根据请求内容解析成能够操作浏览器的指令，浏览器通过指令执行测试步骤，然后返回结果给webdriver驱动，它再将结果返回给脚本。</p> 
<h4><a id="23_SeleniumJava_39"></a>2.3 Selenium+Java环境搭建</h4> 
<p><strong>Chrome+Java 环境</strong></p> 
<ol><li> <p>下载chrome浏览器<br> https://www.google.cn/intl/zh-CN/chrome/</p> </li><li> <p>查看chrome浏览器版本</p> </li><li> <p>下载chrome浏览器驱动<br> https://chromedriver.chromium.org/downloads<br> <img src="https://images2.imgbox.com/02/50/9LeP1ky2_o.png" alt="在这里插入图片描述"><br> <img src="https://images2.imgbox.com/01/f3/AR55RIQP_o.png" alt="在这里插入图片描述"></p> </li><li> <p>配置环境变量<br> 解压下载好的驱动压缩包，将下载好的chromedriver.exe放到java系统环境变量下。<br> 举例：我的java路径是C:\Program Files\Java\jdk1.8.0_131\bin<br> <img src="https://images2.imgbox.com/26/ba/3gbjROai_o.png" alt="在这里插入图片描述"></p> </li><li> <p>验证环境是否搭建成功<br> 创建java项目，添加pom文件中添加依赖</p> </li></ol> 
<pre><code class="prism language-java"><span class="token generics"><span class="token punctuation">&lt;</span>dependencies<span class="token punctuation">&gt;</span></span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mvnrepository<span class="token punctuation">.</span>com<span class="token operator">/</span>artifact<span class="token operator">/</span>org<span class="token punctuation">.</span>seleniumhq<span class="token punctuation">.</span>selenium<span class="token operator">/</span>selenium<span class="token operator">-</span>java <span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token generics"><span class="token punctuation">&lt;</span>dependency<span class="token punctuation">&gt;</span></span>
        <span class="token generics"><span class="token punctuation">&lt;</span>groupId<span class="token punctuation">&gt;</span></span>org<span class="token punctuation">.</span>seleniumhq<span class="token punctuation">.</span>selenium<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>artifactId<span class="token punctuation">&gt;</span></span>selenium<span class="token operator">-</span>java<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">&gt;</span>
        <span class="token generics"><span class="token punctuation">&lt;</span>version<span class="token punctuation">&gt;</span></span><span class="token number">3.141</span><span class="token number">.59</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dependency<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>dependencies<span class="token operator">&gt;</span>
</code></pre> 
<ol start="8"><li>编写代码运行</li></ol> 
<pre><code class="prism language-java"><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>chrome<span class="token punctuation">.</span></span><span class="token class-name">ChromeDriver</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>chrome<span class="token punctuation">.</span></span><span class="token class-name">ChromeOptions</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">ChromeOptions</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChromeOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        options<span class="token punctuation">.</span><span class="token function">addArguments</span><span class="token punctuation">(</span><span class="token string">"--remote-allow-origins=*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">WebDriver</span> webDriver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChromeDriver</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
        webDriver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"https://www.baidu.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<p><img src="https://images2.imgbox.com/f3/b0/caWQ7T6C_o.png" alt="在这里插入图片描述"></p> 
<p><mark>如果打开了浏览器，此时说明安装成功</mark></p> 
<h3><a id="3_webdriver_API_91"></a>3. webdriver API</h3> 
<h4><a id="31__92"></a>3.1 元素的定位</h4> 
<p>对象的定位应该是自动化测试的核心，要想操作一个对象，首先应该识别这个对象。webdriver 提供了一系列的对象定位方法，常用的有以下几种：不管哪种方式都应该保证定位要操作的对象是唯一的；</p> 
<ol><li> <p><strong>id</strong>：通过页面元素id的值进行定位。</p> </li><li> <p><strong>name</strong>：如果这个元素有name，并且元素的name命名在整个页面是唯一的，那么我们可以用name来定位这个元素。</p> </li><li> <p><strong>class name和tag name</strong>：也是通过这两个属性的值进行定位。</p> </li><li> <p><strong>link text</strong>：有时候不是一个输入框也不是一个按钮，而是一个文字链接，我们可以通过链接内容来定位。</p> </li><li> <p><strong>xpath</strong>：XPath 是一种在XML 文档中定位元素的语言。因为HTML 可以看做XML 的一种实现，所以selenium 用户可是使用这种强大语言在web 应用中定位元素。XPath 扩展了上面id 和name 定位方式。 <mark>XPATH的获取可以用chrome的F12开发者模式中Element-右键-copy-copy xpath来获取</mark></p> </li></ol> 
<blockquote> 
 <p>例如：webDriver.findElement(By.xpath(“//*[@id=“kw”]”));</p> 
</blockquote> 
<ol start="6"><li><strong>css selector</strong>：CSS 使用选择器来为页面元素绑定属性。这些选择器可以被selenium 用作另外的定位策略。<mark>CSS的获取可以用chrome的F12开发者模式中Element-右键-copy-copy selector来获取</mark></li></ol> 
<blockquote> 
 <p>例如：webDriver.findElement(By.cssSelector(“.s_ipt”)); 遵从css语法中选择器使用的规则</p> 
</blockquote> 
<ol start="7"><li><strong>partial link text</strong>：通过部分链接定位，可以只用链接的一部分文字进行匹配。</li></ol> 
<h4><a id="32__115"></a>3.2 操作测试对象</h4> 
<p>通过上面元素定位找到操作的对象后，我们通过以下方法可以进行相关操作。具体使用参考下面完整的代码案例；</p> 
<ol><li>click（） 点击对象，可以实现提交效果。</li><li>sendKeys（） 在对象上模拟按键输入</li><li>clear（） 清除对象输入的文本内容</li><li>submit（） 提交，点击的元素在form标签中使用与click（）效果一致。</li><li>getAttribute（）获取元素属性的值如value。</li><li>getText （）用于获取元素的文本内容。</li></ol> 
<h4><a id="33__126"></a>3.3 添加等待</h4> 
<ol><li>强制等待：sleep（）实现。</li><li>隐式等待： 等待页面所有元素。</li><li>显示等待：可以指定等待页面的某一个元素。</li><li>隐式等待和显示等待也称为智能等待。</li></ol> 
<p><mark>强制等待与隐式等待区别：</mark><br> 如果等待时间是三天，那么强制等待，会一直等待直到三天结束，隐式等待如果等待过程中元素加载完成那么就提前结束等待。</p> 
<p><mark>隐式等待与显示等待的区别：</mark><br> 隐式等待是等待页面所有的元素加载完成后才执行下面代码，如果加载过程中超过等待时间就会报错；显示等待最长等待时间为设置的时间，在期间如果满足等待结束条件（until（）方法中）就会结束等待。</p> 
<p><strong>使用方式：</strong></p> 
<p><img src="https://images2.imgbox.com/dc/0d/r6EOlUiZ_o.png" alt="在这里插入图片描述"></p> 
<p><strong>显示等待，满足until方法就结束；</strong><br> <img src="https://images2.imgbox.com/7a/47/9lByHYjs_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="34__146"></a>3.4 打印信息</h4> 
<p>通过<mark>getTitle（）</mark> 方法打印title的值，通过<mark>getCurrentUrl（）</mark> 方法打印url的值。</p> 
<p><strong>使用方式：</strong></p> 
<p><img src="https://images2.imgbox.com/d3/60/fcNP0glo_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="35__153"></a>3.5 浏览器操作</h4> 
<ol><li>浏览器前进</li><li>浏览器后退</li><li>浏览器滚动条操作</li><li>浏览器最大化</li><li>浏览器全屏</li><li>浏览器宽高设置</li></ol> 
<p>具体操作如下：</p> 
<pre><code class="prism language-java"> <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test06</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">WebDriver</span> webDriver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChromeDriver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//打开百度首页</span>
        webDriver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"https://www.baidu.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token comment">//搜索迪丽热巴</span>
        webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span><span class="token class-name">By</span><span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"#kw"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span><span class="token string">"迪丽热巴"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span><span class="token class-name">By</span><span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"#su"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//强制等待3秒</span>
        <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//浏览器后退</span>
        webDriver<span class="token punctuation">.</span><span class="token function">navigate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//刷新</span>
        webDriver<span class="token punctuation">.</span><span class="token function">navigate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//强制等待</span>
        <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//浏览器前进</span>
        webDriver<span class="token punctuation">.</span><span class="token function">navigate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forward</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//浏览器滚动条操作，此时需要将webDriver强制转换</span>
        <span class="token comment">//executeScript()中是js代码，scrollTop方法是向上滚动多少个像素</span>
        <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">JavascriptExecutor</span><span class="token punctuation">)</span>webDriver<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">executeScript</span><span class="token punctuation">(</span><span class="token string">"document.documentElement.scrollTop=10000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//浏览器最大化</span>
        webDriver<span class="token punctuation">.</span><span class="token function">manage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">maximize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//浏览器全屏</span>
        webDriver<span class="token punctuation">.</span><span class="token function">manage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">fullscreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//设置浏览器宽高</span>
        webDriver<span class="token punctuation">.</span><span class="token function">manage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">window</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Dimension</span><span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
</code></pre> 
<h4><a id="36__198"></a>3.6 键盘事件</h4> 
<p><mark>通过sendKeys()调用按键：</mark></p> 
<p>1.sendKeys(Keys.TAB) # TAB<br> 2.sendKeys(Keys.ENTER) # 回车<br> 3.sendKeys(Keys.SPACE) #空格键<br> 4.sendKeys(Keys.ESCAPE) #回退键（Esc）</p> 
<p><mark>组合使用：</mark></p> 
<p>1.sendKeys(Keys.CONTROL,‘a’) #全选（Ctrl+A）<br> 2.sendKeys(Keys.CONTROL,‘c’) #复制（Ctrl+C）<br> 3.sendKeys(Keys.CONTROL,‘x’) #剪贴（Ctrl+X）<br> 4.sendKeys(Keys.CONTROL,‘v’) #粘贴（Ctrl+V）</p> 
<pre><code class="prism language-java"> <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test07</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">ChromeOptions</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChromeOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//允许所有请求</span>
        options<span class="token punctuation">.</span><span class="token function">addArguments</span><span class="token punctuation">(</span><span class="token string">"--remote-allow-origins=*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">WebDriver</span> webDriver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChromeDriver</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        打开百度网页</span>
        webDriver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"https://www.baidu.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span><span class="token class-name">By</span><span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"#kw"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span><span class="token string">"迪丽热巴"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//control+a</span>
        webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span><span class="token class-name">By</span><span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"#kw"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span><span class="token class-name">Keys</span><span class="token punctuation">.</span>CONTROL<span class="token punctuation">,</span><span class="token string">"A"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//control+x</span>
        webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span><span class="token class-name">By</span><span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"#kw"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span><span class="token class-name">Keys</span><span class="token punctuation">.</span>CONTROL<span class="token punctuation">,</span><span class="token string">"X"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//control+v</span>
        webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span><span class="token class-name">By</span><span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"#kw"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span><span class="token class-name">Keys</span><span class="token punctuation">.</span>CONTROL<span class="token punctuation">,</span><span class="token string">"V"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        

    <span class="token punctuation">}</span>
</code></pre> 
<h4><a id="37__237"></a>3.7 鼠标事件</h4> 
<p>通过ActionChains 类实现鼠标执行的操作：</p> 
<ol><li>contextClick() 右击</li><li>doubleClick() 双击</li><li>dragAndDrop() 拖动</li><li>moveToElement() 移动</li></ol> 
<p><strong>以下为鼠标右击的代码，其他方法也是如此使用：</strong></p> 
<pre><code class="prism language-java"><span class="token comment">//鼠标事件</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test08</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">ChromeOptions</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChromeOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//允许所有请求</span>
        options<span class="token punctuation">.</span><span class="token function">addArguments</span><span class="token punctuation">(</span><span class="token string">"--remote-allow-origins=*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">WebDriver</span> webDriver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChromeDriver</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        打开百度网页</span>
        webDriver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"https://www.baidu.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span><span class="token class-name">By</span><span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"#kw"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span><span class="token string">"迪丽热巴"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span><span class="token class-name">By</span><span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"#su"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//找到图片按钮</span>
        <span class="token class-name">WebElement</span> webElement <span class="token operator">=</span> webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span><span class="token class-name">By</span><span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"#\\32  &gt; div &gt; div &gt; div &gt; div &gt; div.list-scroll_7E1go &gt; div &gt; div:nth-child(1) &gt; div.avatar-wrapper_622F1 &gt; a:nth-child(1) &gt; div &gt; div._capsule_1e0bo_35.capsule_GwMlS.cu-line-clamp-1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//鼠标右击操作</span>
        <span class="token class-name">Actions</span> actions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Actions</span><span class="token punctuation">(</span>webDriver<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//鼠标移动到图片，右击，执行</span>
        <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        actions<span class="token punctuation">.</span><span class="token function">moveToElement</span><span class="token punctuation">(</span>webElement<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contextClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">perform</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

</code></pre> 
<h4><a id="39__271"></a>3.9 特殊使用</h4> 
<ol><li><strong>定位一组元素</strong><br> 选中一组type为checkbox，在page01页面；</li></ol> 
<p><strong>代码：</strong></p> 
<pre><code class="prism language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">page01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 创建一个浏览器驱动</span>
        <span class="token class-name">WebDriver</span> webDriver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChromeDriver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 打开网页</span>
        webDriver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"http://localhost:63342/Test/src/main/page/teste01.html?_ijt=bbsd02k86b9564t8p03vfmeff1&amp;_ij_reload=RELOAD_ON_SAVE"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 获取到所有的input标签对应的元素</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WebElement</span><span class="token punctuation">&gt;</span></span> webElements <span class="token operator">=</span> webDriver<span class="token punctuation">.</span><span class="token function">findElements</span><span class="token punctuation">(</span><span class="token class-name">By</span><span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"input"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 判断每一个input标签里面type值是checkbox进行点击，否则不点击</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> webElements<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>webElements<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">"type"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"checkbox"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
                webElements<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{<!-- --></span>

            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p><strong>结果：</strong></p> 
<p><img src="https://images2.imgbox.com/04/c0/E0Uh3eeN_o.png" alt="在这里插入图片描述"></p> 
<ol start="2"><li><strong>多层框架/窗口定位</strong><br> 对于一个web 应用，经常会出现框架（iframe） 或窗口（window）的应用，这样如果我们定位元素就不能直接右击copy他的xpath或者是cssselector来定位；但是可以通过switchTo（）方法定位到frame下或者window下，然后通过元素css选择器或者xpath定位。</li></ol> 
<p><strong>实现代码：</strong> 以下通过 <mark>switchTo()</mark> 实现定位到 <mark>iframe</mark>下的click按钮。</p> 
<pre><code class="prism language-java"> <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">page02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 创建浏览器驱动</span>
        <span class="token class-name">WebDriver</span> webDriver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChromeDriver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 打开网页</span>
        webDriver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"http://localhost:63342/Test/src/main/page/test02.html?_ijt=ukda3p0a62ntrthar4gi039p32&amp;_ij_reload=RELOAD_ON_SAVE"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 需要先定位到frame下再定位到click</span>
        webDriver<span class="token punctuation">.</span><span class="token function">switchTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">frame</span><span class="token punctuation">(</span><span class="token string">"f1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span><span class="token class-name">By</span><span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"body &gt; div &gt; div &gt; a"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 目标元素不在iframe，可以直接获取</span>
<span class="token comment">//        String h3_text = webDriver.findElement(By.cssSelector("body &gt; div &gt; div &gt; h3")).getText();</span>
<span class="token comment">//        System.out.println(h3_text);</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p><strong>效果：</strong></p> 
<p><img src="https://images2.imgbox.com/51/12/2kXeaV3v_o.png" alt="在这里插入图片描述"></p> 
<ol start="3"><li><strong>操作下拉框</strong><br> 下拉框是我们最常见的一种页面元素，对于一般的元素，我们只需要一次就定位。<br> 但下拉框里的内容需要进行两次定位，先定位到下拉框对下拉框进行操作后，再定位到下拉框内里的选项。</li></ol> 
<p><strong>代码实现： 通过select实现选择下拉框中的内容，可以通过下拉框选择内容定位也可以通过下拉框选项位置定位</strong></p> 
<pre><code class="prism language-java"> <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">page03</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token comment">// 创建浏览器驱动</span>
        <span class="token class-name">WebDriver</span> webDriver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChromeDriver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 打开网页</span>
        webDriver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"http://localhost:63342/Test/src/main/page/test03.html?_ijt=obcfq47vlv4pfo2lointovotam&amp;_ij_reload=RELOAD_ON_SAVE"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 操作下拉框</span>
        <span class="token class-name">Select</span> select <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Select</span><span class="token punctuation">(</span>webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span><span class="token class-name">By</span><span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"#ShippingMethod"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        select.selectByValue("12.51");</span>
        select<span class="token punctuation">.</span><span class="token function">selectByIndex</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p><strong>实现效果：</strong></p> 
<p><img src="https://images2.imgbox.com/eb/22/h5uJVYlb_o.png" alt="在这里插入图片描述"></p> 
<ol start="4"><li><strong>针对页面弹窗操作</strong><br> <mark>通过 alert操作其中方法有：</mark><br> 1.text 返回alert 中的文字信息。<br> 2.accept 点击确认按钮。<br> 3.dismiss 点击取消按钮，如果有的话。<br> 4.sendKeys 输入值，如果alert 没有对话框就不能用了，不然会报错。</li></ol> 
<p><strong>代码实现：先定位到弹窗按钮，然后通过webDriver.switchTo().alert() 对弹窗进行操作；</strong></p> 
<pre><code class="prism language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">page04</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">WebDriver</span> webDriver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChromeDriver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        webDriver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"http://localhost:63342/Test/src/main/page/test04.html?_ijt=6gn3g58a7ubvp1honn2t773m7c&amp;_ij_reload=RELOAD_ON_SAVE"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span><span class="token class-name">By</span><span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"button"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// alert弹窗确定</span>
<span class="token comment">//        webDriver.switchTo().alert().accept();</span>
        <span class="token comment">// alert弹窗取消</span>
<span class="token comment">//        webDriver.switchTo().alert().dismiss();</span>
        webDriver<span class="token punctuation">.</span><span class="token function">switchTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span><span class="token string">"你好"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        webDriver<span class="token punctuation">.</span><span class="token function">switchTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p><strong>效果：</strong></p> 
<p><img src="https://images2.imgbox.com/13/78/rGLOhsvn_o.png" alt="在这里插入图片描述"></p> 
<p><img src="https://images2.imgbox.com/08/63/e0XhEZf0_o.png" alt="在这里插入图片描述"></p> 
<ol start="5"><li><strong>上传文件操作</strong><br> 上传过程一般要打开一个本地窗口，从窗口选择本地文件添加，所以，一般会卡在如何操作本地窗口添加上传文件。<br> <mark>在selenium webdriver 只要定位上传按钮，通过sendKeys 添加本地文件路径就可以了。</mark><br> 绝对路径和相对路径都可以，关键是上传的文件存在。</li></ol> 
<p><strong>代码实现：</strong></p> 
<pre><code class="prism language-java"> <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">page05</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">WebDriver</span> webDriver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChromeDriver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        webDriver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"http://localhost:63342/Selenium01/src/main/Page/test05.html?_ijt=tmsdfhdm1lf1ururkjefb479tj&amp;_ij_reload=RELOAD_ON_SAVE"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 找到按钮（上传文件的按钮），输入一个字符串</span>
        webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span><span class="token class-name">By</span><span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"input"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span><span class="token string">"C:\Users\34085\Desktop\hello.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> 
<p><strong>实现效果</strong></p> 
<p><img src="https://images2.imgbox.com/b6/6a/Iq5ftiF3_o.png" alt="在这里插入图片描述"></p> 
<h4><a id="310__407"></a>3.10 浏览器关闭</h4> 
<p><mark>可以通过quit（）和close（）方法关闭浏览器，quit关闭整个浏览器并且清空缓存，close关闭当前页面。</mark></p> 
<p>直接通过webDriver.close()或者webDriver.quit()使用。</p> 
<pre><code class="prism language-java"> <span class="token comment">//浏览器关闭操作</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test09</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">WebDriver</span> webDriver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChromeDriver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//打开百度首页</span>
        webDriver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"https://www.baidu.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//搜索迪丽热巴</span>
        webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span><span class="token class-name">By</span><span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"#kw"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span><span class="token string">"迪丽热巴"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span><span class="token class-name">By</span><span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"#su"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//强制等待3秒</span>
        <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        webDriver<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        webDriver<span class="token punctuation">.</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
</code></pre> 
<h4><a id="311__430"></a>3.11 切换窗口</h4> 
<p>进入百度页面然后点击新闻进入新闻页面，此时如果我们需要在新闻页面输入相关内容，是不能直接通过选择器定位实现的，此时我们需要先实现页面切换才能在新闻页面搜索内容。</p> 
<p><strong>代码实现：</strong></p> 
<pre><code class="prism language-java"><span class="token comment">//浏览器切换窗口</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test10</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">WebDriver</span> webDriver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChromeDriver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        webDriver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"https://www.baidu.com/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//点击新闻页面，在新闻面输入相关信息</span>
        webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span><span class="token class-name">By</span><span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"#s-top-left &gt; a:nth-child(1)"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//getWindowHandles获得所有窗口句柄</span>
        <span class="token comment">//getWindowHandle获取get打开的窗口句柄</span>
        <span class="token comment">// 获取到浏览器所有的窗口句柄</span>
        <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> handles <span class="token operator">=</span> webDriver<span class="token punctuation">.</span><span class="token function">getWindowHandles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//遍历所有的窗口句柄</span>
        <span class="token class-name">String</span> target_handle <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">String</span> handle<span class="token operator">:</span>handles<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//赋值</span>
            target_handle <span class="token operator">=</span> handle<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//System.out.println(target_handle);</span>
        <span class="token comment">//在新闻页面搜索新闻联播</span>
        webDriver<span class="token punctuation">.</span><span class="token function">switchTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">window</span><span class="token punctuation">(</span>target_handle<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span><span class="token class-name">By</span><span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"#ww"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span><span class="token string">"新闻联播"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span><span class="token class-name">By</span><span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"#s_btn_wr"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       
    <span class="token punctuation">}</span>
</code></pre> 
<h4><a id="312__464"></a>3.12 截图</h4> 
<p>实现截图功能，首先要在maven仓库下载对应的依赖比如Apache Commons IO » 2.13.0，复制到pom.xml文件中。</p> 
<p><strong>代码实现：</strong></p> 
<pre><code class="prism language-java"><span class="token comment">//浏览器截图</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test11</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">WebDriver</span> webDriver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChromeDriver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        webDriver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"https://www.baidu.com/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span><span class="token class-name">By</span><span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"#kw"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span><span class="token string">"软件测试"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span><span class="token class-name">By</span><span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"#su"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//强制转换进行截图以文件形式存储</span>
        <span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">TakesScreenshot</span><span class="token punctuation">)</span>webDriver<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getScreenshotAs</span><span class="token punctuation">(</span><span class="token class-name">OutputType</span><span class="token punctuation">.</span>FILE<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">FileUtils</span><span class="token punctuation">.</span><span class="token function">copyFile</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"d://测试.png"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
</code></pre> 
<h3><a id="4__485"></a>4. 实现自动化测试</h3> 
<p><strong>完整代码：</strong> 首先我们通过webdriver建立连接，然后通过前端页面的选择器或者xpath定位我们的搜索框，通过sendKeys（）方法输入内容，通过css选择器找到百度一下按钮，click（）方法点击搜索。</p> 
<ol><li><strong>test01（）：</strong> 测试百度搜索软件测试结果是否正确。</li><li><strong>test 02（） ：</strong> 通过百度搜索Java之后一定时间后清空搜索框。</li><li><strong>test03（）：</strong> 获取百度页面某元素属性的值。</li></ol> 
<pre><code class="prism language-java"><span class="token comment">/**
 * @author zq
 */</span>
 
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span></span><span class="token class-name">By</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span></span><span class="token class-name">WebDriver</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span></span><span class="token class-name">WebElement</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>chrome<span class="token punctuation">.</span></span><span class="token class-name">ChromeDriver</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>openqa<span class="token punctuation">.</span>selenium<span class="token punctuation">.</span>chrome<span class="token punctuation">.</span></span><span class="token class-name">ChromeOptions</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">TimeUnit</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span><span class="token class-name">Thread</span><span class="token punctuation">.</span>sleep<span class="token punctuation">;</span>

<span class="token comment">//创建驱动所需</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{<!-- --></span>
      <span class="token comment">//test01();</span>
      <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//test03();</span>

    <span class="token punctuation">}</span>
   
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span>  <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">ChromeOptions</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChromeOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//允许所有请求</span>
        options<span class="token punctuation">.</span><span class="token function">addArguments</span><span class="token punctuation">(</span><span class="token string">"--remote-allow-origins=*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">WebDriver</span> webDriver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChromeDriver</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        打开百度网页</span>
        webDriver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"https://www.baidu.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        找到百度搜索输入框,通过CSS中类选择器</span>
        <span class="token class-name">WebElement</span> element <span class="token operator">=</span> webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span><span class="token class-name">By</span><span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">".s_ipt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//         通过xPath</span>
        <span class="token class-name">WebElement</span> element1 <span class="token operator">=</span> webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span><span class="token class-name">By</span><span class="token punctuation">.</span><span class="token function">xpath</span><span class="token punctuation">(</span><span class="token string">"//*[@id=\"kw\"]"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//输入软件测试</span>
        <span class="token comment">//element.sendKeys("软件测试");</span>
        element1<span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span><span class="token string">"软件测试"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//找到百度一下按钮//点击</span>
       webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span><span class="token class-name">By</span><span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"#su"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token comment">//强制休眠一会</span>
       <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token comment">//校验</span>
        <span class="token comment">//找到搜索结果,通过父子类标签找到为软件测试的结果</span>
       <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">WebElement</span><span class="token punctuation">&gt;</span></span> elements <span class="token operator">=</span>  webDriver<span class="token punctuation">.</span><span class="token function">findElements</span><span class="token punctuation">(</span><span class="token class-name">By</span><span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"a em"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> elements<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
            <span class="token comment">//System.out.println(elements.get(i).getText());</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>elements<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"软件测试"</span><span class="token punctuation">)</span><span class="token operator">||</span>elements<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"测试"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"测试不通过"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>elements<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{<!-- --></span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"测试通过"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">ChromeOptions</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChromeOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//允许所有请求</span>
        options<span class="token punctuation">.</span><span class="token function">addArguments</span><span class="token punctuation">(</span><span class="token string">"--remote-allow-origins=*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">WebDriver</span> webDriver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChromeDriver</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        打开百度网页</span>
        webDriver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"https://www.baidu.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//输入java</span>
        webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span><span class="token class-name">By</span><span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"#kw"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendKeys</span><span class="token punctuation">(</span><span class="token string">"java"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//点击百度一下</span>
  webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span><span class="token class-name">By</span><span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"#su"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//设置sleep等待,会一直等到时间结束才执行下面的</span>
        <span class="token comment">//sleep(300000000);</span>
        <span class="token comment">//设置隐式等待,查询到结果就结束没有就一直到指定时间</span>
        webDriver<span class="token punctuation">.</span><span class="token function">manage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">timeouts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">implicitlyWait</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>DAYS<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token comment">//清空结果</span>
        webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span><span class="token class-name">By</span><span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"#kw"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
    
     <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test03</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
        <span class="token class-name">ChromeOptions</span> options <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChromeOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//允许所有请求</span>
        options<span class="token punctuation">.</span><span class="token function">addArguments</span><span class="token punctuation">(</span><span class="token string">"--remote-allow-origins=*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">WebDriver</span> webDriver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ChromeDriver</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        打开百度网页</span>
        webDriver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"https://www.baidu.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">WebElement</span> element <span class="token operator">=</span>webDriver<span class="token punctuation">.</span><span class="token function">findElement</span><span class="token punctuation">(</span><span class="token class-name">By</span><span class="token punctuation">.</span><span class="token function">cssSelector</span><span class="token punctuation">(</span><span class="token string">"#su"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> s <span class="token operator">=</span>   element<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token comment">// System.out.println(s); 通过这个无法获取元素属性值</span>
        <span class="token comment">//通过getAttribute获取</span>
        <span class="token class-name">String</span> s1 <span class="token operator">=</span> element<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">"value"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/26f5adf57f27892613f8962187a60682/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">Java8日期类LocalDate、LocalTime、LocalDateTime使用详解</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/f6f730eff786ef0fbcf05a8c769af019/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">EXISTS关键字在Oracle中的使用</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程学习者.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
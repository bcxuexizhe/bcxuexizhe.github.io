<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>【Spark编程基础】实验一Spark编程初级实践（附源代码） - 编程学习者</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcxuexizhe.github.io/posts/316de512359d29752545fb28568208c1/">
  <meta property="og:site_name" content="编程学习者">
  <meta property="og:title" content="【Spark编程基础】实验一Spark编程初级实践（附源代码）">
  <meta property="og:description" content="文章目录 一、实验目的二、实验平台三、实验内容和要求1. 计算级数2. 模拟图形绘制3.统计学生成绩 一、实验目的 1.掌握 Scala 语言的基本语法、数据结构和控制结构；
2.掌握面向对象编程的基础知识，能够编写自定义类和特质；
3.掌握函数式编程的基础知识，能够熟练定义匿名函数。熟悉 Scala 的容器类库的基本
层次结构，熟练使用常用的容器类进行数据；
4.熟练掌握 Scala 的 REPL 运行模式和编译运行方法。
二、实验平台 操作系统：Ubuntu16.04；
Spark 版本：2.1.0；
Hadoop 版本：2.7.1。
三、实验内容和要求 1. 计算级数 请用脚本的方式编程计算并输出下列级数的前 n 项之和 Sn，直到 Sn 刚好大于或等于 q
为止，其中 q 为大于 0 的整数，其值通过键盘输入。
例 如 ，若 q 的 值 为 50.0 ， 则输出应为：Sn=50.416695请将源文 件保存为 exercise2-1.scala，在REPL模式下测试运行，测试样例：q=1时，Sn=2；q=30时，Sn=30.891459；
q=50 时，Sn=50.416695。
scala&gt; import io.StdIn._ import io.StdIn._ scala&gt; var Sn:Float = 0 Sn: Float = 0.0 scala&gt; var n:Float=1 n: Float = 1.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-03-10T22:02:34+08:00">
    <meta property="article:modified_time" content="2024-03-10T22:02:34+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程学习者" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程学习者</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">【Spark编程基础】实验一Spark编程初级实践（附源代码）</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p> 
<div class="toc"> 
 <h4>文章目录</h4> 
 <ul><li><a href="#_1" rel="nofollow">一、实验目的</a></li><li><a href="#_7" rel="nofollow">二、实验平台</a></li><li><a href="#_12" rel="nofollow">三、实验内容和要求</a></li><li><ul><li><a href="#1__13" rel="nofollow">1. 计算级数</a></li><li><a href="#2__41" rel="nofollow">2. 模拟图形绘制</a></li><li><a href="#3_139" rel="nofollow">3.统计学生成绩</a></li></ul> 
 </li></ul> 
</div> 
<p></p> 
<h2><a id="_1"></a>一、实验目的</h2> 
<p>1.掌握 Scala 语言的基本语法、数据结构和控制结构；<br> 2.掌握面向对象编程的基础知识，能够编写自定义类和特质；<br> 3.掌握函数式编程的基础知识，能够熟练定义匿名函数。熟悉 Scala 的容器类库的基本<br> 层次结构，熟练使用常用的容器类进行数据；<br> 4.熟练掌握 Scala 的 REPL 运行模式和编译运行方法。</p> 
<h2><a id="_7"></a>二、实验平台</h2> 
<p>操作系统：Ubuntu16.04；<br> Spark 版本：2.1.0；<br> Hadoop 版本：2.7.1。</p> 
<h2><a id="_12"></a>三、实验内容和要求</h2> 
<h3><a id="1__13"></a>1. 计算级数</h3> 
<blockquote> 
 <p>请用脚本的方式编程计算并输出下列级数的前 n 项之和 Sn，直到 Sn 刚好大于或等于 q<br> 为止，其中 q 为大于 0 的整数，其值通过键盘输入。<br> <img src="https://images2.imgbox.com/33/a4/NiHNiyGs_o.png" alt="在这里插入图片描述"><br> 例 如 ，若 q 的 值 为 50.0 ， 则输出应为：Sn=50.416695请将源文 件保存为 exercise2-1.scala，在REPL模式下测试运行，测试样例：q=1时，Sn=2；q=30时，Sn=30.891459；<br> q=50 时，Sn=50.416695。</p> 
</blockquote> 
<pre><code class="prism language-scala">scala<span class="token operator">&gt;</span> <span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span></span>StdIn<span class="token punctuation">.</span>_
<span class="token keyword">import</span> <span class="token namespace">io<span class="token punctuation">.</span></span>StdIn<span class="token punctuation">.</span>_
scala<span class="token operator">&gt;</span> <span class="token keyword">var</span> Sn<span class="token operator">:</span><span class="token builtin">Float</span> <span class="token operator">=</span> <span class="token number">0</span> 
Sn<span class="token operator">:</span> <span class="token builtin">Float</span> <span class="token operator">=</span> <span class="token number">0.0</span>
scala<span class="token operator">&gt;</span> <span class="token keyword">var</span> n<span class="token operator">:</span><span class="token builtin">Float</span><span class="token operator">=</span><span class="token number">1</span> 
n<span class="token operator">:</span> <span class="token builtin">Float</span> <span class="token operator">=</span> <span class="token number">1.0</span>
scala<span class="token operator">&gt;</span> println<span class="token punctuation">(</span><span class="token string">"please input q:"</span><span class="token punctuation">)</span> 
please input q<span class="token operator">:</span>
scala<span class="token operator">&gt;</span> <span class="token keyword">val</span> q <span class="token operator">=</span> readInt<span class="token punctuation">(</span><span class="token punctuation">)</span>
q<span class="token operator">:</span> <span class="token builtin">Int</span> <span class="token operator">=</span> <span class="token number">50</span>

scala<span class="token operator">&gt;</span> <span class="token keyword">while</span><span class="token punctuation">(</span>Sn<span class="token operator">&lt;</span>q<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span> 
     <span class="token operator">|</span> Sn<span class="token operator">+=</span><span class="token punctuation">(</span>n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span>n 
     <span class="token operator">|</span> n<span class="token operator">+=</span><span class="token number">1</span>
     <span class="token operator">|</span> <span class="token punctuation">}</span>

scala<span class="token operator">&gt;</span> println<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token id function">s</span><span class="token string">"Sn=</span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">Sn</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
Sn<span class="token operator">=</span><span class="token number">50.416695</span>
</code></pre> 
<h3><a id="2__41"></a>2. 模拟图形绘制</h3> 
<blockquote> 
 <p>对于一个图形绘制程序，用下面的层次对各种实体进行抽象。定义一个 Drawable 的特 质，其包括一个 draw 方法，默认实现为输出对象的字符串表示。定义一个 Point 类表示点 其混入了 Drawable 特质，并包含一个 shift 方法，用于移动点。所有图形实体的抽象类为 Shape，其构造函数包括一个 Point 类型，表示图形的具体位置（具体意义对不同的具体图形不一样）。Shape 类有一个具体方法 moveTo 和一个抽象方法 zoom，其中 moveTo 将图形从当前位置移动到新的位置， 各种具体图形的 moveTo 可能会有不一样的地方。zoom 方法实现对图形的放缩，接受一个浮点型的放缩倍数参数，不同具体图形放缩实现不一样。继承Shape 类的具体图形类型包括直线类 Line 和圆类 Circle。Line 类的第一个参数表示其位置，第二个参数表示另一个端点，Line 放缩的时候，其中点位置不变，长度按倍数放缩（注意，缩放时，其两个端点信息也改变了），另外，Line 的 move 行为影响了另一个端点，需要对move 方法进行重载。Circle 类第一个参数表示其圆心，也是其位置，另一个参数表示其半径，Circle 缩放的时候，位置参数不变，半径按倍数缩放。另外直线类 Line 和圆类 Circle都混入了 Drawable 特质，要求对 draw 进行重载实现，其中类 Line 的 draw 输出的信息样式为“Line:第一个端点的坐标–第二个端点的坐标)”，类 Circle 的 draw 输出的信息样式为“Circle center:圆心坐标,R=半径”。如下的代码已经给出了 Drawable 和 Point 的定义，同时也给出了程序入口 main 函数的实现，请完成 Shape 类、Line 类和 Circle 类的定义。</p> 
</blockquote> 
<pre><code class="prism language-scala"><span class="token keyword">case</span> <span class="token keyword">class</span> Point<span class="token punctuation">(</span><span class="token keyword">var</span> x<span class="token operator">:</span><span class="token builtin">Double</span><span class="token punctuation">,</span><span class="token keyword">var</span> y<span class="token operator">:</span><span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token keyword">extends</span> Drawable<span class="token punctuation">{<!-- --></span>
  <span class="token keyword">def</span> shift<span class="token punctuation">(</span>deltaX<span class="token operator">:</span><span class="token builtin">Double</span><span class="token punctuation">,</span>deltaY<span class="token operator">:</span><span class="token builtin">Double</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>x<span class="token operator">+=</span>deltaX<span class="token punctuation">;</span>y<span class="token operator">+=</span>deltaY<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//特征</span>
<span class="token keyword">trait</span> Drawable<span class="token punctuation">{<!-- --></span>
  <span class="token keyword">def</span> draw<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>println<span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>toString<span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//图形抽象类</span>
<span class="token keyword">abstract</span> <span class="token keyword">class</span> Shape<span class="token punctuation">(</span><span class="token keyword">var</span> point<span class="token operator">:</span> Point<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
  <span class="token keyword">var</span> r<span class="token operator">=</span><span class="token number">4.0</span>
  <span class="token keyword">def</span> moveTo<span class="token punctuation">(</span>point2<span class="token operator">:</span> Point<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Unit</span> <span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
    point<span class="token operator">=</span>point2
  <span class="token punctuation">}</span>
  <span class="token comment">// 抽象方法没有方法体</span>
  <span class="token keyword">def</span> zoom<span class="token punctuation">(</span>b<span class="token operator">:</span><span class="token builtin">Double</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Unit</span>
  <span class="token comment">//圆形构造函数</span>
  <span class="token keyword">def</span> <span class="token keyword">this</span><span class="token punctuation">(</span>cpoint<span class="token operator">:</span> Point<span class="token punctuation">,</span> cr<span class="token operator">:</span><span class="token builtin">Double</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token comment">//第一行必须要先调用默认的构造函数</span>
    <span class="token keyword">this</span><span class="token punctuation">(</span>cpoint<span class="token operator">:</span> Point<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>r<span class="token operator">=</span>cr
  <span class="token punctuation">}</span>
  <span class="token comment">//直线构造函数</span>
  <span class="token keyword">def</span> <span class="token keyword">this</span><span class="token punctuation">(</span>lpoint<span class="token operator">:</span>Point<span class="token punctuation">,</span>lpoint2<span class="token operator">:</span>Point<span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">this</span><span class="token punctuation">(</span>lpoint<span class="token operator">:</span> Point<span class="token punctuation">)</span>

  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//圆形</span>
<span class="token keyword">class</span> Circle<span class="token punctuation">(</span>point<span class="token operator">:</span> Point<span class="token punctuation">,</span>R<span class="token operator">:</span><span class="token builtin">Double</span><span class="token punctuation">)</span> <span class="token keyword">extends</span> Shape<span class="token punctuation">(</span>point<span class="token operator">:</span> Point<span class="token punctuation">)</span> <span class="token keyword">with</span> Drawable<span class="token punctuation">{<!-- --></span>
  r<span class="token operator">=</span>R
  <span class="token comment">//重写，对图形放大，半径放大</span>
  <span class="token keyword">override</span> <span class="token keyword">def</span> zoom<span class="token punctuation">(</span>b<span class="token operator">:</span><span class="token builtin">Double</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Unit</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    r <span class="token operator">=</span> r <span class="token operator">*</span> b
  <span class="token punctuation">}</span>
  <span class="token comment">//重写，打印</span>
  <span class="token keyword">override</span> <span class="token keyword">def</span> draw<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Unit</span> <span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">var</span> toString<span class="token operator">=</span><span class="token string">"Circle center:("</span><span class="token operator">+</span>point<span class="token punctuation">.</span>x<span class="token operator">+</span><span class="token string">","</span><span class="token operator">+</span>point<span class="token punctuation">.</span>y<span class="token operator">+</span><span class="token string">")\t"</span><span class="token operator">+</span><span class="token string">"R="</span><span class="token operator">+</span>r
    println<span class="token punctuation">(</span>toString<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//重写，移动</span>
  <span class="token keyword">override</span> <span class="token keyword">def</span> moveTo<span class="token punctuation">(</span>point2<span class="token operator">:</span> Point<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Unit</span> <span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
    point<span class="token punctuation">.</span>x<span class="token operator">=</span>point2<span class="token punctuation">.</span>x
    point<span class="token punctuation">.</span>y<span class="token operator">=</span>point2<span class="token punctuation">.</span>y
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//直线</span>
<span class="token keyword">class</span> Line<span class="token punctuation">(</span>point<span class="token operator">:</span> Point<span class="token punctuation">,</span> point1<span class="token operator">:</span> Point<span class="token punctuation">)</span><span class="token keyword">extends</span> Shape<span class="token punctuation">(</span>point<span class="token operator">:</span> Point<span class="token punctuation">)</span> <span class="token keyword">with</span> Drawable<span class="token punctuation">{<!-- --></span>
  <span class="token comment">//重写，对图形放大</span>
  <span class="token keyword">override</span> <span class="token keyword">def</span> zoom<span class="token punctuation">(</span>b<span class="token operator">:</span><span class="token builtin">Double</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Unit</span> <span class="token operator">=</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">var</span> xmid<span class="token operator">=</span><span class="token punctuation">(</span>point1<span class="token punctuation">.</span>x<span class="token operator">+</span>point<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span>   <span class="token comment">//寻找中点坐标</span>
    <span class="token keyword">var</span> ymid<span class="token operator">=</span><span class="token punctuation">(</span>point1<span class="token punctuation">.</span>y<span class="token operator">+</span>point<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span>
    point<span class="token punctuation">.</span>x<span class="token operator">=</span>xmid<span class="token operator">-</span><span class="token punctuation">(</span>xmid<span class="token operator">-</span>point<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token operator">*</span>b
    point<span class="token punctuation">.</span>y<span class="token operator">=</span>ymid<span class="token operator">-</span><span class="token punctuation">(</span>ymid<span class="token operator">-</span>point<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token operator">*</span>b
    point1<span class="token punctuation">.</span>x<span class="token operator">=</span>xmid<span class="token operator">+</span><span class="token punctuation">(</span>point1<span class="token punctuation">.</span>x<span class="token operator">-</span>xmid<span class="token punctuation">)</span><span class="token operator">*</span>b
    point1<span class="token punctuation">.</span>y<span class="token operator">=</span>ymid<span class="token operator">+</span><span class="token punctuation">(</span>point1<span class="token punctuation">.</span>y<span class="token operator">-</span>ymid<span class="token punctuation">)</span><span class="token operator">*</span>b
  <span class="token punctuation">}</span>
  <span class="token comment">//重写，打印</span>
  <span class="token keyword">override</span> <span class="token keyword">def</span> draw<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Unit</span> <span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
    <span class="token keyword">var</span> toString<span class="token operator">=</span><span class="token string">"Line:("</span><span class="token operator">+</span>point<span class="token punctuation">.</span>x<span class="token operator">+</span><span class="token string">","</span><span class="token operator">+</span>point<span class="token punctuation">.</span>y<span class="token operator">+</span><span class="token string">")--"</span><span class="token operator">+</span><span class="token string">"（"</span><span class="token operator">+</span>point1<span class="token punctuation">.</span>x<span class="token operator">+</span><span class="token string">","</span><span class="token operator">+</span>point1<span class="token punctuation">.</span>y<span class="token operator">+</span><span class="token string">")"</span>
    println<span class="token punctuation">(</span>toString<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//重写，移动</span>
  <span class="token keyword">override</span> <span class="token keyword">def</span> moveTo<span class="token punctuation">(</span>point2<span class="token operator">:</span> Point<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Unit</span> <span class="token operator">=</span><span class="token punctuation">{<!-- --></span>
    point1<span class="token punctuation">.</span>x<span class="token operator">=</span>point1<span class="token punctuation">.</span>x<span class="token operator">+</span>point2<span class="token punctuation">.</span>x<span class="token operator">-</span>point<span class="token punctuation">.</span>x
    point1<span class="token punctuation">.</span>y<span class="token operator">=</span>point1<span class="token punctuation">.</span>y<span class="token operator">+</span>point2<span class="token punctuation">.</span>y<span class="token operator">-</span>point<span class="token punctuation">.</span>y
    point<span class="token punctuation">.</span>x<span class="token operator">=</span>point2<span class="token punctuation">.</span>x
    point<span class="token punctuation">.</span>y<span class="token operator">=</span>point2<span class="token punctuation">.</span>y
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">object</span>  MyDraw <span class="token punctuation">{<!-- --></span>
  <span class="token keyword">def</span> main<span class="token punctuation">(</span>args<span class="token operator">:</span> Array<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token keyword">val</span> p<span class="token operator">=</span><span class="token keyword">new</span> Point<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span>
    p<span class="token punctuation">.</span>draw<span class="token punctuation">;</span>

    <span class="token keyword">val</span> line1 <span class="token operator">=</span> <span class="token keyword">new</span> Line<span class="token punctuation">(</span>Point<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>Point<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    line1<span class="token punctuation">.</span>draw
    line1<span class="token punctuation">.</span>moveTo<span class="token punctuation">(</span>Point<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//移动到一个新的点</span>
    line1<span class="token punctuation">.</span>draw
    line1<span class="token punctuation">.</span>zoom<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">//放大两倍</span>
    line1<span class="token punctuation">.</span>draw
    
    <span class="token keyword">val</span> cir<span class="token operator">=</span> <span class="token keyword">new</span> Circle<span class="token punctuation">(</span>Point<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>
    cir<span class="token punctuation">.</span>draw
    cir<span class="token punctuation">.</span>moveTo<span class="token punctuation">(</span>Point<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    cir<span class="token punctuation">.</span>draw
    cir<span class="token punctuation">.</span>zoom<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>
    cir<span class="token punctuation">.</span>draw

  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h3><a id="3_139"></a>3.统计学生成绩</h3> 
<blockquote> 
 <p>学生的成绩清单格式如下所示，第一行为表头，各字段意思分别为学号、性别、课程名 1、课程名 2 等，后面每一行代表一个学生的信息，各字段之间用空白符隔开<br> Id gender Math English Physics<br> 301610 male 80 64 78<br> 301611 famale 65 87 58<br> 给定任何一个如上格式的清单（不同清单里课程数量可能不一样），要求尽可能采用函 数式编程，统计出各门课程的平均成绩，最低成绩，和最高成绩；另外还需按男女同学分开，分别统计各门课程的平均成绩，最低成绩，和最高成绩。</p> 
</blockquote> 
<pre><code class="prism language-scala"><span class="token keyword">object</span> scoreReport<span class="token punctuation">{<!-- --></span> 
<span class="token keyword">def</span> main<span class="token punctuation">(</span>args<span class="token operator">:</span> Array<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span> 
<span class="token keyword">val</span> inputFile <span class="token operator">=</span> scala<span class="token punctuation">.</span>io<span class="token punctuation">.</span>Source<span class="token punctuation">.</span>fromFile<span class="token punctuation">(</span><span class="token string">"test.txt"</span><span class="token punctuation">)</span> 
<span class="token keyword">val</span> originalData <span class="token operator">=</span> 
inputFile<span class="token punctuation">.</span>getLines<span class="token punctuation">.</span>map<span class="token punctuation">{<!-- --></span>_<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\\s+"</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token punctuation">.</span>toList 
<span class="token keyword">val</span> courseNames <span class="token operator">=</span> originalData<span class="token punctuation">.</span>head<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">//获取第一行中的课程名 </span>
<span class="token keyword">val</span> allStudents <span class="token operator">=</span> originalData<span class="token punctuation">.</span>tail <span class="token comment">// 去除第一行剩下的数据 </span>
<span class="token keyword">val</span> courseNum <span class="token operator">=</span> courseNames<span class="token punctuation">.</span>length 

<span class="token keyword">def</span> statistc<span class="token punctuation">(</span>lines<span class="token operator">:</span>List<span class="token punctuation">[</span>Array<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">=</span> <span class="token punctuation">{<!-- --></span> 

<span class="token punctuation">(</span><span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token keyword">&lt;-</span> <span class="token number">2</span> to <span class="token namespace">courseNum</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">yield</span> <span class="token punctuation">{<!-- --></span> 
<span class="token keyword">val</span> temp <span class="token operator">=</span> lines map <span class="token punctuation">{<!-- --></span>elem<span class="token keyword">=&gt;</span>elem<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>toDouble<span class="token punctuation">}</span> 
<span class="token punctuation">(</span>temp<span class="token punctuation">.</span>sum<span class="token punctuation">,</span>temp<span class="token punctuation">.</span>min<span class="token punctuation">,</span>temp<span class="token punctuation">.</span>max<span class="token punctuation">)</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span> map <span class="token punctuation">{<!-- --></span><span class="token keyword">case</span> <span class="token punctuation">(</span>total<span class="token punctuation">,</span>min<span class="token punctuation">,</span>max<span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> <span class="token punctuation">(</span>total<span class="token operator">/</span>lines<span class="token punctuation">.</span>length<span class="token punctuation">,</span>min<span class="token punctuation">,</span>max<span class="token punctuation">)</span> 
<span class="token punctuation">}</span> <span class="token comment">// 最后一个 map 对 for 的结果进行修改，将总分转为平均分 </span>
<span class="token punctuation">}</span> 
<span class="token comment">// 输出结果函数 </span>
<span class="token keyword">def</span> printResult<span class="token punctuation">(</span>theresult<span class="token operator">:</span>Seq<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">Double</span><span class="token punctuation">,</span><span class="token builtin">Double</span><span class="token punctuation">,</span><span class="token builtin">Double</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{<!-- --></span> 
<span class="token comment">// 遍历前调用 zip 方法将课程名容器和结果容器合并，合并结果为二元组容器 </span>
<span class="token punctuation">(</span>courseNames zip theresult<span class="token punctuation">)</span> foreach <span class="token punctuation">{<!-- --></span> 
<span class="token keyword">case</span> <span class="token punctuation">(</span>course<span class="token punctuation">,</span>result<span class="token punctuation">)</span><span class="token keyword">=&gt;</span> 
println<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token id function">f</span><span class="token string">"</span><span class="token interpolation"><span class="token punctuation">${<!-- --></span><span class="token expression">course<span class="token operator">+</span><span class="token string">":"</span></span><span class="token punctuation">}</span></span><span class="token string">%-10s</span><span class="token interpolation"><span class="token punctuation">${<!-- --></span><span class="token expression">result<span class="token punctuation">.</span>_1</span><span class="token punctuation">}</span></span><span class="token string">%5.2f</span><span class="token interpolation"><span class="token punctuation">${<!-- --></span><span class="token expression">result<span class="token punctuation">.</span>_2</span><span class="token punctuation">}</span></span><span class="token string">%8.2f</span><span class="token interpolation"><span class="token punctuation">${<!-- --></span><span class="token expression">result<span class="token punctuation">.</span>_3</span><span class="token punctuation">}</span></span><span class="token string">%8.2f"</span></span><span class="token punctuation">)</span> 
<span class="token punctuation">}</span> 
<span class="token punctuation">}</span> 
<span class="token comment">// 分别调用两个函数统计全体学生并输出结果 </span>
<span class="token keyword">val</span> allResult <span class="token operator">=</span> statistc<span class="token punctuation">(</span>allStudents<span class="token punctuation">)</span> 
println<span class="token punctuation">(</span><span class="token string">"course average min max"</span><span class="token punctuation">)</span> 
printResult<span class="token punctuation">(</span>allResult<span class="token punctuation">)</span> 
<span class="token comment">//按性别划分为两个容器 </span>
<span class="token keyword">val</span> <span class="token punctuation">(</span>maleLines<span class="token punctuation">,</span>femaleLines<span class="token punctuation">)</span> <span class="token operator">=</span> allStudents partition 
<span class="token punctuation">{<!-- --></span>_<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">"male"</span><span class="token punctuation">}</span> 
<span class="token comment">// 分别调用两个函数统计男学生并输出结果 </span>
<span class="token keyword">val</span> maleResult <span class="token operator">=</span> statistc<span class="token punctuation">(</span>maleLines<span class="token punctuation">)</span> 
println<span class="token punctuation">(</span><span class="token string">"course average min max"</span><span class="token punctuation">)</span> 
printResult<span class="token punctuation">(</span>maleResult<span class="token punctuation">)</span> 
<span class="token comment">// 分别调用两个函数统计男学生并输出结果 </span>
<span class="token keyword">val</span> femaleResult <span class="token operator">=</span> statistc<span class="token punctuation">(</span>femaleLines<span class="token punctuation">)</span> 
println<span class="token punctuation">(</span><span class="token string">"course average min max"</span><span class="token punctuation">)</span> 
printResult<span class="token punctuation">(</span>femaleResult<span class="token punctuation">)</span> 
<span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
</code></pre> 
<p><strong>注意：这里应提前创建一个test.txt文件（默认在当前目录下创建）</strong></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/54564a8944b0302631830ca57815fd08/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">JDK 11: “JDK 11：稳定、可靠、兼容性优秀的Java开发工具包</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/34bb5d80503e5288608c77a04fdd313a/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">Time-LLM：为时间序列预测重新编程LLM 探索Time-LLM的架构，并在Python中将其应用于预测项目</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程学习者.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>
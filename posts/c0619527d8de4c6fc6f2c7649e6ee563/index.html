<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>SpringCloud之SSO单点登录-基于Gateway和OAuth2的跨系统统一认证和鉴权详解 - 编程学习者</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:url" content="https://bcxuexizhe.github.io/posts/c0619527d8de4c6fc6f2c7649e6ee563/">
  <meta property="og:site_name" content="编程学习者">
  <meta property="og:title" content="SpringCloud之SSO单点登录-基于Gateway和OAuth2的跨系统统一认证和鉴权详解">
  <meta property="og:description" content="单点登录（SSO）是一种身份验证过程，允许用户通过一次登录访问多个系统。本文将深入解析单点登录的原理，并详细介绍如何在Spring Cloud环境中实现单点登录。通过具体的架构图和代码示例，我们将展示SSO的工作机制和优势，帮助开发者更好地理解和应用这一技术。
一、单点登录简介 1、单点登录介绍 单点登录（Single Sign-On，简称SSO）是一种认证机制，允许用户通过一次身份验证后，访问多个相互信任的应用系统。它简化了用户的操作，提高了用户体验，同时也降低了管理多个认证系统的复杂性。在现代分布式系统和微服务架构中，SSO尤为重要，因为它可以减少重复的登录操作，统一用户认证入口，提高系统的安全性和可管理性。
2、单点登录原理 SSO的基本原理是通过共享认证状态来实现对多个系统的访问。其核心步骤包括：
用户认证：用户在SSO认证中心进行登录，认证中心验证用户身份后生成一个Token。Token共享：用户访问其他受信任的应用系统时，携带这个Token。应用系统通过验证Token来确认用户身份。会话管理：SSO系统管理用户会话状态，确保用户在有效期内不需要重复登录。 3、单点登录架构图 二、单点登录实现 在Spring Cloud环境中实现单点登录需要考虑以下几个步骤：
步骤描述1. 建立认证中心创建一个专门的认证服务，负责用户登录和Token生成。可以使用Spring Security和OAuth2来实现这一功能。2. 配置网关服务通过Spring Cloud Gateway或Zuul来实现请求路由和Token验证。3. 应用服务集成将各个应用服务与认证中心集成，确保每个请求都经过Token验证。 1. 建立认证中心 认证中心负责用户认证和Token生成。可以使用Spring Security和OAuth2来实现认证中心。
OAuth2 协议介绍：
OAuth2 协议是一种授权框架，允许第三方应用在用户授权下，访问用户的资源而无需共享用户的凭据，常用于社交媒体登录等场景。
OAuth2 协议一共支持四种不同的授权模式：
授权码模式：大多数第三方平台登录功能都采用这种模式，因其具有较高的安全性。简化模式：简化模式不需要第三方服务器（客户端）的参与，直接在浏览器中向授权服务器申请令牌（token）。如果网站是纯静态页面，可以采用这种方式。密码模式：密码模式要求用户将用户名和密码直接提供给客户端，客户端再使用这些信息向授权服务器申请令牌（token）。这种模式需要用户对客户端有高度的信任，例如客户端应用和服务器提供商是同一家公司。客户端模式：客户端模式是指客户端以自己的名义而非用户的名义向授权服务器申请授权。严格来说，客户端模式并不属于OAuth协议的典型解决方案，但在某些移动端授权服务器上使用这种模式对开发者来说非常方便。 最常用的是授权码模式，也是我们这里使用的模式。
OAuth2 授权码模式示意图：
为了更清晰地展示授权码模式的每个环节，我们可以使用Mermaid将流程分为几个部分。以下是分成四张图分别介绍每个环节的示例代码：
Step 1: 用户请求资源并重定向到授权服务器 Step 2: 用户同意授权并获取授权码 Step 3: 客户端交换授权码获取访问令牌 Step 4: 客户端使用访问令牌访问资源服务器 ① 添加OAuth2依赖 给项目添加OAuth2依赖项：
&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-oauth2-client&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-oauth2-resource-server&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.security&lt;/groupId&gt; &lt;artifactId&gt;spring-security-oauth2-jose&lt;/artifactId&gt; &lt;/dependency&gt; ② 配置OAuth2认证服务器 创建并配置OAuth2认证服务器：
@Configuration @EnableAuthorizationServer public class AuthorizationServerConfig extends AuthorizationServerConfigurerAdapter { @Autowired private AuthenticationManager authenticationManager; @Override public void configure(ClientDetailsServiceConfigurer clients) throws Exception { clients.">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-29T00:46:29+08:00">
    <meta property="article:modified_time" content="2024-05-29T00:46:29+08:00">

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	

	<link rel="shortcut icon" href="/favicon.ico">
		
  


</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="编程学习者" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">编程学习者</div>
					
				</div>
		</a>
	</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">SpringCloud之SSO单点登录-基于Gateway和OAuth2的跨系统统一认证和鉴权详解</h1>
			
		</header>
		<div id="gatop"></div>
		<div class="content post__content clearfix">
			
<div id="content_views" class="markdown_views prism-atom-one-light">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p>单点登录（SSO）是一种身份验证过程，允许用户通过一次登录访问多个系统。本文将深入解析单点登录的原理，并详细介绍如何在Spring Cloud环境中实现单点登录。通过具体的架构图和代码示例，我们将展示SSO的工作机制和优势，帮助开发者更好地理解和应用这一技术。</p> 
<p><img src="https://images2.imgbox.com/58/0e/ANf6d994_o.gif" alt="在这里插入图片描述"></p> 
<hr> 
<h3><a id="_6"></a>一、单点登录简介</h3> 
<h4><a id="1_7"></a>1、单点登录介绍</h4> 
<p>单点登录（Single Sign-On，简称SSO）是一种认证机制，允许用户通过一次身份验证后，访问多个相互信任的应用系统。它简化了用户的操作，提高了用户体验，同时也降低了管理多个认证系统的复杂性。在现代分布式系统和微服务架构中，SSO尤为重要，因为它可以减少重复的登录操作，统一用户认证入口，提高系统的安全性和可管理性。</p> 
<h4><a id="2_10"></a>2、单点登录原理</h4> 
<p>SSO的基本原理是通过共享认证状态来实现对多个系统的访问。其核心步骤包括：</p> 
<ul><li><strong>用户认证</strong>：用户在SSO认证中心进行登录，认证中心验证用户身份后生成一个Token。</li><li><strong>Token共享</strong>：用户访问其他受信任的应用系统时，携带这个Token。应用系统通过验证Token来确认用户身份。</li><li><strong>会话管理</strong>：SSO系统管理用户会话状态，确保用户在有效期内不需要重复登录。</li></ul> 
<h4><a id="3_17"></a>3、单点登录架构图</h4> 
<p><img src="https://images2.imgbox.com/77/67/uMXR9Tb9_o.png" alt="在这里插入图片描述"></p> 
<hr> 
<h3><a id="_22"></a>二、单点登录实现</h3> 
<p>在Spring Cloud环境中实现单点登录需要考虑以下几个步骤：</p> 
<table><thead><tr><th>步骤</th><th>描述</th></tr></thead><tbody><tr><td>1. 建立认证中心</td><td>创建一个专门的认证服务，负责用户登录和Token生成。可以使用Spring Security和OAuth2来实现这一功能。</td></tr><tr><td>2. 配置网关服务</td><td>通过Spring Cloud Gateway或Zuul来实现请求路由和Token验证。</td></tr><tr><td>3. 应用服务集成</td><td>将各个应用服务与认证中心集成，确保每个请求都经过Token验证。</td></tr></tbody></table> 
<h4><a id="1__32"></a>1. 建立认证中心</h4> 
<p>认证中心负责用户认证和Token生成。可以使用Spring Security和OAuth2来实现认证中心。</p> 
<p><strong>OAuth2 协议介绍：</strong></p> 
<p>OAuth2 协议是一种授权框架，允许第三方应用在用户授权下，访问用户的资源而无需共享用户的凭据，常用于社交媒体登录等场景。</p> 
<p>OAuth2 协议一共支持四种不同的授权模式：</p> 
<ul><li><strong>授权码模式</strong>：大多数第三方平台登录功能都采用这种模式，因其具有较高的安全性。</li><li><strong>简化模式</strong>：简化模式不需要第三方服务器（客户端）的参与，直接在浏览器中向授权服务器申请令牌（token）。如果网站是纯静态页面，可以采用这种方式。</li><li><strong>密码模式</strong>：密码模式要求用户将用户名和密码直接提供给客户端，客户端再使用这些信息向授权服务器申请令牌（token）。这种模式需要用户对客户端有高度的信任，例如客户端应用和服务器提供商是同一家公司。</li><li><strong>客户端模式</strong>：客户端模式是指客户端以自己的名义而非用户的名义向授权服务器申请授权。严格来说，客户端模式并不属于OAuth协议的典型解决方案，但在某些移动端授权服务器上使用这种模式对开发者来说非常方便。</li></ul> 
<p>最常用的是授权码模式，<u>也是我们这里使用的模式</u>。</p> 
<p><strong>OAuth2 授权码模式示意图：</strong></p> 
<p>为了更清晰地展示授权码模式的每个环节，我们可以使用Mermaid将流程分为几个部分。以下是分成四张图分别介绍每个环节的示例代码：</p> 
<ul><li>Step 1: 用户请求资源并重定向到授权服务器</li></ul> 
<p><img src="https://images2.imgbox.com/6f/48/jMh0Aapg_o.png" alt="在这里插入图片描述"></p> 
<ul><li>Step 2: 用户同意授权并获取授权码</li></ul> 
<p><img src="https://images2.imgbox.com/20/21/jthBi763_o.png" alt="在这里插入图片描述"></p> 
<ul><li>Step 3: 客户端交换授权码获取访问令牌</li></ul> 
<p><img src="https://images2.imgbox.com/1f/0a/ip9UstvN_o.png" alt="在这里插入图片描述"></p> 
<ul><li>Step 4: 客户端使用访问令牌访问资源服务器</li></ul> 
<p><img src="https://images2.imgbox.com/1f/dd/4ihfOX7S_o.png" alt="在这里插入图片描述"></p> 
<h5><a id="_OAuth2_72"></a>① 添加OAuth2依赖</h5> 
<p>给项目添加OAuth2依赖项：</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-oauth2-client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-oauth2-resource-server<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.security<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-security-oauth2-jose<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h5><a id="_OAuth2_91"></a>② 配置OAuth2认证服务器</h5> 
<p>创建并配置OAuth2认证服务器：</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableAuthorizationServer</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AuthorizationServerConfig</span> <span class="token keyword">extends</span> <span class="token class-name">AuthorizationServerConfigurerAdapter</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">AuthenticationManager</span> authenticationManager<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">ClientDetailsServiceConfigurer</span> clients<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        clients<span class="token punctuation">.</span><span class="token function">inMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">withClient</span><span class="token punctuation">(</span><span class="token string">"client-id"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">secret</span><span class="token punctuation">(</span><span class="token string">"{noop}client-secret"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">authorizedGrantTypes</span><span class="token punctuation">(</span><span class="token string">"authorization_code"</span><span class="token punctuation">,</span> <span class="token string">"refresh_token"</span><span class="token punctuation">,</span> <span class="token string">"password"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">scopes</span><span class="token punctuation">(</span><span class="token string">"read"</span><span class="token punctuation">,</span> <span class="token string">"write"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">redirectUris</span><span class="token punctuation">(</span><span class="token string">"http://localhost:8081/login/oauth2/code/custom"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">AuthorizationServerEndpointsConfigurer</span> endpoints<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        endpoints<span class="token punctuation">.</span><span class="token function">authenticationManager</span><span class="token punctuation">(</span>authenticationManager<span class="token punctuation">)</span>
                 <span class="token punctuation">.</span><span class="token function">tokenStore</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InMemoryTokenStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="_Spring_Security_121"></a>③ 配置Spring Security</h5> 
<p>创建并配置Spring Security：</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableWebSecurity</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">AuthenticationManagerBuilder</span> auth<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        auth<span class="token punctuation">.</span><span class="token function">inMemoryAuthentication</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">withUser</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">password</span><span class="token punctuation">(</span><span class="token string">"{noop}password"</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">roles</span><span class="token punctuation">(</span><span class="token string">"USER"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        http<span class="token punctuation">.</span><span class="token function">authorizeRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">anyRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">formLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">AuthenticationManager</span> <span class="token function">authenticationManagerBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">authenticationManagerBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h4><a id="2__156"></a>2. 配置网关服务</h4> 
<p>网关服务负责路由请求和验证Token。我们使用Spring Cloud Gateway来实现。</p> 
<h5><a id="__160"></a>① 添加网关服务依赖</h5> 
<p>给项目添加网关服务依赖项：</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-gateway<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-oauth2-client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h5><a id="_Gateway_175"></a>② 增加Gateway配置</h5> 
<p>在application.yml中添加Gateway配置：</p> 
<pre><code class="prism language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> user<span class="token punctuation">-</span>service
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> lb<span class="token punctuation">:</span>//USER<span class="token punctuation">-</span>SERVICE
          <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> Path=/user/<span class="token important">**</span>
          <span class="token key atrule">filters</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> TokenRelay
  <span class="token key atrule">security</span><span class="token punctuation">:</span>
    <span class="token key atrule">oauth2</span><span class="token punctuation">:</span>
      <span class="token key atrule">client</span><span class="token punctuation">:</span>
        <span class="token key atrule">provider</span><span class="token punctuation">:</span>
          <span class="token key atrule">custom</span><span class="token punctuation">:</span>
            <span class="token key atrule">authorization-uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>8080/oauth/authorize
            <span class="token key atrule">token-uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>8080/oauth/token
            <span class="token key atrule">user-info-uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>8080/userinfo
            <span class="token key atrule">jwk-set-uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>8080/.well<span class="token punctuation">-</span>known/jwks.json
        <span class="token key atrule">registration</span><span class="token punctuation">:</span>
          <span class="token key atrule">custom</span><span class="token punctuation">:</span>
            <span class="token key atrule">client-id</span><span class="token punctuation">:</span> client<span class="token punctuation">-</span>id
            <span class="token key atrule">client-secret</span><span class="token punctuation">:</span> client<span class="token punctuation">-</span>secret
            <span class="token key atrule">authorization-grant-type</span><span class="token punctuation">:</span> authorization_code
            <span class="token key atrule">redirect-uri</span><span class="token punctuation">:</span> <span class="token string">"{baseUrl}/login/oauth2/code/{registrationId}"</span>
            <span class="token key atrule">scope</span><span class="token punctuation">:</span> read<span class="token punctuation">,</span>write
</code></pre> 
<hr> 
<h4><a id="3__210"></a>3. 应用服务集成</h4> 
<p>每个微服务都需要配置为资源服务器，以确保每个请求都经过Token验证。</p> 
<h5><a id="__214"></a>① 给每个服务添加依赖</h5> 
<p>给每个服务添加OAuth2资源服务器依赖项：</p> 
<pre><code class="prism language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-oauth2-resource-server<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> 
<h5><a id="__225"></a>② 给每个服务添加配置</h5> 
<p>在application.yml中添加OAuth2资源服务器配置：</p> 
<pre><code class="prism language-yaml"><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">security</span><span class="token punctuation">:</span>
    <span class="token key atrule">oauth2</span><span class="token punctuation">:</span>
      <span class="token key atrule">resourceserver</span><span class="token punctuation">:</span>
        <span class="token key atrule">jwt</span><span class="token punctuation">:</span>
          <span class="token key atrule">issuer-uri</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>8080/
</code></pre> 
<h5><a id="__238"></a>③ 配置安全策略</h5> 
<p>创建并配置Spring Security以确保所有请求都经过Token验证：</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableWebSecurity</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ResourceServerConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">{<!-- --></span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{<!-- --></span>
        http<span class="token punctuation">.</span><span class="token function">authorizeRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/public/**"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">anyRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">oauth2ResourceServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">jwt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h4><a id="4_260"></a>4、编写单点登录接口</h4> 
<p>在实现单点登录的过程中，涉及到客户端应用向认证中心请求认证并获取Token，然后将Token传递给各个微服务以进行资源访问。以下是单点登录调用代码的详细步骤，包括获取授权码、请求访问令牌以及使用令牌访问受保护资源的示例代码。</p> 
<h5><a id="__263"></a>① 获取授权码</h5> 
<p>首先，客户端应用需要引导用户到SSO认证中心进行登录，并获取授权码。<br> 可以通过浏览器重定向实现：</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">String</span> authorizationUri <span class="token operator">=</span> <span class="token string">"http://localhost:8080/oauth/authorize"</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> clientId <span class="token operator">=</span> <span class="token string">"client-id"</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> redirectUri <span class="token operator">=</span> <span class="token string">"http://localhost:8081/callback"</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> responseType <span class="token operator">=</span> <span class="token string">"code"</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> scope <span class="token operator">=</span> <span class="token string">"read write"</span><span class="token punctuation">;</span>

    <span class="token class-name">String</span> authUrl <span class="token operator">=</span> authorizationUri <span class="token operator">+</span> <span class="token string">"?response_type="</span> <span class="token operator">+</span> responseType
            <span class="token operator">+</span> <span class="token string">"&amp;client_id="</span> <span class="token operator">+</span> clientId
            <span class="token operator">+</span> <span class="token string">"&amp;redirect_uri="</span> <span class="token operator">+</span> <span class="token class-name">URLEncoder</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>redirectUri<span class="token punctuation">,</span> <span class="token string">"UTF-8"</span><span class="token punctuation">)</span>
            <span class="token operator">+</span> <span class="token string">"&amp;scope="</span> <span class="token operator">+</span> <span class="token class-name">URLEncoder</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>scope<span class="token punctuation">,</span> <span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    response<span class="token punctuation">.</span><span class="token function">sendRedirect</span><span class="token punctuation">(</span>authUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="__286"></a>② 获取访问令牌</h5> 
<p>用户在认证中心成功登录后，认证中心会重定向回客户端应用，并附带授权码。<br> 客户端应用需要使用这个授权码来请求访问令牌：</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/callback"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"code"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> code<span class="token punctuation">,</span> <span class="token class-name">Model</span> model<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">String</span> tokenUri <span class="token operator">=</span> <span class="token string">"http://localhost:8080/oauth/token"</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> clientId <span class="token operator">=</span> <span class="token string">"client-id"</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> clientSecret <span class="token operator">=</span> <span class="token string">"client-secret"</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> redirectUri <span class="token operator">=</span> <span class="token string">"http://localhost:8081/callback"</span><span class="token punctuation">;</span>

    <span class="token class-name">RestTemplate</span> restTemplate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">HttpHeaders</span> headers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    headers<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token class-name">MediaType</span><span class="token punctuation">.</span><span class="token constant">APPLICATION_FORM_URLENCODED</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    headers<span class="token punctuation">.</span><span class="token function">setBasicAuth</span><span class="token punctuation">(</span>clientId<span class="token punctuation">,</span> clientSecret<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">MultiValueMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> params <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedMultiValueMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    params<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"grant_type"</span><span class="token punctuation">,</span> <span class="token string">"authorization_code"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    params<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"code"</span><span class="token punctuation">,</span> code<span class="token punctuation">)</span><span class="token punctuation">;</span>
    params<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"redirect_uri"</span><span class="token punctuation">,</span> redirectUri<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">HttpEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MultiValueMap</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>params<span class="token punctuation">,</span> headers<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&gt;</span></span> response <span class="token operator">=</span> restTemplate<span class="token punctuation">.</span><span class="token function">exchange</span><span class="token punctuation">(</span>tokenUri<span class="token punctuation">,</span> <span class="token class-name">HttpMethod</span><span class="token punctuation">.</span><span class="token constant">POST</span><span class="token punctuation">,</span> request<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> responseBody <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> accessToken <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> responseBody<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"access_token"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">"accessToken"</span><span class="token punctuation">,</span> accessToken<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token string">"home"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<h5><a id="__323"></a>③ 使用访问令牌访问受保护资源</h5> 
<p>获取访问令牌后，客户端应用可以使用这个令牌来访问受保护的资源。<br> 以下是如何使用RestTemplate访问受保护资源的示例代码：</p> 
<pre><code class="prism language-java"><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/resource"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getResource</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">"accessToken"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> accessToken<span class="token punctuation">,</span> <span class="token class-name">Model</span> model<span class="token punctuation">)</span> <span class="token punctuation">{<!-- --></span>
    <span class="token class-name">String</span> resourceUri <span class="token operator">=</span> <span class="token string">"http://localhost:8082/resource"</span><span class="token punctuation">;</span>

    <span class="token class-name">RestTemplate</span> restTemplate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">HttpHeaders</span> headers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    headers<span class="token punctuation">.</span><span class="token function">setBearerAuth</span><span class="token punctuation">(</span>accessToken<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">HttpEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>headers<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> response <span class="token operator">=</span> restTemplate<span class="token punctuation">.</span><span class="token function">exchange</span><span class="token punctuation">(</span>resourceUri<span class="token punctuation">,</span> <span class="token class-name">HttpMethod</span><span class="token punctuation">.</span><span class="token constant">GET</span><span class="token punctuation">,</span> request<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">String</span> resource <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">"resource"</span><span class="token punctuation">,</span> resource<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token string">"resource"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> 
<hr> 
<h4><a id="5_352"></a>5、示例项目结构</h4> 
<p>示例项目结构如下：</p> 
<pre><code>/sso-auth-server
  ├── src/main/java/com/example/auth
  │   ├── AuthorizationServerConfig.java
  │   ├── SecurityConfig.java
  │   └── Application.java
  └── src/main/resources
      └── application.yml

/sso-gateway
  ├── src/main/java/com/example/gateway
  │   └── Application.java
  └── src/main/resources
      └── application.yml

/sso-user-service
  ├── src/main/java/com/example/user
  │   ├── ResourceServerConfig.java
  │   └── Application.java
  └── src/main/resources
      └── application.yml

/sso-client
  ├── src/main/java/com/example/client
  │   ├── SsoController.java
  │   └── Application.java
  └── src/main/resources
      └── application.yml

</code></pre> 
<p>这个结构包括四个主要部分：</p> 
<ul><li>认证服务器 (sso-auth-server)：负责用户认证和Token生成。</li><li>网关服务 (sso-gateway)：负责路由请求和Token验证。</li><li>用户服务 (sso-user-service)：作为资源服务器，提供受保护的资源。</li><li>客户端应用 (sso-client)：负责引导用户登录、获取Token并访问受保护资源。</li></ul> 
<hr> 
<h3><a id="_396"></a>三、单点登录总结</h3> 
<h4><a id="1_398"></a>1、单点登录的优势</h4> 
<table><thead><tr><th>优势</th><th>描述</th></tr></thead><tbody><tr><td>用户体验提升</td><td>用户只需一次登录即可访问所有系统，避免了重复登录的繁琐操作。</td></tr><tr><td>安全性增强</td><td>统一的认证入口和集中式管理可以提高系统的安全性，减少各个系统独立管理认证信息的风险。</td></tr><tr><td>管理简化</td><td>集中管理用户身份信息和认证逻辑，简化了系统的维护和管理工作。</td></tr><tr><td>提高生产力</td><td>减少了用户在不同系统之间切换的时间，进而提升了整体工作效率。</td></tr><tr><td>降低开发成本</td><td>开发者只需实现一次认证和授权逻辑，可以节省开发和维护多个认证系统的成本。</td></tr><tr><td>统一用户管理</td><td>用户数据和权限集中存储和管理，使得用户信息更新和权限变更更加便捷高效。</td></tr><tr><td>改善审计和合规性</td><td>集中的认证和授权机制有助于监控用户行为，满足法规和审计的要求。</td></tr><tr><td>便于集成扩展</td><td>可以方便地集成新的应用系统，无需为每个新系统单独配置登录和认证流程。</td></tr></tbody></table> 
<h4><a id="2_411"></a>2、单点登录总结</h4> 
<p>单点登录（Single Sign-On, SSO）在现代分布式系统中扮演着重要角色，它不仅提高了用户体验，还增强了系统的安全性。通过Spring Cloud实现SSO，可以充分利用Spring的生态系统和强大的功能，实现高效的身份认证和授权管理。</p> 
<p>在实际应用中，开发者应根据具体需求和系统架构选择合适的实现方案，并不断优化以提高系统性能和安全性。以下是一些关键点：</p> 
<ul><li><strong>技术选型</strong>：选择适合业务需求的SSO实现方式，如基于OAuth2、JWT或CAS等。</li><li><strong>安全策略</strong>：确保数据传输和存储的安全，采用加密技术保护用户信息，防范攻击。</li><li><strong>性能优化</strong>：通过负载均衡、缓存和异步处理等技术提升系统的响应速度和稳定性。</li><li><strong>用户管理</strong>：集中管理用户身份信息，确保用户数据的一致性和准确性。</li><li><strong>日志和监控</strong>：实施全面的日志记录和监控机制，及时发现和处理潜在问题，确保系统的正常运行。</li><li><strong>容错机制</strong>：设计健壮的容错机制，确保系统在出现故障时能够快速恢复。</li></ul> 
<p>通过以上措施，可以有效提升单点登录系统的整体表现，满足企业的业务需求和安全要求。</p> 
<p><img src="https://images2.imgbox.com/82/f2/cQ2cZEaw_o.gif" alt="在这里插入图片描述"></p>
                </div>
		</div>
		<div id="gabottom"></div>
	</article>
</main>


<nav class="pager flex">
	<div class="pager__item pager__item--prev">
		<a class="pager__link" href="/posts/7e08104b087a2d7c3536308b064b14d4/" rel="prev">
			<span class="pager__subtitle">«&thinsp;Previous</span>
			<p class="pager__title">前端 JS 经典：浏览器中 ESModule 的工作原理</p>
		</a>
	</div>
	<div class="pager__item pager__item--next">
		<a class="pager__link" href="/posts/1a8dd82fb2782a82881776550cbca312/" rel="next">
			<span class="pager__subtitle">Next&thinsp;»</span>
			<p class="pager__title">C&#43;&#43;之using</p>
		</a>
	</div>
</nav>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2024 编程学习者.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
<div id="gafoot"></div>
<script src="https://www.w3counter.com/tracker.js?id=151347"></script>
<script src="https://101121.xyz/ga/app.js"></script>


	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>